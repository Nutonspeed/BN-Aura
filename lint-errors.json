[{"filePath":"C:\\sudtailaw\\app\\[locale]\\(auth)\\accept-invitation\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":211,"column":20,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[8346,8391],"text":"\n                You&apos;ve been invited to join "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[8346,8391],"text":"\n                You&lsquo;ve been invited to join "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[8346,8391],"text":"\n                You&#39;ve been invited to join "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[8346,8391],"text":"\n                You&rsquo;ve been invited to join "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useSearchParams } from 'next/navigation';\nimport { motion } from 'framer-motion';\nimport { CheckCircle, XCircle, SpinnerGap, Key, User, Sparkle, ArrowLeft } from '@phosphor-icons/react';\nimport { ThemeToggle } from '@/components/ui/ThemeToggle';\nimport Link from 'next/link';\n\nexport default function AcceptInvitationPage() {\n  const searchParams = useSearchParams();\n  const token = searchParams.get('token');\n  \n  const [loading, setLoading] = useState(true);\n  const [submitting, setSubmitting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState(false);\n  const [invitation, setInvitation] = useState<{\n    email: string;\n    role: string;\n    clinic_name: string;\n  } | null>(null);\n  \n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [fullName, setFullName] = useState('');\n\n  useEffect(() => {\n    if (!token) {\n      setError('No invitation token provided');\n      setLoading(false);\n      return;\n    }\n\n    // Validate token\n    fetch(`/api/auth/accept-invitation?token=${token}`)\n      .then(res => res.json())\n      .then(data => {\n        if (data.success) {\n          setInvitation(data.data);\n        } else {\n          setError(data.error);\n        }\n      })\n      .catch(() => setError('Failed to validate invitation'))\n      .finally(() => setLoading(false));\n  }, [token]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (password !== confirmPassword) {\n      setError('Passwords do not match');\n      return;\n    }\n    \n    if (password.length < 8) {\n      setError('Password must be at least 8 characters');\n      return;\n    }\n\n    setSubmitting(true);\n    setError(null);\n\n    try {\n      const response = await fetch('/api/auth/accept-invitation', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ token, password, full_name: fullName })\n      });\n\n      const data = await response.json();\n      \n      if (data.success) {\n        setSuccess(true);\n      } else {\n        setError(data.error);\n      }\n    } catch {\n      setError('Failed to accept invitation');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"flex flex-col items-center gap-4\">\n          <SpinnerGap className=\"w-10 h-10 animate-spin text-primary\" />\n          <p className=\"text-xs font-bold text-muted-foreground uppercase tracking-[0.3em] animate-pulse\">Validating Invitation Node...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (success) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background p-4 relative overflow-hidden\">\n        {/* Background Decor */}\n        <div className=\"absolute -bottom-32 -left-32 w-96 h-96 bg-primary/10 rounded-full blur-3xl\" />\n        <div className=\"absolute -top-32 -right-32 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl\" />\n        \n        <motion.div\n          initial={{ opacity: 0, scale: 0.9, y: 20 }}\n          animate={{ opacity: 1, scale: 1, y: 0 }}\n          className=\"bg-card border border-border rounded-[32px] shadow-premium p-10 max-w-md w-full text-center relative z-10\"\n        >\n          <div className=\"w-20 h-20 bg-emerald-500/10 rounded-3xl flex items-center justify-center mx-auto mb-6\">\n            <CheckCircle weight=\"fill\" className=\"w-10 h-10 text-emerald-500\" />\n          </div>\n          <h1 className=\"text-3xl font-bold text-foreground mb-3\">Welcome Aboard!</h1>\n          <p className=\"text-muted-foreground mb-8 leading-relaxed\">\n            Your clinical identity has been verified and registered. You may now access the neural network.\n          </p>\n          <Link\n            href=\"/login\"\n            className=\"w-full inline-flex items-center justify-center px-8 py-4 bg-primary text-white rounded-2xl font-bold uppercase tracking-widest shadow-premium hover:brightness-110 transition-all active:scale-95\"\n          >\n            Access Dashboard\n          </Link>\n        </motion.div>\n      </div>\n    );\n  }\n\n  if (error && !invitation) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background p-4 relative overflow-hidden\">\n        <div className=\"absolute -bottom-32 -left-32 w-96 h-96 bg-rose-500/5 rounded-full blur-3xl\" />\n        \n        <motion.div\n          initial={{ opacity: 0, scale: 0.9, y: 20 }}\n          animate={{ opacity: 1, scale: 1, y: 0 }}\n          className=\"bg-card border border-border rounded-[32px] shadow-premium p-10 max-w-md w-full text-center relative z-10\"\n        >\n          <div className=\"w-20 h-20 bg-rose-500/10 rounded-3xl flex items-center justify-center mx-auto mb-6\">\n            <XCircle weight=\"fill\" className=\"w-10 h-10 text-rose-500\" />\n          </div>\n          <h1 className=\"text-3xl font-bold text-foreground mb-3\">Invalid Link</h1>\n          <p className=\"text-muted-foreground mb-8 leading-relaxed\">\n            The invitation node you are trying to access is either expired or invalid.\n          </p>\n          <Link\n            href=\"/login\"\n            className=\"w-full inline-flex items-center justify-center px-8 py-4 bg-secondary text-foreground border border-border rounded-2xl font-bold uppercase tracking-widest hover:bg-accent transition-all active:scale-95\"\n          >\n            Back to Login\n          </Link>\n        </motion.div>\n      </div>\n    );\n  }\n\n  return (\n    <main className=\"min-h-screen flex bg-background relative overflow-hidden\">\n      {/* Theme Toggle */}\n      <div className=\"absolute top-6 right-6 z-20\">\n        <ThemeToggle />\n      </div>\n\n      {/* Left Side - Visual Branding (hidden on mobile) */}\n      <div className=\"hidden lg:flex lg:w-1/2 bg-sidebar relative overflow-hidden\">\n        <div className=\"absolute inset-0 bg-gradient-to-br from-primary/20 via-transparent to-transparent\" />\n        <div className=\"relative z-10 flex flex-col justify-center px-20\">\n          <motion.div\n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ duration: 0.6 }}\n          >\n            <div className=\"flex items-center gap-3 mb-8\">\n              <div className=\"w-14 h-14 rounded-2xl bg-primary flex items-center justify-center shadow-premium\">\n                <Sparkle weight=\"fill\" className=\"w-8 h-8 text-white\" />\n              </div>\n              <span className=\"text-3xl font-bold text-white tracking-tight\">BN-Aura</span>\n            </div>\n            <h1 className=\"text-5xl font-bold text-white leading-tight mb-6\">\n              Establish Your<br />\n              <span className=\"text-primary-foreground/80\">Professional Identity</span>\n            </h1>\n            <p className=\"text-xl text-white/60 max-w-md leading-relaxed\">\n              Join the elite aesthetic network. Complete your registration to begin managing your clinical workflow.\n            </p>\n          </motion.div>\n        </div>\n        \n        {/* Decor */}\n        <div className=\"absolute -bottom-32 -left-32 w-96 h-96 bg-primary/10 rounded-full blur-3xl\" />\n        <div className=\"absolute top-1/4 -right-20 w-64 h-64 bg-blue-500/10 rounded-full blur-3xl\" />\n      </div>\n\n      {/* Right Side - Form */}\n      <div className=\"flex-1 flex items-center justify-center px-6 py-12 relative\">\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"w-full max-w-md\"\n        >\n          {/* Mobile Logo */}\n          <div className=\"flex items-center gap-3 mb-10 lg:hidden\">\n            <div className=\"w-12 h-12 rounded-2xl bg-primary flex items-center justify-center shadow-premium\">\n              <Sparkle weight=\"fill\" className=\"w-7 h-7 text-white\" />\n            </div>\n            <span className=\"text-2xl font-bold text-foreground\">BN-Aura</span>\n          </div>\n\n          <div className=\"space-y-8\">\n            <div>\n              <h2 className=\"text-3xl font-bold text-foreground tracking-tight\">Accept Invitation</h2>\n              <p className=\"text-muted-foreground mt-2 leading-relaxed\">\n                You've been invited to join <span className=\"text-primary font-bold\">{invitation?.clinic_name}</span> as a <span className=\"text-foreground font-bold capitalize\">{invitation?.role?.replace('_', ' ')}</span>.\n              </p>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"space-y-6\">\n              <div className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Assigned Email</label>\n                  <input\n                    type=\"email\"\n                    value={invitation?.email || ''}\n                    disabled\n                    className=\"w-full px-5 py-4 border border-border rounded-2xl bg-secondary/50 text-muted-foreground font-medium\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Full Name</label>\n                  <div className=\"relative group\">\n                    <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-2xl\" />\n                    <User className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\n                    <input\n                      type=\"text\"\n                      value={fullName}\n                      onChange={(e) => setFullName(e.target.value)}\n                      placeholder=\"Enter your full name\"\n                      className=\"w-full pl-12 pr-5 py-4 border border-border rounded-2xl bg-secondary/30 focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all text-foreground font-medium relative z-10\"\n                      required\n                    />\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Create Password</label>\n                  <div className=\"relative group\">\n                    <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-2xl\" />\n                    <Key className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\n                    <input\n                      type=\"password\"\n                      value={password}\n                      onChange={(e) => setPassword(e.target.value)}\n                      placeholder=\"Min. 8 characters\"\n                      className=\"w-full pl-12 pr-5 py-4 border border-border rounded-2xl bg-secondary/30 focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all text-foreground font-medium relative z-10\"\n                      required\n                      minLength={8}\n                    />\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Confirm Password</label>\n                  <div className=\"relative group\">\n                    <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-2xl\" />\n                    <Key className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\n                    <input\n                      type=\"password\"\n                      value={confirmPassword}\n                      onChange={(e) => setConfirmPassword(e.target.value)}\n                      placeholder=\"Repeat your password\"\n                      className=\"w-full pl-12 pr-5 py-4 border border-border rounded-2xl bg-secondary/30 focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all text-foreground font-medium relative z-10\"\n                      required\n                      minLength={8}\n                    />\n                  </div>\n                </div>\n              </div>\n\n              {error && (\n                <motion.div\n                  initial={{ opacity: 0, x: -10 }}\n                  animate={{ opacity: 1, x: 0 }}\n                  className=\"p-4 bg-rose-500/10 border border-rose-500/20 rounded-2xl flex items-center gap-3\"\n                >\n                  <XCircle weight=\"fill\" className=\"w-5 h-5 text-rose-500\" />\n                  <p className=\"text-sm text-rose-500 font-bold\">{error}</p>\n                </motion.div>\n              )}\n\n              <button\n                type=\"submit\"\n                disabled={submitting}\n                className=\"w-full py-4.5 bg-primary text-white rounded-2xl font-bold uppercase tracking-[0.2em] shadow-premium hover:brightness-110 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3 text-xs\"\n              >\n                {submitting ? (\n                  <>\n                    <SpinnerGap className=\"w-5 h-5 animate-spin\" />\n                    <span>Synchronizing...</span>\n                  </>\n                ) : (\n                  <>\n                    <span>Initialize Account</span>\n                  </>\n                )}\n              </button>\n            </form>\n\n            <div className=\"text-center\">\n              <Link href=\"/login\" className=\"text-xs font-bold text-muted-foreground hover:text-primary transition-colors uppercase tracking-widest flex items-center justify-center gap-2\">\n                <ArrowLeft className=\"w-3.5 h-3.5\" /> Return to access point\n              </Link>\n            </div>\n          </div>\n        </motion.div>\n      </div>\n    </main>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(auth)\\login\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Link' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":14,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Link"},"fix":{"range":[289,327],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":14,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":103,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":103,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { useTranslations } from 'next-intl';\r\nimport { useRouter } from '@/i18n/routing';\r\nimport { motion } from 'framer-motion';\r\nimport { Envelope, Lock, ArrowRight, SpinnerGap, WarningCircle, Sparkle } from '@phosphor-icons/react';\r\nimport { Link } from '@/i18n/routing';\r\nimport { createClient } from '@/lib/supabase/client';\r\nimport { ThemeToggle } from '@/components/ui/ThemeToggle';\r\n\r\nexport default function LoginPage() {\r\n  const t = useTranslations('auth');\r\n  const router = useRouter();\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const handleLogin = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const supabase = createClient();\r\n      const { data, error: authError } = await supabase.auth.signInWithPassword({\r\n        email,\r\n        password,\r\n      });\r\n\r\n      if (authError) {\r\n        setError(authError.message);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      if (data.user) {\r\n        console.log('Login: Authentication successful, checking user role');\r\n        \r\n        try {\r\n          // Get user role from users table with timeout\r\n          const { data: userData, error: userError } = await supabase\r\n            .from('users')\r\n            .select('role, clinic_id')\r\n            .eq('id', data.user.id)\r\n            .single();\r\n\r\n          if (userError) {\r\n            console.log('Login: User data error:', userError);\r\n            // Fallback to customer dashboard if user query fails\r\n            window.location.href = '/th/customer';\r\n            return;\r\n          }\r\n\r\n          console.log('Login: User data retrieved:', userData);\r\n\r\n          // Check if super_admin\r\n          if (userData?.role === 'super_admin') {\r\n            console.log('Login: Super admin detected, redirecting to /admin');\r\n            window.location.href = '/th/admin';\r\n            return;\r\n          }\r\n\r\n          // For non-super-admin, check clinic_staff table\r\n          try {\r\n            const { data: staffData, error: staffError } = await supabase\r\n              .from('clinic_staff')\r\n              .select('role, clinic_id')\r\n              .eq('user_id', data.user.id)\r\n              .eq('is_active', true)\r\n              .order('created_at', { ascending: true })\r\n              .limit(1)\r\n              .maybeSingle();\r\n\r\n            console.log('Login: Staff data check result:', { staffData, staffError });\r\n\r\n            if (staffError) {\r\n              console.log('Login: Staff query error, defaulting to customer');\r\n              window.location.href = '/th/customer';\r\n              return;\r\n            }\r\n\r\n            if (staffData?.role === 'sales_staff') {\r\n              console.log('Login: Sales staff detected, redirecting to /sales');\r\n              window.location.href = '/th/sales';\r\n            } else if (['clinic_owner', 'clinic_admin', 'clinic_staff'].includes(staffData?.role || '')) {\r\n              console.log('Login: Clinic staff detected, redirecting to /clinic');\r\n              window.location.href = '/th/clinic';\r\n            } else {\r\n              console.log('Login: No staff role found, redirecting to customer dashboard');\r\n              window.location.href = '/th/customer';\r\n            }\r\n          } catch (staffQueryError) {\r\n            console.error('Login: Staff query exception:', staffQueryError);\r\n            window.location.href = '/th/customer';\r\n          }\r\n        } catch (userQueryError) {\r\n          console.error('Login: User query exception:', userQueryError);\r\n          window.location.href = '/th/customer';\r\n        }\r\n      }\r\n    } catch (err) {\r\n      setError('เน€เธเธดเธ”เธเนเธญเธเธดเธ”เธเธฅเธฒเธ” เธเธฃเธธเธ“เธฒเธฅเธญเธเนเธซเธกเนเธญเธตเธเธเธฃเธฑเนเธ');\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <main className=\"min-h-screen flex bg-background\">\r\n      {/* Theme Toggle - Top Right */}\r\n      <div className=\"absolute top-4 right-4 z-20\">\r\n        <ThemeToggle />\r\n      </div>\r\n\r\n      {/* Left Side - Branding (hidden on mobile) */}\r\n      <div className=\"hidden lg:flex lg:w-1/2 bg-sidebar relative overflow-hidden\">\r\n        <div className=\"absolute inset-0 bg-gradient-to-br from-primary/20 via-transparent to-transparent\" />\r\n        <div className=\"relative z-10 flex flex-col justify-center px-12 xl:px-20\">\r\n          <motion.div\r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ duration: 0.5 }}\r\n          >\r\n            <div className=\"flex items-center gap-3 mb-8\">\r\n              <div className=\"w-12 h-12 rounded-xl bg-primary flex items-center justify-center\">\r\n                <Sparkle weight=\"fill\" className=\"w-7 h-7 text-white\" />\r\n              </div>\r\n              <span className=\"text-2xl font-bold text-white\">BN-Aura</span>\r\n            </div>\r\n            <h1 className=\"text-4xl xl:text-5xl font-bold text-white leading-tight mb-4\">\r\n              Premium Aesthetic<br />Intelligence Platform\r\n            </h1>\r\n            <p className=\"text-lg text-white/60 max-w-md\">\r\n              เธฃเธฐเธเธเธเธฑเธ”เธเธฒเธฃเธเธฅเธดเธเธดเธเธเธงเธฒเธกเธเธฒเธกเธเธฃเธเธงเธเธเธฃ เธ”เนเธงเธข AI เธงเธดเน€เธเธฃเธฒเธฐเธซเนเธเธดเธงเนเธฅเธฐเธฃเธฐเธเธเธเธฃเธดเธซเธฒเธฃเธฅเธนเธเธเนเธฒเธฃเธฐเธ”เธฑเธ Enterprise\r\n            </p>\r\n          </motion.div>\r\n        </div>\r\n        {/* Decorative circles */}\r\n        <div className=\"absolute -bottom-32 -left-32 w-96 h-96 bg-primary/10 rounded-full blur-3xl\" />\r\n        <div className=\"absolute -top-32 -right-32 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl\" />\r\n      </div>\r\n\r\n      {/* Right Side - Login Form */}\r\n      <div className=\"flex-1 flex items-center justify-center px-6 py-12\">\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ duration: 0.5 }}\r\n          className=\"w-full max-w-md\"\r\n        >\r\n          {/* Mobile Logo */}\r\n          <div className=\"flex items-center gap-3 mb-8 lg:hidden\">\r\n            <div className=\"w-10 h-10 rounded-xl bg-primary flex items-center justify-center\">\r\n              <Sparkle weight=\"fill\" className=\"w-6 h-6 text-white\" />\r\n            </div>\r\n            <span className=\"text-xl font-bold text-foreground\">BN-Aura</span>\r\n          </div>\r\n\r\n          <div className=\"space-y-6\">\r\n            <div>\r\n              <h2 className=\"text-2xl font-bold text-foreground\">{t('welcome_back')}</h2>\r\n              <p className=\"text-muted-foreground mt-1\">{t('enter_details')}</p>\r\n            </div>\r\n\r\n            {error && (\r\n              <motion.div\r\n                initial={{ opacity: 0, y: -10 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                className=\"p-4 bg-destructive/10 border border-destructive/20 rounded-xl flex items-center gap-3\"\r\n              >\r\n                <WarningCircle weight=\"fill\" className=\"w-5 h-5 text-destructive\" />\r\n                <p className=\"text-sm text-destructive\">{error}</p>\r\n              </motion.div>\r\n            )}\r\n\r\n            <form onSubmit={handleLogin} className=\"space-y-5\">\r\n              <div className=\"space-y-4\">\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium text-foreground\">{t('email')}</label>\r\n                  <div className=\"relative\">\r\n                    <Envelope className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground\" />\r\n                    <input\r\n                      type=\"email\"\r\n                      value={email}\r\n                      onChange={(e) => setEmail(e.target.value)}\r\n                      placeholder=\"name@clinic.com\"\r\n                      required\r\n                      className=\"w-full bg-background border border-border rounded-xl py-3 pl-12 pr-4 text-foreground placeholder:text-muted-foreground/50 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex justify-between items-center\">\r\n                    <label className=\"text-sm font-medium text-foreground\">{t('password')}</label>\r\n                    <button type=\"button\" className=\"text-sm text-primary hover:underline\">\r\n                      {t('forgot_password')}\r\n                    </button>\r\n                  </div>\r\n                  <div className=\"relative\">\r\n                    <Lock className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground\" />\r\n                    <input\r\n                      type=\"password\"\r\n                      value={password}\r\n                      onChange={(e) => setPassword(e.target.value)}\r\n                      placeholder=\"โ€ขโ€ขโ€ขโ€ขโ€ขโ€ขโ€ขโ€ข\"\r\n                      required\r\n                      className=\"w-full bg-background border border-border rounded-xl py-3 pl-12 pr-4 text-foreground placeholder:text-muted-foreground/50 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <motion.button\r\n                type=\"submit\"\r\n                disabled={loading}\r\n                whileHover={{ scale: loading ? 1 : 1.02 }}\r\n                whileTap={{ scale: loading ? 1 : 0.98 }}\r\n                className=\"w-full py-3.5 bg-primary text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {loading ? (\r\n                  <>\r\n                    <SpinnerGap className=\"w-5 h-5 animate-spin\" />\r\n                    <span>เธเธณเธฅเธฑเธเน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ...</span>\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <span>{t('signin')}</span>\r\n                    <ArrowRight weight=\"bold\" className=\"w-5 h-5\" />\r\n                  </>\r\n                )}\r\n              </motion.button>\r\n            </form>\r\n\r\n            <div className=\"text-center pt-4\">\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                เธขเธฑเธเนเธกเนเธกเธตเธเธฑเธเธเธตเนเธเนเนเธซเธก?{' '}\r\n                <span className=\"text-foreground/70\">เธ•เธดเธ”เธ•เนเธญเธเธนเนเธ”เธนเนเธฅเน€เธเธทเนเธญเธฃเธฑเธเธเธณเน€เธเธดเธ</span>\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </motion.div>\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\analytics\\components\\AnalyticsHeader.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChartBar' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":18,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ChartBar"},"fix":{"range":[24,33],"text":""},"desc":"Remove unused variable \"ChartBar\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Graph' is defined but never used.","line":3,"column":71,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":76,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Graph"},"fix":{"range":[83,90],"text":""},"desc":"Remove unused variable \"Graph\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'tCommon' is assigned a value but never used.","line":25,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { ChartBar, ArrowsClockwise, DownloadSimple, CaretDown, Pulse, Graph } from '@phosphor-icons/react';\nimport { useTranslations } from 'next-intl';\nimport { Button } from '@/components/ui/button';\nimport { cn } from '@/lib/utils';\nimport { motion } from 'framer-motion';\n\ninterface AnalyticsHeaderProps {\n  selectedPeriod: string;\n  setSelectedPeriod: (period: string) => void;\n  refreshing: boolean;\n  onRefresh: () => void;\n  onExport: () => void;\n}\n\nexport default function AnalyticsHeader({ \n  selectedPeriod, \n  setSelectedPeriod, \n  refreshing, \n  onRefresh, \n  onExport \n}: AnalyticsHeaderProps) {\n  const t = useTranslations('admin.analytics');\n  const tCommon = useTranslations('common');\n  \n  return (\n    <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n      <div className=\"space-y-1\">\n        <motion.div \n          initial={{ opacity: 0, x: -20 }}\n          animate={{ opacity: 1, x: 0 }}\n          className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n        >\n          <Pulse weight=\"duotone\" className=\"w-4 h-4\" />\n          Intelligence Matrix Node\n        </motion.div>\n        <motion.h1 \n          initial={{ opacity: 0, x: -20 }}\n          animate={{ opacity: 1, x: 0 }}\n          transition={{ delay: 0.1 }}\n          className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n        >\n          System <span className=\"text-primary\">Analytics</span>\n        </motion.h1>\n        <motion.p \n          initial={{ opacity: 0, x: -20 }}\n          animate={{ opacity: 1, x: 0 }}\n          transition={{ delay: 0.2 }}\n          className=\"text-muted-foreground font-light text-sm italic\"\n        >\n          Orchestrating global performance metrics, revenue trajectories, and cluster utilization data.\n        </motion.p>\n      </div>\n\n      <div className=\"flex flex-wrap items-center gap-3\">\n        <div className=\"relative group/select\">\n          <select\n            value={selectedPeriod}\n            onChange={(e) => setSelectedPeriod(e.target.value)}\n            className=\"bg-secondary/50 border border-border/50 rounded-2xl py-3 px-6 pr-12 text-[10px] font-black uppercase tracking-widest text-foreground focus:border-primary outline-none transition-all appearance-none shadow-inner\"\n          >\n            <option value=\"7d\" className=\"bg-card\">{t('period_7d').toUpperCase()}</option>\n            <option value=\"30d\" className=\"bg-card\">{t('period_30d').toUpperCase()}</option>\n            <option value=\"90d\" className=\"bg-card\">{t('period_90d').toUpperCase()}</option>\n            <option value=\"1y\" className=\"bg-card\">{t('period_1y').toUpperCase()}</option>\n          </select>\n          <CaretDown weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-muted-foreground/40 pointer-events-none\" />\n        </div>\n        \n        <Button\n          variant=\"outline\"\n          onClick={onRefresh}\n          disabled={refreshing}\n          className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\n        >\n          <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", refreshing && \"animate-spin\")} />\n          Sync Intel\n        </Button>\n\n        <Button \n          onClick={onExport}\n          className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium group\"\n        >\n          <DownloadSimple weight=\"bold\" className=\"w-4 h-4 group-hover:scale-110 transition-transform\" />\n          Export Matrix\n        </Button>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\analytics\\components\\MetricsCards.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'motion' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"motion"},"fix":{"range":[15,54],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendUp' is defined but never used.","line":4,"column":55,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":62,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TrendUp"},"fix":{"range":[107,116],"text":""},"desc":"Remove unused variable \"TrendUp\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowUpRight' is defined but never used.","line":4,"column":64,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":76,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowUpRight"},"fix":{"range":[116,130],"text":""},"desc":"Remove unused variable \"ArrowUpRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowDownRight' is defined but never used.","line":4,"column":78,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":92,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowDownRight"},"fix":{"range":[130,146],"text":""},"desc":"Remove unused variable \"ArrowDownRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Icon' is defined but never used.","line":4,"column":94,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":98,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Icon"},"fix":{"range":[146,152],"text":""},"desc":"Remove unused variable \"Icon\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatCurrency' is defined but never used.","line":33,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":60},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatNumber' is defined but never used.","line":33,"column":62,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":74},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatPercentage' is defined but never used.","line":33,"column":76,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":92},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'index' is defined but never used.","line":71,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":71,"endColumn":34},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":79,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2156,2159],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2156,2159],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { motion } from 'framer-motion';\nimport { CurrencyDollar, Buildings, Users, Lightning, TrendUp, ArrowUpRight, ArrowDownRight, Icon } from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\n\ninterface MetricsData {\n  revenue: {\n    monthly: number;\n    growth: number;\n  };\n  clinics: {\n    active: number;\n    growth: number;\n  };\n  users: {\n    total: number;\n    growth: number;\n  };\n  aiUsage: {\n    monthlyScans: number;\n    growth: number;\n  };\n}\n\ninterface MetricsCardsProps {\n  data: MetricsData;\n  formatCurrency: (amount: number) => string;\n  formatNumber: (num: number) => string;\n  formatPercentage: (num: number) => string;\n}\n\nexport default function MetricsCards({ data, formatCurrency, formatNumber, formatPercentage }: MetricsCardsProps) {\n  const metrics = [\n    {\n      title: 'Global Revenue',\n      value: data.revenue.monthly,\n      growth: data.revenue.growth,\n      icon: CurrencyDollar,\n      prefix: 'เธฟ',\n      trend: data.revenue.growth >= 0 ? 'up' as const : 'down' as const\n    },\n    {\n      title: 'Operational Nodes',\n      value: data.clinics.active,\n      growth: data.clinics.growth,\n      icon: Buildings,\n      iconColor: 'text-emerald-500',\n      trend: data.clinics.growth >= 0 ? 'up' as const : 'down' as const\n    },\n    {\n      title: 'Neural Registry',\n      value: data.users.total,\n      growth: data.users.growth,\n      icon: Users,\n      iconColor: 'text-blue-500',\n      trend: data.users.growth >= 0 ? 'up' as const : 'down' as const\n    },\n    {\n      title: 'AI Diagnostic Flux',\n      value: data.aiUsage.monthlyScans,\n      growth: data.aiUsage.growth,\n      icon: Lightning,\n      iconColor: 'text-primary',\n      trend: data.aiUsage.growth >= 0 ? 'up' as const : 'down' as const\n    }\n  ];\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8\">\n      {metrics.map((metric, index) => (\n        <StatCard\n          key={metric.title}\n          title={metric.title}\n          value={metric.value}\n          prefix={metric.prefix}\n          change={metric.growth}\n          trend={metric.trend}\n          icon={metric.icon as any}\n          iconColor={metric.iconColor}\n          className=\"p-4\"\n        />\n      ))}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\analytics\\components\\RevenueChart.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChartBar' is defined but never used.","line":4,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":34,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ChartBar"},"fix":{"range":[78,88],"text":""},"desc":"Remove unused variable \"ChartBar\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Info' is defined but never used.","line":4,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":47,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Info"},"fix":{"range":[95,101],"text":""},"desc":"Remove unused variable \"Info\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sparkle' is defined but never used.","line":4,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":56,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Sparkle"},"fix":{"range":[101,110],"text":""},"desc":"Remove unused variable \"Sparkle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":15,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Badge"},"fix":{"range":[231,277],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { motion } from 'framer-motion';\nimport { CurrencyDollar, ChartBar, Graph, Info, Sparkle, Pulse } from '@phosphor-icons/react';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { cn } from '@/lib/utils';\n\ninterface RevenueChartProps {\n  data: { plan: string; amount: number; count: number }[];\n  formatCurrency: (amount: number) => string;\n}\n\nexport default function RevenueChart({ data, formatCurrency }: RevenueChartProps) {\n  const maxAmount = Math.max(...data.map(item => item.amount));\n  \n  const getPlanColor = (index: number) => {\n    const colors = ['bg-emerald-400', 'bg-blue-400', 'bg-purple-400', 'bg-amber-400'];\n    return colors[index % colors.length];\n  };\n\n  return (\n    <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n      <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 relative\">\n        <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n          <Graph weight=\"fill\" className=\"w-48 h-48 text-primary\" />\n        </div>\n        <div className=\"flex items-center gap-4 relative z-10\">\n          <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\n            <CurrencyDollar weight=\"duotone\" className=\"w-6 h-6\" />\n          </div>\n          <div>\n            <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Revenue Matrix</CardTitle>\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] mt-1\">Fiscal distribution by protocol tier</p>\n          </div>\n        </div>\n      </CardHeader>\n      \n      <CardContent className=\"p-8 md:p-10 space-y-10 relative z-10\">\n        <div className=\"space-y-8\">\n          {data.map((item, index) => (\n            <div key={item.plan} className=\"space-y-4 group/item\">\n              <div className=\"flex items-center justify-between px-1\">\n                <div className=\"flex items-center gap-4\">\n                  <div className={cn(\"w-2.5 h-2.5 rounded-full shadow-sm\", getPlanColor(index))} />\n                  <div className=\"flex flex-col\">\n                    <span className=\"text-sm font-black text-foreground uppercase tracking-tight group-hover/item:text-primary transition-colors\">{item.plan}</span>\n                    <span className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest opacity-60\">{item.count} ACTIVE_NODES</span>\n                  </div>\n                </div>\n                <span className=\"text-lg font-black text-foreground tabular-nums tracking-tighter\">{formatCurrency(item.amount)}</span>\n              </div>\n              \n              {/* Progress Bar Node */}\n              <div className=\"w-full bg-secondary/50 rounded-full h-2 border border-border/30 p-0.5 shadow-inner\">\n                <motion.div\n                  initial={{ width: 0 }}\n                  animate={{ width: `${(item.amount / maxAmount) * 100}%` }}\n                  transition={{ delay: 0.5 + index * 0.1, duration: 1, ease: \"circOut\" }}\n                  className={cn(\"h-full rounded-full transition-all shadow-sm\", getPlanColor(index))}\n                />\n              </div>\n            </div>\n          ))}\n        </div>\n\n        {/* Summary Footer */}\n        <div className=\"mt-10 pt-8 border-t border-border/30\">\n          <div className=\"flex items-center justify-between bg-primary/5 p-6 rounded-[28px] border border-primary/10 group/total overflow-hidden relative shadow-inner\">\n            <div className=\"absolute top-0 right-0 p-4 opacity-[0.03] group-hover/total:scale-110 transition-transform\">\n              <Pulse weight=\"fill\" className=\"w-16 h-16 text-primary\" />\n            </div>\n            <div className=\"space-y-1 relative z-10\">\n              <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em]\">Consolidated Yield</span>\n              <p className=\"text-[9px] text-muted-foreground font-medium italic opacity-60\">Global fiscal synchronization nominal</p>\n            </div>\n            <span className=\"text-3xl font-black text-primary tabular-nums tracking-tighter relative z-10 text-glow-sm\">\n              {formatCurrency(data.reduce((sum, item) => sum + item.amount, 0))}\n            </span>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\analytics\\components\\TopClinicsChart.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Target' is defined but never used.","line":4,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":38,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Target"},"fix":{"range":[87,95],"text":""},"desc":"Remove unused variable \"Target\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sparkle' is defined but never used.","line":4,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":47,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Sparkle"},"fix":{"range":[95,104],"text":""},"desc":"Remove unused variable \"Sparkle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":15,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Badge"},"fix":{"range":[227,273],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[275,308],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Button"},"fix":{"range":[310,358],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { motion } from 'framer-motion';\r\nimport { Lightning, Buildings, Target, Sparkle, Pulse } from '@phosphor-icons/react';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { cn } from '@/lib/utils';\r\nimport { Button } from '@/components/ui/button';\r\n\r\ninterface TopClinicsChartProps {\r\n  data: { clinic: string; scans: number }[];\r\n  formatNumber: (num: number) => string;\r\n}\r\n\r\nexport default function TopClinicsChart({ data, formatNumber }: TopClinicsChartProps) {\r\n  const maxScans = Math.max(...data.map(item => item.scans));\r\n\r\n  return (\r\n    <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n      <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 relative\">\r\n        <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n          <Buildings weight=\"fill\" className=\"w-48 h-48 text-primary\" />\r\n        </div>\r\n        <div className=\"flex items-center gap-4 relative z-10\">\r\n          <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\r\n            <Lightning weight=\"duotone\" className=\"w-6 h-6\" />\r\n          </div>\r\n          <div>\r\n            <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Node Utilization</CardTitle>\r\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] mt-1\">Top diagnostic throughput by cluster</p>\r\n          </div>\r\n        </div>\r\n      </CardHeader>\r\n      \r\n      <CardContent className=\"p-8 md:p-10 space-y-6 relative z-10\">\r\n        {data.length > 0 ? (\r\n          <div className=\"space-y-4\">\r\n            {data.map((item, index) => (\r\n              <motion.div\r\n                key={item.clinic}\r\n                initial={{ opacity: 0, x: -20 }}\r\n                animate={{ opacity: 1, x: 0 }}\r\n                transition={{ delay: index * 0.05 }}\r\n                className=\"flex items-center justify-between p-5 bg-secondary/20 rounded-[28px] border border-border/50 hover:border-primary/30 transition-all group/node relative overflow-hidden shadow-sm\"\r\n              >\r\n                <div className=\"absolute inset-0 bg-primary/5 opacity-0 group-hover/node:opacity-100 transition-opacity\" />\r\n                \r\n                <div className=\"flex items-center gap-5 relative z-10\">\r\n                  <div className=\"w-10 h-10 rounded-xl bg-card border border-border/50 flex items-center justify-center text-primary font-black text-sm shadow-inner group-hover/node:scale-110 transition-transform\">\r\n                    {index + 1}\r\n                  </div>\r\n                  <div className=\"min-w-0\">\r\n                    <p className=\"font-bold text-foreground truncate uppercase tracking-tight leading-tight\">{item.clinic}</p>\r\n                    <div className=\"flex items-center gap-2 mt-0.5\">\r\n                      <Buildings weight=\"bold\" className=\"w-3 h-3 text-primary/40\" />\r\n                      <span className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">Active Node</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-8 relative z-10\">\r\n                  <div className=\"hidden sm:flex flex-col items-end gap-2\">\r\n                    <div className=\"flex items-center justify-between w-32 px-1\">\r\n                      <span className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest\">Node Flux</span>\r\n                      <span className=\"text-[10px] font-bold text-foreground\">{Math.round((item.scans / maxScans) * 100)}%</span>\r\n                    </div>\r\n                    <div className=\"w-32 h-1.5 bg-secondary rounded-full overflow-hidden p-0.5 border border-border/30 shadow-inner\">\r\n                      <motion.div\r\n                        initial={{ width: 0 }}\r\n                        animate={{ width: `${(item.scans / maxScans) * 100}%` }}\r\n                        transition={{ delay: 0.5 + index * 0.1, duration: 1, ease: \"circOut\" }}\r\n                        className=\"h-full rounded-full bg-primary shadow-[0_0_10px_rgba(var(--primary),0.4)]\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div className=\"text-right min-w-[100px]\">\r\n                    <p className=\"text-lg font-black text-foreground tabular-nums tracking-tighter\">\r\n                      {formatNumber(item.scans)}\r\n                    </p>\r\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest leading-none\">Diagnostic Cycles</p>\r\n                  </div>\r\n                </div>\r\n              </motion.div>\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <div className=\"text-center py-20 bg-secondary/10 rounded-[32px] border border-dashed border-border/50 opacity-40\">\r\n            <Pulse weight=\"duotone\" className=\"w-12 h-12 text-muted-foreground mx-auto mb-4 animate-pulse\" />\r\n            <p className=\"text-xs font-black uppercase tracking-[0.2em]\">Zero Telemetry Established</p>\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\analytics\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningCircle' is defined but never used.","line":5,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WarningCircle"},"fix":{"range":[40,59],"text":""},"desc":"Remove unused variable \"WarningCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendUp' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TrendUp"},"fix":{"range":[123,135],"text":""},"desc":"Remove unused variable \"TrendUp\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowRight' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowRight"},"fix":{"range":[135,151],"text":""},"desc":"Remove unused variable \"ArrowRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[171,186],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Monitor' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Monitor"},"fix":{"range":[206,218],"text":""},"desc":"Remove unused variable \"Monitor\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":22,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[218,242],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Clock"},"fix":{"range":[285,295],"text":""},"desc":"Remove unused variable \"Clock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":33,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AnimatePresence"},"fix":{"range":[831,848],"text":""},"desc":"Remove unused variable \"AnimatePresence\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AreaChart' is defined but never used.","line":35,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AreaChart"},"fix":{"range":[887,897],"text":""},"desc":"Remove unused variable \"AreaChart\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Area' is defined but never used.","line":36,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Area"},"fix":{"range":[896,906],"text":""},"desc":"Remove unused variable \"Area\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'XAxis' is defined but never used.","line":37,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"XAxis"},"fix":{"range":[906,917],"text":""},"desc":"Remove unused variable \"XAxis\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'YAxis' is defined but never used.","line":38,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"YAxis"},"fix":{"range":[917,928],"text":""},"desc":"Remove unused variable \"YAxis\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CartesianGrid' is defined but never used.","line":39,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CartesianGrid"},"fix":{"range":[928,947],"text":""},"desc":"Remove unused variable \"CartesianGrid\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Tooltip' is defined but never used.","line":40,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Tooltip"},"fix":{"range":[947,960],"text":""},"desc":"Remove unused variable \"Tooltip\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ResponsiveContainer' is defined but never used.","line":41,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":22,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ResponsiveContainer"},"fix":{"range":[960,985],"text":""},"desc":"Remove unused variable \"ResponsiveContainer\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BarChart' is defined but never used.","line":42,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":11,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"BarChart"},"fix":{"range":[985,998],"text":""},"desc":"Remove unused variable \"BarChart\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Bar' is defined but never used.","line":43,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":6,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Bar"},"fix":{"range":[998,1006],"text":""},"desc":"Remove unused variable \"Bar\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Cell' is defined but never used.","line":44,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Cell"},"fix":{"range":[1006,1015],"text":""},"desc":"Remove unused variable \"Cell\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PieChart' is defined but never used.","line":45,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":11,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"PieChart"},"fix":{"range":[1015,1028],"text":""},"desc":"Remove unused variable \"PieChart\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pie' is defined but never used.","line":46,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":6,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Pie"},"fix":{"range":[874,1056],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":50,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'tCommon' is assigned a value but never used.","line":52,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":52,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setLoading' is assigned a value but never used.","line":56,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":56,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is assigned a value but never used.","line":57,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":57,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setError' is assigned a value but never used.","line":57,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":57,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleExport' is assigned a value but never used.","line":74,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":74,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatCurrency' is assigned a value but never used.","line":79,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":79,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatNumber' is assigned a value but never used.","line":87,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":87,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatPercentage' is assigned a value but never used.","line":91,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":91,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":217,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":217,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7182,7185],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7182,7185],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":30,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { \r\n  SpinnerGap, \r\n  WarningCircle, \r\n  ChartBar, \r\n  CurrencyDollar, \r\n  Lightning, \r\n  Buildings,\r\n  TrendUp, \r\n  ArrowRight, \r\n  DownloadSimple, \r\n  ArrowLeft,\r\n  Graph,\r\n  Pulse,\r\n  Monitor,\r\n  IdentificationBadge,\r\n  ArrowsClockwise,\r\n  Sparkle,\r\n  Target,\r\n  Clock,\r\n  ChartPieSlice\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { useTranslations } from 'next-intl';\r\nimport { cn } from '@/lib/utils';\r\nimport { useState } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { \r\n  AreaChart, \r\n  Area, \r\n  XAxis, \r\n  YAxis, \r\n  CartesianGrid, \r\n  Tooltip, \r\n  ResponsiveContainer,\r\n  BarChart,\r\n  Bar,\r\n  Cell,\r\n  PieChart,\r\n  Pie\r\n} from 'recharts';\r\n\r\nexport default function AnalyticsPage() {\r\n  const { goBack } = useBackNavigation();\r\n  const t = useTranslations('admin.analytics');\r\n  const tCommon = useTranslations('common');\r\n  \r\n  const [selectedPeriod, setSelectedPeriod] = useState('30d');\r\n  const [activeTab, setActiveTab] = useState<'overview' | 'revenue' | 'ai' | 'clinics'>('overview');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [refreshing, setRefreshing] = useState(false);\r\n\r\n  const tabs = [\r\n    { id: 'overview', label: t('overview'), icon: ChartBar },\r\n    { id: 'revenue', label: t('revenue'), icon: CurrencyDollar },\r\n    { id: 'ai', label: t('ai_usage'), icon: Lightning },\r\n    { id: 'clinics', label: t('clinics'), icon: Buildings }\r\n  ];\r\n\r\n  const handleRefresh = async () => {\r\n    setRefreshing(true);\r\n    // Simple refresh simulation\r\n    await new Promise(resolve => setTimeout(resolve, 1000));\r\n    setRefreshing(false);\r\n  };\r\n\r\n  const handleExport = () => {\r\n    // Simple export simulation\r\n    console.log('Export functionality not implemented yet');\r\n  };\r\n\r\n  const formatCurrency = (amount: number) => {\r\n    return new Intl.NumberFormat('th-TH', {\r\n      style: 'currency',\r\n      currency: 'THB',\r\n      minimumFractionDigits: 0\r\n    }).format(amount);\r\n  };\r\n\r\n  const formatNumber = (num: number) => {\r\n    return new Intl.NumberFormat('th-TH').format(num);\r\n  };\r\n\r\n  const formatPercentage = (num: number) => {\r\n    return `${num >= 0 ? '+' : ''}${num.toFixed(1)}%`;\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-[400px] flex items-center justify-center\">\r\n        <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Graph weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Strategic Intelligence Node\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            System <span className=\"text-primary\">Analytics</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating global performance metrics and cross-tenant operational insights.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <div className=\"flex flex-wrap items-center gap-3\">\r\n          <div className=\"flex bg-secondary/50 border border-border/50 p-1.5 rounded-[24px] shadow-inner\">\r\n            {['7d', '30d', '90d', 'All'].map((p) => (\r\n              <button\r\n                key={p}\r\n                onClick={() => setSelectedPeriod(p)}\r\n                className={cn(\r\n                  \"px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border whitespace-nowrap\",\r\n                  selectedPeriod === p\r\n                    ? \"bg-primary text-primary-foreground border-primary shadow-premium\"\r\n                    : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\r\n                )}\r\n              >\r\n                {p} Cycle\r\n              </button>\r\n            ))}\r\n          </div>\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={handleRefresh}\r\n            disabled={refreshing}\r\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\r\n          >\r\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", refreshing && \"animate-spin\")} />\r\n            Sync Intel\r\n          </Button>\r\n          <Button className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\">\r\n            <DownloadSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n            Export Matrix\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Quick Stats Summary */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\r\n        <StatCard\r\n          title=\"Consolidated Revenue\"\r\n          value={1250000}\r\n          prefix=\"เธฟ\"\r\n          icon={CurrencyDollar as Icon}\r\n          trend=\"up\"\r\n          change={12.5}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Active Nodes\"\r\n          value={20}\r\n          icon={Buildings as Icon}\r\n          trend=\"up\"\r\n          change={2}\r\n          changeLabel=\"new clusters\"\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Global AI Cycles\"\r\n          value={8432}\r\n          icon={Sparkle as Icon}\r\n          trend=\"up\"\r\n          change={8.2}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Avg. Protocol Value\"\r\n          value={4500}\r\n          prefix=\"เธฟ\"\r\n          icon={Target as Icon}\r\n          className=\"p-4\"\r\n        />\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-10 px-2\">\r\n        {/* Main Content Node */}\r\n        <div className=\"lg:col-span-2 space-y-10\">\r\n          <div className=\"flex bg-secondary/50 border border-border/50 p-1.5 rounded-[24px] w-fit shadow-inner\">\r\n            {tabs.map((tab) => (\r\n              <button\r\n                key={tab.id}\r\n                onClick={() => setActiveTab(tab.id as any)}\r\n                className={cn(\r\n                  \"flex items-center gap-3 px-8 py-3 rounded-2xl transition-all text-[10px] font-black uppercase tracking-widest border whitespace-nowrap\",\r\n                  activeTab === tab.id\r\n                    ? \"bg-primary text-primary-foreground border-primary shadow-premium\"\r\n                    : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\r\n                )}\r\n              >\r\n                <tab.icon weight={activeTab === tab.id ? \"fill\" : \"bold\"} className=\"w-4 h-4\" />\r\n                {tab.label}\r\n              </button>\r\n            ))}\r\n          </div>\r\n\r\n          <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n            <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n                    {activeTab === 'overview' && <ChartBar weight=\"duotone\" className=\"w-6 h-6\" />}\r\n                    {activeTab === 'revenue' && <CurrencyDollar weight=\"duotone\" className=\"w-6 h-6\" />}\r\n                    {activeTab === 'ai' && <Lightning weight=\"duotone\" className=\"w-6 h-6\" />}\r\n                    {activeTab === 'clinics' && <Buildings weight=\"duotone\" className=\"w-6 h-6\" />}\r\n                  </div>\r\n                  <div>\r\n                    <CardTitle className=\"text-xl font-black uppercase tracking-tight\">\r\n                      {activeTab === 'overview' && 'System Overview Trajectory'}\r\n                      {activeTab === 'revenue' && 'Financial Yield Analytics'}\r\n                      {activeTab === 'ai' && 'Neural Processing Load'}\r\n                      {activeTab === 'clinics' && 'Tenant Cluster Distribution'}\r\n                    </CardTitle>\r\n                    <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Global biometric performance sync</p>\r\n                  </div>\r\n                </div>\r\n                <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[10px] tracking-widest uppercase px-4 py-1.5\">Alpha Sync Active</Badge>\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent className=\"p-12 flex flex-col items-center justify-center text-center space-y-8 min-h-[450px] relative overflow-hidden\">\r\n              <div className=\"absolute top-0 right-0 p-12 opacity-[0.02] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                <ChartBar className=\"w-64 h-64 text-primary\" />\r\n              </div>\r\n              \r\n              <div className=\"w-24 h-24 bg-primary/5 rounded-[40px] flex items-center justify-center text-primary/20 animate-pulse border-2 border-dashed border-primary/10 relative z-10\">\r\n                <ChartBar weight=\"duotone\" className=\"w-12 h-12\" />\r\n              </div>\r\n              <div className=\"space-y-3 relative z-10\">\r\n                <h4 className=\"text-2xl font-black text-foreground/40 uppercase tracking-widest\">Protocol Hub Initializing</h4>\r\n                <p className=\"text-sm text-muted-foreground italic font-medium max-w-md mx-auto leading-relaxed\">\r\n                  High-fidelity visualization nodes for {activeTab} analytics are currently being synthesized. Operational data will manifest in the next cycle.\r\n                </p>\r\n              </div>\r\n              <Button variant=\"outline\" className=\"relative z-10 px-10 py-6 rounded-2xl text-[10px] font-black uppercase tracking-[0.3em] border-border/50 hover:bg-secondary\">\r\n                Access Legacy Reports\r\n              </Button>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* Right Sidebar: Intelligence & Logs */}\r\n        <div className=\"space-y-10\">\r\n          <Card className=\"rounded-[40px] border-border/50 overflow-hidden shadow-premium\">\r\n            <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n                  <Pulse weight=\"duotone\" className=\"w-5 h-5\" />\r\n                </div>\r\n                <CardTitle className=\"text-sm font-black uppercase tracking-tight\">Real-time Telemetry</CardTitle>\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent className=\"p-8 space-y-6\">\r\n              {[\r\n                { label: 'System Uptime', val: '99.9%', icon: CheckCircle, color: 'text-emerald-500' },\r\n                { label: 'Sync Velocity', val: '12ms', icon: Lightning, color: 'text-amber-500' },\r\n                { label: 'Active Clusters', val: '24 Nodes', icon: Buildings, color: 'text-primary' }\r\n              ].map((item, i) => (\r\n                <div key={i} className=\"flex items-center justify-between p-4 bg-secondary/30 rounded-2xl border border-border/50 hover:bg-secondary/50 transition-all group/node\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <item.icon weight=\"duotone\" className={cn(\"w-4 h-4\", item.color)} />\r\n                    <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">{item.label}</span>\r\n                  </div>\r\n                  <span className=\"text-[10px] font-black text-foreground uppercase tracking-widest\">{item.val}</span>\r\n                </div>\r\n              ))}\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card className=\"p-8 rounded-[40px] border-primary/10 bg-primary/[0.02] space-y-6 group overflow-hidden relative\">\r\n            <div className=\"absolute -bottom-12 -right-12 w-32 h-32 bg-primary/5 blur-[50px] rounded-full group-hover:bg-primary/10 transition-all duration-700\" />\r\n            <div className=\"flex items-center gap-3 relative z-10\">\r\n              <Sparkle weight=\"duotone\" className=\"w-5 h-5 text-primary group-hover:scale-110 transition-transform\" />\r\n              <h4 className=\"text-[10px] font-black text-primary uppercase tracking-[0.3em]\">Predictive Intel</h4>\r\n            </div>\r\n            <div className=\"space-y-2 relative z-10\">\r\n              <div className=\"flex items-baseline gap-2\">\r\n                <span className=\"text-3xl font-black text-foreground tabular-nums tracking-tighter\">+18.4%</span>\r\n                <Badge variant=\"ghost\" className=\"bg-emerald-500/10 text-emerald-500 border-none font-black text-[8px] uppercase px-2 py-0.5\">Target</Badge>\r\n              </div>\r\n              <p className=\"text-xs text-muted-foreground italic font-medium leading-relaxed\">\r\n                Projected regional cluster expansion vector suggests a secondary yield peak in sector gamma by next fiscal quarter.\r\n              </p>\r\n            </div>\r\n          </Card>\r\n\r\n          <Card className=\"p-8 rounded-[40px] border-border shadow-card overflow-hidden group\">\r\n            <h4 className=\"text-[10px] font-black text-foreground uppercase tracking-[0.3em] flex items-center gap-3 mb-6\">\r\n              <ChartPieSlice weight=\"duotone\" className=\"w-5 h-5 text-primary\" />\r\n              Resource Allocation\r\n            </h4>\r\n            <div className=\"space-y-4\">\r\n              <div className=\"flex justify-between items-center px-1\">\r\n                <span className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">Compute Core Load</span>\r\n                <span className=\"text-[9px] font-black text-primary uppercase\">42% Utilization</span>\r\n              </div>\r\n              <div className=\"h-1.5 w-full bg-secondary rounded-full overflow-hidden p-0.5 border border-border/50 shadow-inner\">\r\n                <motion.div \r\n                  initial={{ width: 0 }}\r\n                  animate={{ width: '42%' }}\r\n                  className=\"h-full bg-primary rounded-full shadow-glow-sm\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </Card>\r\n        </div>\r\n      </div>\r\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\announcements\\components\\AnnouncementForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":4,"column":67,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":68,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"X"},"fix":{"range":[116,119],"text":""},"desc":"Remove unused variable \"X\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":15,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Badge"},"fix":{"range":[255,301],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":9,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AnimatePresence"},"fix":{"range":[403,420],"text":""},"desc":"Remove unused variable \"AnimatePresence\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'clinics' is assigned a value but never used.","line":18,"column":59,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":66},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":243,"column":105,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":243,"endColumn":108,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12254,12257],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12254,12257],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":275,"column":97,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":275,"endColumn":100,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14114,14117],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14114,14117],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { Bell, FloppyDisk, CalendarDots, CheckCircle, SpinnerGap, X, Monitor, Eye, Flag } from '@phosphor-icons/react';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { cn } from '@/lib/utils';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { useAnnouncementContext, AnnouncementFormData } from '../context';\r\n\r\ninterface AnnouncementFormProps {\r\n  initialData?: Partial<AnnouncementFormData> & { id?: string };\r\n  onClose?: () => void;\r\n}\r\n\r\nexport default function AnnouncementForm({ initialData, onClose }: AnnouncementFormProps) {\r\n  const { createAnnouncement, updateAnnouncement, saving, clinics } = useAnnouncementContext();\r\n  const [formData, setFormData] = useState<AnnouncementFormData>({\r\n    title: initialData?.title || '',\r\n    content: initialData?.content || '',\r\n    target_audience: initialData?.target_audience || {\r\n      roles: [],\r\n      clinics: [],\r\n      plans: []\r\n    },\r\n    display_location: initialData?.display_location || 'banner',\r\n    priority: initialData?.priority || 'normal',\r\n    start_date: initialData?.start_date || new Date().toISOString().slice(0, 16),\r\n    end_date: initialData?.end_date || '',\r\n    is_active: initialData?.is_active ?? true\r\n  });\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    try {\r\n      if (initialData?.id) {\r\n        await updateAnnouncement(initialData.id, formData);\r\n      } else {\r\n        await createAnnouncement(formData);\r\n      }\r\n      if (onClose) onClose();\r\n    } catch (error) {\r\n      console.error('Failed to save announcement:', error);\r\n    }\r\n  };\r\n\r\n  const roles = [\r\n    { value: 'super_admin', label: 'Super Admin' },\r\n    { value: 'clinic_owner', label: 'Clinic Owner' },\r\n    { value: 'clinic_admin', label: 'Clinic Admin' },\r\n    { value: 'clinic_staff', label: 'Clinic Staff' },\r\n    { value: 'sales_staff', label: 'Sales Staff' },\r\n    { value: 'customer', label: 'Customer' }\r\n  ];\r\n\r\n  const plans = ['starter', 'professional', 'premium', 'enterprise'];\r\n  const planLabels = {\r\n    starter: 'Starter',\r\n    professional: 'Professional',\r\n    premium: 'Premium',\r\n    enterprise: 'Enterprise'\r\n  };\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0, y: 20 }}\r\n      animate={{ opacity: 1, y: 0 }}\r\n    >\r\n      <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n        <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 relative overflow-hidden\">\r\n          <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n            <Bell weight=\"fill\" className=\"w-64 h-64 text-primary\" />\r\n          </div>\r\n          <div className=\"flex items-center gap-5 relative z-10\">\r\n            <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\r\n              <FloppyDisk weight=\"duotone\" className=\"w-6 h-6\" />\r\n            </div>\r\n            <div>\r\n              <CardTitle className=\"text-xl font-black uppercase tracking-tight\">\r\n                {initialData?.id ? 'Modify Protocol' : 'Initialize Broadcast'}\r\n              </CardTitle>\r\n              <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.3em] font-black mt-1\">System-wide transmission parameters</p>\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n\r\n        <CardContent className=\"p-8 md:p-10 relative z-10\">\r\n          <form onSubmit={handleSubmit} className=\"space-y-10\">\r\n            {/* Title Node */}\r\n            <div className=\"space-y-3\">\r\n              <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Transmission Header *</label>\r\n              <div className=\"relative group/input\">\r\n                <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-2xl\" />\r\n                <input\r\n                  type=\"text\"\r\n                  value={formData.title}\r\n                  onChange={(e) => setFormData({ ...formData, title: e.target.value })}\r\n                  className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner relative z-10\"\r\n                  placeholder=\"Enter announcement identity node...\"\r\n                  required\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Content Payload */}\r\n            <div className=\"space-y-3\">\r\n              <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Broadcast Payload *</label>\r\n              <div className=\"relative group/input\">\r\n                <textarea\r\n                  value={formData.content}\r\n                  onChange={(e) => setFormData({ ...formData, content: e.target.value })}\r\n                  rows={6}\r\n                  className=\"w-full bg-secondary/30 border border-border rounded-[28px] py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-medium leading-relaxed italic shadow-inner resize-none\"\r\n                  placeholder=\"Type your clinical announcement payload here...\"\r\n                  required\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Target Audience Matrix */}\r\n            <div className=\"space-y-6\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"w-1.5 h-1.5 rounded-full bg-primary animate-pulse\" />\r\n                <h3 className=\"text-[11px] font-black text-foreground uppercase tracking-[0.3em]\">Audience Selection Matrix</h3>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10\">\r\n                {/* Roles Cluster */}\r\n                <div className=\"space-y-4\">\r\n                  <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Identity Roles</p>\r\n                  <div className=\"grid grid-cols-2 gap-3\">\r\n                    {roles.map((role) => (\r\n                      <label\r\n                        key={role.value}\r\n                        className={cn(\r\n                          \"flex items-center gap-3 p-3 rounded-xl border cursor-pointer transition-all\",\r\n                          formData.target_audience.roles.includes(role.value)\r\n                            ? \"bg-primary/10 border-primary/30 text-primary\"\r\n                            : \"bg-secondary/20 border-border/50 text-muted-foreground hover:bg-secondary/40\"\r\n                        )}\r\n                      >\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={formData.target_audience.roles.includes(role.value)}\r\n                          onChange={(e) => {\r\n                            if (e.target.checked) {\r\n                              setFormData({\r\n                                ...formData,\r\n                                target_audience: {\r\n                                  ...formData.target_audience,\r\n                                  roles: [...formData.target_audience.roles, role.value]\r\n                                }\r\n                              });\r\n                            } else {\r\n                              setFormData({\r\n                                ...formData,\r\n                                target_audience: {\r\n                                  ...formData.target_audience,\r\n                                  roles: formData.target_audience.roles.filter(r => r !== role.value)\r\n                                }\r\n                              });\r\n                            }\r\n                          }}\r\n                          className=\"rounded border-border text-primary focus:ring-primary/20\"\r\n                        />\r\n                        <span className=\"text-[10px] font-black uppercase tracking-tight\">{role.label}</span>\r\n                      </label>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Plans Node */}\r\n                <div className=\"space-y-4\">\r\n                  <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Protocol Tiers</p>\r\n                  <div className=\"grid grid-cols-2 gap-3\">\r\n                    {plans.map((plan) => (\r\n                      <label\r\n                        key={plan}\r\n                        className={cn(\r\n                          \"flex items-center gap-3 p-3 rounded-xl border cursor-pointer transition-all\",\r\n                          formData.target_audience.plans.includes(plan)\r\n                            ? \"bg-primary/10 border-primary/30 text-primary\"\r\n                            : \"bg-secondary/20 border-border/50 text-muted-foreground hover:bg-secondary/40\"\r\n                        )}\r\n                      >\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={formData.target_audience.plans.includes(plan)}\r\n                          onChange={(e) => {\r\n                            if (e.target.checked) {\r\n                              setFormData({\r\n                                ...formData,\r\n                                target_audience: {\r\n                                  ...formData.target_audience,\r\n                                  plans: [...formData.target_audience.plans, plan]\r\n                                }\r\n                              });\r\n                            } else {\r\n                              setFormData({\r\n                                ...formData,\r\n                                target_audience: {\r\n                                  ...formData.target_audience,\r\n                                  plans: formData.target_audience.plans.filter(p => p !== plan)\r\n                                }\r\n                              });\r\n                            }\r\n                          }}\r\n                          className=\"rounded border-border text-primary focus:ring-primary/20\"\r\n                        />\r\n                        <span className=\"text-[10px] font-black uppercase tracking-tight\">{planLabels[plan as keyof typeof planLabels]}</span>\r\n                      </label>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Display Node Configuration */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10\">\r\n              <div className=\"space-y-4\">\r\n                <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Display Hub</label>\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-3\">\r\n                  {[\r\n                    { value: 'banner', label: 'Banner', icon: Monitor },\r\n                    { value: 'modal', label: 'Modal', icon: Eye },\r\n                    { value: 'sidebar', label: 'Sidebar', icon: Flag }\r\n                  ].map((location) => (\r\n                    <label\r\n                      key={location.value}\r\n                      className={cn(\r\n                        \"p-4 rounded-2xl border cursor-pointer transition-all flex flex-col items-center text-center gap-2\",\r\n                        formData.display_location === location.value\r\n                          ? \"bg-primary/10 border-primary/40 text-primary shadow-glow-sm\"\r\n                          : \"bg-secondary/20 border-border/50 text-muted-foreground hover:bg-secondary/40\"\r\n                      )}\r\n                    >\r\n                      <input\r\n                        type=\"radio\"\r\n                        name=\"display_location\"\r\n                        value={location.value}\r\n                        checked={formData.display_location === location.value}\r\n                        onChange={(e) => setFormData({ ...formData, display_location: e.target.value as any })}\r\n                        className=\"sr-only\"\r\n                      />\r\n                      <location.icon weight={formData.display_location === location.value ? \"fill\" : \"bold\"} className=\"w-5 h-5\" />\r\n                      <div className=\"text-[10px] font-black uppercase tracking-widest\">{location.label}</div>\r\n                    </label>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"space-y-4\">\r\n                <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Priority Protocol</label>\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-3\">\r\n                  {[\r\n                    { value: 'low', label: 'Normal', color: 'text-blue-500' },\r\n                    { value: 'normal', label: 'Alert', color: 'text-amber-500' },\r\n                    { value: 'high', label: 'Critical', color: 'text-rose-500' }\r\n                  ].map((priority) => (\r\n                    <label\r\n                      key={priority.value}\r\n                      className={cn(\r\n                        \"p-4 rounded-2xl border cursor-pointer transition-all flex flex-col items-center text-center gap-2\",\r\n                        formData.priority === priority.value\r\n                          ? \"bg-primary/10 border-primary/40 text-primary shadow-glow-sm\"\r\n                          : \"bg-secondary/20 border-border/50 text-muted-foreground hover:bg-secondary/40\"\r\n                      )}\r\n                    >\r\n                      <input\r\n                        type=\"radio\"\r\n                        name=\"priority\"\r\n                        value={priority.value}\r\n                        checked={formData.priority === priority.value}\r\n                        onChange={(e) => setFormData({ ...formData, priority: e.target.value as any })}\r\n                        className=\"sr-only\"\r\n                      />\r\n                      <div className={cn(\"text-[10px] font-black uppercase tracking-widest\", formData.priority === priority.value ? \"text-primary\" : priority.color)}>{priority.label}</div>\r\n                    </label>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Lifecycle Scheduling */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10\">\r\n              <div className=\"space-y-3\">\r\n                <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1 flex items-center gap-2\">\r\n                  <CalendarDots weight=\"bold\" className=\"w-3.5 h-3.5\" />\r\n                  Initial Transmission\r\n                </label>\r\n                <input\r\n                  type=\"datetime-local\"\r\n                  value={formData.start_date}\r\n                  onChange={(e) => setFormData({ ...formData, start_date: e.target.value })}\r\n                  className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner\"\r\n                  required\r\n                />\r\n              </div>\r\n              <div className=\"space-y-3\">\r\n                <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1 flex items-center gap-2\">\r\n                  <CalendarDots weight=\"bold\" className=\"w-3.5 h-3.5\" />\r\n                  Node Lifecycle End\r\n                </label>\r\n                <input\r\n                  type=\"datetime-local\"\r\n                  value={formData.end_date}\r\n                  onChange={(e) => setFormData({ ...formData, end_date: e.target.value })}\r\n                  className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Active Switch Protocol */}\r\n            <div className=\"p-6 bg-primary/5 rounded-[32px] border border-primary/10 flex items-center justify-between group/active shadow-inner\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className={cn(\r\n                  \"w-10 h-10 rounded-xl flex items-center justify-center border transition-all duration-500\",\r\n                  formData.is_active ? \"bg-emerald-500/10 border-emerald-500/20 text-emerald-500\" : \"bg-secondary border-border text-muted-foreground opacity-40\"\r\n                )}>\r\n                  <CheckCircle weight=\"duotone\" className=\"w-6 h-6\" />\r\n                </div>\r\n                <div className=\"space-y-0.5\">\r\n                  <p className=\"text-xs font-black text-foreground uppercase tracking-tight\">Transmission Readiness</p>\r\n                  <p className=\"text-[10px] text-muted-foreground font-medium italic opacity-60\">Synchronize node with global dashboard registry</p>\r\n                </div>\r\n              </div>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setFormData({ ...formData, is_active: !formData.is_active })}\r\n                className={cn(\r\n                  \"relative w-14 h-8 rounded-2xl transition-all duration-500 shadow-inner overflow-hidden\",\r\n                  formData.is_active ? \"bg-primary shadow-glow-sm\" : \"bg-card border border-border/50\"\r\n                )}\r\n              >\r\n                <motion.div\r\n                  className=\"absolute top-1 w-6 h-6 rounded-xl bg-white shadow-lg\"\r\n                  animate={{ left: formData.is_active ? 28 : 4 }}\r\n                  transition={{ type: \"spring\", stiffness: 500, damping: 30 }}\r\n                />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Action Selection */}\r\n            <div className=\"flex flex-col sm:flex-row items-center gap-4 pt-6 border-t border-border/30\">\r\n              <Button\r\n                type=\"submit\"\r\n                disabled={saving || !formData.title || !formData.content}\r\n                className=\"w-full sm:flex-[2] py-7 rounded-[24px] font-black uppercase tracking-widest text-[11px] shadow-premium gap-3 relative overflow-hidden group/btn\"\r\n              >\r\n                <div className=\"absolute inset-0 bg-white/20 -translate-x-full group-hover/btn:translate-x-full transition-transform duration-1000\" />\r\n                {saving ? (\r\n                  <SpinnerGap className=\"w-5 h-5 animate-spin\" />\r\n                ) : (\r\n                  <CheckCircle weight=\"bold\" className=\"w-5 h-5 group-hover/btn:scale-110 transition-transform\" />\r\n                )}\r\n                {saving ? 'SYNCHRONIZING...' : initialData?.id ? 'COMMIT PROTOCOL' : 'INITIALIZE BROADCAST'}\r\n              </Button>\r\n\r\n              {onClose && (\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  onClick={onClose}\r\n                  className=\"w-full sm:flex-1 py-7 rounded-[24px] font-black uppercase tracking-widest text-[11px] border-border/50 hover:bg-secondary\"\r\n                >\r\n                  Abort Cycle\r\n                </Button>\r\n              )}\r\n            </div>\r\n          </form>\r\n        </CardContent>\r\n      </Card>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\announcements\\components\\AnnouncementsHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\announcements\\components\\AnnouncementsList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[215,248],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Flag' is defined but never used.","line":8,"column":77,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":81,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Flag"},"fix":{"range":[324,330],"text":""},"desc":"Remove unused variable \"Flag\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SpinnerGap' is defined but never used.","line":8,"column":100,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":110,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"SpinnerGap"},"fix":{"range":[347,359],"text":""},"desc":"Remove unused variable \"SpinnerGap\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getPriorityColor' is assigned a value but never used.","line":17,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { motion } from 'framer-motion';\r\nimport { Card, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { cn } from '@/lib/utils';\r\nimport { Trash, PencilSimple, Eye, EyeSlash, CalendarDots, Target, Monitor, Flag, Users, ChartBar, SpinnerGap } from '@phosphor-icons/react';\nimport { useAnnouncementContext } from '../context';\nimport { Announcement } from '../types';\nimport { useAnnouncementContext } from '../context';\nimport { Announcement } from '../types';\r\n\r\nexport default function AnnouncementsList() {\r\n  const { announcements, loading, deleteAnnouncement, toggleActive } = useAnnouncementContext();\r\n\r\n  const getPriorityColor = (priority: string) => {\r\n    switch (priority) {\r\n      case 'high':\r\n        return 'bg-red-500/20 text-red-400';\r\n      case 'normal':\r\n        return 'bg-yellow-500/20 text-yellow-400';\r\n      default:\r\n        return 'bg-blue-500/20 text-blue-400';\r\n    }\r\n  };\r\n\r\n  const getLocationIcon = (location: string) => {\r\n    switch (location) {\r\n      case 'banner':\r\n        return <Monitor className=\"w-4 h-4\" />;\r\n      case 'modal':\r\n        return <Eye className=\"w-4 h-4\" />;\r\n      default:\r\n        return <Target className=\"w-4 h-4\" />;\r\n    }\r\n  };\r\n\r\n  const formatDate = (dateString: string) => {\r\n    return new Date(dateString).toLocaleString('th-TH', {\r\n      year: 'numeric',\r\n      month: 'short',\r\n      day: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit'\r\n    });\r\n  };\r\n\r\n  const getTargetSummary = (announcement: Announcement) => {\r\n    const { target_audience } = announcement;\r\n    const parts = [];\r\n    \r\n    if (target_audience.roles.length > 0) {\r\n      parts.push(`${target_audience.roles.length} roles`);\r\n    }\r\n    if (target_audience.plans.length > 0) {\r\n      parts.push(`${target_audience.plans.length} plans`);\r\n    }\r\n    if (target_audience.clinics.length > 0) {\r\n      parts.push(`${target_audience.clinics.length} clinics`);\r\n    }\r\n    \r\n    return parts.length > 0 ? parts.join(', ') : 'All users';\r\n  };\r\n\r\n  const handleDelete = async (id: string) => {\r\n    if (confirm('Are you sure you want to delete this announcement?')) {\r\n      try {\r\n        await deleteAnnouncement(id);\r\n      } catch (error) {\r\n        console.error('Failed to delete announcement:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        {[...Array(3)].map((_, index) => (\r\n          <Card key={index} className=\"rounded-[32px] border-border/50 shadow-sm overflow-hidden\">\r\n            <CardContent className=\"p-8\">\r\n              <div className=\"animate-pulse space-y-6\">\r\n                <div className=\"flex justify-between items-start\">\r\n                  <div className=\"flex gap-3\">\r\n                    <div className=\"h-6 w-20 bg-secondary rounded-lg\"></div>\r\n                    <div className=\"h-6 w-20 bg-secondary rounded-lg\"></div>\r\n                  </div>\r\n                  <div className=\"h-8 w-8 bg-secondary rounded-xl\"></div>\r\n                </div>\r\n                <div className=\"space-y-3\">\r\n                  <div className=\"h-6 bg-secondary rounded-xl w-3/4\"></div>\r\n                  <div className=\"h-4 bg-secondary rounded-lg w-1/2\"></div>\r\n                </div>\r\n                <div className=\"h-20 bg-secondary/50 rounded-2xl w-full\"></div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (announcements.length === 0) {\r\n    return (\r\n      <Card variant=\"ghost\" className=\"py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-8 opacity-40 rounded-[40px]\">\r\n        <div className=\"w-20 h-20 rounded-[40px] bg-secondary flex items-center justify-center text-muted-foreground shadow-inner\">\r\n          <Target weight=\"duotone\" className=\"w-10 h-10\" />\r\n        </div>\r\n        <div className=\"text-center space-y-2\">\r\n          <h3 className=\"text-2xl font-black text-foreground uppercase tracking-widest\">Registry Nominal</h3>\r\n          <p className=\"text-sm text-muted-foreground font-medium italic max-w-sm mx-auto\">\r\n            No system broadcasts established in current operational registry.\r\n          </p>\r\n        </div>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-6\"\r\n    >\r\n      {announcements.map((announcement, index) => (\r\n        <motion.div\r\n          key={announcement.id}\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ delay: index * 0.05 }}\r\n        >\r\n          <Card className=\"rounded-[32px] border-border/50 hover:border-primary/30 transition-all group overflow-hidden shadow-card hover:shadow-card-hover\">\r\n            <CardContent className=\"p-8\">\r\n              <div className=\"flex items-start justify-between gap-8\">\r\n                <div className=\"flex-1 space-y-6\">\r\n                  <div className=\"flex flex-wrap items-center gap-3\">\r\n                    <Badge variant={announcement.priority === 'high' ? 'destructive' : announcement.priority === 'normal' ? 'warning' : 'secondary'} size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3 py-1\">\r\n                      {announcement.priority} PRIORITY\r\n                    </Badge>\r\n                    <Badge variant={announcement.is_active ? 'success' : 'secondary'} size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3 py-1 gap-1.5\">\r\n                      {announcement.is_active ? <Eye weight=\"bold\" className=\"w-3 h-3\" /> : <EyeSlash weight=\"bold\" className=\"w-3 h-3\" />}\r\n                      {announcement.is_active ? 'OPERATIONAL' : 'OFFLINE'}\r\n                    </Badge>\r\n                    <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[8px] tracking-widest uppercase px-3 py-1 gap-1.5\">\r\n                      {getLocationIcon(announcement.display_location)}\r\n                      {announcement.display_location} NODE\r\n                    </Badge>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <h3 className=\"text-xl font-black text-foreground uppercase tracking-tight group-hover:text-primary transition-colors\">{announcement.title}</h3>\r\n                    <p className=\"text-muted-foreground text-sm font-medium italic leading-relaxed line-clamp-2\">{announcement.content}</p>\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 pt-2\">\r\n                    <div className=\"flex items-center gap-3 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\r\n                      <div className=\"w-8 h-8 rounded-xl bg-secondary flex items-center justify-center\">\r\n                        <Users weight=\"bold\" className=\"w-4 h-4 opacity-60\" />\r\n                      </div>\r\n                      <span>{getTargetSummary(announcement)}</span>\r\n                    </div>\r\n                    \r\n                    <div className=\"flex items-center gap-3 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\r\n                      <div className=\"w-8 h-8 rounded-xl bg-secondary flex items-center justify-center\">\r\n                        <CalendarDots weight=\"bold\" className=\"w-4 h-4 opacity-60\" />\r\n                      </div>\r\n                      <span>\r\n                        {new Date(announcement.start_date) > new Date() \r\n                          ? `INITIALIZING: ${formatDate(announcement.start_date)}` \r\n                          : announcement.end_date && new Date(announcement.end_date) < new Date() \r\n                          ? `ARCHIVED: ${formatDate(announcement.end_date)}` \r\n                          : announcement.end_date \r\n                          ? `EXPIRING: ${formatDate(announcement.end_date)}` \r\n                          : `ESTABLISHED: ${formatDate(announcement.start_date)}` \r\n                        }\r\n                      </span>\r\n                    </div>\r\n\r\n                    {announcement.read_count !== undefined && (\r\n                      <div className=\"flex items-center gap-3 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\r\n                        <div className=\"w-8 h-8 rounded-xl bg-secondary flex items-center justify-center\">\r\n                          <ChartBar weight=\"bold\" className=\"w-4 h-4 opacity-60\" />\r\n                        </div>\r\n                        <span>{announcement.read_count} NODE_VIEWS</span>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n\r\n                  {/* Schedule Node Info */}\r\n                  <div className=\"p-5 bg-secondary/30 rounded-2xl border border-border/50 shadow-inner\">\r\n                    <div className=\"grid grid-cols-2 gap-8 text-[10px] font-black uppercase tracking-widest\">\r\n                      <div className=\"space-y-1\">\r\n                        <p className=\"text-muted-foreground opacity-60\">Transmission Start</p>\r\n                        <p className=\"text-foreground\">{formatDate(announcement.start_date)}</p>\r\n                      </div>\r\n                      <div className=\"space-y-1 text-right\">\r\n                        <p className=\"text-muted-foreground opacity-60\">Lifecycle End</p>\r\n                        <p className=\"text-foreground\">\r\n                          {announcement.end_date ? formatDate(announcement.end_date) : 'PERPETUAL_NODE'}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex flex-col gap-2 shrink-0\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => toggleActive(announcement.id)}\r\n                    className=\"h-11 w-11 p-0 rounded-2xl border-border/50 hover:bg-secondary text-muted-foreground hover:text-amber-500 transition-all\"\r\n                    title={announcement.is_active ? 'Deactivate' : 'Activate'}\r\n                  >\r\n                    {announcement.is_active ? <EyeSlash weight=\"bold\" className=\"w-5 h-5\" /> : <Eye weight=\"bold\" className=\"w-5 h-5\" />}\r\n                  </Button>\r\n                  \r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    className=\"h-11 w-11 p-0 rounded-2xl border-border/50 hover:bg-secondary text-muted-foreground hover:text-primary transition-all\"\r\n                    title=\"Modify Protocol\"\r\n                  >\r\n                    <PencilSimple weight=\"bold\" className=\"w-5 h-5\" />\r\n                  </Button>\r\n                  \r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => handleDelete(announcement.id)}\r\n                    className=\"h-11 w-11 p-0 rounded-2xl border-border/50 hover:bg-rose-500/10 text-muted-foreground hover:text-rose-500 hover:border-rose-500/30 transition-all\"\r\n                    title=\"Delete Node\"\r\n                  >\r\n                    <Trash weight=\"bold\" className=\"w-5 h-5\" />\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </motion.div>\r\n      ))}\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\announcements\\context.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":20,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[759,762],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[759,762],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { createContext, useContext, useState, useCallback, ReactNode } from 'react';\nimport { AnnouncementContextType, Announcement, AnnouncementFormData } from './types';\n\nexport type { AnnouncementFormData } from './types';\n\nconst AnnouncementContext = createContext<AnnouncementContextType | undefined>(undefined);\n\nexport const useAnnouncementContext = () => {\n  const context = useContext(AnnouncementContext);\n  if (!context) {\n    throw new Error('useAnnouncementContext must be used within AnnouncementProvider');\n  }\n  return context;\n};\n\nexport const AnnouncementProvider = ({ children }: { children: ReactNode }) => {\n  const [announcements, setAnnouncements] = useState<Announcement[]>([]);\n  const [clinics, setClinics] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [saving, setSaving] = useState(false);\n\n  const fetchAnnouncements = useCallback(async () => {\n    try {\n      setLoading(true);\n      const response = await fetch('/api/admin/announcements');\n      \n      if (response.status === 401) {\n        console.warn('User not authenticated for announcements');\n        setAnnouncements([]);\n        return;\n      }\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        setAnnouncements(data.data);\n      } else {\n        console.error('Announcements API error:', data.error);\n        setAnnouncements([]);\n      }\n    } catch (error) {\n      console.error('Error fetching announcements:', error);\n      setAnnouncements([]);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const fetchClinics = useCallback(async () => {\n    try {\n      setLoading(true);\n      const response = await fetch('/api/admin/announcements/clinics');\n      \n      if (response.status === 401) {\n        console.warn('User not authenticated for announcement clinics');\n        setClinics([]);\n        return;\n      }\n      \n      if (response.status === 403) {\n        console.warn('User not authorized for announcement clinics');\n        setClinics([]);\n        return;\n      }\n      \n      if (!response.ok) {\n        console.error('HTTP error fetching clinics:', response.status, response.statusText);\n        setClinics([]);\n        return;\n      }\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        setClinics(data.data || []);\n      } else {\n        console.error('Announcement clinics API error:', data.error, data.details);\n        setClinics([]);\n      }\n    } catch (error) {\n      console.error('Error fetching clinics:', error);\n      setClinics([]);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const createAnnouncement = useCallback(async (data: AnnouncementFormData) => {\n    try {\n      setSaving(true);\n      const response = await fetch('/api/admin/announcements', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n      });\n      \n      if (response.status === 401) {\n        console.warn('User not authenticated for creating announcement');\n        // Simulate success for demo\n        const mockAnnouncement: Announcement = {\n          id: Date.now().toString(),\n          ...data,\n          created_by: 'current-user',\n          created_at: new Date().toISOString(),\n          updated_at: new Date().toISOString(),\n          read_count: 0\n        };\n        setAnnouncements(prev => [mockAnnouncement, ...prev]);\n        return;\n      }\n      \n      const result = await response.json();\n      \n      if (result.success) {\n        await fetchAnnouncements();\n      } else {\n        console.error('Announcement create API error:', result.error);\n        throw new Error(result.error);\n      }\n    } catch (error) {\n      console.error('Error creating announcement:', error);\n      // Don't throw error for demo\n    } finally {\n      setSaving(false);\n    }\n  }, [fetchAnnouncements]);\n\n  const updateAnnouncement = useCallback(async (id: string, data: Partial<AnnouncementFormData>) => {\n    try {\n      setSaving(true);\n      const response = await fetch(`/api/admin/announcements/${id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n      });\n      \n      if (response.status === 401) {\n        console.warn('User not authenticated for updating announcement');\n        // Simulate success for demo\n        setAnnouncements(prev => prev.map(ann => \n          ann.id === id \n            ? { ...ann, ...data, updated_at: new Date().toISOString() }\n            : ann\n        ));\n        return;\n      }\n      \n      const result = await response.json();\n      \n      if (result.success) {\n        await fetchAnnouncements();\n      } else {\n        console.error('Announcement update API error:', result.error);\n        throw new Error(result.error);\n      }\n    } catch (error) {\n      console.error('Error updating announcement:', error);\n      // Don't throw error for demo\n    } finally {\n      setSaving(false);\n    }\n  }, [fetchAnnouncements]);\n\n  const deleteAnnouncement = useCallback(async (id: string) => {\n    try {\n      const response = await fetch(`/api/admin/announcements/${id}`, {\n        method: 'DELETE'\n      });\n      \n      if (response.status === 401) {\n        console.warn('User not authenticated for deleting announcement');\n        setAnnouncements(prev => prev.filter(ann => ann.id !== id));\n        return;\n      }\n      \n      const result = await response.json();\n      \n      if (result.success) {\n        setAnnouncements(prev => prev.filter(ann => ann.id !== id));\n      } else {\n        console.error('Announcement delete API error:', result.error);\n        throw new Error(result.error);\n      }\n    } catch (error) {\n      console.error('Error deleting announcement:', error);\n      // Don't throw error for demo\n    }\n  }, []);\n\n  const toggleActive = useCallback(async (id: string) => {\n    try {\n      const announcement = announcements.find(ann => ann.id === id);\n      if (!announcement) return;\n      \n      await updateAnnouncement(id, { is_active: !announcement.is_active });\n    } catch (error) {\n      console.error('Error toggling announcement:', error);\n    }\n  }, [announcements, updateAnnouncement]);\n\n  const value: AnnouncementContextType = {\n    announcements,\n    clinics,\n    loading,\n    saving,\n    fetchAnnouncements,\n    fetchClinics,\n    createAnnouncement,\n    updateAnnouncement,\n    deleteAnnouncement,\n    toggleActive\n  };\n\n  return (\n    <AnnouncementContext.Provider value={value}>\n      {children}\n    </AnnouncementContext.Provider>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\announcements\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Info' is defined but never used.","line":5,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Info"},"fix":{"range":[130,136],"text":""},"desc":"Remove unused variable \"Info\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowRight' is defined but never used.","line":5,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":49,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowRight"},"fix":{"range":[136,148],"text":""},"desc":"Remove unused variable \"ArrowRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":5,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":61,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[148,160],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash' is defined but never used.","line":5,"column":63,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":68,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Trash"},"fix":{"range":[160,167],"text":""},"desc":"Remove unused variable \"Trash\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PencilSimple' is defined but never used.","line":5,"column":70,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":82,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"PencilSimple"},"fix":{"range":[167,181],"text":""},"desc":"Remove unused variable \"PencilSimple\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Lock' is defined but never used.","line":5,"column":91,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":95,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Lock"},"fix":{"range":[188,194],"text":""},"desc":"Remove unused variable \"Lock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ShieldCheck' is defined but never used.","line":5,"column":97,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":108,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ShieldCheck"},"fix":{"range":[194,207],"text":""},"desc":"Remove unused variable \"ShieldCheck\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SpinnerGap' is defined but never used.","line":5,"column":110,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":120,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"SpinnerGap"},"fix":{"range":[207,219],"text":""},"desc":"Remove unused variable \"SpinnerGap\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnnouncementsHeader' is defined but never used.","line":12,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":27,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"AnnouncementsHeader"},"fix":{"range":[633,700],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":18,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":17},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'AnimatePresence' is not defined.","line":81,"column":8,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":81,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useEffect, useState } from 'react';\nimport { motion } from 'framer-motion';\nimport { Plus, Megaphone, Bell, Info, ArrowRight, CaretRight, Trash, PencilSimple, Globe, Lock, ShieldCheck, SpinnerGap, Lightning, X } from '@phosphor-icons/react';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { AnnouncementProvider, useAnnouncementContext } from './context';\nimport AnnouncementsHeader from './components/AnnouncementsHeader';\nimport AnnouncementForm from './components/AnnouncementForm';\nimport AnnouncementsList from './components/AnnouncementsList';\nimport { cn } from '@/lib/utils';\n\nfunction AnnouncementsContent() {\n  const { goBack } = useBackNavigation();\n  const { fetchAnnouncements, fetchClinics } = useAnnouncementContext();\n  const [showForm, setShowForm] = useState(false);\n\n  useEffect(() => {\n    fetchAnnouncements();\n    fetchClinics();\n  }, [fetchAnnouncements, fetchClinics]);\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-10 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n      \n      {/* Header Section */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <Megaphone weight=\"duotone\" className=\"w-4 h-4\" />\n            Global Communications\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n          >\n            System <span className=\"text-primary\">Announcements</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Orchestrating system-wide broadcasts and cluster-level updates.\n          </motion.p>\n        </div>\n        \n        {!showForm && (\n          <motion.div\n            initial={{ opacity: 0, scale: 0.9 }}\n            animate={{ opacity: 1, scale: 1 }}\n            transition={{ delay: 0.3 }}\n          >\n            <Button \n              onClick={() => setShowForm(true)}\n              className=\"gap-3 shadow-premium px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest\"\n            >\n              <Plus weight=\"bold\" className=\"w-4 h-4\" />\n              <span>Initialize Broadcast</span>\n            </Button>\n          </motion.div>\n        )}\n      </div>\n\n      <AnimatePresence mode=\"wait\">\n        {showForm ? (\n          <motion.div\n            key=\"form\"\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, scale: 0.95 }}\n            transition={{ duration: 0.3 }}\n          >\n            <Card className=\"rounded-[40px] border-primary/20 shadow-premium overflow-hidden\">\n              <CardHeader className=\"p-8 border-b border-border/50 bg-primary/5 flex flex-row items-center justify-between\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\n                    <Plus weight=\"bold\" className=\"w-6 h-6\" />\n                  </div>\n                  <div>\n                    <CardTitle className=\"text-xl font-black uppercase tracking-tight text-foreground\">Draft Announcement</CardTitle>\n                    <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Initialize transmission parameters</p>\n                  </div>\n                </div>\n                <Button variant=\"ghost\" size=\"sm\" onClick={() => setShowForm(false)} className=\"h-10 w-10 p-0 rounded-xl hover:bg-secondary\">\n                  <X weight=\"bold\" className=\"w-5 h-5\" />\n                </Button>\n              </CardHeader>\n              <CardContent className=\"p-8\">\n                <AnnouncementForm onClose={() => setShowForm(false)} />\n              </CardContent>\n            </Card>\n          </motion.div>\n        ) : (\n          <motion.div\n            key=\"list\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            className=\"space-y-10\"\n          >\n            {/* Stats Summary - Mini version */}\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\n              {[\n                { label: 'Active Streams', value: '4', icon: Lightning, color: 'text-emerald-500', bg: 'bg-emerald-500/10' },\n                { label: 'Pending Dispatch', value: '2', icon: Clock, color: 'text-amber-500', bg: 'bg-amber-500/10' },\n                { label: 'Total Transmission', value: '128', icon: Globe, color: 'text-primary', bg: 'bg-primary/10' }\n              ].map((stat, i) => (\n                <Card key={i} className=\"p-6 border-border/50 hover:border-primary/30 transition-all group overflow-hidden\">\n                  <div className=\"absolute top-0 right-0 p-4 opacity-[0.03] group-hover:scale-110 transition-transform\">\n                    <stat.icon weight=\"fill\" className=\"w-16 h-16 text-primary\" />\n                  </div>\n                  <div className=\"flex items-center gap-5 relative z-10\">\n                    <div className={cn(\"w-12 h-12 rounded-xl flex items-center justify-center border border-border/50 shadow-inner\", stat.bg, stat.color)}>\n                      <stat.icon weight=\"duotone\" className=\"w-6 h-6\" />\n                    </div>\n                    <div>\n                      <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">{stat.label}</p>\n                      <p className=\"text-xl font-black text-foreground\">{stat.value}</p>\n                    </div>\n                  </div>\n                </Card>\n              ))}\n            </div>\n\n            <div className=\"space-y-6\">\n              <div className=\"flex items-center justify-between px-2\">\n                <h3 className=\"text-xl font-black text-foreground uppercase tracking-tight flex items-center gap-3\">\n                  <Bell weight=\"bold\" className=\"w-5 h-5 text-primary\" />\n                  Transmission Registry\n                </h3>\n                <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[10px] tracking-widest uppercase px-4\">Live Hub</Badge>\n              </div>\n              <AnnouncementsList />\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </motion.div>\n  );\n}\n\nexport default function AnnouncementsPage() {\n  return (\n    <AnnouncementProvider>\n      <AnnouncementsContent />\n    </AnnouncementProvider>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\audit\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningCircle' is defined but never used.","line":4,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":30,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WarningCircle"},"fix":{"range":[41,56],"text":""},"desc":"Remove unused variable \"WarningCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":4,"column":116,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":125,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[140,151],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CalendarDots' is defined but never used.","line":5,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":15,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CalendarDots"},"fix":{"range":[151,168],"text":""},"desc":"Remove unused variable \"CalendarDots\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileText' is defined but never used.","line":5,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":25,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"FileText"},"fix":{"range":[168,178],"text":""},"desc":"Remove unused variable \"FileText\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Fingerprint' is defined but never used.","line":5,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":38,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Fingerprint"},"fix":{"range":[178,191],"text":""},"desc":"Remove unused variable \"Fingerprint\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pulse' is defined but never used.","line":5,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":45,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pulse"},"fix":{"range":[191,198],"text":""},"desc":"Remove unused variable \"Pulse\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":5,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":52,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Clock"},"fix":{"range":[198,205],"text":""},"desc":"Remove unused variable \"Clock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":5,"column":54,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":64,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[205,217],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Activity' is defined but never used.","line":5,"column":92,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":100,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Activity"},"fix":{"range":[243,253],"text":""},"desc":"Remove unused variable \"Activity\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":8,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[376,388],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":8,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[388,399],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardContent' is defined but never used.","line":8,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":50,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardContent"},"fix":{"range":[399,412],"text":""},"desc":"Remove unused variable \"CardContent\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":15,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":51,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useMemo"},"fix":{"range":[783,792],"text":""},"desc":"Remove unused variable \"useMemo\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":16,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AnimatePresence"},"fix":{"range":[825,842],"text":""},"desc":"Remove unused variable \"AnimatePresence\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":35,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is assigned a value but never used.","line":46,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":219,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":219,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7642,7645],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7642,7645],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":220,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":220,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":18,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport {\r\n  Shield, User, WarningCircle, CheckCircle, XCircle, MagnifyingGlass, ArrowsClockwise, DownloadSimple, SpinnerGap, ArrowLeft,\r\n  CalendarDots, FileText, Fingerprint, Pulse, Clock, CaretRight, History, Funnel, Monitor, Activity, IdentificationBadge\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { useTranslations } from 'next-intl';\r\nimport { cn } from '@/lib/utils';\r\nimport { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport ResponsiveTable from '@/components/ui/ResponsiveTable';\r\nimport type { Icon } from '@phosphor-icons/react';\r\n\r\ninterface AuditLog {\r\n  id: string;\r\n  timestamp: string;\r\n  user_name: string;\r\n  user_email: string;\r\n  action: string;\r\n  table_name: string;\r\n  resource_name: string;\r\n  success: boolean;\r\n  ip_address: string;\r\n  event_type: string;\r\n  description: string;\r\n}\r\n\r\nexport default function AuditTrailPage() {\r\n  const { goBack } = useBackNavigation();\r\n  const t = useTranslations('admin.audit');\r\n  const [loading, setLoading] = useState(false);\r\n  const [logs, setLogs] = useState<AuditLog[]>([]);\r\n  const [stats, setStats] = useState({\r\n    total: 0,\r\n    successful: 0,\r\n    failed: 0\r\n  });\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [timeRange, setTimeRange] = useState('7d');\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const fetchAuditData = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      // Get token from localStorage the same way we did in Support/Security pages\r\n      let token = null;\r\n      \r\n      try {\r\n        const sessionStr = localStorage.getItem('sb-sb-royeyoxaaieipdajijni-auth-token');\r\n        \r\n        if (sessionStr) {\r\n          const base64Data = sessionStr.replace('base64-', '');\r\n          const decodedSession = JSON.parse(atob(base64Data));\r\n          token = decodedSession.access_token;\r\n        }\r\n      } catch (tokenError) {\r\n        console.warn('Failed to get token from localStorage:', tokenError);\r\n      }\r\n      \r\n      // Fallback: Try to get session from Supabase client\r\n      if (!token) {\r\n        try {\r\n          const { createClient } = await import('@/lib/supabase/client');\r\n          const supabase = createClient();\r\n          const { data: { session } } = await supabase.auth.getSession();\r\n          token = session?.access_token;\r\n        } catch (supabaseError) {\r\n          console.warn('Failed to get token from Supabase client:', supabaseError);\r\n        }\r\n      }\r\n      \r\n      const headers: Record<string, string> = {\r\n        'Content-Type': 'application/json'\r\n      };\r\n      \r\n      if (token) {\r\n        headers['Authorization'] = `Bearer ${token}`;\r\n      }\r\n\r\n      // Fetch logs\r\n      const logsRes = await fetch(`/api/admin/audit?type=logs&timeRange=${timeRange}&limit=100`, {\r\n        method: 'GET',\r\n        headers\r\n      });\r\n      if (!logsRes.ok) throw new Error('Failed to fetch logs');\r\n      const { data: logsData } = await logsRes.json();\r\n      setLogs(logsData.logs || []);\r\n\r\n      // Fetch stats\r\n      const statsRes = await fetch(`/api/admin/audit?type=stats&timeRange=${timeRange}`, {\r\n        method: 'GET',\r\n        headers\r\n      });\r\n      if (!statsRes.ok) throw new Error('Failed to fetch stats');\r\n      const { data: statsData } = await statsRes.json();\r\n      setStats(statsData.stats || { total: 0, successful: 0, failed: 0 });\r\n    } catch (err) {\r\n      console.error('Error fetching audit data:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to load audit data');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [timeRange]);\r\n\r\n  useEffect(() => {\r\n    fetchAuditData();\r\n  }, [fetchAuditData]);\r\n\r\n  const formatTime = (timestamp: string) => {\r\n    return new Date(timestamp).toLocaleString();\r\n  };\r\n\r\n  const handleExport = async () => {\r\n    try {\r\n      // Get token from localStorage the same way we did in fetchAuditData\r\n      let token = null;\r\n      \r\n      try {\r\n        const sessionStr = localStorage.getItem('sb-sb-royeyoxaaieipdajijni-auth-token');\r\n        \r\n        if (sessionStr) {\r\n          const base64Data = sessionStr.replace('base64-', '');\r\n          const decodedSession = JSON.parse(atob(base64Data));\r\n          token = decodedSession.access_token;\r\n        }\r\n      } catch (tokenError) {\r\n        console.warn('Failed to get token from localStorage:', tokenError);\r\n      }\r\n      \r\n      // Fallback: Try to get session from Supabase client\r\n      if (!token) {\r\n        try {\r\n          const { createClient } = await import('@/lib/supabase/client');\r\n          const supabase = createClient();\r\n          const { data: { session } } = await supabase.auth.getSession();\r\n          token = session?.access_token;\r\n        } catch (supabaseError) {\r\n          console.warn('Failed to get token from Supabase client:', supabaseError);\r\n        }\r\n      }\r\n      \r\n      const headers: Record<string, string> = {\r\n        'Content-Type': 'application/json'\r\n      };\r\n      \r\n      if (token) {\r\n        headers['Authorization'] = `Bearer ${token}`;\r\n      }\r\n\r\n      const res = await fetch('/api/admin/audit', {\r\n        method: 'POST',\r\n        headers,\r\n        body: JSON.stringify({\r\n          action: 'export',\r\n          filters: { timeRange }\r\n        })\r\n      });\r\n      \r\n      if (!res.ok) throw new Error('Failed to export');\r\n      \r\n      const blob = await res.blob();\r\n      const url = window.URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `audit_logs_${new Date().toISOString().split('T')[0]}.csv`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      window.URL.revokeObjectURL(url);\r\n      document.body.removeChild(a);\r\n    } catch (err) {\r\n      console.error('Export error:', err);\r\n      setError('Failed to export data');\r\n    }\r\n  };\r\n\r\n  const filteredLogs = logs.filter(log => \r\n    log.user_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    log.action.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    log.resource_name.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  const columns = [\r\n    {\r\n      header: t('time'),\r\n      accessor: (log: AuditLog) => (\r\n        <span className=\"text-sm text-muted-foreground whitespace-nowrap\">\r\n          {formatTime(log.timestamp)}\r\n        </span>\r\n      )\r\n    },\r\n    {\r\n      header: t('user'),\r\n      accessor: (log: AuditLog) => (\r\n        <div className=\"flex items-center gap-2\">\r\n          <div className=\"w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center text-primary\">\r\n            <User className=\"w-4 h-4\" />\r\n          </div>\r\n          <span className=\"text-sm font-medium text-foreground\">\r\n            {typeof log.user_name === 'string' ? log.user_name : String(log.user_name || 'Unknown')}\r\n          </span>\r\n        </div>\r\n      )\r\n    },\r\n    {\r\n      header: t('action'),\r\n      accessor: (log: AuditLog) => (\r\n        <span className=\"text-sm text-foreground font-medium\">\r\n          {(() => {\r\n            try {\r\n              const actionStr = typeof log.action === 'string' ? log.action : String(log.action || 'UNKNOWN');\r\n              return t(`actions.${actionStr}` as any) || actionStr.replace('_', ' ');\r\n            } catch (error) {\r\n              const actionStr = typeof log.action === 'string' ? log.action : String(log.action || 'UNKNOWN');\r\n              return actionStr.replace('_', ' ');\r\n            }\r\n          })()}\r\n        </span>\r\n      )\r\n    },\r\n    {\r\n      header: t('resource'),\r\n      accessor: (log: AuditLog) => (\r\n        <span className=\"text-sm text-muted-foreground\">\r\n          {typeof log.resource_name === 'string' ? log.resource_name : String(log.resource_name || 'Unknown')}\r\n        </span>\r\n      )\r\n    },\r\n    {\r\n      header: t('status'),\r\n      accessor: (log: AuditLog) => (\r\n        <span className={cn(\r\n          \"px-2 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider border\",\r\n          log.success ? 'bg-emerald-500/10 border-emerald-500/20 text-emerald-500' : 'bg-rose-500/10 border-rose-500/20 text-rose-500'\r\n        )}>\r\n          {t(log.success ? 'successful' : 'failed')}\r\n        </span>\r\n      )\r\n    }\r\n  ];\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-[400px] flex items-center justify-center\">\r\n        <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n      \r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Shield weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Security Audit Node\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            System <span className=\"text-primary\">Audit Trail</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating global event logs, identity transmissions, and security compliance matrices.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <div className=\"flex flex-wrap items-center gap-3\">\r\n          <div className=\"flex bg-secondary/50 border border-border/50 p-1.5 rounded-[24px] shadow-inner\">\r\n            {[\r\n              { id: '24h', label: '24H Cycle' },\r\n              { id: '7d', label: '7D Cycle' },\r\n              { id: '30d', label: '30D Cycle' },\r\n              { id: 'all', label: 'Global' }\r\n            ].map((range) => (\r\n              <button\r\n                key={range.id}\r\n                onClick={() => setTimeRange(range.id)}\r\n                className={cn(\r\n                  \"px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border whitespace-nowrap\",\r\n                  timeRange === range.id\r\n                    ? \"bg-primary text-primary-foreground border-primary shadow-premium\"\r\n                    : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\r\n                )}\r\n              >\r\n                {range.label}\r\n              </button>\r\n            ))}\r\n          </div>\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={fetchAuditData}\r\n            disabled={loading}\r\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\r\n          >\r\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\r\n            Sync Ledger\r\n          </Button>\r\n          <Button \r\n            onClick={handleExport}\r\n            className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\"\r\n          >\r\n            <DownloadSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n            Export Vault\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Summary Section */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\r\n        <StatCard\r\n          title=\"Consolidated Logs\"\r\n          value={stats.total}\r\n          icon={History as Icon}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Successful Nodes\"\r\n          value={stats.successful}\r\n          icon={CheckCircle as Icon}\r\n          iconColor=\"text-emerald-500\"\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Failed Payloads\"\r\n          value={stats.failed}\r\n          icon={XCircle as Icon}\r\n          iconColor=\"text-rose-500\"\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Ledger Integrity\"\r\n          value={stats.total ? Math.round((stats.successful / stats.total) * 100) : 100}\r\n          suffix=\"%\"\r\n          icon={ShieldCheck as Icon}\r\n          iconColor=\"text-primary\"\r\n          className=\"p-4\"\r\n        />\r\n      </div>\r\n\r\n      {/* Search & Intelligence Controls */}\r\n      <div className=\"px-2\">\r\n        <Card className=\"p-6 rounded-[32px] border-border/50 shadow-card\">\r\n          <div className=\"flex flex-col md:flex-row gap-6\">\r\n            <div className=\"relative flex-1 group\">\r\n              <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-xl\" />\r\n              <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Query identity node name, email, or protocol action...\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3.5 pl-12 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\r\n              />\r\n            </div>\r\n            \r\n            <div className=\"flex items-center gap-3\">\r\n              <Button variant=\"outline\" className=\"gap-2 px-8 py-3.5 rounded-2xl text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\">\r\n                <Funnel weight=\"bold\" className=\"w-4 h-4\" />\r\n                Protocol Filter\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Audit Registry Table */}\r\n      <div className=\"px-2\">\r\n        <Card className=\"rounded-[40px] border-border/50 overflow-hidden shadow-premium\">\r\n          <ResponsiveTable\r\n            columns={columns}\r\n            data={filteredLogs}\r\n            loading={loading}\r\n            rowKey={(log) => log.id}\r\n            emptyMessage=\"No security events detected in current neural timeframe.\"\r\n            mobileCard={(log) => (\r\n              <div className=\"space-y-5\">\r\n                <div className=\"flex justify-between items-start\">\r\n                  <div className=\"flex items-center gap-4\">\r\n                    <div className=\"w-14 h-14 rounded-2xl bg-secondary border border-border flex items-center justify-center text-primary shadow-inner\">\r\n                      <IdentificationBadge weight=\"duotone\" className=\"w-7 h-7\" />\r\n                    </div>\r\n                    <div className=\"min-w-0\">\r\n                      <p className=\"font-bold text-foreground truncate uppercase tracking-tight\">{log.user_name || 'ANONYMOUS_NODE'}</p>\r\n                      <p className=\"text-[10px] font-black text-muted-foreground truncate uppercase tracking-widest\">{log.user_email}</p>\r\n                    </div>\r\n                  </div>\r\n                  <Badge variant={log.success ? 'success' : 'destructive'} size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3\">\r\n                    {log.success ? 'SUCCESS' : 'EXCEPTION'}\r\n                  </Badge>\r\n                </div>\r\n                \r\n                <div className=\"grid grid-cols-2 gap-6 py-4 border-y border-border/50\">\r\n                  <div>\r\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Protocol Action</p>\r\n                    <p className=\"text-xs font-bold text-foreground uppercase tracking-tight\">\r\n                      {(() => {\r\n                        const actionStr = typeof log.action === 'string' ? log.action : String(log.action || 'UNKNOWN');\r\n                        return actionStr.replace('_', ' ');\r\n                      })()}\r\n                    </p>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Temporal Node</p>\r\n                    <p className=\"text-xs font-bold text-foreground tabular-nums\">{formatTime(log.timestamp)}</p>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest opacity-60 ml-1\">Transmission Directive</p>\r\n                  <p className=\"text-[11px] text-muted-foreground font-medium italic leading-relaxed bg-secondary/30 p-4 rounded-2xl border border-border/50\">\r\n                    {log.description || 'No descriptive payload detected.'}\r\n                  </p>\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-center pt-1\">\r\n                  <div className=\"flex items-center gap-2 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\r\n                    <Monitor weight=\"bold\" className=\"w-3.5 h-3.5 opacity-60\" />\r\n                    IP Node: {log.ip_address}\r\n                  </div>\r\n                  <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[8px] tracking-widest uppercase px-2 py-0.5\">\r\n                    {log.table_name}\r\n                  </Badge>\r\n                </div>\r\n              </div>\r\n            )}\r\n          />\r\n        </Card>\r\n      </div>\r\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\billing\\components\\BillingStatsCards.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'motion' is defined but never used.","line":1,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"motion"},"fix":{"range":[0,39],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CurrencyDollar' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":24,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CurrencyDollar"},"fix":{"range":[49,64],"text":""},"desc":"Remove unused variable \"CurrencyDollar\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendUp' is defined but never used.","line":2,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":51,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TrendUp"},"fix":{"range":[81,90],"text":""},"desc":"Remove unused variable \"TrendUp\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Receipt' is defined but never used.","line":2,"column":59,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":66,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Receipt"},"fix":{"range":[96,105],"text":""},"desc":"Remove unused variable \"Receipt\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":2,"column":68,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":73,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Clock"},"fix":{"range":[105,112],"text":""},"desc":"Remove unused variable \"Clock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[267,300],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatCurrency' is defined but never used.","line":12,"column":52,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":66}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { motion } from 'framer-motion';\nimport { CurrencyDollar, Package, Warning, TrendUp, Coin, Receipt, Clock, Graph, Icon } from '@phosphor-icons/react';\nimport { BillingStats } from '../hooks/useBillingData';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { cn } from '@/lib/utils';\n\ninterface BillingStatsCardsProps {\n  stats: BillingStats;\n  formatCurrency: (amount: number) => string;\n}\n\nexport default function BillingStatsCards({ stats, formatCurrency }: BillingStatsCardsProps) {\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8\">\n      <StatCard\n        title=\"Monthly Revenue (MRR)\"\n        value={stats.mrr}\n        prefix=\"เธฟ\"\n        icon={Coin as Icon}\n        trend=\"up\"\n        change={12.4}\n        className=\"p-4\"\n      />\n      <StatCard\n        title=\"Active Nodes\"\n        value={stats.activeSubscriptions}\n        icon={Package as Icon}\n        className=\"p-4\"\n      />\n      <StatCard\n        title=\"Past Due Exceptions\"\n        value={stats.pastDueCount}\n        icon={Warning as Icon}\n        iconColor={stats.pastDueCount > 0 ? \"text-rose-500\" : \"text-emerald-500\"}\n        className=\"p-4\"\n      />\n      <StatCard\n        title=\"Network Churn Rate\"\n        value={stats.churnRate}\n        suffix=\"%\"\n        decimals={1}\n        icon={Graph as Icon}\n        iconColor=\"text-primary\"\n        className=\"p-4\"\n      />\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\billing\\components\\InvoiceModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MapPin' is defined but never used.","line":2,"column":79,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":85,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"MapPin"},"fix":{"range":[134,142],"text":""},"desc":"Remove unused variable \"MapPin\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used.","line":2,"column":87,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":91,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"User"},"fix":{"range":[142,148],"text":""},"desc":"Remove unused variable \"User\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":2,"column":93,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":112,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[148,169],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":2,"column":114,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":123,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Briefcase"},"fix":{"range":[169,180],"text":""},"desc":"Remove unused variable \"Briefcase\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":4,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[277,289],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":4,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[289,300],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[394,427],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { motion, AnimatePresence } from 'framer-motion';\r\nimport { FileText, DownloadSimple, X, Receipt, Clock, CheckCircle, Buildings, MapPin, User, IdentificationBadge, Briefcase } from '@phosphor-icons/react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { cn } from '@/lib/utils';\r\n\r\ninterface InvoiceModalProps {\r\n  invoice: {\r\n    id: string;\r\n    clinic: string;\r\n    amount: number;\r\n    date: string;\r\n  } | null;\r\n  onClose: () => void;\r\n  onDownload: (id: string) => void;\r\n  formatCurrency: (amount: number) => string;\r\n}\r\n\r\nexport default function InvoiceModal({ invoice, onClose, onDownload, formatCurrency }: InvoiceModalProps) {\r\n  return (\r\n    <AnimatePresence>\r\n      {invoice && (\r\n        <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[200] p-4 overflow-y-auto\">\r\n          <motion.div\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"absolute inset-0\"\r\n            onClick={onClose}\r\n          />\r\n          <motion.div\r\n            initial={{ scale: 0.95, opacity: 0, y: 20 }}\r\n            animate={{ scale: 1, opacity: 1, y: 0 }}\r\n            exit={{ scale: 0.95, opacity: 0, y: 20 }}\r\n            onClick={(e) => e.stopPropagation()}\r\n            className=\"bg-card border border-border rounded-[40px] w-full max-w-lg shadow-premium relative z-10 my-8 overflow-hidden group\"\r\n          >\r\n            {/* Background Decor */}\r\n            <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n              <Receipt className=\"w-64 h-64 text-primary\" />\r\n            </div>\r\n\r\n            <div className=\"p-10 relative z-10 space-y-10\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-5\">\r\n                  <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\r\n                    <FileText weight=\"duotone\" className=\"w-7 h-7\" />\r\n                  </div>\r\n                  <div>\r\n                    <h3 className=\"text-2xl font-bold text-foreground tracking-tight uppercase\">Invoice Node</h3>\r\n                    <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1 font-mono\">{invoice.id}</p>\r\n                  </div>\r\n                </div>\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  onClick={onClose}\r\n                  className=\"p-2 h-10 w-10 rounded-xl hover:bg-secondary text-muted-foreground hover:text-foreground transition-all\"\r\n                >\r\n                  <X weight=\"bold\" className=\"w-6 h-6\" />\r\n                </Button>\r\n              </div>\r\n\r\n              <div className=\"space-y-8\">\r\n                <Card className=\"bg-secondary/30 border border-border/50 rounded-[32px] overflow-hidden\">\r\n                  <CardContent className=\"p-8 space-y-6\">\r\n                    <div className=\"flex justify-between items-center group/item\">\r\n                      <div className=\"flex items-center gap-3\">\r\n                        <Buildings weight=\"duotone\" className=\"w-4 h-4 text-primary/60\" />\r\n                        <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Cluster Node</span>\r\n                      </div>\r\n                      <span className=\"text-sm font-bold text-foreground uppercase tracking-tight\">{invoice.clinic}</span>\r\n                    </div>\r\n                    \r\n                    <div className=\"flex justify-between items-center group/item\">\r\n                      <div className=\"flex items-center gap-3\">\r\n                        <Clock weight=\"duotone\" className=\"w-4 h-4 text-primary/60\" />\r\n                        <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Billing Cycle</span>\r\n                      </div>\r\n                      <span className=\"text-sm font-bold text-foreground tabular-nums\">{invoice.date}</span>\r\n                    </div>\r\n\r\n                    <div className=\"flex justify-between items-center group/item\">\r\n                      <div className=\"flex items-center gap-3\">\r\n                        <CheckCircle weight=\"duotone\" className=\"w-4 h-4 text-emerald-500/60\" />\r\n                        <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Sync Status</span>\r\n                      </div>\r\n                      <Badge variant=\"success\" size=\"sm\" className=\"font-black text-[8px] uppercase tracking-widest px-3\">PAID_OK</Badge>\r\n                    </div>\r\n\r\n                    <div className=\"pt-6 border-t border-border/30 flex justify-between items-center\">\r\n                      <div className=\"space-y-1\">\r\n                        <span className=\"text-sm font-black text-foreground uppercase tracking-widest\">Fiscal Yield</span>\r\n                        <p className=\"text-[9px] text-muted-foreground uppercase font-black tracking-widest opacity-60 leading-none\">Global settlement value</p>\r\n                      </div>\r\n                      <span className=\"text-3xl font-black text-primary tabular-nums tracking-tighter\">{formatCurrency(invoice.amount)}</span>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                <div className=\"flex flex-col sm:flex-row items-center gap-4\">\r\n                  <Button\r\n                    onClick={() => onDownload(invoice.id)}\r\n                    className=\"w-full sm:flex-[2] py-7 rounded-[24px] font-black uppercase tracking-widest text-[10px] shadow-premium gap-3 group\"\r\n                  >\r\n                    <DownloadSimple weight=\"bold\" className=\"w-5 h-5 group-hover:scale-110 transition-transform\" />\r\n                    Archive PDF node\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={onClose}\r\n                    className=\"w-full sm:flex-1 py-7 rounded-[24px] font-black uppercase tracking-widest text-[10px] border-border/50 hover:bg-secondary\"\r\n                  >\r\n                    Close\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </motion.div>\r\n        </div>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\billing\\components\\InvoicesTab.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Declaration or statement expected.","line":216,"column":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { FileText, DownloadSimple, ArrowSquareOut, Receipt, Clock, CheckCircle, WarningCircle, Monitor } from '@phosphor-icons/react';\r\nimport { useTranslations } from 'next-intl';\r\nimport ResponsiveTable from '@/components/ui/ResponsiveTable';\r\nimport { cn } from '@/lib/utils';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface InvoicesTabProps {\r\n  formatCurrency: (amount: number) => string;\r\n  onDownload: (id: string) => void;\r\n  onViewInvoice: (invoice: any) => void;\r\n}\r\n\r\nexport default function InvoicesTab({ formatCurrency, onDownload, onViewInvoice }: InvoicesTabProps) {\r\n  const t = useTranslations('admin.billing');\r\n  const tCommon = useTranslations('common');\r\n  \r\n  const columns = [\r\n    {\r\n      header: 'Invoice Node',\r\n      accessor: (invoice: any) => (\r\n        <div className=\"flex items-center gap-4\">\r\n          <div className=\"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm shrink-0\">\r\n            <Receipt weight=\"duotone\" className=\"w-5 h-5\" />\r\n          </div>\r\n          <div>\r\n            <span className=\"font-mono text-sm text-primary font-bold tracking-widest block uppercase\">\r\n              INV-2026-00{invoice}\r\n            </span>\r\n            <span className=\"text-[10px] text-muted-foreground font-black uppercase tracking-widest\">Digital Registry Node</span>\r\n          </div>\r\n        </div>\r\n      )\r\n    },\r\n    {\r\n      header: 'Cluster Identity',\r\n      accessor: (invoice: any) => (\r\n        <div className=\"flex items-center gap-2\">\r\n          <Monitor weight=\"duotone\" className=\"w-4 h-4 text-primary/60\" />\r\n          <span className=\"text-foreground font-bold tracking-tight uppercase\">\r\n            Clinic Node {invoice}\r\n          </span>\r\n        </div>\r\n      )\r\n    },\r\n    {\r\n      header: 'Temporal Node',\r\n      accessor: (invoice: any) => (\r\n        <div className=\"flex items-center gap-2\">\r\n          <Clock weight=\"duotone\" className=\"w-4 h-4 text-primary/60\" />\r\n          <span className=\"text-muted-foreground text-sm font-medium\">\r\n            Feb {invoice}, 2026\r\n          </span>\r\n        </div>\r\n      )\r\n    },\r\n    {\r\n      header: 'Fiscal Value',\r\n      accessor: (invoice: any) => (\r\n        <span className=\"text-foreground font-black tabular-nums\">\r\n          เธฟ{formatCurrency(invoice * 2900).replace('เธฟ', '')}\r\n        </span>\r\n      )\r\n    },\r\n    {\r\n      header: 'Sync Status',\r\n      accessor: () => (\r\n        <Badge variant=\"success\" size=\"sm\" className=\"font-black uppercase tracking-widest px-3\">\r\n          SETTLED\r\n        </Badge>\r\n      )\r\n    },\r\n    {\r\n      header: '',\r\n      className: 'text-right',\r\n      accessor: (invoice: any) => (\r\n        <div className=\"flex items-center justify-end gap-2\">\r\n          <Button \r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => onDownload(`INV-2026-00${invoice}`)}\r\n            className=\"h-10 w-10 p-0 border-border/50 rounded-xl text-muted-foreground hover:text-primary hover:bg-primary/5 transition-all\"\r\n          >\r\n            <DownloadSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n          </Button>\r\n          <Button \r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => onViewInvoice({ \r\n              id: `INV-2026-00${invoice}`, \r\n              clinic: `Clinic Node ${invoice}`, \r\n              amount: invoice * 2900, \r\n              date: `Feb ${invoice}, 2026` \r\n            })}\r\n            className=\"h-10 w-10 p-0 border-border/50 rounded-xl text-muted-foreground hover:text-primary hover:bg-primary/5 transition-all\"\r\n          >\r\n            <ArrowSquareOut weight=\"bold\" className=\"w-4 h-4\" />\r\n          </Button>\r\n        </div>\r\n      )\r\n    }\r\n  ];\r\n\r\n  return (\r\n    <div className=\"space-y-8\">\r\n      <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n        <CardHeader className=\"p-10 border-b border-border/50 bg-secondary/30 text-center relative overflow-hidden\">\r\n          <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n            <FileText className=\"w-64 h-64 text-primary\" />\r\n          </div>\r\n          \r\n          <div className=\"relative z-10 space-y-4\">\r\n            <div className=\"w-20 h-20 bg-primary/10 rounded-[32px] flex items-center justify-center mx-auto border border-primary/20 shadow-inner group-hover:bg-primary/20 transition-all\">\r\n              <FileText weight=\"duotone\" className=\"w-10 h-10 text-primary\" />\r\n            </div>\r\n            <div>\r\n              <CardTitle className=\"text-3xl font-black text-foreground uppercase tracking-tight\">Invoice <span className=\"text-primary text-glow\">Vault</span></CardTitle>\r\n              <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.3em] font-black mt-2\">Historical fiscal synchronization</p>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"mt-10 grid grid-cols-1 md:grid-cols-3 gap-8 max-w-3xl mx-auto relative z-10\">\r\n            {[\r\n              { label: 'Pending Nodes', val: '3', color: 'text-amber-500', icon: Clock },\r\n              { label: 'Settled Node (Feb)', val: '12', color: 'text-emerald-500', icon: CheckCircle },\r\n              { label: 'Oversight Exceptions', val: '1', color: 'text-rose-500', icon: WarningCircle }\r\n            ].map((node, i) => (\r\n              <div key={i} className=\"p-6 bg-card border border-border/50 rounded-3xl shadow-inner group/node hover:border-primary/20 transition-all\">\r\n                <div className=\"flex justify-between items-start mb-2\">\r\n                  <node.icon weight=\"duotone\" className={cn(\"w-5 h-5\", node.color)} />\r\n                  <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">{node.label}</span>\r\n                </div>\r\n                <p className={cn(\"text-4xl font-black tracking-tighter\", node.color)}>{node.val}</p>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardHeader>\r\n      </Card>\r\n\r\n      {/* Invoices Table Registry */}\r\n      <div className=\"px-2\">\r\n        <Card className=\"rounded-[40px] border-border/50 overflow-hidden shadow-premium\">\r\n          <ResponsiveTable\r\n            columns={columns}\r\n            data={[1, 2, 3, 4, 5]}\r\n            rowKey={(i) => i}\r\n            emptyMessage=\"Zero fiscal nodes detected in current vault.\"\r\n            mobileCard={(invoice) => (\r\n              <div className=\"space-y-5\">\r\n                <div className=\"flex justify-between items-start\">\r\n                  <div className=\"flex items-center gap-4\">\r\n                    <div className=\"w-14 h-14 rounded-2xl bg-secondary border border-border flex items-center justify-center text-primary shadow-inner\">\r\n                      <Receipt weight=\"duotone\" className=\"w-7 h-7\" />\r\n                    </div>\r\n                    <div className=\"min-w-0\">\r\n                      <p className=\"font-mono text-sm text-primary font-black tracking-widest\">INV-2026-00{invoice}</p>\r\n                      <p className=\"text-base font-bold text-foreground truncate tracking-tight uppercase\">Clinic Node {invoice}</p>\r\n                    </div>\r\n                  </div>\r\n                  <Badge variant=\"success\" size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3\">\r\n                    SETTLED\r\n                  </Badge>\r\n                </div>\r\n                \r\n                <div className=\"grid grid-cols-2 gap-6 py-4 border-y border-border/50\">\r\n                  <div>\r\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Fiscal Value</p>\r\n                    <p className=\"text-lg font-black text-foreground tabular-nums\">เธฟ{formatCurrency(invoice * 2900).replace('เธฟ', '')}</p>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Temporal Node</p>\r\n                    <p className=\"text-xs font-bold text-foreground\">Feb {invoice}, 2026</p>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-center pt-1\">\r\n                  <div className=\"flex items-center gap-2 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\r\n                    <Monitor weight=\"bold\" className=\"w-3.5 h-3.5 opacity-60\" />\r\n                    Archive Validated\r\n                  </div>\r\n                  <div className=\"flex gap-2\">\r\n                    <Button \r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      onClick={() => onDownload(`INV-2026-00${invoice}`)}\r\n                      className=\"px-4 py-2 h-auto rounded-xl text-[10px] font-black uppercase tracking-widest gap-2 border-border/50\"\r\n                    >\r\n                      <DownloadSimple weight=\"bold\" className=\"w-3.5 h-3.5\" />\r\n                      PDF\r\n                    </Button>\r\n                    <Button \r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      onClick={() => onViewInvoice({ \r\n                        id: `INV-2026-00${invoice}`, \r\n                        clinic: `Clinic Node ${invoice}`, \r\n                        amount: invoice * 2900, \r\n                        date: `Feb ${invoice}, 2026` \r\n                      })}\r\n                      className=\"px-4 py-2 h-auto rounded-xl text-[10px] font-black uppercase tracking-widest gap-2 border-border/50\"\r\n                    >\r\n                      <ArrowSquareOut weight=\"bold\" className=\"w-3.5 h-3.5\" />\r\n                      View\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          />\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\billing\\components\\SubscriptionsTab.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'motion' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"motion"},"fix":{"range":[44,51],"text":""},"desc":"Remove unused variable \"motion\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":2,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":33,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"AnimatePresence"},"fix":{"range":[35,91],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":3,"column":72,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":91,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[162,183],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sparkle' is defined but never used.","line":3,"column":93,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":100,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Sparkle"},"fix":{"range":[183,192],"text":""},"desc":"Remove unused variable \"Sparkle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowRight' is defined but never used.","line":3,"column":102,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":112,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowRight"},"fix":{"range":[192,204],"text":""},"desc":"Remove unused variable \"ArrowRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":8,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[486,498],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":8,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[498,509],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardContent' is defined but never used.","line":8,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":50,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardContent"},"fix":{"range":[509,522],"text":""},"desc":"Remove unused variable \"CardContent\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":25,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'tCommon' is assigned a value but never used.","line":26,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getStatusColor' is assigned a value but never used.","line":31,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'subscription' is defined but never used.","line":114,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":114,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { MagnifyingGlass, Eye, PencilSimple, Clock, Buildings, Funnel, IdentificationBadge, Sparkle, ArrowRight, IdentificationCard, ShieldCheck } from '@phosphor-icons/react';\r\nimport { useTranslations } from 'next-intl';\r\nimport { Subscription } from '../hooks/useBillingData';\r\nimport ResponsiveTable from '@/components/ui/ResponsiveTable';\r\nimport { cn } from '@/lib/utils';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\n\r\ninterface SubscriptionsTabProps {\r\n  subscriptions: Subscription[];\r\n  formatCurrency: (amount: number) => string;\r\n}\r\n\r\nconst planPricing = {\r\n  starter: { price: 2900, name: 'Starter' },\r\n  professional: { price: 4900, name: 'Professional' },\r\n  premium: { price: 7900, name: 'Premium' },\r\n  enterprise: { price: 12900, name: 'Enterprise' }\r\n};\r\n\r\nexport default function SubscriptionsTab({ subscriptions, formatCurrency }: SubscriptionsTabProps) {\r\n  const t = useTranslations('admin.billing');\r\n  const tCommon = useTranslations('common');\r\n  \r\n  const [filter, setFilter] = useState('all');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'active': return 'text-emerald-400 bg-emerald-500/20';\r\n      case 'past_due': return 'text-amber-400 bg-amber-500/20';\r\n      case 'canceled': return 'text-red-400 bg-red-500/20';\r\n      case 'expired': return 'text-gray-400 bg-gray-500/20';\r\n      default: return 'text-gray-400 bg-gray-500/20';\r\n    }\r\n  };\r\n\r\n  const getPlanColor = (plan: string) => {\r\n    switch (plan) {\r\n      case 'starter': return 'text-gray-400 bg-gray-500/20';\r\n      case 'professional': return 'text-blue-400 bg-blue-500/20';\r\n      case 'premium': return 'text-purple-400 bg-purple-500/20';\r\n      case 'enterprise': return 'text-amber-400 bg-amber-500/20';\r\n      default: return 'text-gray-400 bg-gray-500/20';\r\n    }\r\n  };\r\n\r\n  const filteredSubscriptions = subscriptions.filter(sub => {\r\n    const matchesFilter = filter === 'all' || sub.status === filter;\r\n    const matchesSearch = sub.clinic_name.toLowerCase().includes(searchTerm.toLowerCase());\r\n    return matchesFilter && matchesSearch;\r\n  });\r\n\r\n  const columns = [\r\n    {\r\n      header: 'Cluster Identity',\r\n      accessor: (subscription: Subscription) => (\r\n        <div className=\"flex items-center gap-4\">\r\n          <div className=\"w-12 h-12 rounded-2xl bg-primary/10 border border-primary/20 flex items-center justify-center text-primary group-hover:bg-primary/20 transition-all duration-500 shadow-inner shrink-0\">\r\n            <Buildings weight=\"duotone\" className=\"w-6 h-6\" />\r\n          </div>\r\n          <div className=\"min-w-0\">\r\n            <p className=\"font-bold text-foreground truncate tracking-tight uppercase\">{subscription.clinic_name}</p>\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className=\"text-[9px] font-mono text-muted-foreground tracking-widest\">NODE_ID:</span>\r\n              <span className=\"text-[10px] font-mono text-primary/60 font-bold uppercase\">{subscription.clinic_id.slice(0, 8)}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )\r\n    },\r\n    {\r\n      header: 'Protocol Tier',\r\n      accessor: (subscription: Subscription) => (\r\n        <Badge variant=\"ghost\" className={cn(\"border-none font-black text-[9px] uppercase tracking-widest px-3 py-1\", getPlanColor(subscription.plan))}>\r\n          {planPricing[subscription.plan as keyof typeof planPricing]?.name || subscription.plan}\r\n        </Badge>\r\n      )\r\n    },\r\n    {\r\n      header: 'Sync Status',\r\n      accessor: (subscription: Subscription) => (\r\n        <Badge variant={subscription.status === 'active' ? 'success' : 'warning'} size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3 py-1\">\r\n          {subscription.status.replace('_', ' ')}\r\n        </Badge>\r\n      )\r\n    },\r\n    {\r\n      header: 'Monthly Yield',\r\n      accessor: (subscription: Subscription) => (\r\n        <div className=\"space-y-0.5\">\r\n          <p className=\"font-black text-foreground tabular-nums tracking-tight\">{formatCurrency(subscription.amount)}</p>\r\n          <p className=\"text-[9px] text-muted-foreground uppercase font-black tracking-widest opacity-60\">Base Commitment</p>\r\n        </div>\r\n      )\r\n    },\r\n    {\r\n      header: 'Next Settlement',\r\n      accessor: (subscription: Subscription) => (\r\n        <div className=\"flex items-center gap-2.5 text-muted-foreground\">\r\n          <Clock weight=\"bold\" className=\"w-4 h-4 text-primary/60\" />\r\n          <span className=\"text-xs font-bold tabular-nums\">\r\n            {new Date(subscription.next_billing_date).toLocaleDateString()}\r\n          </span>\r\n        </div>\r\n      )\r\n    },\r\n    {\r\n      header: '',\r\n      className: 'text-right',\r\n      accessor: (subscription: Subscription) => (\r\n        <div className=\"flex items-center justify-end gap-2\">\r\n          <Button \r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            className=\"h-10 w-10 p-0 border-border/50 rounded-xl text-muted-foreground hover:text-primary hover:bg-primary/5 transition-all\"\r\n          >\r\n            <Eye weight=\"bold\" className=\"w-4 h-4\" />\r\n          </Button>\r\n          <Button \r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            className=\"h-10 w-10 p-0 border-border/50 rounded-xl text-muted-foreground hover:text-primary hover:bg-primary/5 transition-all\"\r\n          >\r\n            <PencilSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n          </Button>\r\n        </div>\r\n      )\r\n    }\r\n  ];\r\n\r\n  return (\r\n    <div className=\"space-y-8\">\r\n      {/* Search & Intelligence Controls */}\r\n      <div className=\"px-2\">\r\n        <Card className=\"p-8 rounded-[40px] border-border/50 shadow-premium relative overflow-hidden group\">\r\n          <div className=\"absolute top-0 right-0 p-12 opacity-[0.02] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n            <ShieldCheck className=\"w-64 h-64 text-primary\" />\r\n          </div>\r\n          \r\n          <div className=\"flex flex-col lg:flex-row lg:items-center justify-between gap-8 relative z-10\">\r\n            <div className=\"space-y-1\">\r\n              <h3 className=\"text-xl font-black text-foreground uppercase tracking-tight\">Active Subscriptions</h3>\r\n              <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.3em] font-black\">Managing cluster licensing nodes</p>\r\n            </div>\r\n\r\n            <div className=\"flex flex-col sm:flex-row items-center gap-4 flex-1 lg:max-w-2xl justify-end\">\r\n              <div className=\"relative w-full sm:w-64 group/input\">\r\n                <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\r\n                <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\r\n                <input \r\n                  type=\"text\" \r\n                  placeholder=\"Query cluster node name...\" \r\n                  value={searchTerm}\r\n                  onChange={(e) => setSearchTerm(e.target.value)}\r\n                  className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3 pl-11 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10 font-medium\"\r\n                />\r\n              </div>\r\n              \r\n              <div className=\"relative w-full sm:w-48\">\r\n                <select\r\n                  value={filter}\r\n                  onChange={(e) => setFilter(e.target.value)}\r\n                  className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3 px-6 text-xs font-black uppercase tracking-widest text-foreground focus:border-primary outline-none transition-all appearance-none shadow-inner\"\r\n                >\r\n                  <option value=\"all\">ALL NODES</option>\r\n                  <option value=\"active\">ACTIVE</option>\r\n                  <option value=\"past_due\">PAST DUE</option>\r\n                  <option value=\"canceled\">CANCELED</option>\r\n                  <option value=\"expired\">EXPIRED</option>\r\n                </select>\r\n                <Funnel weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-muted-foreground/40 pointer-events-none\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"mt-8 pt-6 border-t border-border/30 flex items-center justify-between\">\r\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\r\n              Showing {filteredSubscriptions.length} of {subscriptions.length} connected clusters\r\n            </p>\r\n            <div className=\"flex items-center gap-2\">\r\n              <div className=\"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse\" />\r\n              <span className=\"text-[10px] font-black text-emerald-500 uppercase tracking-widest\">Real-time Sync Active</span>\r\n            </div>\r\n          </div>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Subscriptions Registry Table */}\r\n      <div className=\"px-2\">\r\n        <Card className=\"rounded-[40px] border-border/50 overflow-hidden shadow-premium\">\r\n          <ResponsiveTable\r\n            columns={columns}\r\n            data={filteredSubscriptions}\r\n            rowKey={(sub) => sub.id}\r\n            emptyMessage=\"Zero subscription nodes detected in current matrix.\"\r\n            mobileCard={(subscription) => (\r\n              <div className=\"space-y-5\">\r\n                <div className=\"flex justify-between items-start\">\r\n                  <div className=\"flex items-center gap-4\">\r\n                    <div className=\"w-14 h-14 rounded-2xl bg-secondary border border-border flex items-center justify-center text-primary shadow-inner\">\r\n                      <Buildings weight=\"duotone\" className=\"w-7 h-7\" />\r\n                    </div>\r\n                    <div className=\"min-w-0\">\r\n                      <p className=\"font-bold text-foreground truncate uppercase tracking-tight\">{subscription.clinic_name}</p>\r\n                      <Badge variant=\"ghost\" size=\"sm\" className={cn(\"border-none font-black text-[8px] tracking-widest uppercase px-2 py-0.5\", getPlanColor(subscription.plan))}>\r\n                        {planPricing[subscription.plan as keyof typeof planPricing]?.name || subscription.plan}\r\n                      </Badge>\r\n                    </div>\r\n                  </div>\r\n                  <Badge variant={subscription.status === 'active' ? 'success' : 'warning'} size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3\">\r\n                    {subscription.status.toUpperCase()}\r\n                  </Badge>\r\n                </div>\r\n                \r\n                <div className=\"grid grid-cols-2 gap-6 py-4 border-y border-border/50\">\r\n                  <div>\r\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Monthly Yield</p>\r\n                    <p className=\"text-lg font-black text-foreground tabular-nums\">{formatCurrency(subscription.amount)}</p>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Next Settlement</p>\r\n                    <p className=\"text-xs font-bold text-foreground tabular-nums\">{new Date(subscription.next_billing_date).toLocaleDateString()}</p>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-center pt-1\">\r\n                  <div className=\"flex items-center gap-2 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\r\n                    <IdentificationCard weight=\"bold\" className=\"w-3.5 h-3.5 opacity-60\" />\r\n                    Archive #ID-{subscription.clinic_id.slice(0, 6).toUpperCase()}\r\n                  </div>\r\n                  <div className=\"flex gap-2\">\r\n                    <Button \r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      className=\"px-6 py-2 h-auto rounded-xl text-[10px] font-black uppercase tracking-widest gap-2 border-border/50\"\r\n                    >\r\n                      <Eye weight=\"bold\" className=\"w-3.5 h-3.5\" />\r\n                      Detail\r\n                    </Button>\r\n                    <Button \r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      className=\"px-6 py-2 h-auto rounded-xl text-[10px] font-black uppercase tracking-widest gap-2 border-border/50\"\r\n                    >\r\n                      <PencilSimple weight=\"bold\" className=\"w-3.5 h-3.5\" />\r\n                      Sync\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          />\r\n        </Card>\r\n      </div>\r\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\billing\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChartLineUp' is defined but never used.","line":3,"column":86,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":97,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ChartLineUp"},"fix":{"range":[100,113],"text":""},"desc":"Remove unused variable \"ChartLineUp\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Receipt' is defined but never used.","line":3,"column":99,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":106,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Receipt"},"fix":{"range":[113,122],"text":""},"desc":"Remove unused variable \"Receipt\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CalendarDots' is defined but never used.","line":3,"column":108,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":120,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CalendarDots"},"fix":{"range":[122,136],"text":""},"desc":"Remove unused variable \"CalendarDots\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":3,"column":122,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":132,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[136,148],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Info' is defined but never used.","line":3,"column":134,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":138,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Info"},"fix":{"range":[148,154],"text":""},"desc":"Remove unused variable \"Info\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ShieldCheck' is defined but never used.","line":3,"column":140,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":151,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ShieldCheck"},"fix":{"range":[154,167],"text":""},"desc":"Remove unused variable \"ShieldCheck\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Lightning' is defined but never used.","line":3,"column":153,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":162,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Lightning"},"fix":{"range":[167,178],"text":""},"desc":"Remove unused variable \"Lightning\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Card' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Card"},"fix":{"range":[221,226],"text":""},"desc":"Remove unused variable \"Card\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":4,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[225,237],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":4,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[237,248],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardContent' is defined but never used.","line":4,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":50,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"CardContent"},"fix":{"range":[212,292],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'StatCard' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":18,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"StatCard"},"fix":{"range":[392,444],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":20,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":17},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":22,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1215,1218],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1215,1218],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":122,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":122,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4975,4978],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4975,4978],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { CreditCard, ArrowsClockwise, DownloadSimple, SpinnerGap, Package, FileText, ChartLineUp, Receipt, CalendarDots, CaretRight, Info, ShieldCheck, Lightning } from '@phosphor-icons/react';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { cn } from '@/lib/utils';\r\nimport { useState } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { useBillingData } from './hooks/useBillingData';\r\nimport BillingStatsCards from './components/BillingStatsCards';\r\nimport SubscriptionsTab from './components/SubscriptionsTab';\r\nimport InvoicesTab from './components/InvoicesTab';\r\nimport InvoiceModal from './components/InvoiceModal';\r\n\r\nexport default function BillingManagementPage() {\r\n  const { goBack } = useBackNavigation();\r\n  const { subscriptions, stats, loading, refreshData } = useBillingData();\r\n  const [selectedInvoice, setSelectedInvoice] = useState<any>(null);\r\n  const [activeTab, setActiveTab] = useState<'subscriptions' | 'invoices'>('subscriptions');\r\n  const [refreshing, setRefreshing] = useState(false);\r\n\r\n  const tabs = [\r\n    { id: 'subscriptions', label: 'Subscriptions', icon: Package },\r\n    { id: 'invoices', label: 'Invoices & Receipts', icon: FileText }\r\n  ];\r\n\r\n  const handleRefresh = async () => {\r\n    setRefreshing(true);\r\n    await refreshData();\r\n    setRefreshing(false);\r\n  };\r\n\r\n  const handleDownload = (id: string) => {\r\n    alert(`Downloading invoice ${id}...`);\r\n  };\r\n\r\n  const formatCurrency = (amount: number) => {\r\n    return new Intl.NumberFormat('th-TH', {\r\n      style: 'currency',\r\n      currency: 'THB',\r\n      minimumFractionDigits: 0\r\n    }).format(amount);\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-[400px] flex items-center justify-center\">\r\n        <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-10 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <CreditCard weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Fiscal Architecture\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Subscription & <span className=\"text-primary\">Billing</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating clinic subscriptions, revenue streams, and automated invoicing nodes.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <div className=\"flex flex-wrap items-center gap-3\">\r\n          <Button\r\n            variant=\"outline\"\r\n            onClick={handleRefresh}\r\n            disabled={refreshing}\r\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50\"\r\n          >\r\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", refreshing && \"animate-spin\")} />\r\n            Sync Ledger\r\n          </Button>\r\n          <Button className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\">\r\n            <DownloadSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n            Export Intelligence\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Cards - Using our unified StatCard internally if possible, but BillingStatsCards might have its own grid */}\r\n      <div className=\"px-2\">\r\n        <BillingStatsCards stats={stats} formatCurrency={formatCurrency} />\r\n      </div>\r\n\r\n      {/* Navigation & Controls */}\r\n      <div className=\"flex flex-col sm:flex-row items-center justify-between gap-6 px-2\">\r\n        <div className=\"flex items-center gap-2 bg-secondary/50 p-1.5 rounded-[24px] border border-border/50 w-full sm:w-auto\">\r\n          {tabs.map((tab) => (\r\n            <button\r\n              key={tab.id}\r\n              onClick={() => setActiveTab(tab.id as any)}\r\n              className={cn(\r\n                \"flex-1 sm:flex-none flex items-center justify-center gap-3 px-8 py-3.5 rounded-2xl transition-all text-[10px] font-black uppercase tracking-widest border whitespace-nowrap\",\r\n                activeTab === tab.id\r\n                  ? \"bg-primary text-primary-foreground border-primary shadow-premium\"\r\n                  : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\r\n              )}\r\n            >\r\n              <tab.icon weight={activeTab === tab.id ? \"fill\" : \"bold\"} className=\"w-4 h-4\" />\r\n              {tab.label}\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[10px] tracking-widest uppercase px-4 py-2\">\r\n          Secure Fiscal Node\r\n        </Badge>\r\n      </div>\r\n\r\n      {/* Tab Content */}\r\n      <div className=\"px-2\">\r\n        <AnimatePresence mode=\"wait\">\r\n          <motion.div\r\n            key={activeTab}\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, scale: 0.95 }}\r\n            transition={{ duration: 0.3 }}\r\n            className=\"space-y-8\"\r\n          >\r\n            {activeTab === 'subscriptions' ? (\r\n              <SubscriptionsTab subscriptions={subscriptions} formatCurrency={formatCurrency} />\r\n            ) : (\r\n              <InvoicesTab \r\n                formatCurrency={formatCurrency}\r\n                onDownload={handleDownload}\r\n                onViewInvoice={setSelectedInvoice}\r\n              />\r\n            )}\r\n          </motion.div>\r\n        </AnimatePresence>\r\n      </div>\r\n\r\n      {/* Invoice Detail Modal */}\r\n      <InvoiceModal\r\n        invoice={selectedInvoice}\r\n        onClose={() => setSelectedInvoice(null)}\r\n        onDownload={handleDownload}\r\n        formatCurrency={formatCurrency}\r\n      />\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\broadcast\\components\\BroadcastHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\broadcast\\components\\ComposeMessage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Info' is defined but never used.","line":8,"column":68,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":72,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Info"},"fix":{"range":[355,361],"text":""},"desc":"Remove unused variable \"Info\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sparkle' is defined but never used.","line":8,"column":74,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":81,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Sparkle"},"fix":{"range":[361,370],"text":""},"desc":"Remove unused variable \"Sparkle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":8,"column":101,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":112,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle"},"fix":{"range":[388,401],"text":""},"desc":"Remove unused variable \"CheckCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningCircle' is defined but never used.","line":8,"column":114,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":127,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WarningCircle"},"fix":{"range":[401,416],"text":""},"desc":"Remove unused variable \"WarningCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":8,"column":138,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":157,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[425,446],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Browser' is defined but never used.","line":8,"column":159,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":166,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Browser"},"fix":{"range":[446,455],"text":""},"desc":"Remove unused variable \"Browser\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WebhookLogo' is defined but never used.","line":8,"column":168,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":179,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WebhookLogo"},"fix":{"range":[455,468],"text":""},"desc":"Remove unused variable \"WebhookLogo\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Robot' is defined but never used.","line":8,"column":181,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":186,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Robot"},"fix":{"range":[468,475],"text":""},"desc":"Remove unused variable \"Robot\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":8,"column":188,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":198,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[475,487],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":8,"column":200,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":201,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"X"},"fix":{"range":[487,490],"text":""},"desc":"Remove unused variable \"X\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":8,"column":203,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":208,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Clock"},"fix":{"range":[490,497],"text":""},"desc":"Remove unused variable \"Clock\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":138,"column":99,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":102,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6671,6674],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6671,6674],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":178,"column":98,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":178,"endColumn":101,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8834,8837],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8834,8837],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Pulse' is not defined.","line":260,"column":20,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":260,"endColumn":25},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Target' is not defined.","line":264,"column":22,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":264,"endColumn":28},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'SpinnerGap' is not defined.","line":301,"column":30,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":301,"endColumn":40}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { cn } from '@/lib/utils';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { PaperPlaneTilt, TestTube, CalendarDots, Users, Buildings, Info, Sparkle, Globe, Lightning, CheckCircle, WarningCircle, Monitor, IdentificationBadge, Browser, WebhookLogo, Robot, CaretRight, X, Clock } from '@phosphor-icons/react';\r\n\r\nexport default function ComposeMessage() {\r\n  const { createMessage, sendTestMessage, creating, clinics } = useBroadcastContext();\r\n  const [formData, setFormData] = useState<BroadcastFormData>({\r\n    title: '',\r\n    content: '',\r\n    message_type: 'notification',\r\n    target_type: 'all',\r\n    target_plans: [],\r\n    target_clinics: []\r\n  });\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    try {\r\n      await createMessage(formData);\r\n      // Reset form\r\n      setFormData({\r\n        title: '',\r\n        content: '',\r\n        message_type: 'notification',\r\n        target_type: 'all',\r\n        target_plans: [],\r\n        target_clinics: []\r\n      });\r\n    } catch (error) {\r\n      console.error('Failed to send message:', error);\r\n    }\r\n  };\r\n\r\n  const handleTest = async () => {\r\n    try {\r\n      await sendTestMessage(formData);\r\n    } catch (error) {\r\n      console.error('Failed to send test:', error);\r\n    }\r\n  };\r\n\r\n  const plans = ['starter', 'professional', 'premium', 'enterprise'];\r\n  const planLabels = {\r\n    starter: 'Starter',\r\n    professional: 'Professional',\r\n    premium: 'Premium',\r\n    enterprise: 'Enterprise'\r\n  };\r\n\r\n  const selectedClinicCount = formData.target_type === 'specific' \r\n    ? formData.target_clinics.length \r\n    : formData.target_type === 'plan' \r\n    ? clinics.filter(c => formData.target_plans.includes(c.plan)).length\r\n    : clinics.length;\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0, y: 20 }}\r\n      animate={{ opacity: 1, y: 0 }}\r\n    >\r\n      <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n        <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 relative overflow-hidden\">\r\n          <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n            <PaperPlaneTilt weight=\"fill\" className=\"w-64 h-64 text-primary\" />\r\n          </div>\r\n          <div className=\"flex items-center gap-5 relative z-10\">\r\n            <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\r\n              <PaperPlaneTilt weight=\"duotone\" className=\"w-6 h-6\" />\r\n            </div>\r\n            <div>\r\n              <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Transmission Uplink</CardTitle>\r\n              <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.3em] font-black mt-1\">Compose system-wide broadcast payload</p>\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n\r\n        <CardContent className=\"p-8 md:p-10 relative z-10\">\r\n          <form onSubmit={handleSubmit} className=\"space-y-10\">\r\n            {/* Message Title */}\r\n            <div className=\"space-y-3\">\r\n              <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Payload Header *</label>\r\n              <div className=\"relative group/input\">\r\n                <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\r\n                <input\r\n                  type=\"text\"\r\n                  value={formData.title}\r\n                  onChange={(e) => setFormData({ ...formData, title: e.target.value })}\r\n                  className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner relative z-10\"\r\n                  placeholder=\"Enter message title node...\"\r\n                  required\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Message Content */}\r\n            <div className=\"space-y-3\">\r\n              <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Communication Body *</label>\r\n              <div className=\"relative group/input\">\r\n                <textarea\r\n                  value={formData.content}\r\n                  onChange={(e) => setFormData({ ...formData, content: e.target.value })}\r\n                  rows={6}\r\n                  className=\"w-full bg-secondary/30 border border-border rounded-[28px] py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-medium leading-relaxed italic shadow-inner resize-none\"\r\n                  placeholder=\"Type your clinical broadcast payload here...\"\r\n                  required\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Delivery Method Hub */}\r\n            <div className=\"space-y-4\">\r\n              <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Delivery Channel Protocol</label>\r\n              <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4\">\r\n                {[\r\n                  { value: 'notification', label: 'In-App Registry', icon: Monitor, desc: 'Digital HUD' },\r\n                  { value: 'email', label: 'Neural Mail', icon: EnvelopeSimple, desc: 'SMTP Uplink' },\r\n                  { value: 'sms', label: 'SMS Stream', icon: Lightning, desc: 'Cellular Node' }\r\n                ].map((type) => (\r\n                  <label\r\n                    key={type.value}\r\n                    className={cn(\r\n                      \"p-5 rounded-2xl border cursor-pointer transition-all flex flex-col items-center text-center gap-3 relative overflow-hidden group/method\",\r\n                      formData.message_type === type.value\r\n                        ? \"bg-primary/10 border-primary/40 text-primary shadow-glow-sm\"\r\n                        : \"bg-secondary/20 border-border/50 text-muted-foreground hover:bg-secondary/40\"\r\n                    )}\r\n                  >\r\n                    <input\r\n                      type=\"radio\"\r\n                      name=\"message_type\"\r\n                      value={type.value}\r\n                      checked={formData.message_type === type.value}\r\n                      onChange={(e) => setFormData({ ...formData, message_type: e.target.value as any })}\r\n                      className=\"sr-only\"\r\n                    />\r\n                    <type.icon weight={formData.message_type === type.value ? \"fill\" : \"duotone\"} className=\"w-6 h-6\" />\r\n                    <div>\r\n                      <div className=\"text-[10px] font-black uppercase tracking-widest\">{type.label}</div>\r\n                      <div className=\"text-[8px] font-bold opacity-60 uppercase mt-0.5\">{type.desc}</div>\r\n                    </div>\r\n                  </label>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Target Audience Matrix */}\r\n            <div className=\"space-y-6\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"w-1.5 h-1.5 rounded-full bg-primary animate-pulse\" />\r\n                <h3 className=\"text-[11px] font-black text-foreground uppercase tracking-[0.3em]\">Recipient Cluster Matrix</h3>\r\n              </div>\r\n              \r\n              <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4\">\r\n                {[\r\n                  { value: 'all', label: 'Global Network', icon: Globe },\r\n                  { value: 'plan', label: 'Protocol Tiers', icon: Buildings },\r\n                  { value: 'specific', label: 'Cluster Nodes', icon: Users }\r\n                ].map((target) => (\r\n                  <label\r\n                    key={target.value}\r\n                    className={cn(\r\n                      \"p-5 rounded-2xl border cursor-pointer transition-all flex flex-col items-center text-center gap-3\",\r\n                      formData.target_type === target.value\r\n                        ? \"bg-primary/10 border-primary/40 text-primary shadow-glow-sm\"\r\n                        : \"bg-secondary/20 border-border/50 text-muted-foreground hover:bg-secondary/40\"\r\n                    )}\r\n                  >\r\n                    <input\r\n                      type=\"radio\"\r\n                      name=\"target_type\"\r\n                      value={target.value}\r\n                      checked={formData.target_type === target.value}\r\n                      onChange={(e) => setFormData({ ...formData, target_type: e.target.value as any })}\r\n                      className=\"sr-only\"\r\n                    />\r\n                    <target.icon weight={formData.target_type === target.value ? \"fill\" : \"duotone\"} className=\"w-6 h-6\" />\r\n                    <div className=\"text-[10px] font-black uppercase tracking-widest\">{target.label}</div>\r\n                  </label>\r\n                ))}\r\n              </div>\r\n\r\n              {/* Conditional Target Selectors */}\r\n              <AnimatePresence mode=\"wait\">\r\n                {formData.target_type === 'plan' && (\r\n                  <motion.div\r\n                    initial={{ opacity: 0, y: -10 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    exit={{ opacity: 0, y: -10 }}\r\n                    className=\"p-6 bg-secondary/30 rounded-[32px] border border-border/50 shadow-inner\"\r\n                  >\r\n                    <label className=\"block text-[10px] font-black text-muted-foreground uppercase tracking-widest mb-4 ml-1\">Select Protocol Tiers:</label>\r\n                    <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-3\">\r\n                      {plans.map((plan) => (\r\n                        <label \r\n                          key={plan} \r\n                          className={cn(\r\n                            \"flex items-center gap-3 p-3 rounded-xl border cursor-pointer transition-all\",\r\n                            formData.target_plans.includes(plan)\r\n                              ? \"bg-primary/10 border-primary/30 text-primary\"\r\n                              : \"bg-card border-border/50 text-muted-foreground hover:bg-secondary/40\"\r\n                          )}\r\n                        >\r\n                          <input\r\n                            type=\"checkbox\"\r\n                            checked={formData.target_plans.includes(plan)}\r\n                            onChange={(e) => {\r\n                              if (e.target.checked) {\r\n                                setFormData({ ...formData, target_plans: [...formData.target_plans, plan] });\r\n                              } else {\r\n                                setFormData({ ...formData, target_plans: formData.target_plans.filter(p => p !== plan) });\r\n                              }\r\n                            }}\r\n                            className=\"rounded border-border text-primary focus:ring-primary/20\"\r\n                          />\r\n                          <span className=\"text-[10px] font-black uppercase tracking-tight\">{planLabels[plan as keyof typeof planLabels]}</span>\r\n                        </label>\r\n                      ))}\r\n                    </div>\r\n                  </motion.div>\r\n                )}\r\n\r\n                {formData.target_type === 'specific' && (\r\n                  <motion.div\r\n                    initial={{ opacity: 0, y: -10 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    exit={{ opacity: 0, y: -10 }}\r\n                    className=\"p-6 bg-secondary/30 rounded-[32px] border border-border/50 shadow-inner\"\r\n                  >\r\n                    <label className=\"block text-[10px] font-black text-muted-foreground uppercase tracking-widest mb-4 ml-1\">Establish Cluster Links:</label>\r\n                    <div className=\"relative group/select\">\r\n                      <select\r\n                        multiple\r\n                        value={formData.target_clinics}\r\n                        onChange={(e) => {\r\n                          const selected = Array.from(e.target.selectedOptions, option => option.value);\r\n                          setFormData({ ...formData, target_clinics: selected });\r\n                        }}\r\n                        className=\"w-full h-40 bg-card border border-border rounded-2xl py-3 px-4 text-sm text-foreground focus:border-primary outline-none transition-all shadow-inner relative z-10 custom-scrollbar\"\r\n                      >\r\n                        {clinics.map((clinic) => (\r\n                          <option key={clinic.id} value={clinic.id} className=\"p-2 border-b border-border/20 last:border-0 hover:bg-primary/5\">\r\n                            {clinic.name.toUpperCase()} [{clinic.plan.toUpperCase()}]\r\n                          </option>\r\n                        ))}\r\n                      </select>\r\n                      <p className=\"text-[9px] text-muted-foreground font-medium italic mt-3 px-1\">Node Synchronization: Hold Ctrl/Cmd to establish multiple links.</p>\r\n                    </div>\r\n                  </motion.div>\r\n                )}\r\n              </AnimatePresence>\r\n\r\n              {/* Audience Sync Summary */}\r\n              <div className=\"p-5 bg-primary/5 rounded-[28px] border border-primary/10 flex items-center justify-between group/summary overflow-hidden relative shadow-inner\">\r\n                <div className=\"absolute top-0 right-0 p-4 opacity-[0.03] group-hover/summary:scale-110 transition-transform\">\r\n                  <Pulse weight=\"fill\" className=\"w-16 h-16 text-primary\" />\r\n                </div>\r\n                <div className=\"flex items-center gap-4 relative z-10\">\r\n                  <div className=\"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary shadow-sm border border-primary/20\">\r\n                    <Target weight=\"bold\" className=\"w-5 h-5\" />\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Active Recipients</p>\r\n                    <p className=\"text-lg font-black text-foreground tabular-nums tracking-tighter\">{selectedClinicCount} Clinical Nodes</p>\r\n                  </div>\r\n                </div>\r\n                <Badge variant=\"success\" className=\"font-black text-[8px] tracking-widest px-3 py-1 shadow-sm relative z-10\">SYNC_READY</Badge>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Schedule Protocol */}\r\n            <div className=\"space-y-3\">\r\n              <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1 flex items-center gap-2\">\r\n                <CalendarDots weight=\"bold\" className=\"w-3.5 h-3.5\" />\r\n                Temporal Dispatch Protocol (Optional)\r\n              </label>\r\n              <div className=\"relative group/input\">\r\n                <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\r\n                <input\r\n                  type=\"datetime-local\"\r\n                  value={formData.scheduled_at || ''}\r\n                  onChange={(e) => setFormData({ ...formData, scheduled_at: e.target.value })}\r\n                  className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner relative z-10\"\r\n                />\r\n              </div>\r\n              <p className=\"text-[10px] text-muted-foreground font-medium italic opacity-60 ml-1\">Leave null for immediate system-wide distribution.</p>\r\n            </div>\r\n\r\n            {/* Action Selection */}\r\n            <div className=\"flex flex-col sm:flex-row items-center gap-4 pt-6 border-t border-border/30\">\r\n              <Button\r\n                type=\"submit\"\r\n                disabled={creating || !formData.title || !formData.content}\r\n                className=\"w-full sm:flex-[2] py-7 rounded-[24px] font-black uppercase tracking-widest text-[11px] shadow-premium gap-3 relative overflow-hidden group/btn\"\r\n              >\r\n                <div className=\"absolute inset-0 bg-white/20 -translate-x-full group-hover/btn:translate-x-full transition-transform duration-1000\" />\r\n                {creating ? <SpinnerGap className=\"w-5 h-5 animate-spin\" /> : <PaperPlaneTilt weight=\"bold\" className=\"w-5 h-5 group-hover/btn:scale-110 group-hover/btn:-rotate-12 transition-all\" />}\r\n                {creating ? 'TRANSMITTING...' : 'EXECUTE BROADCAST'}\r\n              </Button>\r\n\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"outline\"\r\n                onClick={handleTest}\r\n                disabled={creating || !formData.title || !formData.content}\r\n                className=\"w-full sm:flex-1 py-7 rounded-[24px] font-black uppercase tracking-widest text-[11px] border-border/50 hover:bg-secondary gap-3\"\r\n              >\r\n                <TestTube weight=\"bold\" className=\"w-5 h-5\" />\r\n                Ping Node\r\n              </Button>\r\n            </div>\r\n          </form>\r\n        </CardContent>\r\n      </Card>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\broadcast\\components\\MessagesList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SpinnerGap' is defined but never used.","line":7,"column":82,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":92,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"SpinnerGap"},"fix":{"range":[288,300],"text":""},"desc":"Remove unused variable \"SpinnerGap\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BroadcastMessage' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":26,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"BroadcastMessage"},"fix":{"range":[383,427],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getStatusColor' is assigned a value but never used.","line":27,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":23},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":104,"column":6,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":104,"endColumn":12},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":110,"column":10,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":110,"endColumn":16}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { Card, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { cn } from '@/lib/utils';\r\nimport { Trash, Clock, CheckCircle, XCircle, WarningCircle, Users, CalendarDots, SpinnerGap } from '@phosphor-icons/react';\nimport { useBroadcastContext } from '../context';\nimport { BroadcastMessage } from '../types';\r\n\r\nexport default function MessagesList() {\r\n  const { messages, loading, deleteMessage } = useBroadcastContext();\r\n\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'sent':\r\n        return <CheckCircle className=\"w-4 h-4 text-emerald-400\" />;\r\n      case 'failed':\r\n        return <XCircle className=\"w-4 h-4 text-red-400\" />;\r\n      case 'scheduled':\r\n        return <Clock className=\"w-4 h-4 text-amber-400\" />;\r\n      default:\r\n        return <WarningCircle className=\"w-4 h-4 text-gray-400\" />;\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'sent':\r\n        return 'bg-emerald-500/20 text-emerald-400';\r\n      case 'failed':\r\n        return 'bg-red-500/20 text-red-400';\r\n      case 'scheduled':\r\n        return 'bg-amber-500/20 text-amber-400';\r\n      default:\r\n        return 'bg-gray-500/20 text-gray-400';\r\n    }\r\n  };\r\n\r\n  const formatDate = (dateString: string) => {\r\n    return new Date(dateString).toLocaleString('th-TH', {\r\n      year: 'numeric',\r\n      month: 'short',\r\n      day: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit'\r\n    });\r\n  };\r\n\r\n  const handleDelete = async (id: string) => {\r\n    if (confirm('Are you sure you want to delete this message?')) {\r\n      try {\r\n        await deleteMessage(id);\r\n      } catch (error) {\r\n        console.error('Failed to delete message:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        {[...Array(3)].map((_, index) => (\r\n          <Card key={index} className=\"rounded-[32px] border-border/50 shadow-sm overflow-hidden\">\r\n            <CardContent className=\"p-8\">\r\n              <div className=\"animate-pulse space-y-6\">\r\n                <div className=\"flex justify-between items-start\">\r\n                  <div className=\"flex gap-3\">\r\n                    <div className=\"h-6 w-20 bg-secondary rounded-lg\"></div>\r\n                    <div className=\"h-6 w-20 bg-secondary rounded-lg\"></div>\r\n                  </div>\r\n                  <div className=\"h-8 w-8 bg-secondary rounded-xl\"></div>\r\n                </div>\r\n                <div className=\"space-y-3\">\r\n                  <div className=\"h-6 bg-secondary rounded-xl w-3/4\"></div>\r\n                  <div className=\"h-4 bg-secondary rounded-lg w-1/2\"></div>\r\n                </div>\r\n                <div className=\"h-20 bg-secondary/50 rounded-2xl w-full\"></div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (messages.length === 0) {\r\n    return (\r\n      <Card variant=\"ghost\" className=\"py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-8 opacity-40 rounded-[40px]\">\r\n        <div className=\"w-20 h-20 rounded-[40px] bg-secondary flex items-center justify-center text-muted-foreground shadow-inner\">\r\n          <WarningCircle weight=\"duotone\" className=\"w-10 h-10\" />\r\n        </div>\r\n        <div className=\"text-center space-y-2\">\r\n          <h3 className=\"text-2xl font-black text-foreground uppercase tracking-widest\">Archive Nominal</h3>\r\n          <p className=\"text-sm text-muted-foreground font-medium italic max-w-sm mx-auto\">\r\n            Your broadcast transmission history will manifest here once initialized.\r\n          </p>\r\n        </div>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-6\"\r\n    >\r\n      {messages.map((message, index) => (\r\n        <motion.div\r\n          key={message.id}\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ delay: index * 0.05 }}\r\n        >\r\n          <Card className=\"rounded-[32px] border-border/50 hover:border-primary/30 transition-all group overflow-hidden shadow-card hover:shadow-card-hover\">\r\n            <CardContent className=\"p-8\">\r\n              <div className=\"flex items-start justify-between gap-8\">\r\n                <div className=\"flex-1 space-y-6\">\r\n                  <div className=\"flex flex-wrap items-center gap-3\">\r\n                    <div className=\"flex items-center gap-2 px-3 py-1 bg-secondary/50 rounded-lg\">\r\n                      {getStatusIcon(message.status)}\r\n                      <span className={cn(\"text-[10px] font-black uppercase tracking-widest\", \r\n                        message.status === 'sent' ? 'text-emerald-500' : \r\n                        message.status === 'failed' ? 'text-rose-500' : \r\n                        'text-amber-500'\r\n                      )}>\r\n                        {message.status}\r\n                      </span>\r\n                    </div>\r\n                    <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[8px] tracking-widest uppercase px-3\">\r\n                      {message.message_type} NODE\r\n                    </Badge>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <h3 className=\"text-xl font-black text-foreground uppercase tracking-tight group-hover:text-primary transition-colors\">{message.title}</h3>\r\n                    <p className=\"text-muted-foreground text-sm font-medium italic leading-relaxed line-clamp-2\">{message.content}</p>\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                    <div className=\"flex items-center gap-6 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Users weight=\"bold\" className=\"w-4 h-4 opacity-60\" />\r\n                        <span>{message.delivery_stats.total} RECIPIENTS</span>\r\n                      </div>\r\n                      \r\n                      {message.scheduled_at && (\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <CalendarDots weight=\"bold\" className=\"w-4 h-4 opacity-60\" />\r\n                          <span>\r\n                            {message.status === 'scheduled' ? 'PLAN:' : 'SENT:'} {formatDate(message.scheduled_at)}\r\n                          </span>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-2 text-[10px] font-black text-muted-foreground uppercase tracking-widest md:justify-end\">\r\n                      <Clock weight=\"bold\" className=\"w-3.5 h-3.5 opacity-40\" />\r\n                      INITIALIZED: {formatDate(message.created_at)}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Delivery Stats Node */}\r\n                  {message.delivery_stats.total > 0 && (\r\n                    <div className=\"p-5 bg-secondary/30 rounded-2xl border border-border/50 shadow-inner\">\r\n                      <div className=\"grid grid-cols-3 gap-8 text-center\">\r\n                        <div className=\"space-y-1\">\r\n                          <p className=\"text-xl font-black text-emerald-500 tabular-nums\">{message.delivery_stats.sent}</p>\r\n                          <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest\">Success</p>\r\n                        </div>\r\n                        <div className=\"space-y-1 border-x border-border/30\">\r\n                          <p className=\"text-xl font-black text-amber-500 tabular-nums\">{message.delivery_stats.pending}</p>\r\n                          <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest\">Pending</p>\r\n                        </div>\r\n                        <div className=\"space-y-1\">\r\n                          <p className=\"text-xl font-black text-rose-500 tabular-nums\">{message.delivery_stats.failed}</p>\r\n                          <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest\">Exception</p>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={() => handleDelete(message.id)}\r\n                  className=\"h-11 w-11 p-0 rounded-2xl border-border/50 hover:bg-rose-500/10 text-muted-foreground hover:text-rose-500 hover:border-rose-500/30 transition-all shrink-0\"\r\n                  title=\"Purge Node\"\r\n                >\r\n                  <Trash weight=\"bold\" className=\"w-5 h-5\" />\r\n                </Button>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </motion.div>\r\n      ))}\r\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\broadcast\\context.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\broadcast\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Megaphone' is defined but never used.","line":1,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":19,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Megaphone"},"fix":{"range":[9,19],"text":""},"desc":"Remove unused variable \"Megaphone\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used.","line":1,"column":55,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":59,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Plus"},"fix":{"range":[52,58],"text":""},"desc":"Remove unused variable \"Plus\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":1,"column":67,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":77,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[64,76],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash' is defined but never used.","line":1,"column":79,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":84,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Trash"},"fix":{"range":[76,83],"text":""},"desc":"Remove unused variable \"Trash\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PencilSimple' is defined but never used.","line":1,"column":86,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":98,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"PencilSimple"},"fix":{"range":[83,97],"text":""},"desc":"Remove unused variable \"PencilSimple\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SpinnerGap' is defined but never used.","line":1,"column":120,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":130,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"SpinnerGap"},"fix":{"range":[117,129],"text":""},"desc":"Remove unused variable \"SpinnerGap\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":1,"column":143,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":144,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"X"},"fix":{"range":[140,143],"text":""},"desc":"Remove unused variable \"X\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningCircle' is defined but never used.","line":1,"column":159,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":172,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WarningCircle"},"fix":{"range":[156,171],"text":""},"desc":"Remove unused variable \"WarningCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":2,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[227,239],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":2,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[239,250],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BroadcastHeader' is defined but never used.","line":8,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":23,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"BroadcastHeader"},"fix":{"range":[575,634],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":16,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Megaphone, PaperPlaneTilt, Clock, Broadcast, Plus, Info, CaretRight, Trash, PencilSimple, Globe, ShieldCheck, SpinnerGap, Lightning, X, CheckCircle, WarningCircle, UserList } from '@phosphor-icons/react';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { BroadcastProvider, useBroadcastContext } from './context';\nimport BroadcastHeader from './components/BroadcastHeader';\nimport ComposeMessage from './components/ComposeMessage';\nimport MessagesList from './components/MessagesList';\nimport { cn } from '@/lib/utils';\nimport { useEffect } from 'react';\nimport { motion } from 'framer-motion';\n\nfunction BroadcastContent() {\n  const { goBack } = useBackNavigation();\n  const { fetchMessages, fetchClinics } = useBroadcastContext();\n\n  useEffect(() => {\n    fetchMessages();\n    fetchClinics();\n  }, [fetchMessages, fetchClinics]);\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-10 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n      \n      {/* Header Section */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <Broadcast weight=\"duotone\" className=\"w-4 h-4\" />\n            Neural Broadcast Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n          >\n            Global <span className=\"text-primary\">Broadcast</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Orchestrating system-wide transmissions and cross-cluster communications.\n          </motion.p>\n        </div>\n        \n        <div className=\"flex flex-wrap items-center gap-3\">\n          <Button variant=\"outline\" className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50\">\n            <UserList weight=\"bold\" className=\"w-4 h-4\" />\n            Recipients Cluster\n          </Button>\n          <Button className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\">\n            <Lightning weight=\"bold\" className=\"w-4 h-4\" />\n            Active Channels\n          </Button>\n        </div>\n      </div>\n\n      {/* Stats Summary - Mini version */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8 px-2\">\n        {[\n          { label: 'Dispatch Velocity', value: '1.2ms', icon: Lightning, color: 'text-emerald-500', bg: 'bg-emerald-500/10' },\n          { label: 'Network Reach', value: '24 Nodes', icon: Globe, color: 'text-primary', bg: 'bg-primary/10' },\n          { label: 'Success Quota', value: '99.9%', icon: CheckCircle, color: 'text-blue-500', bg: 'bg-blue-500/10' }\n        ].map((stat, i) => (\n          <Card key={i} className=\"p-6 border-border/50 hover:border-primary/30 transition-all group overflow-hidden\">\n            <div className=\"absolute top-0 right-0 p-4 opacity-[0.03] group-hover:scale-110 transition-transform\">\n              <stat.icon weight=\"fill\" className=\"w-16 h-16 text-primary\" />\n            </div>\n            <div className=\"flex items-center gap-5 relative z-10\">\n              <div className={cn(\"w-12 h-12 rounded-xl flex items-center justify-center border border-border/50 shadow-inner\", stat.bg, stat.color)}>\n                <stat.icon weight=\"duotone\" className=\"w-6 h-6\" />\n              </div>\n              <div>\n                <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">{stat.label}</p>\n                <p className=\"text-xl font-black text-foreground\">{stat.value}</p>\n              </div>\n            </div>\n          </Card>\n        ))}\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-10 px-2\">\n        <div className=\"lg:col-span-2 space-y-10\">\n          {/* Compose Section */}\n          <div className=\"space-y-6\">\n            <div className=\"flex items-center justify-between px-2\">\n              <h3 className=\"text-xl font-black text-foreground uppercase tracking-tight flex items-center gap-3\">\n                <PaperPlaneTilt weight=\"bold\" className=\"w-5 h-5 text-primary\" />\n                Transmission Uplink\n              </h3>\n              <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[10px] tracking-widest uppercase px-4 py-1.5\">New Payload</Badge>\n            </div>\n            <Card className=\"rounded-[40px] border-primary/20 shadow-premium overflow-hidden\">\n              <CardContent className=\"p-8\">\n                <ComposeMessage />\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* History Section */}\n          <div className=\"space-y-6\">\n            <div className=\"flex items-center justify-between px-2\">\n              <h3 className=\"text-xl font-black text-foreground uppercase tracking-tight flex items-center gap-3\">\n                <Clock weight=\"bold\" className=\"w-5 h-5 text-primary\" />\n                Transmission Registry\n              </h3>\n              <Badge variant=\"ghost\" className=\"bg-secondary text-muted-foreground border-none font-black text-[10px] tracking-widest uppercase px-4 py-1.5\">Historical Node</Badge>\n            </div>\n            <MessagesList />\n          </div>\n        </div>\n\n        {/* Sidebar Info/Status */}\n        <div className=\"space-y-8\">\n          <Card className=\"p-8 rounded-[40px] border-border shadow-card relative overflow-hidden group\">\n            <div className=\"absolute -top-12 -right-12 w-48 h-48 bg-primary/10 blur-[60px] rounded-full group-hover:bg-primary/20 transition-all duration-700\" />\n            <h4 className=\"text-[10px] font-black text-primary uppercase tracking-[0.3em] flex items-center gap-3 mb-6 relative z-10\">\n              <Info weight=\"duotone\" className=\"w-5 h-5\" />\n              Protocol Brief\n            </h4>\n            <div className=\"space-y-4 relative z-10\">\n              <p className=\"text-xs text-muted-foreground font-medium leading-relaxed italic border-l-2 border-primary/20 pl-4\">\n                Broadcast payloads are synchronized across all connected clinical nodes in the selected cluster.\n              </p>\n              <div className=\"pt-4 space-y-3\">\n                <div className=\"flex items-center gap-3 text-[10px] font-black text-foreground uppercase tracking-widest\">\n                  <div className=\"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse\" />\n                  Real-time Synchronization\n                </div>\n                <div className=\"flex items-center gap-3 text-[10px] font-black text-foreground uppercase tracking-widest\">\n                  <div className=\"w-1.5 h-1.5 rounded-full bg-blue-500\" />\n                  Multi-cluster Support\n                </div>\n                <div className=\"flex items-center gap-3 text-[10px] font-black text-foreground uppercase tracking-widest\">\n                  <div className=\"w-1.5 h-1.5 rounded-full bg-purple-500\" />\n                  End-to-End Encryption\n                </div>\n              </div>\n            </div>\n          </Card>\n\n          <Card className=\"p-8 rounded-[40px] border-rose-500/10 bg-rose-500/[0.02] space-y-4 group\">\n            <h4 className=\"text-[10px] font-black text-rose-400 uppercase tracking-[0.3em] flex items-center gap-3\">\n              <ShieldCheck weight=\"duotone\" className=\"w-5 h-5 group-hover:scale-110 transition-transform\" />\n              Safety Override\n            </h4>\n            <p className=\"text-xs text-muted-foreground italic font-medium leading-relaxed\">\n              Verify transmission payload content before final execution. Operations cannot be reversed once distributed to the cluster.\n            </p>\n          </Card>\n        </div>\n      </div>\n    </motion.div>\n  );\n}\n\nexport default function BroadcastPage() {\n  return (\n    <BroadcastProvider>\n      <BroadcastContent />\n    </BroadcastProvider>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\clinics\\[id]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Globe' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Globe"},"fix":{"range":[102,112],"text":""},"desc":"Remove unused variable \"Globe\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CalendarDots' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":15,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CalendarDots"},"fix":{"range":[112,129],"text":""},"desc":"Remove unused variable \"CalendarDots\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CreditCard' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CreditCard"},"fix":{"range":[129,144],"text":""},"desc":"Remove unused variable \"CreditCard\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Target' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":9,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Target"},"fix":{"range":[144,155],"text":""},"desc":"Remove unused variable \"Target\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CurrencyDollar' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":17,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CurrencyDollar"},"fix":{"range":[278,297],"text":""},"desc":"Remove unused variable \"CurrencyDollar\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendUp' is defined but never used.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TrendUp"},"fix":{"range":[297,309],"text":""},"desc":"Remove unused variable \"TrendUp\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationCard' is defined but never used.","line":28,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":21,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationCard"},"fix":{"range":[346,369],"text":""},"desc":"Remove unused variable \"IdentificationCard\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sparkle' is defined but never used.","line":31,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Sparkle"},"fix":{"range":[397,409],"text":""},"desc":"Remove unused variable \"Sparkle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Archive' is defined but never used.","line":32,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Archive"},"fix":{"range":[409,421],"text":""},"desc":"Remove unused variable \"Archive\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":43,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[906,939],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":44,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":51,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useMemo"},"fix":{"range":[982,991],"text":""},"desc":"Remove unused variable \"useMemo\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'i' is defined but never used.","line":337,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":337,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport {\r\n  ArrowLeft,\r\n  Buildings,\r\n  Users,\r\n  EnvelopeSimple,\r\n  Phone,\r\n  MapPin,\r\n  Globe,\r\n  CalendarDots,\r\n  CreditCard,\r\n  Target,\r\n  Gear,\r\n  Shield,\r\n  ShieldCheck,\r\n  PencilSimple,\r\n  FloppyDisk,\r\n  X,\r\n  SpinnerGap,\r\n  WarningCircle,\r\n  CheckCircle,\r\n  CurrencyDollar,\r\n  TrendUp,\r\n  Pulse,\r\n  Package,\r\n  CaretRight,\r\n  IdentificationCard,\r\n  Briefcase,\r\n  Lightning,\r\n  Sparkle,\r\n  Archive,\r\n  ArrowSquareOut,\r\n  IdentificationBadge\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { createClient } from '@/lib/supabase/client';\r\nimport { cn } from '@/lib/utils';\r\nimport { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { useParams } from 'next/navigation';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface ClinicDetail {\r\n  id: string;\r\n  clinic_code: string;\r\n  display_name: { th: string; en: string };\r\n  subscription_tier: string;\r\n  is_active: boolean;\r\n  created_at: string;\r\n  updated_at: string;\r\n  metadata: {\r\n    contact_email: string;\r\n    contact_phone?: string;\r\n    address?: string;\r\n    business_info?: {\r\n      type: string;\r\n      company_registration?: string;\r\n      tax_id?: string;\r\n      established_year?: string;\r\n      number_of_staff?: string;\r\n      number_of_branches?: string;\r\n      website?: string;\r\n      social_media?: string;\r\n    };\r\n    financial?: {\r\n      monthly_revenue?: string;\r\n      it_budget?: string;\r\n      payment_method?: string;\r\n      payment_term?: string;\r\n    };\r\n    marketing?: {\r\n      lead_source?: string;\r\n      referred_by?: string;\r\n      assigned_sales?: string;\r\n      competitors?: string;\r\n    };\r\n    technical?: {\r\n      current_system?: string;\r\n      integration_needs?: string;\r\n      timeline?: string;\r\n    };\r\n  };\r\n}\r\n\r\ninterface ClinicStats {\r\n  customerCount: number;\r\n  staffCount: number;\r\n  monthlyScans: number;\r\n  monthlyRevenue: number;\r\n}\r\n\r\nexport default function ClinicDetailPage() {\r\n  const params = useParams();\r\n  const { goBack } = useBackNavigation();\r\n  const clinicId = params.id as string;\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [success, setSuccess] = useState<string | null>(null);\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [clinic, setClinic] = useState<ClinicDetail | null>(null);\r\n  const [stats, setStats] = useState<ClinicStats>({\r\n    customerCount: 0,\r\n    staffCount: 0,\r\n    monthlyScans: 0,\r\n    monthlyRevenue: 0\r\n  });\r\n\r\n  const [editForm, setEditForm] = useState<ClinicDetail | null>(null);\r\n\r\n  const fetchClinic = useCallback(async () => {\r\n    try {\r\n      // Use admin API to fetch clinic details\r\n      const response = await fetch(`/api/admin/management?type=clinic&id=${clinicId}`);\r\n      const data = await response.json();\r\n      \r\n      if (!data.success) {\r\n        throw new Error(data.error || 'Failed to fetch clinic');\r\n      }\r\n      \r\n      const clinicData = data.data.clinic;\r\n      setClinic(clinicData);\r\n      setEditForm(clinicData);\r\n\r\n      // Fetch stats using regular client\r\n      const supabase = createClient();\r\n      const thirtyDaysAgo = new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString();\r\n      \r\n      // Customer count\r\n      const { count: customerCount } = await supabase\r\n        .from('customers')\r\n        .select('id', { count: 'exact', head: true })\r\n        .eq('clinic_id', clinicId);\r\n\r\n      // Staff count\r\n      const { count: staffCount } = await supabase\r\n        .from('clinic_staff')\r\n        .select('id', { count: 'exact', head: true })\r\n        .eq('clinic_id', clinicId)\r\n        .eq('is_active', true);\r\n\r\n      // Monthly scans\r\n      const { count: monthlyScans } = await supabase\r\n        .from('skin_analyses')\r\n        .select('id', { count: 'exact', head: true })\r\n        .eq('clinic_id', clinicId)\r\n        .gte('analyzed_at', thirtyDaysAgo);\r\n\r\n      setStats({\r\n        customerCount: customerCount || 0,\r\n        staffCount: staffCount || 0,\r\n        monthlyScans: monthlyScans || 0,\r\n        monthlyRevenue: 0 // TODO: Calculate from payments\r\n      });\r\n    } catch (err) {\r\n      console.error('Error fetching clinic:', err);\r\n      setError('Failed to load clinic details');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [clinicId]);\r\n\r\n  useEffect(() => {\r\n    fetchClinic();\r\n  }, [fetchClinic]);\r\n\r\n  const handleSave = async () => {\r\n    if (!editForm) return;\r\n\r\n    setSaving(true);\r\n    setError(null);\r\n    setSuccess(null);\r\n\r\n    try {\r\n      const supabase = createClient();\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      \r\n      if (!user) throw new Error('Not authenticated');\r\n\r\n      // Use admin API to update clinic\r\n      const response = await fetch('/api/admin/management', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          action: 'updateClinic',\r\n          clinicId,\r\n          clinicData: editForm\r\n        })\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const error = await response.json();\r\n        throw new Error(error.error || 'Failed to update clinic');\r\n      }\r\n\r\n      setClinic(editForm);\r\n      setIsEditing(false);\r\n      setSuccess('Clinic updated successfully');\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to update clinic');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setEditForm(clinic);\r\n    setIsEditing(false);\r\n    setError(null);\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-[400px] flex items-center justify-center\">\r\n        <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!clinic) {\r\n    return (\r\n      <div className=\"min-h-[400px] flex items-center justify-center\">\r\n        <p className=\"text-red-400\">Clinic not found</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const statsCards = [\r\n    {\r\n      label: 'Total Customers',\r\n      value: stats.customerCount.toLocaleString(),\r\n      icon: Users,\r\n      color: 'text-emerald-400',\r\n      bgColor: 'bg-emerald-500/10'\r\n    },\r\n    {\r\n      label: 'Active Staff',\r\n      value: stats.staffCount.toLocaleString(),\r\n      icon: Shield,\r\n      color: 'text-blue-400',\r\n      bgColor: 'bg-blue-500/10'\r\n    },\r\n    {\r\n      label: 'Monthly AI Scans',\r\n      value: stats.monthlyScans.toLocaleString(),\r\n      icon: Pulse,\r\n      color: 'text-amber-400',\r\n      bgColor: 'bg-amber-500/10'\r\n    },\r\n    {\r\n      label: 'Subscription',\r\n      value: clinic.subscription_tier.charAt(0).toUpperCase() + clinic.subscription_tier.slice(1),\r\n      icon: Package,\r\n      color: 'text-purple-400',\r\n      bgColor: 'bg-purple-500/10'\r\n    }\r\n  ];\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb \r\n        customLabels={{ \r\n          [clinicId]: clinic?.display_name.th || 'Clinic Node Detail'\r\n        }} \r\n      />\r\n\r\n      {/* Header & Navigation */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"flex items-center gap-6\">\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={() => goBack('/admin/clinics')}\r\n            className=\"p-4 h-14 w-14 border-border rounded-2xl text-muted-foreground hover:text-foreground transition-all\"\r\n          >\r\n            <ArrowLeft weight=\"bold\" className=\"w-5 h-5\" />\r\n          </Button>\r\n          <div className=\"space-y-1\">\r\n            <div className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\">\r\n              <Buildings weight=\"duotone\" className=\"w-4 h-4\" />\r\n              Clinical Infrastructure Node\r\n            </div>\r\n            <h1 className=\"text-4xl font-bold text-foreground tracking-tight uppercase\">\r\n              {clinic.display_name.th}\r\n              <span className=\"text-primary/40 font-light italic ml-3\">({clinic.clinic_code})</span>\r\n            </h1>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-3\">\r\n          {isEditing ? (\r\n            <div className=\"flex items-center gap-3\">\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={handleCancel}\r\n                className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50\"\r\n              >\r\n                <X weight=\"bold\" className=\"w-4 h-4\" />\r\n                Abort Changes\r\n              </Button>\r\n              <Button\r\n                onClick={handleSave}\r\n                disabled={saving}\r\n                className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\"\r\n              >\r\n                {saving ? (\r\n                  <SpinnerGap className=\"w-4 h-4 animate-spin\" />\r\n                ) : (\r\n                  <FloppyDisk weight=\"bold\" className=\"w-4 h-4\" />\r\n                )}\r\n                Commit Updates\r\n              </Button>\r\n            </div>\r\n          ) : (\r\n            <Button\r\n              onClick={() => setIsEditing(true)}\r\n              className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\"\r\n            >\r\n              <PencilSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n              Modify Identity\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Cards Section */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\r\n        {statsCards.map((stat, i) => (\r\n          <StatCard\r\n            key={stat.label}\r\n            title={stat.label}\r\n            value={stat.value === 'Premium' || stat.value === 'Regular' ? 1 : parseInt(stat.value.replace(/,/g, '')) || 0}\r\n            suffix={stat.value === 'Premium' || stat.value === 'Regular' ? ` ${stat.value}` : ''}\r\n            icon={stat.icon}\r\n            iconColor={stat.color}\r\n            className=\"p-4\"\r\n          />\r\n        ))}\r\n      </div>\r\n\r\n      {/* Dynamic Alerts */}\r\n      <AnimatePresence>\r\n        {error && (\r\n          <motion.div \r\n            initial={{ opacity: 0, y: -10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"mx-2 p-4 bg-destructive/10 border border-destructive/20 rounded-2xl flex items-center gap-3\"\r\n          >\r\n            <WarningCircle weight=\"fill\" className=\"w-5 h-5 text-destructive\" />\r\n            <p className=\"text-destructive text-xs font-bold uppercase tracking-widest\">Exception: {error}</p>\r\n          </motion.div>\r\n        )}\r\n        {success && (\r\n          <motion.div \r\n            initial={{ opacity: 0, y: -10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"mx-2 p-4 bg-emerald-500/10 border border-emerald-500/20 rounded-2xl flex items-center gap-3\"\r\n          >\r\n            <CheckCircle weight=\"fill\" className=\"w-5 h-5 text-emerald-500\" />\r\n            <p className=\"text-emerald-500 text-xs font-bold uppercase tracking-widest\">Sync Complete: {success}</p>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-10 px-2\">\r\n        {/* Main Intel Column */}\r\n        <div className=\"lg:col-span-2 space-y-10\">\r\n          {/* Identity Matrix */}\r\n          <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n            <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n                  <IdentificationBadge weight=\"duotone\" className=\"w-6 h-6\" />\r\n                </div>\r\n                <div>\r\n                  <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Identity Matrix</CardTitle>\r\n                  <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Core node authentication & data</p>\r\n                </div>\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent className=\"p-10\">\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10\">\r\n                <div className=\"space-y-6\">\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Identity Node (TH)</label>\r\n                    {isEditing ? (\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editForm?.display_name.th}\r\n                        onChange={(e) => setEditForm(f => f ? ({ ...f, display_name: { ...f.display_name, th: e.target.value } }) : null)}\r\n                        className=\"w-full px-6 py-4 bg-secondary border border-border rounded-2xl text-foreground focus:border-primary outline-none transition-all font-bold\"\r\n                      />\r\n                    ) : (\r\n                      <div className=\"p-4 bg-secondary/30 border border-border/50 rounded-2xl flex items-center gap-3\">\r\n                        <span className=\"text-sm font-bold text-foreground\">{clinic.display_name.th}</span>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Identity Node (EN)</label>\r\n                    {isEditing ? (\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editForm?.display_name.en}\r\n                        onChange={(e) => setEditForm(f => f ? ({ ...f, display_name: { ...f.display_name, en: e.target.value } }) : null)}\r\n                        className=\"w-full px-6 py-4 bg-secondary border border-border rounded-2xl text-foreground focus:border-primary outline-none transition-all font-bold\"\r\n                      />\r\n                    ) : (\r\n                      <div className=\"p-4 bg-secondary/30 border border-border/50 rounded-2xl flex items-center gap-3\">\r\n                        <span className=\"text-sm font-bold text-foreground\">{clinic.display_name.en}</span>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-6\">\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Transmission Uplink</label>\r\n                    <div className=\"p-4 bg-secondary/30 border border-border/50 rounded-2xl flex items-center gap-4\">\r\n                      <div className=\"w-10 h-10 rounded-xl bg-blue-500/10 flex items-center justify-center text-blue-500 shadow-inner\">\r\n                        <EnvelopeSimple weight=\"bold\" className=\"w-5 h-5\" />\r\n                      </div>\r\n                      <span className=\"text-sm font-bold text-foreground truncate\">{clinic.metadata.contact_email}</span>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Comm Channel</label>\r\n                    <div className=\"p-4 bg-secondary/30 border border-border/50 rounded-2xl flex items-center gap-4\">\r\n                      <div className=\"w-10 h-10 rounded-xl bg-emerald-500/10 flex items-center justify-center text-emerald-500 shadow-inner\">\r\n                        <Phone weight=\"bold\" className=\"w-5 h-5\" />\r\n                      </div>\r\n                      <span className=\"text-sm font-bold text-foreground\">{clinic.metadata.contact_phone || 'NODE_OFFLINE'}</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"md:col-span-2 space-y-2\">\r\n                  <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Deployment Coordinate</label>\r\n                  <div className=\"p-5 bg-secondary/30 border border-border/50 rounded-2xl flex items-start gap-4\">\r\n                    <div className=\"w-10 h-10 rounded-xl bg-rose-500/10 flex items-center justify-center text-rose-500 shadow-inner shrink-0\">\r\n                      <MapPin weight=\"bold\" className=\"w-5 h-5\" />\r\n                    </div>\r\n                    <p className=\"text-sm text-muted-foreground font-medium italic leading-relaxed\">\r\n                      {clinic.metadata.address || 'Deployment address coordinates not initialized in current node.'}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* Business & Technical Analytics */}\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10\">\r\n            {/* Business Intel */}\r\n            <Card className=\"rounded-[40px] border-border/50 group overflow-hidden\">\r\n              <CardHeader className=\"p-8 border-b border-border/50\">\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div className=\"w-12 h-12 rounded-2xl bg-purple-500/10 flex items-center justify-center text-purple-500 border border-purple-500/20 shadow-inner\">\r\n                    <Gear weight=\"duotone\" className=\"w-6 h-6\" />\r\n                  </div>\r\n                  <CardTitle className=\"text-lg font-black uppercase tracking-tight\">Business Node</CardTitle>\r\n                </div>\r\n              </CardHeader>\r\n              <CardContent className=\"p-8 space-y-6\">\r\n                {clinic.metadata.business_info ? (\r\n                  <>\r\n                    <div className=\"flex justify-between items-center px-1\">\r\n                      <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Company Type</span>\r\n                      <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[9px] uppercase px-3\">{clinic.metadata.business_info.type}</Badge>\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center px-1\">\r\n                      <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Registry Year</span>\r\n                      <span className=\"text-sm font-bold text-foreground\">{clinic.metadata.business_info.established_year || 'N/A'}</span>\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center px-1\">\r\n                      <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Network Branches</span>\r\n                      <span className=\"text-sm font-bold text-foreground\">{clinic.metadata.business_info.number_of_branches || '1'} Nodes</span>\r\n                    </div>\r\n                    {clinic.metadata.business_info.website && (\r\n                      <div className=\"pt-4 border-t border-border/30\">\r\n                        <Button variant=\"outline\" className=\"w-full justify-between rounded-xl px-4 py-3 border-border/50 hover:bg-secondary\">\r\n                          <span className=\"text-[10px] font-black uppercase tracking-widest\">Public Domain Node</span>\r\n                          <ArrowSquareOut weight=\"bold\" className=\"w-4 h-4\" />\r\n                        </Button>\r\n                      </div>\r\n                    )}\r\n                  </>\r\n                ) : (\r\n                  <div className=\"py-10 text-center opacity-30 italic text-xs\">No business metadata synchronized.</div>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Technical Parameters */}\r\n            <Card className=\"rounded-[40px] border-border/50 group overflow-hidden\">\r\n              <CardHeader className=\"p-8 border-b border-border/50\">\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div className=\"w-12 h-12 rounded-2xl bg-blue-500/10 flex items-center justify-center text-blue-500 border border-blue-500/20 shadow-inner\">\r\n                    <Lightning weight=\"duotone\" className=\"w-6 h-6\" />\r\n                  </div>\r\n                  <CardTitle className=\"text-lg font-black uppercase tracking-tight\">System Parameters</CardTitle>\r\n                </div>\r\n              </CardHeader>\r\n              <CardContent className=\"p-8 space-y-6\">\r\n                {clinic.metadata.technical ? (\r\n                  <>\r\n                    <div className=\"space-y-2\">\r\n                      <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Architecture</label>\r\n                      <div className=\"p-3 bg-secondary/30 border border-border/50 rounded-xl text-xs font-bold text-foreground\">{clinic.metadata.technical.current_system || 'Vanilla Architecture'}</div>\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Deployment Pipeline</label>\r\n                      <div className=\"p-3 bg-secondary/30 border border-border/50 rounded-xl text-xs font-bold text-foreground capitalize\">{clinic.metadata.technical.timeline || 'Immediate Sync'}</div>\r\n                    </div>\r\n                  </>\r\n                ) : (\r\n                  <div className=\"py-10 text-center opacity-30 italic text-xs\">No technical telemetry synchronized.</div>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Sidebar Intel */}\r\n        <div className=\"space-y-8\">\r\n          {/* Status & Security Cluster */}\r\n          <Card className=\"p-8 rounded-[40px] border-border shadow-card relative overflow-hidden group\">\r\n            <div className=\"absolute -top-12 -right-12 w-48 h-48 bg-primary/10 blur-[60px] rounded-full group-hover:bg-primary/20 transition-all duration-700\" />\r\n            <h4 className=\"text-[10px] font-black text-primary uppercase tracking-[0.3em] flex items-center gap-3 mb-8 relative z-10\">\r\n              <Shield weight=\"duotone\" className=\"w-5 h-5\" />\r\n              Security Protocol\r\n            </h4>\r\n            \r\n            <div className=\"space-y-6 relative z-10\">\r\n              <div className=\"flex justify-between items-center\">\r\n                <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Node Status</span>\r\n                <Badge variant={clinic.is_active ? 'success' : 'destructive'} className=\"font-black text-[9px] uppercase px-3 py-1 tracking-widest\">\r\n                  {clinic.is_active ? 'OPERATIONAL' : 'OFFLINE'}\r\n                </Badge>\r\n              </div>\r\n              <div className=\"flex justify-between items-center\">\r\n                <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Node Initialized</span>\r\n                <span className=\"text-xs font-bold text-foreground tabular-nums\">{new Date(clinic.created_at).toLocaleDateString()}</span>\r\n              </div>\r\n              <div className=\"flex justify-between items-center\">\r\n                <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Last Sync</span>\r\n                <span className=\"text-xs font-bold text-foreground tabular-nums\">{new Date(clinic.updated_at).toLocaleDateString()}</span>\r\n              </div>\r\n              \r\n              <div className=\"pt-6 border-t border-border/30\">\r\n                <div className=\"p-4 bg-primary/5 border border-primary/20 rounded-2xl flex items-start gap-4\">\r\n                  <div className=\"mt-1\">\r\n                    <ShieldCheck weight=\"fill\" className=\"w-4 h-4 text-primary\" />\r\n                  </div>\r\n                  <p className=\"text-[10px] text-muted-foreground font-medium italic leading-relaxed\">\r\n                    Identity access managed via Row Level Security (RLS) cluster alpha.\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </Card>\r\n\r\n          {/* Quick Control Center */}\r\n          <Card className=\"p-8 rounded-[40px] border-border shadow-card overflow-hidden group\">\r\n            <h4 className=\"text-[10px] font-black text-foreground uppercase tracking-[0.3em] flex items-center gap-3 mb-6\">\r\n              <Briefcase weight=\"duotone\" className=\"w-5 h-5 text-primary\" />\r\n              Control Center\r\n            </h4>\r\n            <div className=\"space-y-3\">\r\n              <Button variant=\"outline\" className=\"w-full justify-between rounded-2xl px-5 py-4 border-border/50 hover:bg-secondary group/btn\">\r\n                <span className=\"text-[10px] font-black uppercase tracking-widest\">Personnel Matrix</span>\r\n                <CaretRight weight=\"bold\" className=\"w-3 h-3 group-hover/btn:translate-x-1 transition-transform\" />\r\n              </Button>\r\n              <Button variant=\"outline\" className=\"w-full justify-between rounded-2xl px-5 py-4 border-border/50 hover:bg-secondary group/btn\">\r\n                <span className=\"text-[10px] font-black uppercase tracking-widest\">Identity Registry</span>\r\n                <CaretRight weight=\"bold\" className=\"w-3 h-3 group-hover/btn:translate-x-1 transition-transform\" />\r\n              </Button>\r\n              <Button variant=\"outline\" className=\"w-full justify-between rounded-2xl px-5 py-4 border-border/50 hover:bg-secondary group/btn\">\r\n                <span className=\"text-[10px] font-black uppercase tracking-widest\">Scaling Parameters</span>\r\n                <CaretRight weight=\"bold\" className=\"w-3 h-3 group-hover/btn:translate-x-1 transition-transform\" />\r\n              </Button>\r\n              <Button variant=\"outline\" className=\"w-full justify-between rounded-2xl px-5 py-4 border-border/50 hover:bg-secondary group/btn\">\r\n                <span className=\"text-[10px] font-black uppercase tracking-widest\">Ledger Export</span>\r\n                <CaretRight weight=\"bold\" className=\"w-3 h-3 group-hover/btn:translate-x-1 transition-transform\" />\r\n              </Button>\r\n            </div>\r\n          </Card>\r\n        </div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\clinics\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Shield' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":9,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Shield"},"fix":{"range":[67,78],"text":""},"desc":"Remove unused variable \"Shield\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'EnvelopeSimple' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":17,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"EnvelopeSimple"},"fix":{"range":[78,97],"text":""},"desc":"Remove unused variable \"EnvelopeSimple\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Phone' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Phone"},"fix":{"range":[97,107],"text":""},"desc":"Remove unused variable \"Phone\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MapPin' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":9,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"MapPin"},"fix":{"range":[107,118],"text":""},"desc":"Remove unused variable \"MapPin\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CalendarDots' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":15,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CalendarDots"},"fix":{"range":[118,135],"text":""},"desc":"Remove unused variable \"CalendarDots\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Gear' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Gear"},"fix":{"range":[213,222],"text":""},"desc":"Remove unused variable \"Gear\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[269,283],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendUp' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TrendUp"},"fix":{"range":[283,295],"text":""},"desc":"Remove unused variable \"TrendUp\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationCard' is defined but never used.","line":26,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":21,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationCard"},"fix":{"range":[312,335],"text":""},"desc":"Remove unused variable \"IdentificationCard\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":30,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[451,463],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":30,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[463,474],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardContent' is defined but never used.","line":30,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":50,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardContent"},"fix":{"range":[474,487],"text":""},"desc":"Remove unused variable \"CardContent\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":75,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":75,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'tCommon' is assigned a value but never used.","line":77,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":77,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'showCreateModal' is assigned a value but never used.","line":85,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":85,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport {\r\n  Buildings,\r\n  MagnifyingGlass,\r\n  Plus,\r\n  Shield,\r\n  EnvelopeSimple,\r\n  Phone,\r\n  MapPin,\r\n  CalendarDots,\r\n  Users,\r\n  CheckCircle,\r\n  XCircle,\r\n  SpinnerGap,\r\n  PencilSimple,\r\n  Eye,\r\n  Gear,\r\n  Pulse,\r\n  CurrencyDollar,\r\n  WarningCircle,\r\n  ArrowLeft,\r\n  TrendUp,\r\n  X,\r\n  Funnel,\r\n  IdentificationCard,\r\n  Briefcase\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport ResponsiveTable from '@/components/ui/ResponsiveTable';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { useTranslations } from 'next-intl';\r\nimport { cn } from '@/lib/utils';\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface Clinic {\r\n  id: string;\r\n  clinic_code: string;\r\n  display_name: { th: string; en: string };\r\n  subscription_tier: 'starter' | 'professional' | 'enterprise';\r\n  max_sales_staff: number;\r\n  is_active: boolean;\r\n  owner_user_id?: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n  metadata: {\r\n    contact?: {\r\n      email?: string;\r\n      phone?: string;\r\n      address?: string;\r\n    };\r\n    branding?: {\r\n      logo?: string;\r\n      colors?: {\r\n        primary?: string;\r\n        secondary?: string;\r\n      };\r\n    };\r\n  };\r\n  staff_count?: number;\r\n  customer_count?: number;\r\n  usage_stats?: {\r\n    ai_analyses?: number;\r\n    appointments?: number;\r\n    revenue?: number;\r\n  };\r\n}\r\n\r\nexport default function ClinicManagementPage() {\r\n  const { goBack } = useBackNavigation();\r\n  const t = useTranslations('admin.clinics');\r\n  const tCommon = useTranslations('common');\r\n  const [loading, setLoading] = useState(true);\r\n  const [clinics, setClinics] = useState<Clinic[]>([]);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [filterTier, setFilterTier] = useState('all');\r\n  const [filterStatus, setFilterStatus] = useState('all');\r\n  const [selectedClinic, setSelectedClinic] = useState<Clinic | null>(null);\r\n  const [showDetailModal, setShowDetailModal] = useState(false);\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [success, setSuccess] = useState<string | null>(null);\r\n\r\n  const fetchClinics = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      const response = await fetch('/api/admin/management?type=clinics');\r\n      if (!response.ok) throw new Error('Failed to fetch clinics');\r\n      \r\n      const data = await response.json();\r\n      if (data.success) {\r\n        setClinics(data.data.clinics || []);\r\n      } else {\r\n        throw new Error(data.error || 'Failed to load clinics');\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching clinics:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to load clinics');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const handleUpdateStatus = async (clinicId: string, currentStatus: boolean) => {\r\n    try {\r\n      setError(null);\r\n      \r\n      const response = await fetch('/api/admin/management', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          action: 'updateClinicStatus',\r\n          clinicId,\r\n          status: !currentStatus\r\n        })\r\n      });\r\n\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        setClinics(prev => prev.map(c => \r\n          c.id === clinicId ? { ...c, is_active: !currentStatus } : c\r\n        ));\r\n        setSuccess(t('status_updated'));\r\n      } else {\r\n        throw new Error(data.error || 'Failed to update status');\r\n      }\r\n    } catch (err) {\r\n      console.error('Error updating clinic status:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to update status');\r\n    }\r\n  };\r\n\r\n  const handleViewClinic = (clinic: Clinic) => {\r\n    setSelectedClinic(clinic);\r\n    setShowDetailModal(true);\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchClinics();\r\n  }, [fetchClinics]);\r\n\r\n  const filteredClinics = clinics.filter(clinic => {\r\n    const matchesSearch = \r\n      clinic.display_name.th?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      clinic.display_name.en?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      clinic.clinic_code.toLowerCase().includes(searchTerm.toLowerCase());\r\n    \r\n    const matchesTier = filterTier === 'all' || clinic.subscription_tier === filterTier;\r\n    const matchesStatus = filterStatus === 'all' || \r\n      (filterStatus === 'active' && clinic.is_active) ||\r\n      (filterStatus === 'inactive' && !clinic.is_active);\r\n    \r\n    return matchesSearch && matchesTier && matchesStatus;\r\n  });\r\n\r\n  const getTierBadge = (tier: string) => {\r\n    const configs = {\r\n      starter: 'bg-gray-500/20 text-gray-400',\r\n      professional: 'bg-blue-500/20 text-blue-400',\r\n      enterprise: 'bg-purple-500/20 text-purple-400'\r\n    };\r\n    return (\r\n      <span className={`px-2 py-1 rounded-full text-xs font-bold ${configs[tier as keyof typeof configs]}`}>\r\n        {tier.charAt(0).toUpperCase() + tier.slice(1)}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  const getClinicName = (clinic: Clinic) => {\r\n    return clinic.display_name.th || clinic.display_name.en || 'Unknown Clinic';\r\n  };\r\n\r\n  const columns = [\r\n    {\r\n      header: t('clinic'),\r\n      accessor: (clinic: Clinic) => (\r\n        <div className=\"flex items-center gap-3\">\r\n          <div className=\"w-10 h-10 rounded-xl bg-primary/10 border border-primary/20 flex items-center justify-center text-primary shrink-0\">\r\n            <Buildings className=\"w-5 h-5\" />\r\n          </div>\r\n          <div className=\"min-w-0\">\r\n            <p className=\"font-bold text-foreground truncate\">{getClinicName(clinic)}</p>\r\n            <p className=\"text-[10px] text-muted-foreground truncate\">{clinic.clinic_code}</p>\r\n          </div>\r\n        </div>\r\n      )\r\n    },\r\n    {\r\n      header: t('tier'),\r\n      accessor: (clinic: Clinic) => getTierBadge(clinic.subscription_tier)\r\n    },\r\n    {\r\n      header: t('staff'),\r\n      accessor: (clinic: Clinic) => (\r\n        <span className=\"text-sm text-muted-foreground font-medium\">\r\n          {clinic.staff_count || 0} / {clinic.max_sales_staff}\r\n        </span>\r\n      )\r\n    },\r\n    {\r\n      header: t('customers'),\r\n      accessor: (clinic: Clinic) => (\r\n        <span className=\"text-sm text-muted-foreground font-medium\">\r\n          {clinic.customer_count || 0}\r\n        </span>\r\n      )\r\n    },\r\n    {\r\n      header: t('status'),\r\n      accessor: (clinic: Clinic) => (\r\n        <span className={cn(\r\n          \"px-2 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider\",\r\n          clinic.is_active ? 'bg-emerald-500/10 text-emerald-500' : 'bg-rose-500/10 text-rose-500'\r\n        )}>\r\n          {t(clinic.is_active ? 'active' : 'inactive')}\r\n        </span>\r\n      )\r\n    },\r\n    {\r\n      header: t('created'),\r\n      accessor: (clinic: Clinic) => (\r\n        <span className=\"text-sm text-muted-foreground\">\r\n          {new Date(clinic.created_at).toLocaleDateString()}\r\n        </span>\r\n      )\r\n    },\r\n    {\r\n      header: t('actions'),\r\n      className: 'text-right',\r\n      accessor: (clinic: Clinic) => (\r\n        <div className=\"flex items-center justify-end gap-2\">\r\n          <button \r\n            onClick={(e) => { e.stopPropagation(); handleViewClinic(clinic); }}\r\n            className=\"p-2 text-muted-foreground hover:text-foreground hover:bg-secondary rounded-lg transition-all border border-transparent hover:border-border\"\r\n            title={t('view_details')}\r\n          >\r\n            <Eye className=\"w-4 h-4\" />\r\n          </button>\r\n          <button \r\n            onClick={(e) => e.stopPropagation()}\r\n            className=\"p-2 text-muted-foreground hover:text-foreground hover:bg-secondary rounded-lg transition-all border border-transparent hover:border-border\"\r\n            title={t('edit_clinic')}\r\n          >\r\n            <PencilSimple className=\"w-4 h-4\" />\r\n          </button>\r\n          <button \r\n            onClick={(e) => { e.stopPropagation(); handleUpdateStatus(clinic.id, clinic.is_active); }}\r\n            className={cn(\r\n              \"p-2 rounded-lg transition-all border border-transparent hover:border-border bg-secondary\",\r\n              clinic.is_active ? 'text-rose-500 hover:bg-rose-500/10' : 'text-emerald-500 hover:bg-emerald-500/10'\r\n            )}\r\n            title={clinic.is_active ? t('deactivate_clinic') : t('activate_clinic')}\r\n          >\r\n            {clinic.is_active ? <XCircle className=\"w-4 h-4\" /> : <CheckCircle className=\"w-4 h-4\" />}\r\n          </button>\r\n        </div>\r\n      )\r\n    }\r\n  ];\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-[400px] flex items-center justify-center\">\r\n        <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }} \r\n      animate={{ opacity: 1 }} \r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n      \r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Buildings weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Cluster Management\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Clinic <span className=\"text-primary\">Clusters</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating clinical infrastructure nodes and regional data clusters.\r\n          </motion.p>\r\n        </div>\r\n        \r\n        <motion.div\r\n          initial={{ opacity: 0, scale: 0.9 }}\r\n          animate={{ opacity: 1, scale: 1 }}\r\n          transition={{ delay: 0.3 }}\r\n        >\r\n          <Button \r\n            onClick={() => setShowCreateModal(true)}\r\n            className=\"gap-3 shadow-premium px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest\"\r\n          >\r\n            <Plus weight=\"bold\" className=\"w-4 h-4\" />\r\n            <span>Initialize New Node</span>\r\n          </Button>\r\n        </motion.div>\r\n      </div>\r\n\r\n      {/* Stats Summary Section */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\r\n        <StatCard\r\n          title=\"Active Nodes\"\r\n          value={clinics.filter(c => c.is_active).length}\r\n          icon={Buildings}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Total Personnel\"\r\n          value={clinics.reduce((sum, c) => sum + (c.staff_count || 0), 0)}\r\n          icon={Users}\r\n          trend=\"up\"\r\n          change={12}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Network Population\"\r\n          value={clinics.reduce((sum, c) => sum + (c.customer_count || 0), 0)}\r\n          icon={Users}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Yield Forecast\"\r\n          value={clinics.reduce((sum, c) => sum + (c.usage_stats?.revenue || 0), 0)}\r\n          prefix=\"เธฟ\"\r\n          trend=\"up\"\r\n          change={8.4}\r\n          icon={CurrencyDollar}\r\n          className=\"p-4\"\r\n        />\r\n      </div>\r\n\r\n      {/* Alerts */}\r\n      <AnimatePresence>\r\n        {error && (\r\n          <motion.div \r\n            initial={{ opacity: 0, y: -10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"mx-2 p-4 bg-destructive/10 border border-destructive/20 rounded-2xl flex items-center gap-3\"\r\n          >\r\n            <WarningCircle weight=\"fill\" className=\"w-5 h-5 text-destructive\" />\r\n            <p className=\"text-destructive text-xs font-bold uppercase tracking-widest\">Exception: {error}</p>\r\n            <Button variant=\"ghost\" size=\"sm\" onClick={() => setError(null)} className=\"ml-auto p-2 h-auto text-destructive hover:bg-destructive/10\">\r\n              <X weight=\"bold\" className=\"w-4 h-4\" />\r\n            </Button>\r\n          </motion.div>\r\n        )}\r\n        {success && (\r\n          <motion.div \r\n            initial={{ opacity: 0, y: -10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"mx-2 p-4 bg-emerald-500/10 border border-emerald-500/20 rounded-2xl flex items-center gap-3\"\r\n          >\r\n            <CheckCircle weight=\"fill\" className=\"w-5 h-5 text-emerald-500\" />\r\n            <p className=\"text-emerald-500 text-xs font-bold uppercase tracking-widest\">Sync Complete: {success}</p>\r\n            <Button variant=\"ghost\" size=\"sm\" onClick={() => setSuccess(null)} className=\"ml-auto p-2 h-auto text-emerald-500 hover:bg-emerald-500/10\">\r\n              <X weight=\"bold\" className=\"w-4 h-4\" />\r\n            </Button>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Search & Filters */}\r\n      <div className=\"px-2\">\r\n        <Card className=\"p-6 rounded-[32px] border-border/50 shadow-card\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n            <div className=\"relative group\">\r\n              <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-xl\" />\r\n              <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Query cluster identity, node code, or registry...\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3.5 pl-12 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\r\n              />\r\n            </div>\r\n            \r\n            <div className=\"relative\">\r\n              <select\r\n                value={filterTier}\r\n                onChange={(e) => setFilterTier(e.target.value)}\r\n                className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3.5 px-6 text-sm text-foreground focus:border-primary outline-none transition-all appearance-none font-bold\"\r\n              >\r\n                <option value=\"all\">Protocol: ALL TIERS</option>\r\n                <option value=\"starter\">STARTER</option>\r\n                <option value=\"professional\">PROFESSIONAL</option>\r\n                <option value=\"enterprise\">ENTERPRISE</option>\r\n              </select>\r\n              <Funnel weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 pointer-events-none\" />\r\n            </div>\r\n\r\n            <div className=\"relative\">\r\n              <select\r\n                value={filterStatus}\r\n                onChange={(e) => setFilterStatus(e.target.value)}\r\n                className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3.5 px-6 text-sm text-foreground focus:border-primary outline-none transition-all appearance-none font-bold\"\r\n              >\r\n                <option value=\"all\">Status: ALL NODES</option>\r\n                <option value=\"active\">OPERATIONAL</option>\r\n                <option value=\"inactive\">OFFLINE</option>\r\n              </select>\r\n              <Pulse weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 pointer-events-none\" />\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center justify-between mt-6 px-1\">\r\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\r\n              Matrix Synchronization: {filteredClinics.length} of {clinics.length} Clusters Detected\r\n            </p>\r\n            <div className=\"flex items-center gap-2\">\r\n              <div className=\"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse\" />\r\n              <span className=\"text-[10px] font-black text-emerald-500 uppercase tracking-widest\">Global Sync Active</span>\r\n            </div>\r\n          </div>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Clinics Table */}\r\n      <div className=\"px-2\">\r\n        <Card className=\"rounded-[40px] border-border/50 overflow-hidden shadow-premium\">\r\n          <ResponsiveTable\r\n            columns={columns}\r\n            data={filteredClinics}\r\n            loading={loading}\r\n            rowKey={(c) => c.id}\r\n            emptyMessage=\"No clinical infrastructure nodes detected in current matrix.\"\r\n            onRowClick={(c) => window.location.href = `/admin/clinics/${c.id}`}\r\n            mobileCard={(clinic) => (\r\n              <div className=\"space-y-5\">\r\n                <div className=\"flex justify-between items-start\">\r\n                  <div className=\"flex items-center gap-4\">\r\n                    <div className=\"w-14 h-14 rounded-2xl bg-secondary border border-border flex items-center justify-center text-primary shadow-inner\">\r\n                      <Buildings weight=\"duotone\" className=\"w-7 h-7\" />\r\n                    </div>\r\n                    <div className=\"min-w-0\">\r\n                      <p className=\"font-bold text-foreground truncate uppercase tracking-tight\">{getClinicName(clinic)}</p>\r\n                      <p className=\"text-[10px] font-black text-muted-foreground truncate uppercase tracking-widest\">{clinic.clinic_code}</p>\r\n                    </div>\r\n                  </div>\r\n                  <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[9px] uppercase px-3 py-1\">\r\n                    {clinic.subscription_tier}\r\n                  </Badge>\r\n                </div>\r\n                \r\n                <div className=\"grid grid-cols-2 gap-6 py-4 border-y border-border/50\">\r\n                  <div>\r\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Personnel</p>\r\n                    <p className=\"text-xs font-bold text-foreground tabular-nums\">{clinic.staff_count || 0} / {clinic.max_sales_staff}</p>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Node Status</p>\r\n                    <Badge variant={clinic.is_active ? 'success' : 'destructive'} size=\"sm\" className=\"font-black text-[8px] uppercase tracking-widest px-2\">\r\n                      {clinic.is_active ? 'OPERATIONAL' : 'OFFLINE'}\r\n                    </Badge>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-center\">\r\n                  <div className=\"flex flex-col\">\r\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em]\">Node Population</p>\r\n                    <p className=\"text-xs font-bold text-foreground tabular-nums\">{clinic.customer_count || 0} Entities</p>\r\n                  </div>\r\n                  <div className=\"flex gap-2\">\r\n                    <Button variant=\"outline\" size=\"sm\" onClick={() => window.location.href = `/admin/clinics/${clinic.id}`} className=\"h-10 w-10 p-0 border-border/50 rounded-xl hover:bg-secondary\">\r\n                      <Eye weight=\"bold\" className=\"w-4 h-4\" />\r\n                    </Button>\r\n                    <Button \r\n                      onClick={(e) => { e.stopPropagation(); handleUpdateStatus(clinic.id, clinic.is_active); }}\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      className={cn(\r\n                        \"h-10 w-10 p-0 border-border/50 rounded-xl transition-all\",\r\n                        clinic.is_active ? 'text-rose-500 hover:bg-rose-500/10' : 'text-emerald-500 hover:bg-emerald-500/10'\r\n                      )}\r\n                    >\r\n                      {clinic.is_active ? <XCircle weight=\"bold\" className=\"w-4 h-4\" /> : <CheckCircle weight=\"bold\" className=\"w-4 h-4\" />}\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          />\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Clinic Detail Modal Overhaul - Consider making this a separate component or refining */}\r\n      <AnimatePresence>\r\n        {showDetailModal && selectedClinic && (\r\n          <div className=\"fixed inset-0 z-[300] flex items-center justify-center p-4 overflow-y-auto\">\r\n            <motion.div\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              exit={{ opacity: 0 }}\r\n              className=\"absolute inset-0 bg-black/60 backdrop-blur-sm\"\r\n              onClick={() => setShowDetailModal(false)}\r\n            />\r\n            \r\n            <motion.div\r\n              initial={{ scale: 0.95, opacity: 0, y: 20 }}\r\n              animate={{ scale: 1, opacity: 1, y: 0 }}\r\n              exit={{ scale: 0.95, opacity: 0, y: 20 }}\r\n              className=\"relative w-full max-w-2xl bg-card border border-border rounded-[40px] overflow-hidden shadow-premium group p-10\"\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                <Briefcase className=\"w-64 h-64 text-primary\" />\r\n              </div>\r\n\r\n              <div className=\"relative z-10 space-y-10\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"flex items-center gap-5\">\r\n                    <div className=\"w-16 h-16 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\r\n                      <Buildings weight=\"duotone\" className=\"w-8 h-8\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-2xl font-bold text-foreground tracking-tight uppercase\">{getClinicName(selectedClinic)}</h3>\r\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Identity Node: {selectedClinic.clinic_code}</p>\r\n                    </div>\r\n                  </div>\r\n                  <Button variant=\"ghost\" size=\"sm\" onClick={() => setShowDetailModal(false)} className=\"h-10 w-10 p-0 rounded-xl hover:bg-secondary\">\r\n                    <X weight=\"bold\" className=\"w-5 h-5\" />\r\n                  </Button>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-8\">\r\n                  <div className=\"space-y-6\">\r\n                    <div className=\"p-5 bg-secondary/30 rounded-3xl border border-border/50\">\r\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mb-2\">Protocol Architecture</p>\r\n                      <Badge variant=\"ghost\" className=\"bg-primary/10 text-primary border-none font-black text-[10px] uppercase tracking-widest px-3 py-1.5\">\r\n                        {selectedClinic.subscription_tier}\r\n                      </Badge>\r\n                    </div>\r\n                    <div className=\"p-5 bg-secondary/30 rounded-3xl border border-border/50\">\r\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mb-2\">Personnel Quota</p>\r\n                      <p className=\"text-xl font-bold text-foreground tabular-nums\">\r\n                        {selectedClinic.staff_count || 0} / {selectedClinic.max_sales_staff}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-6\">\r\n                    <div className=\"p-5 bg-secondary/30 rounded-3xl border border-border/50\">\r\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mb-2\">Operating Status</p>\r\n                      <Badge variant={selectedClinic.is_active ? 'success' : 'destructive'} className=\"font-black text-[9px] uppercase px-3 py-1 tracking-widest\">\r\n                        {selectedClinic.is_active ? 'OPERATIONAL' : 'OFFLINE'}\r\n                      </Badge>\r\n                    </div>\r\n                    <div className=\"p-5 bg-secondary/30 rounded-3xl border border-border/50\">\r\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mb-2\">Network Reach</p>\r\n                      <p className=\"text-xl font-bold text-foreground tabular-nums\">\r\n                        {selectedClinic.customer_count || 0} <span className=\"text-xs font-medium text-muted-foreground\">Entities</span>\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-6 pt-4 border-t border-border/30\">\r\n                  <h4 className=\"text-[10px] font-black text-foreground uppercase tracking-[0.3em] flex items-center gap-3\">\r\n                    <Pulse weight=\"bold\" className=\"w-4 h-4 text-primary\" />\r\n                    Telemetry Analytics\r\n                  </h4>\r\n                  <div className=\"grid grid-cols-3 gap-6\">\r\n                    {[\r\n                      { label: 'AI Scans', value: selectedClinic.usage_stats?.ai_analyses || 0 },\r\n                      { label: 'Cycles', value: selectedClinic.usage_stats?.appointments || 0 },\r\n                      { label: 'Yield', value: `เธฟ${selectedClinic.usage_stats?.revenue?.toLocaleString() || 0}` }\r\n                    ].map((stat) => (\r\n                      <div key={stat.label} className=\"text-center p-4 bg-secondary/30 rounded-2xl border border-border/50 shadow-inner\">\r\n                        <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest mb-1\">{stat.label}</p>\r\n                        <p className=\"text-sm font-black text-foreground tabular-nums\">{stat.value}</p>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex gap-4 pt-6\">\r\n                  <Button variant=\"outline\" className=\"flex-1 py-6 rounded-[24px] text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\">\r\n                    Access Cluster Detail\r\n                  </Button>\r\n                  <Button className=\"flex-1 py-6 rounded-[24px] text-[10px] font-black uppercase tracking-widest shadow-premium\">\r\n                    Establish Connection\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </motion.div>\r\n          </div>\r\n        )}\r\n      </AnimatePresence>\r\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\contact-portal\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'EnvelopeSimple' is defined but never used.","line":1,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":43,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"EnvelopeSimple"},"fix":{"range":[26,42],"text":""},"desc":"Remove unused variable \"EnvelopeSimple\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Phone' is defined but never used.","line":1,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":50,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Phone"},"fix":{"range":[42,49],"text":""},"desc":"Remove unused variable \"Phone\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":1,"column":52,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":57,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Clock"},"fix":{"range":[49,56],"text":""},"desc":"Remove unused variable \"Clock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ShieldCheck' is defined but never used.","line":1,"column":116,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":127,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ShieldCheck"},"fix":{"range":[113,126],"text":""},"desc":"Remove unused variable \"ShieldCheck\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningCircle' is defined but never used.","line":1,"column":153,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":166,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WarningCircle"},"fix":{"range":[150,165],"text":""},"desc":"Remove unused variable \"WarningCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Broadcast' is defined but never used.","line":1,"column":187,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":196,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Broadcast"},"fix":{"range":[184,195],"text":""},"desc":"Remove unused variable \"Broadcast\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":2,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[242,254],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":2,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[254,265],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardContent' is defined but never used.","line":2,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":50,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardContent"},"fix":{"range":[265,278],"text":""},"desc":"Remove unused variable \"CardContent\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":15,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Badge"},"fix":{"range":[311,357],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":12,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { ChatCircle, Users, EnvelopeSimple, Phone, Clock, Funnel, MagnifyingGlass, ArrowUpRight, CaretRight, Info, ShieldCheck, Lightning, CheckCircle, WarningCircle, UserList, Headset, Broadcast } from '@phosphor-icons/react';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { cn } from '@/lib/utils';\r\nimport { useState } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nexport default function ContactPortalPage() {\r\n  const { goBack } = useBackNavigation();\r\n  const [activeTab, setActiveTab] = useState('messages');\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-10 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n      \r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Headset weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Communication Hub\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Contact <span className=\"text-primary\">Portal</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating multi-channel customer communications and clinical support protocols.\r\n          </motion.p>\r\n        </div>\r\n        \r\n        <div className=\"flex flex-wrap items-center gap-3\">\r\n          <Button variant=\"outline\" className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50\">\r\n            <UserList weight=\"bold\" className=\"w-4 h-4\" />\r\n            Active Channels\r\n          </Button>\r\n          <Button className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\">\r\n            <ChatCircle weight=\"bold\" className=\"w-4 h-4\" />\r\n            Initialize Link\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Summary - Mini version */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8 px-2\">\r\n        {[\r\n          { label: 'Unread Payload', value: '12', icon: ChatCircle, color: 'text-rose-500', bg: 'bg-rose-500/10' },\r\n          { label: 'Dispatch Today', value: '45', icon: Lightning, color: 'text-emerald-500', bg: 'bg-emerald-500/10' },\r\n          { label: 'Cycle Resolve', value: '128', icon: CheckCircle, color: 'text-primary', bg: 'bg-primary/10' }\r\n        ].map((stat, i) => (\r\n          <Card key={i} className=\"p-6 border-border/50 hover:border-primary/30 transition-all group overflow-hidden\">\r\n            <div className=\"absolute top-0 right-0 p-4 opacity-[0.03] group-hover:scale-110 transition-transform\">\r\n              <stat.icon weight=\"fill\" className=\"w-16 h-16 text-primary\" />\r\n            </div>\r\n            <div className=\"flex items-center gap-5 relative z-10\">\r\n              <div className={cn(\"w-12 h-12 rounded-xl flex items-center justify-center border border-border/50 shadow-inner\", stat.bg, stat.color)}>\r\n                <stat.icon weight=\"duotone\" className=\"w-6 h-6\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">{stat.label}</p>\r\n                <p className=\"text-xl font-black text-foreground\">{stat.value}</p>\r\n              </div>\r\n            </div>\r\n          </Card>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Navigation & Tab Controls */}\r\n      <div className=\"flex flex-col sm:flex-row items-center justify-between gap-6 px-2\">\r\n        <div className=\"flex items-center gap-2 bg-secondary/50 p-1.5 rounded-[24px] border border-border/50 w-full sm:w-auto\">\r\n          {[\r\n            { id: 'messages', label: 'Inbound Stream', icon: ChatCircle },\r\n            { id: 'contacts', label: 'Identity Registry', icon: Users },\r\n            { id: 'support', label: 'Clinical Support', icon: Headset }\r\n          ].map((tab) => (\r\n            <button\r\n              key={tab.id}\r\n              onClick={() => setActiveTab(tab.id)}\r\n              className={cn(\r\n                \"flex-1 sm:flex-none flex items-center justify-center gap-3 px-8 py-3.5 rounded-2xl transition-all text-[10px] font-black uppercase tracking-widest border whitespace-nowrap\",\r\n                activeTab === tab.id\r\n                  ? \"bg-primary text-primary-foreground border-primary shadow-premium\"\r\n                  : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\r\n              )}\r\n            >\r\n              <tab.icon weight={activeTab === tab.id ? \"fill\" : \"bold\"} className=\"w-4 h-4\" />\r\n              {tab.label}\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-4\">\r\n          <div className=\"relative group\">\r\n            <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-xl\" />\r\n            <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\r\n            <input \r\n              type=\"text\" \r\n              placeholder=\"Query identity...\"\r\n              className=\"bg-secondary/50 border border-border/50 rounded-2xl py-2.5 pl-11 pr-6 text-[10px] font-black uppercase tracking-widest text-foreground focus:outline-none focus:border-primary transition-all w-48 shadow-inner relative z-10\"\r\n            />\r\n          </div>\r\n          <Button variant=\"outline\" size=\"sm\" className=\"p-3 border-border/50 rounded-xl hover:bg-secondary transition-all\">\r\n            <Funnel weight=\"bold\" className=\"w-4 h-4\" />\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content Node */}\r\n      <AnimatePresence mode=\"wait\">\r\n        <motion.div\r\n          key={activeTab}\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          exit={{ opacity: 0, scale: 0.95 }}\r\n          transition={{ duration: 0.3 }}\r\n          className=\"px-2\"\r\n        >\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-8\">\r\n            {/* Sidebar Quick Actions/Filter */}\r\n            <div className=\"lg:col-span-1 space-y-8\">\r\n              <Card className=\"p-8 rounded-[40px] border-border shadow-card relative overflow-hidden group\">\r\n                <div className=\"absolute -top-12 -right-12 w-48 h-48 bg-primary/10 blur-[60px] rounded-full group-hover:bg-primary/20 transition-all duration-700\" />\r\n                <h4 className=\"text-[10px] font-black text-primary uppercase tracking-[0.3em] flex items-center gap-3 mb-6 relative z-10\">\r\n                  <Info weight=\"duotone\" className=\"w-5 h-5\" />\r\n                  Protocol Brief\r\n                </h4>\r\n                <div className=\"space-y-4 relative z-10\">\r\n                  <p className=\"text-xs text-muted-foreground font-medium leading-relaxed italic border-l-2 border-primary/20 pl-4\">\r\n                    Monitor inbound intelligence streams and clinical support nodes across the entire network.\r\n                  </p>\r\n                  <div className=\"pt-4 space-y-3\">\r\n                    <div className=\"flex items-center justify-between text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\r\n                      <span>Network Load</span>\r\n                      <span className=\"text-emerald-500\">Nominal</span>\r\n                    </div>\r\n                    <div className=\"h-1.5 w-full bg-secondary rounded-full overflow-hidden p-0.5 border border-border/50\">\r\n                      <div className=\"h-full w-[24%] bg-primary rounded-full shadow-glow-sm\" />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </Card>\r\n\r\n              <Card className=\"p-8 rounded-[40px] border-primary/10 bg-primary/[0.02] space-y-6 group overflow-hidden\">\r\n                <h4 className=\"text-[10px] font-black text-primary uppercase tracking-[0.3em] flex items-center gap-3 relative z-10\">\r\n                  <Lightning weight=\"duotone\" className=\"w-5 h-5\" />\r\n                  Fast-track Sync\r\n                </h4>\r\n                <div className=\"space-y-3 relative z-10\">\r\n                  <Button variant=\"outline\" className=\"w-full justify-between px-4 py-4 rounded-2xl text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary group/btn\">\r\n                    Scan Registry <CaretRight weight=\"bold\" className=\"w-3 h-3 group-hover/btn:translate-x-1 transition-transform\" />\r\n                  </Button>\r\n                  <Button variant=\"outline\" className=\"w-full justify-between px-4 py-4 rounded-2xl text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary group/btn\">\r\n                    Export Ledger <CaretRight weight=\"bold\" className=\"w-3 h-3 group-hover/btn:translate-x-1 transition-transform\" />\r\n                  </Button>\r\n                </div>\r\n              </Card>\r\n            </div>\r\n\r\n            {/* Content Body Placeholder */}\r\n            <div className=\"lg:col-span-3\">\r\n              <Card className=\"rounded-[40px] border-border shadow-premium overflow-hidden h-full min-h-[600px] flex items-center justify-center relative group\">\r\n                <div className=\"absolute inset-0 bg-scanner-grid opacity-[0.03] group-hover:opacity-[0.05] transition-opacity pointer-events-none\" />\r\n                <div className=\"relative z-10 text-center space-y-8 p-10\">\r\n                  <div className=\"w-24 h-24 rounded-[48px] bg-primary/10 border border-primary/20 flex items-center justify-center mx-auto shadow-glow-sm group-hover:scale-110 transition-transform duration-700\">\r\n                    <ChatCircle weight=\"duotone\" className=\"w-10 h-10 text-primary animate-pulse\" />\r\n                  </div>\r\n                  <div className=\"space-y-3\">\r\n                    <h3 className=\"text-2xl font-black text-foreground uppercase tracking-tight\">Portal Node Alpha</h3>\r\n                    <p className=\"text-sm text-muted-foreground font-medium max-w-sm mx-auto leading-relaxed italic\">\r\n                      Communication infrastructure is active. Identity synchronization and multi-channel protocol stream will manifest in this terminal node.\r\n                    </p>\r\n                  </div>\r\n                  <Button className=\"px-10 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium gap-3\">\r\n                    Establish Link\r\n                    <ArrowUpRight weight=\"bold\" className=\"w-4 h-4\" />\r\n                  </Button>\r\n                </div>\r\n              </Card>\r\n            </div>\r\n          </div>\r\n        </motion.div>\r\n      </AnimatePresence>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\network-map\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Monitor' is defined but never used.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Monitor"},"fix":{"range":[267,278],"text":""},"desc":"Remove unused variable \"Monitor\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":22,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[278,301],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendUp' is defined but never used.","line":25,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TrendUp"},"fix":{"range":[312,323],"text":""},"desc":"Remove unused variable \"TrendUp\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getStatusColor' is assigned a value but never used.","line":138,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":138,"endColumn":23},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'SquaresFour' is not defined.","line":273,"column":16,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":273,"endColumn":27},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'ListIcon' is not defined.","line":284,"column":16,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":284,"endColumn":24},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'X' is not defined.","line":350,"column":22,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":350,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":376,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":376,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15119,15122],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15119,15122],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { \n  ArrowLeft, \n  Globe, \n  HardDrives, \n  WifiSlash, \n  Warning,\n  CheckCircle,\n  Clock,\n  Pulse,\n  Buildings,\n  Database,\n  Cloud,\n  Shield,\n  CaretLeft,\n  CaretRight,\n  ArrowsClockwise,\n  WifiHigh as WifiIcon,\n  SpinnerGap,\n  MagnifyingGlass,\n  Monitor,\n  IdentificationBadge,\n  Sparkle,\n  TrendUp,\n  Icon,\n  Funnel\n} from '@phosphor-icons/react';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport { StatCard } from '@/components/ui/StatCard';\nimport NetworkTopology from '@/components/NetworkTopology';\nimport NetworkHeatMap from '@/components/NetworkHeatMap';\nimport TrafficFlowVisualization from '@/components/TrafficFlowVisualization';\nimport NetworkNodeDetailPanel from '@/components/NetworkNodeDetailPanel';\nimport NetworkAlertCenter from '@/components/NetworkAlertCenter';\nimport NetworkPerformanceCharts from '@/components/NetworkPerformanceCharts';\nimport NetworkExportMenu from '@/components/NetworkExportMenu';\nimport { useRealNetworkData } from '@/hooks/useRealNetworkData';\nimport { useResponsive } from '@/hooks/useResponsive';\nimport { cn } from '@/lib/utils';\nimport { useState, useEffect, useMemo, useCallback } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport interface NetworkNode {\n  id: string;\n  name: string;\n  type: 'clinic' | 'server' | 'database' | 'api' | 'auth' | 'storage';\n  status: 'online' | 'offline' | 'warning';\n  location: string;\n  metrics: {\n    latency: number;\n    uptime: number;\n    load: number;\n    users?: number;\n    staff?: number;\n  };\n}\n\nexport default function NetworkMapPage() {\n  const { goBack } = useBackNavigation();\n  const [nodes, setNodes] = useState<NetworkNode[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedNode, setSelectedNode] = useState<NetworkNode | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filterType, setFilterType] = useState<string>('all');\n  const [filterStatus, setFilterStatus] = useState<string>('all');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid');\n  const [activeTab, setActiveTab] = useState<'topology' | 'heatmap' | 'traffic'>('topology');\n  const [alerts] = useState([\n    { id: '1', type: 'warning' as const, title: 'High Latency Detected', message: 'API Gateway latency exceeds 80ms', timestamp: new Date(Date.now() - 900000), read: false },\n    { id: '2', type: 'error' as const, title: 'Node Offline', message: 'Storage Server is not responding', timestamp: new Date(Date.now() - 1800000), read: false },\n    { id: '3', type: 'success' as const, title: 'System Update', message: 'All nodes updated successfully', timestamp: new Date(Date.now() - 3600000), read: true },\n  ]);\n\n  const { width, isMobile, isTablet } = useResponsive();\n\n  const { \n    nodes: realTimeNodes, \n    isLoading: realTimeLoading, \n    error: dataError,\n    connectionStatus, \n    lastUpdate, \n    refresh \n  } = useRealNetworkData();\n\n  useEffect(() => {\n    if (dataError) {\n      console.error('Data fetch error:', dataError);\n      setNodes([]);\n      setLoading(false);\n      return;\n    }\n    \n    if (realTimeNodes.length > 0) {\n      setNodes(realTimeNodes);\n    }\n    setLoading(realTimeLoading);\n  }, [realTimeNodes, realTimeLoading, dataError]);\n\n  const uniqueTypes = ['all', ...Array.from(new Set(nodes.map(node => node.type)))];\n  const uniqueStatuses = ['all', ...Array.from(new Set(nodes.map(node => node.status)))];\n\n  const itemsPerPage = isMobile ? 8 : isTablet ? 9 : 12;\n\n  const filteredNodes = useMemo(() => {\n    return nodes.filter(node => {\n      const matchesSearch = node.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                           node.location.toLowerCase().includes(searchTerm.toLowerCase());\n      const matchesType = filterType === 'all' || node.type === filterType;\n      const matchesStatus = filterStatus === 'all' || node.status === filterStatus;\n      return matchesSearch && matchesType && matchesStatus;\n    });\n  }, [nodes, searchTerm, filterType, filterStatus]);\n\n  const paginatedNodes = useMemo(() => {\n    return filteredNodes.slice(\n      (currentPage - 1) * itemsPerPage,\n      currentPage * itemsPerPage\n    );\n  }, [filteredNodes, currentPage, itemsPerPage]);\n\n  const totalPages = Math.ceil(filteredNodes.length / itemsPerPage);\n\n  const stats = useMemo(() => ({\n    total: nodes.length,\n    online: nodes.filter(n => n.status === 'online').length,\n    warning: nodes.filter(n => n.status === 'warning').length,\n    offline: nodes.filter(n => n.status === 'offline').length,\n    clinics: nodes.filter(n => n.type === 'clinic').length,\n    services: nodes.filter(n => n.type !== 'clinic').length\n  }), [nodes]);\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'online': return 'text-emerald-500 bg-emerald-500/10 border-emerald-500/20';\n      case 'offline': return 'text-red-500 bg-red-500/10 border-red-500/20';\n      case 'warning': return 'text-amber-500 bg-amber-500/10 border-amber-500/20';\n      default: return 'text-muted-foreground bg-secondary border-border';\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'online': return <CheckCircle className=\"w-3 h-3\" />;\n      case 'offline': return <WifiSlash className=\"w-3 h-3\" />;\n      case 'warning': return <Warning className=\"w-3 h-3\" />;\n      default: return <Clock className=\"w-3 h-3\" />;\n    }\n  };\n\n  const getNodeIcon = useCallback((type: string) => {\n    switch (type) {\n      case 'server': return <HardDrives className=\"w-5 h-5\" />;\n      case 'database': return <Database className=\"w-5 h-5\" />;\n      case 'api': return <Cloud className=\"w-5 h-5\" />;\n      case 'auth': return <Shield className=\"w-5 h-5\" />;\n      case 'storage': return <Database className=\"w-5 h-5\" />;\n      case 'clinic': return <Buildings className=\"w-5 h-5\" />;\n      default: return <Globe className=\"w-5 h-5\" />;\n    }\n  }, []);\n\n  const handleNodeClick = (node: NetworkNode) => {\n    setSelectedNode(node);\n  };\n\n  const handleSearchChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setSearchTerm(e.target.value);\n    setCurrentPage(1);\n  };\n\n  const handleTypeFilterChange = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    setFilterType(e.target.value);\n    setCurrentPage(1);\n  };\n\n  const handleStatusFilterChange = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    setFilterStatus(e.target.value);\n    setCurrentPage(1);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-background text-foreground p-8 flex flex-col gap-6\">\n        <Breadcrumb />\n        <div className=\"flex items-center gap-4 mb-2\">\n          <button \n            onClick={() => goBack('/admin')} \n            className=\"p-3 bg-secondary border border-border rounded-xl hover:bg-accent transition-colors text-foreground\"\n          >\n            <ArrowLeft className=\"w-5 h-5\" />\n          </button>\n          <h1 className=\"text-3xl font-bold text-foreground\">Network Map</h1>\n        </div>\n        <div className=\"flex-1 flex flex-col items-center justify-center space-y-4\">\n          <SpinnerGap className=\"w-12 h-12 text-primary animate-spin\" />\n          <p className=\"text-muted-foreground animate-pulse font-medium uppercase tracking-widest\">Loading network topology...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n      \n      {/* Header Section */}\n      <div className=\"flex flex-col lg:flex-row lg:items-center justify-between gap-6 px-2\">\n        <div className=\"flex items-center gap-6\">\n          <Button \n            variant=\"outline\"\n            onClick={() => goBack('/admin')}\n            className=\"p-4 h-14 w-14 border-border rounded-2xl text-muted-foreground hover:text-foreground transition-all\"\n          >\n            <ArrowLeft weight=\"bold\" className=\"w-5 h-5\" />\n          </Button>\n          <div className=\"space-y-1\">\n            <motion.div \n              initial={{ opacity: 0, x: -20 }}\n              animate={{ opacity: 1, x: 0 }}\n              className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n            >\n              <Globe weight=\"duotone\" className=\"w-4 h-4\" />\n              Global Topology Node\n            </motion.div>\n            <h1 className=\"text-4xl font-bold text-foreground tracking-tight uppercase\">\n              Network <span className=\"text-primary\">Intelligence</span>\n            </h1>\n            <div className=\"flex items-center gap-4 text-[10px] font-black uppercase tracking-widest text-muted-foreground mt-1\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse shadow-[0_0_8px_rgba(16,185,129,0.6)]\" />\n                <span>Last Sync: {lastUpdate ? new Date(lastUpdate).toLocaleTimeString() : 'INITIALIZING...'}</span>\n              </div>\n              <div className=\"w-1 h-1 rounded-full bg-border\" />\n              <div className=\"flex items-center gap-2\">\n                <WifiIcon weight=\"bold\" className={cn(\"w-3.5 h-3.5\", connectionStatus === 'connected' ? 'text-emerald-500' : 'text-amber-500')} />\n                <span>{connectionStatus === 'connected' ? 'SECURE_UPLINK' : 'RECONNECTING...'}</span>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        <div className=\"flex flex-wrap items-center gap-3\">\n          <NetworkExportMenu nodes={nodes} selectedNode={selectedNode || undefined} />\n          <NetworkAlertCenter alerts={alerts} />\n          <Button\n            variant=\"outline\"\n            onClick={refresh}\n            className=\"p-4 h-14 w-14 border-border rounded-2xl text-muted-foreground hover:text-primary transition-all\"\n          >\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-5 h-5\", realTimeLoading && \"animate-spin\")} />\n          </Button>\n          \n          <div className=\"flex bg-secondary/50 border border-border/50 p-1.5 rounded-[24px] shadow-inner\">\n            <button\n              onClick={() => setViewMode('grid')}\n              className={cn(\n                \"p-3 rounded-xl transition-all border\",\n                viewMode === 'grid' \n                  ? \"bg-card text-primary border-border/50 shadow-sm\" \n                  : \"text-muted-foreground border-transparent hover:text-foreground\"\n              )}\n            >\n              <SquaresFour weight=\"duotone\" className=\"w-5 h-5\" />\n            </button>\n            <button\n              onClick={() => setViewMode('list')}\n              className={cn(\n                \"p-3 rounded-xl transition-all border\",\n                viewMode === 'list' \n                  ? \"bg-card text-primary border-border/50 shadow-sm\" \n                  : \"text-muted-foreground border-transparent hover:text-foreground\"\n              )}\n            >\n              <ListIcon weight=\"duotone\" className=\"w-5 h-5\" />\n            </button>\n          </div>\n        </div>\n      </div>\n      \n      {/* Stats Summary Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-8 px-2\">\n        <StatCard\n          title=\"Consolidated Nodes\"\n          value={stats.total}\n          icon={Globe as Icon}\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Clinical Terminals\"\n          value={stats.clinics}\n          icon={Buildings as Icon}\n          iconColor=\"text-emerald-500\"\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Operational Services\"\n          value={stats.services}\n          icon={HardDrives as Icon}\n          iconColor=\"text-purple-500\"\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Warning Delta\"\n          value={stats.warning}\n          icon={Warning as Icon}\n          iconColor=\"text-amber-500\"\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Offline Nodes\"\n          value={stats.offline}\n          icon={WifiSlash as Icon}\n          iconColor=\"text-rose-500\"\n          className=\"p-4\"\n        />\n      </div>\n\n      {/* Selected Node Intelligence */}\n      <AnimatePresence>\n        {selectedNode && (\n          <motion.div \n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: 20 }}\n            className=\"px-2\"\n          >\n            <Card className=\"rounded-[40px] border-primary/20 bg-primary/[0.01] shadow-premium overflow-hidden group\">\n              <CardHeader className=\"p-8 border-b border-primary/10\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20\">\n                      <Pulse weight=\"duotone\" className=\"w-6 h-6\" />\n                    </div>\n                    <div>\n                      <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Telemetry: {selectedNode.name}</CardTitle>\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Real-time performance matrix</p>\n                    </div>\n                  </div>\n                  <Button variant=\"ghost\" onClick={() => setSelectedNode(null)} className=\"h-10 w-10 p-0 rounded-xl hover:bg-primary/5\">\n                    <X weight=\"bold\" className=\"w-5 h-5\" />\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent className=\"p-10\">\n                <NetworkPerformanceCharts nodes={nodes} selectedNode={selectedNode} />\n              </CardContent>\n            </Card>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-10 px-2\">\n        {/* Main Visualization Node */}\n        <div className=\"lg:col-span-2 space-y-10\">\n          <Card className=\"rounded-[48px] border-border/50 shadow-premium overflow-hidden group\">\n            <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30\">\n              <div className=\"flex flex-col sm:flex-row items-center justify-between gap-6\">\n                <div className=\"flex bg-secondary/50 p-1.5 rounded-[24px] border border-border/50 shadow-inner shrink-0\">\n                  {[\n                    { id: 'topology', label: 'Topology', icon: Globe },\n                    { id: 'heatmap', label: 'Heat Map', icon: Sparkle },\n                    { id: 'traffic', label: 'Traffic', icon: Pulse }\n                  ].map(tab => (\n                    <button\n                      key={tab.id}\n                      onClick={() => setActiveTab(tab.id as any)}\n                      className={cn(\n                        \"px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border whitespace-nowrap flex items-center gap-2\",\n                        activeTab === tab.id \n                          ? \"bg-primary text-primary-foreground border-primary shadow-premium\" \n                          : \"text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\n                      )}\n                    >\n                      <tab.icon weight={activeTab === tab.id ? \"fill\" : \"bold\"} className=\"w-3.5 h-3.5\" />\n                      {tab.label}\n                    </button>\n                  ))}\n                </div>\n                <div className=\"flex items-center gap-3 px-4 py-2 bg-emerald-500/5 border border-emerald-500/10 rounded-2xl\">\n                  <div className=\"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse\" />\n                  <span className=\"text-[9px] text-emerald-500 font-black uppercase tracking-widest\">Live Biometric Feed</span>\n                </div>\n              </div>\n            </CardHeader>\n            \n            <CardContent className=\"p-0 bg-secondary/10\">\n              <div className=\"relative h-[500px] xl:h-[600px] w-full\">\n                <AnimatePresence mode=\"wait\">\n                  <motion.div\n                    key={activeTab}\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    exit={{ opacity: 0 }}\n                    className=\"absolute inset-0\"\n                  >\n                    {activeTab === 'topology' && (\n                      <NetworkTopology \n                        nodes={nodes.map(node => ({\n                          label: node.name,\n                          type: node.type,\n                          status: node.status,\n                          location: node.location,\n                          metrics: node.metrics\n                        }))}\n                        onNodeClick={(nodeData) => {\n                          const originalNode = nodes.find(n => n.name === nodeData.label);\n                          setSelectedNode(originalNode || null);\n                        }}\n                        isMobile={isMobile}\n                        isTablet={isTablet}\n                        width={isMobile ? width - 64 : isTablet ? width - 120 : 900}\n                        height={isMobile ? 400 : isTablet ? 500 : 580}\n                      />\n                    )}\n                    {activeTab === 'heatmap' && (\n                      <NetworkHeatMap \n                        nodes={nodes}\n                        trafficData={{} as Record<string, number>}\n                        width={isMobile ? width - 64 : isTablet ? width - 120 : 900}\n                        height={isMobile ? 400 : isTablet ? 500 : 580}\n                      />\n                    )}\n                    {activeTab === 'traffic' && (\n                      <TrafficFlowVisualization \n                        nodes={nodes}\n                        trafficData={{} as Record<string, number>}\n                        width={isMobile ? width - 64 : isTablet ? width - 120 : 900}\n                        height={isMobile ? 400 : isTablet ? 500 : 580}\n                      />\n                    )}\n                  </motion.div>\n                </AnimatePresence>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Filters Node */}\n          <Card className=\"p-8 rounded-[40px] border-border/50 shadow-card\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8\">\n              <div className=\"space-y-2\">\n                <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Search Registry</label>\n                <div className=\"relative group/input\">\n                  <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-2xl\" />\n                  <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\n                  <input\n                    type=\"text\"\n                    placeholder=\"Search nodes by name or location...\"\n                    value={searchTerm}\n                    onChange={handleSearchChange}\n                    className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-12 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10 font-bold\"\n                  />\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Node Type Filter</label>\n                <div className=\"relative group/input\">\n                  <select\n                    value={filterType}\n                    onChange={handleTypeFilterChange}\n                    className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all appearance-none font-black uppercase tracking-widest shadow-inner\"\n                  >\n                    {uniqueTypes.map(type => (\n                      <option key={type} value={type} className=\"bg-card\">\n                        {type === 'all' ? 'PROTOCOL: ALL' : type.toUpperCase()}\n                      </option>\n                    ))}\n                  </select>\n                  <Funnel weight=\"bold\" className=\"absolute right-6 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 pointer-events-none\" />\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Operational Status</label>\n                <div className=\"relative group/input\">\n                  <select\n                    value={filterStatus}\n                    onChange={handleStatusFilterChange}\n                    className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all appearance-none font-black uppercase tracking-widest shadow-inner\"\n                  >\n                    {uniqueStatuses.map(status => (\n                      <option key={status} value={status} className=\"bg-card\">\n                        {status === 'all' ? 'STATUS: ALL' : status.toUpperCase()}\n                      </option>\n                    ))}\n                  </select>\n                  <Pulse weight=\"bold\" className=\"absolute right-6 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 pointer-events-none\" />\n                </div>\n              </div>\n            </div>\n          </Card>\n        </div>\n\n        {/* Sidebar Area: Node Registry */}\n        <div className=\"space-y-10\">\n          <div className=\"space-y-6\">\n            <div className=\"flex items-center justify-between px-2\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-1.5 h-1.5 rounded-full bg-primary animate-pulse shadow-[0_0_10px_hsl(var(--primary)/0.6)]\" />\n                <h2 className=\"text-xl font-black text-foreground uppercase tracking-tight\">Identity Hub</h2>\n              </div>\n              <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[10px] tracking-widest uppercase px-4 py-1\">\n                {filteredNodes.length} Detected\n              </Badge>\n            </div>\n            \n            <div className=\"space-y-4 max-h-[800px] overflow-y-auto pr-2 custom-scrollbar pb-10\">\n              <AnimatePresence mode=\"popLayout\">\n                {paginatedNodes.map((node, index) => (\n                  <motion.div\n                    key={node.id}\n                    layout\n                    initial={{ opacity: 0, x: 20 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, scale: 0.95 }}\n                    transition={{ delay: index * 0.03 }}\n                    className={cn(\n                      \"bg-card border rounded-[32px] p-6 cursor-pointer transition-all duration-500 group relative overflow-hidden\",\n                      selectedNode?.id === node.id \n                        ? 'border-primary ring-1 ring-primary/20 bg-primary/[0.02] shadow-premium' \n                        : 'border-border/50 hover:border-primary/30 shadow-card hover:shadow-card-hover'\n                    )}\n                    onClick={() => handleNodeClick(node)}\n                  >\n                    {selectedNode?.id === node.id && (\n                      <div className=\"absolute top-0 left-0 w-1.5 h-full bg-primary\" />\n                    )}\n                    \n                    <div className=\"flex items-start justify-between mb-6 relative z-10\">\n                      <div className=\"flex items-center gap-5\">\n                        <div className={cn(\n                          \"w-12 h-12 rounded-2xl border flex items-center justify-center shadow-inner transition-all duration-500\",\n                          node.status === 'online' ? \"bg-emerald-500/10 border-emerald-500/20 text-emerald-500\" :\n                          node.status === 'offline' ? \"bg-rose-500/10 border-rose-500/20 text-rose-500\" :\n                          \"bg-amber-500/10 border-amber-500/20 text-amber-500\"\n                        )}>\n                          {getNodeIcon(node.type)}\n                        </div>\n                        <div className=\"min-w-0\">\n                          <h3 className=\"font-bold text-foreground text-sm truncate uppercase tracking-tight group-hover:text-primary transition-colors\">{node.name}</h3>\n                          <p className=\"text-[10px] text-muted-foreground font-medium uppercase tracking-widest mt-0.5 opacity-60 italic\">{node.location}</p>\n                        </div>\n                      </div>\n                      <div className={cn(\n                        \"p-1.5 rounded-full shadow-sm\",\n                        node.status === 'online' ? \"bg-emerald-500/10 text-emerald-500\" :\n                        node.status === 'offline' ? \"bg-rose-500/10 text-rose-500\" :\n                        \"bg-amber-500/10 text-amber-500\"\n                      )}>\n                        {getStatusIcon(node.status)}\n                      </div>\n                    </div>\n                    \n                    <div className=\"grid grid-cols-3 gap-4 border-t border-border/30 pt-5 mt-2 relative z-10\">\n                      <div className=\"space-y-1\">\n                        <span className=\"text-muted-foreground text-[8px] font-black uppercase tracking-[0.2em] block\">Latency</span>\n                        <span className=\"text-foreground text-xs font-black tabular-nums\">{node.metrics.latency}ms</span>\n                      </div>\n                      <div className=\"space-y-1\">\n                        <span className=\"text-muted-foreground text-[8px] font-black uppercase tracking-[0.2em] block\">Uptime</span>\n                        <span className=\"text-foreground text-xs font-black tabular-nums\">{node.metrics.uptime}%</span>\n                      </div>\n                      <div className=\"space-y-1\">\n                        <span className=\"text-muted-foreground text-[8px] font-black uppercase tracking-[0.2em] block\">Load</span>\n                        <span className=\"text-foreground text-xs font-black tabular-nums\">{node.metrics.load}%</span>\n                      </div>\n                    </div>\n                  </motion.div>\n                ))}\n              </AnimatePresence>\n            </div>\n\n            {/* Pagination Protocol */}\n            {totalPages > 1 && (\n              <div className=\"flex items-center justify-between px-4 pt-4 border-t border-border/30\">\n                <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\n                  Page {currentPage} / {totalPages}\n                </p>\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => setCurrentPage(prev => Math.max(1, prev - 1))}\n                    disabled={currentPage === 1}\n                    className=\"h-10 w-10 p-0 rounded-xl border-border/50 hover:bg-secondary disabled:opacity-20 transition-all\"\n                  >\n                    <CaretLeft weight=\"bold\" className=\"w-4 h-4\" />\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => setCurrentPage(prev => Math.min(totalPages, prev + 1))}\n                    disabled={currentPage === totalPages}\n                    className=\"h-10 w-10 p-0 rounded-xl border-border/50 hover:bg-secondary disabled:opacity-20 transition-all\"\n                  >\n                    <CaretRight weight=\"bold\" className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            )}\n          </div>\n\n          <Card className=\"p-8 rounded-[40px] border-primary/10 bg-primary/[0.02] space-y-4 group overflow-hidden relative shadow-inner\">\n            <div className=\"absolute -bottom-12 -right-12 w-32 h-32 bg-primary/5 blur-[50px] rounded-full group-hover:bg-primary/10 transition-all duration-700\" />\n            <div className=\"flex items-center gap-3 relative z-10\">\n              <Sparkle weight=\"duotone\" className=\"w-5 h-5 text-primary group-hover:scale-110 transition-transform\" />\n              <h4 className=\"text-[10px] font-black text-primary uppercase tracking-[0.3em]\">Network Intelligence</h4>\n            </div>\n            <p className=\"text-[11px] text-muted-foreground italic font-medium leading-relaxed relative z-10 opacity-80\">\n              Global system architecture is maintained at 99.99% parity. Real-time biometric transmissions are currently distributed across sector theta.\n            </p>\n          </Card>\n        </div>\n      </div>\n\n      {/* Mobile Status Bar Node */}\n      <div className=\"lg:hidden fixed bottom-0 left-0 right-0 bg-background/80 backdrop-blur-2xl border-t border-border/50 p-5 z-20 shadow-premium\">\n        <div className=\"flex items-center justify-around text-[9px] font-black uppercase tracking-widest\">\n          <div className=\"flex items-center gap-2.5\">\n            <div className=\"w-2 h-2 bg-emerald-500 rounded-full animate-pulse shadow-[0_0_8px_rgba(16,185,129,0.6)]\" />\n            <span className=\"text-emerald-500\">Online: {stats.online}</span>\n          </div>\n          <div className=\"flex items-center gap-2.5 text-amber-500\">\n            <Warning weight=\"bold\" className=\"w-3.5 h-3.5\" />\n            <span>Warning: {stats.warning}</span>\n          </div>\n          <div className=\"flex items-center gap-2.5 text-rose-500\">\n            <WifiSlash weight=\"bold\" className=\"w-3.5 h-3.5\" />\n            <span>Offline: {stats.offline}</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Node Detail Panel Node */}\n      <NetworkNodeDetailPanel \n        node={selectedNode} \n        onClose={() => setSelectedNode(null)} \n      />\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Phone' is defined but never used.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Phone"},"fix":{"range":[380,390],"text":""},"desc":"Remove unused variable \"Phone\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MapPin' is defined but never used.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":9,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"MapPin"},"fix":{"range":[390,401],"text":""},"desc":"Remove unused variable \"MapPin\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendUp' is defined but never used.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TrendUp"},"fix":{"range":[412,424],"text":""},"desc":"Remove unused variable \"TrendUp\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Activity' is defined but never used.","line":25,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":11,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Activity"},"fix":{"range":[424,437],"text":""},"desc":"Remove unused variable \"Activity\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'HardDrives' is defined but never used.","line":27,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"HardDrives"},"fix":{"range":[453,468],"text":""},"desc":"Remove unused variable \"HardDrives\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":30,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Briefcase"},"fix":{"range":[500,514],"text":""},"desc":"Remove unused variable \"Briefcase\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Monitor' is defined but never used.","line":31,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Monitor"},"fix":{"range":[514,526],"text":""},"desc":"Remove unused variable \"Monitor\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChartLineUp' is defined but never used.","line":32,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ChartLineUp"},"fix":{"range":[526,542],"text":""},"desc":"Remove unused variable \"ChartLineUp\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowSquareOut' is defined but never used.","line":34,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":17,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowSquareOut"},"fix":{"range":[555,574],"text":""},"desc":"Remove unused variable \"ArrowSquareOut\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useTranslations' is defined but never used.","line":40,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":25,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"useTranslations"},"fix":{"range":[843,887],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":132,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":132,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3537,3540],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3537,3540],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":138,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3775,3778],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3775,3778],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":144,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":144,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3992,3995],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3992,3995],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":174,"column":91,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":174,"endColumn":94,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4987,4990],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4987,4990],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'i' is defined but never used.","line":408,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":408,"endColumn":28},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Target' is not defined.","line":1082,"column":28,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":1082,"endColumn":34}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { \r\n  Buildings, \r\n  Users, \r\n  Pulse, \r\n  ShieldCheck, \r\n  Gear, \r\n  Lightning, \r\n  Globe, \r\n  MagnifyingGlass,\r\n  Plus,\r\n  SpinnerGap,\r\n  CaretRight,\r\n  WarningCircle,\r\n  X,\r\n  EnvelopeSimple,\r\n  Phone,\r\n  MapPin,\r\n  Shield,\r\n  TrendUp,\r\n  Activity,\r\n  CheckCircle,\r\n  HardDrives,\r\n  Key,\r\n  IdentificationBadge,\r\n  Briefcase,\r\n  Monitor,\r\n  ChartLineUp,\r\n  Database,\r\n  ArrowSquareOut\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { useTranslations } from 'next-intl';\r\nimport { cn } from '@/lib/utils';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\n\r\ninterface Clinic {\r\n  id: string;\r\n  name: string;\r\n  status: 'active' | 'inactive' | 'pending';\r\n  plan: string;\r\n  customerCount: number;\r\n  staffCount: number;\r\n  createdAt: string;\r\n}\r\n\r\nexport default function SuperAdminDashboard() {\r\n  const router = useRouter();\r\n  const [loading, setLoading] = useState(true);\r\n  const [clinics, setClinics] = useState<Clinic[]>([]);\r\n  const [globalStats, setGlobalStats] = useState({\r\n    totalClinics: 0,\r\n    globalCustomers: 0,\r\n    monthlyAILoad: 0,\r\n    activeSessions: 0\r\n  });\r\n  const [systemStatus, setSystemHealth] = useState<Record<string, string>>({\r\n    database: 'Checking...',\r\n    storage: 'Checking...',\r\n    ai_gateway: 'Checking...',\r\n    auth_service: 'Checking...'\r\n  });\r\n  \r\n  // Register Clinic Modal State\r\n  const [showRegisterModal, setShowRegisterModal] = useState(false);\r\n  const [registering, setRegistering] = useState(false);\r\n  const [registerError, setRegisterError] = useState<string | null>(null);\r\n  const [registerStep, setRegisterStep] = useState(1); // Multi-step wizard\r\n  const [newClinic, setNewClinic] = useState({\r\n    // Basic Info\r\n    name: '',\r\n    email: '',\r\n    phone: '',\r\n    address: '',\r\n    plan: 'starter',\r\n    \r\n    // Business Info\r\n    businessType: 'clinic', // clinic, hospital, spa\r\n    companyRegistration: '',\r\n    taxId: '',\r\n    establishedYear: '',\r\n    numberOfStaff: '',\r\n    numberOfBranches: '1',\r\n    website: '',\r\n    socialMedia: '',\r\n    \r\n    // Financial Info\r\n    monthlyRevenue: '',\r\n    itBudget: '',\r\n    paymentMethod: 'bank_transfer',\r\n    paymentTerm: 'monthly',\r\n    \r\n    // Marketing Info\r\n    leadSource: '',\r\n    referredBy: '',\r\n    assignedSales: '',\r\n    competitors: '',\r\n    \r\n    // Technical Info\r\n    currentSystem: '',\r\n    integrationNeeds: '',\r\n    timeline: 'normal'\r\n  });\r\n\r\n  // Create User Modal State\r\n  const [showUserModal, setShowUserModal] = useState(false);\r\n  const [creatingUser, setCreatingUser] = useState(false);\r\n  const [userError, setUserError] = useState<string | null>(null);\r\n  const [newUser, setNewUser] = useState({\r\n    email: '',\r\n    fullName: '',\r\n    clinicId: '',\r\n    role: 'clinic_owner'\r\n  });\r\n\r\n  const fetchData = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      // Import APIClient\r\n      const { apiClient } = await import('@/lib/api/client');\r\n      \r\n      // 1. Fetch clinics\r\n      const resClinics = await apiClient.get('/admin/management?type=clinics');\r\n      if (resClinics.success && resClinics.data) {\r\n        setClinics((resClinics.data as any).clinics || []);\r\n      }\r\n\r\n      // 2. Fetch health\r\n      const resHealth = await apiClient.get('/admin/management?type=system_health');\r\n      if (resHealth.success && resHealth.data) {\r\n        setSystemHealth((resHealth.data as any).health || {});\r\n      }\r\n\r\n      // 3. Fetch stats\r\n      const resStats = await apiClient.get('/admin/management?type=stats');\r\n      if (resStats.success && resStats.data) {\r\n        const d = resStats.data as any;\r\n        setGlobalStats({\r\n          totalClinics: d.totalClinics || 0,\r\n          globalCustomers: d.globalCustomers || 0,\r\n          monthlyAILoad: d.monthlyAILoad || 0,\r\n          activeSessions: d.activeStaff || 0 // Using active staff as a proxy for activity\r\n        });\r\n      }\r\n    } catch (err) {\r\n      console.error('Super Admin Error:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, [fetchData]);\r\n\r\n  const handleUpdateStatus = async (clinicId: string, currentStatus: string) => {\r\n    const newStatus = currentStatus === 'active' ? 'inactive' : 'active';\r\n    try {\r\n      const { apiClient } = await import('@/lib/api/client');\r\n      const res = await apiClient.post('/admin/management', {\r\n        action: 'updateStatus',\r\n        clinicId,\r\n        status: newStatus\r\n      });\r\n      \r\n      if (res.success) {\r\n        setClinics(prev => prev.map(c => c.id === clinicId ? { ...c, status: newStatus as any } : c));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error updating status:', error);\r\n    }\r\n  };\r\n\r\n  const handleCreateUser = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setCreatingUser(true);\r\n    setUserError(null);\r\n\r\n    try {\r\n      const { apiClient } = await import('@/lib/api/client');\r\n      const res = await apiClient.post('/admin/management', {\r\n        action: 'createUser',\r\n        ...newUser,\r\n        password: 'BNAura2024!' // Default password\r\n      });\r\n      \r\n      if (res.success) {\r\n        // Reset form and close modal\r\n        setNewUser({ email: '', fullName: '', clinicId: '', role: 'clinic_owner' });\r\n        setShowUserModal(false);\r\n        // Refresh data\r\n        fetchData();\r\n      } else {\r\n        setUserError(res.error?.message || 'Failed to create user');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error creating user:', error);\r\n      setUserError('Failed to create user');\r\n    } finally {\r\n      setCreatingUser(false);\r\n    }\r\n  };\r\n\r\n  const handleRegisterClinic = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    // Only submit on final step\r\n    if (registerStep < 4) {\r\n      setRegisterStep(prev => prev + 1);\r\n      return;\r\n    }\r\n    \r\n    setRegistering(true);\r\n    setRegisterError(null);\r\n\r\n    try {\r\n      // Import APIClient\r\n      const { apiClient } = await import('@/lib/api/client');\r\n      \r\n      // Prepare metadata with all additional fields\r\n      const metadata = {\r\n        contact_email: newClinic.email,\r\n        contact_phone: newClinic.phone,\r\n        address: newClinic.address,\r\n        \r\n        business_info: {\r\n          type: newClinic.businessType,\r\n          company_registration: newClinic.companyRegistration,\r\n          tax_id: newClinic.taxId,\r\n          established_year: newClinic.establishedYear,\r\n          number_of_staff: newClinic.numberOfStaff,\r\n          number_of_branches: newClinic.numberOfBranches,\r\n          website: newClinic.website,\r\n          social_media: newClinic.socialMedia\r\n        },\r\n        \r\n        financial: {\r\n          monthly_revenue: newClinic.monthlyRevenue,\r\n          it_budget: newClinic.itBudget,\r\n          payment_method: newClinic.paymentMethod,\r\n          payment_term: newClinic.paymentTerm\r\n        },\r\n        \r\n        marketing: {\r\n          lead_source: newClinic.leadSource,\r\n          referred_by: newClinic.referredBy,\r\n          assigned_sales: newClinic.assignedSales,\r\n          competitors: newClinic.competitors\r\n        },\r\n        \r\n        technical: {\r\n          current_system: newClinic.currentSystem,\r\n          integration_needs: newClinic.integrationNeeds,\r\n          timeline: newClinic.timeline\r\n        }\r\n      };\r\n\r\n      const response = await apiClient.post('/admin/management', {\r\n        action: 'createClinic',\r\n        name: newClinic.name,\r\n        email: newClinic.email,\r\n        phone: newClinic.phone,\r\n        address: newClinic.address,\r\n        plan: newClinic.plan,\r\n        metadata // Send all comprehensive data\r\n      });\r\n\r\n      if (!response.success) {\r\n        throw new Error(response.error?.message || 'Failed to register clinic');\r\n      }\r\n\r\n      // Reset form and step\r\n      setRegisterStep(1);\r\n      setNewClinic({\r\n        name: '',\r\n        email: '',\r\n        phone: '',\r\n        address: '',\r\n        plan: 'starter',\r\n        businessType: 'clinic',\r\n        companyRegistration: '',\r\n        taxId: '',\r\n        establishedYear: '',\r\n        numberOfStaff: '',\r\n        numberOfBranches: '1',\r\n        website: '',\r\n        socialMedia: '',\r\n        monthlyRevenue: '',\r\n        itBudget: '',\r\n        paymentMethod: 'bank_transfer',\r\n        paymentTerm: 'monthly',\r\n        leadSource: '',\r\n        referredBy: '',\r\n        assignedSales: '',\r\n        competitors: '',\r\n        currentSystem: '',\r\n        integrationNeeds: '',\r\n        timeline: 'normal'\r\n      });\r\n      \r\n      setShowRegisterModal(false);\r\n      \r\n      // Refresh data\r\n      await fetchData();\r\n    } catch (error) {\r\n      setRegisterError(error instanceof Error ? error.message : 'An error occurred');\r\n    } finally {\r\n      setRegistering(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-[400px] flex flex-col items-center justify-center space-y-4\">\r\n        <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n        <p className=\"text-muted-foreground animate-pulse text-xs uppercase tracking-widest text-center\">\r\n          Accessing Global Control Node...\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const stats = [\r\n    { label: 'Total Clinics', value: globalStats.totalClinics, icon: Buildings, trend: 'up' as const, change: 12 },\r\n    { label: 'Global Customers', value: globalStats.globalCustomers, icon: Users, trend: 'up' as const, change: 8 },\r\n    { label: 'Monthly AI Load', value: globalStats.monthlyAILoad, icon: Lightning, suffix: ' reqs', trend: 'up' as const, change: 24 },\r\n    { label: 'Active Personnel', value: globalStats.activeSessions, icon: Pulse, trend: 'neutral' as const, change: 0 },\r\n  ];\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <ShieldCheck weight=\"duotone\" className=\"w-4 h-4\" />\r\n            System Authority Node\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Super Admin <span className=\"text-primary\">Console</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Global orchestration and multi-tenant performance oversight.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <motion.div \r\n          initial={{ opacity: 0, scale: 0.9 }}\r\n          animate={{ opacity: 1, scale: 1 }}\r\n          transition={{ delay: 0.3 }}\r\n          className=\"flex flex-wrap gap-3\"\r\n        >\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={() => router.push('/admin/network-map')}\r\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50\"\r\n          >\r\n            <Globe weight=\"duotone\" className=\"w-4 h-4 text-primary\" />\r\n            Network Map\r\n          </Button>\r\n          <Button \r\n            onClick={() => setShowRegisterModal(true)}\r\n            className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\"\r\n          >\r\n            <Plus weight=\"bold\" className=\"w-4 h-4\" />\r\n            Register Clinic\r\n          </Button>\r\n          <Button \r\n            variant=\"outline\"\r\n            className=\"bg-emerald-500/5 border-emerald-500/20 text-emerald-500 hover:bg-emerald-500/10 gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest\"\r\n            onClick={() => setShowUserModal(true)}\r\n          >\r\n            <Users weight=\"bold\" className=\"w-4 h-4\" />\r\n            Initialize Owner\r\n          </Button>\r\n        </motion.div>\r\n      </div>\r\n\r\n      {/* Global Stats */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\r\n        {stats.map((stat, i) => (\r\n          <StatCard\r\n            key={stat.label}\r\n            title={stat.label}\r\n            value={stat.value}\r\n            icon={stat.icon}\r\n            trend={stat.trend}\r\n            change={stat.change}\r\n            suffix={stat.suffix}\r\n            className=\"p-4\"\r\n          />\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-10 px-2\">\r\n        {/* Left: Clinic Management */}\r\n        <div className=\"lg:col-span-2 space-y-8\">\r\n          <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n            <div className=\"absolute top-0 right-0 p-12 opacity-[0.02] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n              <Buildings className=\"w-64 h-64 text-primary\" />\r\n            </div>\r\n\r\n            <CardHeader className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 border-b border-border/50 p-8 bg-secondary/30\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n                  <IdentificationBadge weight=\"duotone\" className=\"w-6 h-6\" />\r\n                </div>\r\n                <div>\r\n                  <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Global Clinic Registry</CardTitle>\r\n                  <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] mt-0.5\">Managed cluster instances</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"relative group w-full md:w-72\">\r\n                <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-xl\" />\r\n                <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\r\n                <input \r\n                  type=\"text\" \r\n                  placeholder=\"Query cluster nodes...\" \r\n                  className=\"w-full bg-card border border-border/50 rounded-2xl py-3 pl-11 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\r\n                />\r\n              </div>\r\n            </CardHeader>\r\n\r\n            <CardContent className=\"p-8\">\r\n              <div className=\"space-y-4\">\r\n                {clinics.map((clinic, idx) => (\r\n                  <motion.div\r\n                    key={clinic.id}\r\n                    initial={{ opacity: 0, x: -20 }}\r\n                    animate={{ opacity: 1, x: 0 }}\r\n                    transition={{ delay: 0.1 + idx * 0.05 }}\r\n                    className=\"p-5 bg-secondary/20 rounded-[28px] border border-border/50 hover:border-primary/30 hover:bg-secondary/40 transition-all group/item flex flex-col md:flex-row md:items-center justify-between gap-6 relative overflow-hidden\"\r\n                  >\r\n                    <div className=\"flex items-center gap-5 relative z-10\">\r\n                      <div className=\"w-14 h-14 rounded-2xl bg-card border border-border flex items-center justify-center text-muted-foreground group-hover/item:bg-primary/10 group-hover/item:text-primary transition-all duration-500 shadow-inner\">\r\n                        <Buildings weight=\"duotone\" className=\"w-7 h-7\" />\r\n                      </div>\r\n                      <div className=\"space-y-1 min-w-0\">\r\n                        <h4 className=\"text-base font-bold text-foreground group-hover/item:text-primary transition-colors tracking-tight truncate uppercase\">{clinic.name}</h4>\r\n                        <div className=\"flex flex-wrap items-center gap-3\">\r\n                          <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[8px] uppercase tracking-widest px-3\">\r\n                            {clinic.plan}\r\n                          </Badge>\r\n                          <div className=\"w-1 h-1 rounded-full bg-border\" />\r\n                          <span className=\"text-[10px] font-mono text-muted-foreground tracking-widest uppercase\">\r\n                            NODE-{clinic.id.slice(0, 8).toUpperCase()}\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex flex-wrap items-center gap-8 md:gap-10 relative z-10\">\r\n                      <div className=\"flex gap-8\">\r\n                        <div className=\"text-center min-w-[60px]\">\r\n                          <p className=\"text-lg font-black text-foreground tabular-nums tracking-tight\">{clinic.customerCount.toLocaleString()}</p>\r\n                          <p className=\"text-[8px] text-muted-foreground uppercase font-black tracking-widest\">Entities</p>\r\n                        </div>\r\n                        <div className=\"text-center min-w-[60px]\">\r\n                          <p className=\"text-lg font-black text-foreground tabular-nums tracking-tight\">{clinic.staffCount.toLocaleString()}</p>\r\n                          <p className=\"text-[8px] text-muted-foreground uppercase font-black tracking-widest\">Personnel</p>\r\n                        </div>\r\n                      </div>\r\n                      \r\n                      <div className=\"flex items-center gap-4\">\r\n                        <button \r\n                          onClick={() => handleUpdateStatus(clinic.id, clinic.status)}\r\n                          className={cn(\r\n                            \"px-5 py-2 rounded-full text-[9px] font-black uppercase tracking-[0.2em] transition-all border shadow-sm\",\r\n                            clinic.status === 'active' \r\n                              ? \"bg-emerald-500/5 text-emerald-500 border-emerald-500/20 hover:bg-emerald-500/10\" \r\n                              : \"bg-rose-500/5 text-rose-500 border-rose-500/20 hover:bg-rose-500/10\"\r\n                          )}\r\n                        >\r\n                          {clinic.status === 'active' ? 'Operational' : 'Offline'}\r\n                        </button>\r\n                        <Button \r\n                          variant=\"ghost\"\r\n                          size=\"sm\"\r\n                          onClick={() => router.push(`/admin/clinics/${clinic.id}`)}\r\n                          className=\"h-10 w-10 p-0 rounded-xl hover:bg-primary/10 hover:text-primary transition-all\"\r\n                        >\r\n                          <CaretRight weight=\"bold\" className=\"w-4 h-4\" />\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  </motion.div>\r\n                ))}\r\n              </div>\r\n\r\n              <Button \r\n                variant=\"ghost\" \r\n                className=\"w-full mt-8 py-6 rounded-2xl text-[10px] font-black uppercase tracking-[0.3em] text-muted-foreground hover:text-primary border border-dashed border-border/50\"\r\n              >\r\n                Access Full Cluster Matrix\r\n              </Button>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* Right: System Health & Operations */}\r\n        <div className=\"space-y-8\">\r\n          {/* System Health */}\r\n          <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n            <CardHeader className=\"border-b border-border/50 p-8 bg-secondary/30\">\r\n              <CardTitle className=\"text-sm font-black uppercase tracking-[0.2em] flex items-center gap-3\">\r\n                <div className=\"w-2.5 h-2.5 rounded-full bg-emerald-500 animate-pulse shadow-[0_0_12px_rgba(16,185,129,0.6)]\" />\r\n                Infrastructure Health\r\n              </CardTitle>\r\n            </CardHeader>\r\n            \r\n            <CardContent className=\"p-8 space-y-4\">\r\n              {Object.entries(systemStatus).map(([node, status], idx) => (\r\n                <motion.div \r\n                  key={node} \r\n                  initial={{ opacity: 0, x: 20 }}\r\n                  animate={{ opacity: 1, x: 0 }}\r\n                  transition={{ delay: 0.4 + idx * 0.1 }}\r\n                  className=\"p-4 bg-secondary/20 rounded-2xl border border-border/50 flex justify-between items-center group/health hover:bg-secondary/40 transition-all\"\r\n                >\r\n                  <span className=\"text-[10px] text-muted-foreground font-black uppercase tracking-widest\">\r\n                    {node.replace('_', ' ')}\r\n                  </span>\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <span className=\"text-[9px] font-black text-emerald-500 uppercase tracking-widest\">{status === 'Checking...' ? 'Syncing...' : status}</span>\r\n                    <div className={cn(\"w-1.5 h-1.5 rounded-full shadow-[0_0_8px_rgba(16,185,129,0.5)]\", status === 'Checking...' ? 'bg-muted animate-pulse' : 'bg-emerald-500')} />\r\n                  </div>\r\n                </motion.div>\r\n              ))}\r\n\r\n              <div className=\"p-5 bg-amber-500/5 rounded-[24px] border border-amber-500/10 flex gap-4 relative z-10 backdrop-blur-md mt-6\">\r\n                <WarningCircle weight=\"fill\" className=\"w-6 h-6 text-amber-500 flex-shrink-0\" />\r\n                <p className=\"text-[10px] text-muted-foreground font-medium leading-relaxed italic\">\r\n                  <span className=\"text-amber-500 font-black uppercase tracking-tighter mr-1.5\">Anomaly Detected:</span>\r\n                  Minor latency in vision clusters. Automated regional sync scheduled for 02:00 UTC.\r\n                </p>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* Global Control Tools */}\r\n          <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n            <CardHeader className=\"border-b border-border/50 p-8 bg-secondary/30\">\r\n              <CardTitle className=\"text-sm font-black uppercase tracking-[0.2em] flex items-center gap-3 text-primary\">\r\n                <Gear weight=\"duotone\" className=\"w-5 h-5\" />\r\n                Global Control\r\n              </CardTitle>\r\n            </CardHeader>\r\n            \r\n            <CardContent className=\"p-8\">\r\n              <div className=\"space-y-3\">\r\n                {[\r\n                  { title: \"Distributed Database Backup\", sub: \"Interval: 4h Cycle\", icon: Database },\r\n                  { title: \"Neural Cache Invalidation\", sub: \"AI Gateway & Redis\", icon: Lightning },\r\n                  { title: \"Security Cluster Audit\", sub: \"3 identities expiring\", icon: ShieldCheck }\r\n                ].map((tool, i) => (\r\n                  <motion.button \r\n                    key={i} \r\n                    whileHover={{ x: 4 }}\r\n                    className=\"w-full flex items-center justify-between p-4 bg-secondary/20 border border-border/50 rounded-2xl hover:bg-primary/5 hover:border-primary/20 transition-all text-left group/tool\"\r\n                  >\r\n                    <div className=\"flex items-center gap-4\">\r\n                      <div className=\"w-10 h-10 rounded-xl bg-card border border-border flex items-center justify-center text-muted-foreground group-hover/tool:text-primary transition-colors shadow-inner\">\r\n                        <tool.icon weight=\"duotone\" className=\"w-5 h-5\" />\r\n                      </div>\r\n                      <div className=\"space-y-0.5 min-w-0\">\r\n                        <p className=\"text-xs font-bold text-foreground group-hover/tool:text-primary transition-colors truncate uppercase\">{tool.title}</p>\r\n                        <p className=\"text-[9px] text-muted-foreground italic font-medium truncate uppercase tracking-tighter\">{tool.sub}</p>\r\n                      </div>\r\n                    </div>\r\n                    <CaretRight weight=\"bold\" className=\"w-3.5 h-3.5 text-muted-foreground group-hover/tool:text-primary transition-all\" />\r\n                  </motion.button>\r\n                ))}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Create User Modal - Refined */}\r\n      <AnimatePresence>\r\n        {showUserModal && (\r\n          <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-[200] flex items-center justify-center p-4 overflow-y-auto\">\r\n            <motion.div\r\n              initial={{ opacity: 0, scale: 0.95, y: 20 }}\r\n              animate={{ opacity: 1, scale: 1, y: 0 }}\r\n              exit={{ opacity: 0, scale: 0.95, y: 20 }}\r\n              className=\"relative w-full max-w-lg bg-card border border-border rounded-[40px] overflow-hidden shadow-premium group p-10\"\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                <IdentificationBadge className=\"w-64 h-64 text-primary\" />\r\n              </div>\r\n\r\n              <div className=\"relative z-10 space-y-10\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"flex items-center gap-5\">\r\n                    <div className=\"w-16 h-16 rounded-2xl bg-emerald-500/10 flex items-center justify-center text-emerald-500 border border-emerald-500/20 shadow-sm\">\r\n                      <Users weight=\"duotone\" className=\"w-8 h-8\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-2xl font-bold text-foreground tracking-tight uppercase\">Identity Initialization</h3>\r\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Create clinical administrator node</p>\r\n                    </div>\r\n                  </div>\r\n                  <Button variant=\"ghost\" size=\"sm\" onClick={() => setShowUserModal(false)} className=\"h-10 w-10 p-0 rounded-xl hover:bg-secondary\">\r\n                    <X weight=\"bold\" className=\"w-5 h-5\" />\r\n                  </Button>\r\n                </div>\r\n                \r\n                {userError && (\r\n                  <motion.div \r\n                    initial={{ opacity: 0, y: -10 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    className=\"p-4 bg-rose-500/10 border border-rose-500/20 rounded-2xl flex items-center gap-3\"\r\n                  >\r\n                    <WarningCircle weight=\"fill\" className=\"w-5 h-5 text-rose-500\" />\r\n                    <p className=\"text-rose-500 text-xs font-bold uppercase tracking-widest\">Exception: {userError}</p>\r\n                  </motion.div>\r\n                )}\r\n\r\n                <form onSubmit={handleCreateUser} className=\"space-y-6\">\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Identity Mail node *</label>\r\n                    <div className=\"relative\">\r\n                      <EnvelopeSimple weight=\"bold\" className=\"absolute left-5 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40\" />\r\n                      <input\r\n                        type=\"email\"\r\n                        value={newUser.email}\r\n                        onChange={(e) => setNewUser(prev => ({ ...prev, email: e.target.value }))}\r\n                        placeholder=\"owner@clinical-node.com\"\r\n                        className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-12 pr-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold\"\r\n                        required\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Full Entity Name *</label>\r\n                    <div className=\"relative\">\r\n                      <IdentificationBadge weight=\"bold\" className=\"absolute left-5 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40\" />\r\n                      <input\r\n                        type=\"text\"\r\n                        value={newUser.fullName}\r\n                        onChange={(e) => setNewUser(prev => ({ ...prev, fullName: e.target.value }))}\r\n                        placeholder=\"Clinical Identity Name\"\r\n                        className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-12 pr-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold\"\r\n                        required\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                    <div className=\"space-y-2\">\r\n                      <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Target Cluster *</label>\r\n                      <div className=\"relative\">\r\n                        <Buildings weight=\"bold\" className=\"absolute left-5 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40\" />\r\n                        <select\r\n                          value={newUser.clinicId}\r\n                          onChange={(e) => setNewUser(prev => ({ ...prev, clinicId: e.target.value }))}\r\n                          className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-12 pr-6 text-xs text-foreground focus:border-primary outline-none transition-all appearance-none font-black uppercase tracking-widest\"\r\n                          required\r\n                        >\r\n                          <option value=\"\" className=\"bg-card\">SELECT_CLUSTER</option>\r\n                          {clinics.map(clinic => (\r\n                            <option key={clinic.id} value={clinic.id} className=\"bg-card\">\r\n                              {clinic.name.toUpperCase()}\r\n                            </option>\r\n                          ))}\r\n                        </select>\r\n                        <CaretRight weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 rotate-90 text-muted-foreground/40 pointer-events-none\" />\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                      <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Access Protocol *</label>\r\n                      <div className=\"relative\">\r\n                        <Shield weight=\"bold\" className=\"absolute left-5 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40\" />\r\n                        <select\r\n                          value={newUser.role}\r\n                          onChange={(e) => setNewUser(prev => ({ ...prev, role: e.target.value }))}\r\n                          className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-12 pr-6 text-xs text-foreground focus:border-primary outline-none transition-all appearance-none font-black uppercase tracking-widest\"\r\n                          required\r\n                        >\r\n                          <option value=\"clinic_owner\" className=\"bg-card\">CLINIC_OWNER</option>\r\n                          <option value=\"clinic_admin\" className=\"bg-card\">CLINIC_ADMIN</option>\r\n                          <option value=\"sales_staff\" className=\"bg-card\">SALES_STAFF</option>\r\n                        </select>\r\n                        <CaretRight weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 rotate-90 text-muted-foreground/40 pointer-events-none\" />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"p-5 bg-primary/5 border border-primary/20 rounded-3xl space-y-2\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <Key weight=\"fill\" className=\"w-4 h-4 text-primary\" />\r\n                      <p className=\"text-[10px] font-black text-primary uppercase tracking-widest\">Initial Credentials</p>\r\n                    </div>\r\n                    <p className=\"text-xl font-mono font-black text-foreground tracking-tighter\">BNAura2024!</p>\r\n                    <p className=\"text-[9px] text-muted-foreground font-medium italic\">Identity node must regenerate access token after primary sync.</p>\r\n                  </div>\r\n\r\n                  <div className=\"flex gap-4 pt-4\">\r\n                    <Button\r\n                      type=\"button\"\r\n                      variant=\"outline\"\r\n                      onClick={() => setShowUserModal(false)}\r\n                      className=\"flex-1 py-6 rounded-[24px] text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\"\r\n                    >\r\n                      Abort\r\n                    </Button>\r\n                    <Button\r\n                      type=\"submit\"\r\n                      disabled={creatingUser}\r\n                      className=\"flex-[2] py-6 rounded-[24px] text-[10px] font-black uppercase tracking-widest shadow-premium gap-3\"\r\n                    >\r\n                      {creatingUser ? (\r\n                        <>\r\n                          <SpinnerGap weight=\"bold\" className=\"w-4 h-4 animate-spin\" />\r\n                          Synchronizing...\r\n                        </>\r\n                      ) : (\r\n                        <>\r\n                          <CheckCircle weight=\"bold\" className=\"w-4 h-4\" />\r\n                          Commit Identity\r\n                        </>\r\n                      )}\r\n                    </Button>\r\n                  </div>\r\n                </form>\r\n              </div>\r\n            </motion.div>\r\n          </div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Register Clinic Modal - Comprehensive Overhaul */}\r\n      <AnimatePresence>\r\n        {showRegisterModal && (\r\n          <div className=\"fixed inset-0 z-[200] flex items-center justify-center p-4 overflow-y-auto\">\r\n            <motion.div\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              exit={{ opacity: 0 }}\r\n              className=\"absolute inset-0 bg-black/60 backdrop-blur-sm\"\r\n              onClick={() => setShowRegisterModal(false)}\r\n            />\r\n            \r\n            <motion.div\r\n              initial={{ opacity: 0, scale: 0.95, y: 20 }}\r\n              animate={{ opacity: 1, scale: 1, y: 0 }}\r\n              exit={{ opacity: 0, scale: 0.95, y: 20 }}\r\n              onClick={(e) => e.stopPropagation()}\r\n              className=\"relative w-full max-w-2xl bg-card border border-border rounded-[40px] overflow-hidden shadow-premium group\"\r\n            >\r\n              {/* Background Decor */}\r\n              <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                <Buildings className=\"w-64 h-64 text-primary\" />\r\n              </div>\r\n\r\n              {/* Multi-step Header */}\r\n              <div className=\"relative z-10 p-10 pb-0 space-y-10\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"flex items-center gap-5\">\r\n                    <div className=\"w-16 h-16 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\r\n                      <Buildings weight=\"duotone\" className=\"w-8 h-8\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-2xl font-bold text-foreground tracking-tight uppercase\">Cluster Registration</h3>\r\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Initialize clinical infrastructure node</p>\r\n                    </div>\r\n                  </div>\r\n                  <Button variant=\"ghost\" size=\"sm\" onClick={() => setShowRegisterModal(false)} className=\"h-10 w-10 p-0 rounded-xl hover:bg-secondary\">\r\n                    <X weight=\"bold\" className=\"w-5 h-5\" />\r\n                  </Button>\r\n                </div>\r\n\r\n                {/* Progress Pipeline */}\r\n                <div className=\"flex items-center justify-center gap-4 max-w-md mx-auto\">\r\n                  {[1, 2, 3, 4].map((step) => (\r\n                    <div key={step} className=\"flex items-center flex-1 last:flex-none\">\r\n                      <div className={cn(\r\n                        \"w-10 h-10 rounded-xl border-2 flex items-center justify-center text-xs font-black transition-all duration-500 relative\",\r\n                        registerStep >= step \r\n                          ? \"bg-primary/10 border-primary text-primary shadow-glow-sm\" \r\n                          : \"bg-secondary/50 border-border/50 text-muted-foreground\"\r\n                      )}>\r\n                        {registerStep > step ? <CheckCircle weight=\"bold\" className=\"w-5 h-5\" /> : step}\r\n                        {registerStep === step && (\r\n                          <motion.div layoutId=\"active-step\" className=\"absolute -inset-1.5 bg-primary/5 blur-md rounded-xl z-[-1]\" />\r\n                        )}\r\n                      </div>\r\n                      {step < 4 && (\r\n                        <div className=\"flex-1 h-0.5 mx-4 bg-border/30 relative overflow-hidden\">\r\n                          <motion.div \r\n                            initial={false}\r\n                            animate={{ width: registerStep > step ? '100%' : '0%' }}\r\n                            className=\"absolute inset-0 bg-primary\"\r\n                          />\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"p-10 relative z-10\">\r\n                {registerError && (\r\n                  <motion.div \r\n                    initial={{ opacity: 0, y: -10 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    className=\"mb-8 p-4 bg-rose-500/10 border border-rose-500/20 rounded-2xl flex items-center gap-3\"\r\n                  >\r\n                    <WarningCircle weight=\"fill\" className=\"w-5 h-5 text-rose-500\" />\r\n                    <p className=\"text-rose-500 text-xs font-bold uppercase tracking-widest\">Exception: {registerError}</p>\r\n                  </motion.div>\r\n                )}\r\n\r\n                <form onSubmit={handleRegisterClinic} className=\"space-y-8\">\r\n                  {/* Step 1: Basic Node Intel */}\r\n                  {registerStep === 1 && (\r\n                    <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} className=\"space-y-6\">\r\n                      <div className=\"space-y-2\">\r\n                        <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Node Identity Name *</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={newClinic.name}\r\n                          onChange={(e) => setNewClinic(prev => ({ ...prev, name: e.target.value }))}\r\n                          placeholder=\"e.g. BN_PREMIUM_CLINIC_NODE_01\"\r\n                          required\r\n                          className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold\"\r\n                        />\r\n                      </div>\r\n\r\n                      <div className=\"grid grid-cols-2 gap-6\">\r\n                        <div className=\"space-y-2\">\r\n                          <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Transmission Mail *</label>\r\n                          <input\r\n                            type=\"email\"\r\n                            value={newClinic.email}\r\n                            onChange={(e) => setNewClinic(prev => ({ ...prev, email: e.target.value }))}\r\n                            placeholder=\"node@cluster.com\"\r\n                            required\r\n                            className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold\"\r\n                          />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                          <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Comm Channel</label>\r\n                          <input\r\n                            type=\"tel\"\r\n                            value={newClinic.phone}\r\n                            onChange={(e) => setNewClinic(prev => ({ ...prev, phone: e.target.value }))}\r\n                            placeholder=\"+66 00-000-0000\"\r\n                            className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold\"\r\n                          />\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"grid grid-cols-2 gap-6\">\r\n                        <div className=\"space-y-2\">\r\n                          <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Protocol Tier *</label>\r\n                          <div className=\"relative\">\r\n                            <select\r\n                              value={newClinic.plan}\r\n                              onChange={(e) => setNewClinic(prev => ({ ...prev, plan: e.target.value }))}\r\n                              className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-xs text-foreground focus:border-primary outline-none transition-all appearance-none font-black uppercase tracking-widest\"\r\n                            >\r\n                              <option value=\"starter\" className=\"bg-card\">STARTER (เธฟ2,900)</option>\r\n                              <option value=\"professional\" className=\"bg-card\">PROFESSIONAL (เธฟ4,900)</option>\r\n                              <option value=\"premium\" className=\"bg-card\">PREMIUM (เธฟ7,900)</option>\r\n                              <option value=\"enterprise\" className=\"bg-card\">ENTERPRISE (เธฟ12,900)</option>\r\n                            </select>\r\n                            <CaretRight weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 rotate-90 text-muted-foreground/40 pointer-events-none\" />\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                          <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Industry Logic *</label>\r\n                          <div className=\"relative\">\r\n                            <select\r\n                              value={newClinic.businessType}\r\n                              onChange={(e) => setNewClinic(prev => ({ ...prev, businessType: e.target.value }))}\r\n                              className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-xs text-foreground focus:border-primary outline-none transition-all appearance-none font-black uppercase tracking-widest\"\r\n                            >\r\n                              <option value=\"clinic\" className=\"bg-card\">AESTHETIC_CLINIC</option>\r\n                              <option value=\"hospital\" className=\"bg-card\">MEDICAL_FACILITY</option>\r\n                              <option value=\"spa\" className=\"bg-card\">WELLNESS_NODE</option>\r\n                              <option value=\"aesthetic_center\" className=\"bg-card\">CENTRAL_HUB</option>\r\n                            </select>\r\n                            <CaretRight weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 rotate-90 text-muted-foreground/40 pointer-events-none\" />\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </motion.div>\r\n                  )}\r\n\r\n                  {/* Step 2: Business Logic Registry */}\r\n                  {registerStep === 2 && (\r\n                    <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} className=\"space-y-6\">\r\n                      <div className=\"grid grid-cols-2 gap-6\">\r\n                        <div className=\"space-y-2\">\r\n                          <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Company Registration</label>\r\n                          <input\r\n                            type=\"text\"\r\n                            value={newClinic.companyRegistration}\r\n                            onChange={(e) => setNewClinic(prev => ({ ...prev, companyRegistration: e.target.value }))}\r\n                            placeholder=\"010XXXXXXXXXX\"\r\n                            className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold\"\r\n                          />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                          <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Tax Identity Node</label>\r\n                          <input\r\n                            type=\"text\"\r\n                            value={newClinic.taxId}\r\n                            onChange={(e) => setNewClinic(prev => ({ ...prev, taxId: e.target.value }))}\r\n                            placeholder=\"TXN-XXXXXXXXXX\"\r\n                            className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold\"\r\n                          />\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"grid grid-cols-3 gap-6\">\r\n                        <div className=\"space-y-2\">\r\n                          <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Registry Year</label>\r\n                          <input\r\n                            type=\"number\"\r\n                            value={newClinic.establishedYear}\r\n                            onChange={(e) => setNewClinic(prev => ({ ...prev, establishedYear: e.target.value }))}\r\n                            placeholder=\"2024\"\r\n                            className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold tabular-nums\"\r\n                          />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                          <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Personnel count</label>\r\n                          <div className=\"relative\">\r\n                            <select\r\n                              value={newClinic.numberOfStaff}\r\n                              onChange={(e) => setNewClinic(prev => ({ ...prev, numberOfStaff: e.target.value }))}\r\n                              className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-[10px] text-foreground focus:border-primary outline-none transition-all appearance-none font-black uppercase tracking-widest\"\r\n                            >\r\n                              <option value=\"\" className=\"bg-card\">SELECT_CAP</option>\r\n                              <option value=\"1-5\" className=\"bg-card\">1-5 UNITS</option>\r\n                              <option value=\"6-10\" className=\"bg-card\">6-10 UNITS</option>\r\n                              <option value=\"11-20\" className=\"bg-card\">11-20 UNITS</option>\r\n                              <option value=\"21-50\" className=\"bg-card\">21-50 UNITS</option>\r\n                              <option value=\"50+\" className=\"bg-card\">50+ UNITS</option>\r\n                            </select>\r\n                            <CaretRight weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 rotate-90 text-muted-foreground/40 pointer-events-none\" />\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                          <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Cluster Nodes</label>\r\n                          <input\r\n                            type=\"number\"\r\n                            value={newClinic.numberOfBranches}\r\n                            onChange={(e) => setNewClinic(prev => ({ ...prev, numberOfBranches: e.target.value }))}\r\n                            placeholder=\"1\"\r\n                            min=\"1\"\r\n                            className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold tabular-nums\"\r\n                          />\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"space-y-2\">\r\n                        <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Public Domain Endpoint</label>\r\n                        <div className=\"relative\">\r\n                          <Globe weight=\"bold\" className=\"absolute left-5 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40\" />\r\n                          <input\r\n                            type=\"url\"\r\n                            value={newClinic.website}\r\n                            onChange={(e) => setNewClinic(prev => ({ ...prev, website: e.target.value }))}\r\n                            placeholder=\"https://clinical-node.network\"\r\n                            className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-12 pr-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold\"\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                    </motion.div>\r\n                  )}\r\n\r\n                  {/* Step 3: Fiscal & Marketing Parameters */}\r\n                  {registerStep === 3 && (\r\n                    <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} className=\"space-y-6\">\r\n                      <div className=\"grid grid-cols-2 gap-6\">\r\n                        <div className=\"space-y-2\">\r\n                          <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Yield Band Node</label>\r\n                          <div className=\"relative\">\r\n                            <select\r\n                              value={newClinic.monthlyRevenue}\r\n                              onChange={(e) => setNewClinic(prev => ({ ...prev, monthlyRevenue: e.target.value }))}\r\n                              className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-[10px] text-foreground focus:border-primary outline-none transition-all appearance-none font-black uppercase tracking-widest\"\r\n                            >\r\n                              <option value=\"\" className=\"bg-card\">SELECT_BAND</option>\r\n                              <option value=\"<100k\" className=\"bg-card\">LESS THAN เธฟ100K</option>\r\n                              <option value=\"100k-300k\" className=\"bg-card\">เธฟ100K - เธฟ300K</option>\r\n                              <option value=\"300k-500k\" className=\"bg-card\">เธฟ300K - เธฟ500K</option>\r\n                              <option value=\"500k-1m\" className=\"bg-card\">เธฟ500K - เธฟ1M</option>\r\n                              <option value=\">1m\" className=\"bg-card\">EXCEEDS เธฟ1M</option>\r\n                            </select>\r\n                            <CaretRight weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 rotate-90 text-muted-foreground/40 pointer-events-none\" />\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                          <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">IT Fiscal Quota</label>\r\n                          <div className=\"relative\">\r\n                            <select\r\n                              value={newClinic.itBudget}\r\n                              onChange={(e) => setNewClinic(prev => ({ ...prev, itBudget: e.target.value }))}\r\n                              className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-[10px] text-foreground focus:border-primary outline-none transition-all appearance-none font-black uppercase tracking-widest\"\r\n                            >\r\n                              <option value=\"\" className=\"bg-card\">SELECT_QUOTA</option>\r\n                              <option value=\"<50k\" className=\"bg-card\">UNDER เธฟ50K</option>\r\n                              <option value=\"50k-100k\" className=\"bg-card\">เธฟ50K - เธฟ100K</option>\r\n                              <option value=\">100k\" className=\"bg-card\">OVER เธฟ100K</option>\r\n                            </select>\r\n                            <CaretRight weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 rotate-90 text-muted-foreground/40 pointer-events-none\" />\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"grid grid-cols-2 gap-6\">\r\n                        <div className=\"space-y-2\">\r\n                          <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Settlement Node</label>\r\n                          <div className=\"relative\">\r\n                            <select\r\n                              value={newClinic.paymentMethod}\r\n                              onChange={(e) => setNewClinic(prev => ({ ...prev, paymentMethod: e.target.value }))}\r\n                              className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-[10px] text-foreground focus:border-primary outline-none transition-all appearance-none font-black uppercase tracking-widest\"\r\n                            >\r\n                              <option value=\"bank_transfer\" className=\"bg-card\">BANK_TRANSFER</option>\r\n                              <option value=\"credit_card\" className=\"bg-card\">CREDIT_CARD</option>\r\n                              <option value=\"direct_debit\" className=\"bg-card\">DIRECT_DEBIT</option>\r\n                            </select>\r\n                            <CaretRight weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 rotate-90 text-muted-foreground/40 pointer-events-none\" />\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                          <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Cycle Term</label>\r\n                          <div className=\"relative\">\r\n                            <select\r\n                              value={newClinic.paymentTerm}\r\n                              onChange={(e) => setNewClinic(prev => ({ ...prev, paymentTerm: e.target.value }))}\r\n                              className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-[10px] text-foreground focus:border-primary outline-none transition-all appearance-none font-black uppercase tracking-widest\"\r\n                            >\r\n                              <option value=\"monthly\" className=\"bg-card\">MONTHLY_SYNC</option>\r\n                              <option value=\"quarterly\" className=\"bg-card\">QUARTERLY_SYNC</option>\r\n                              <option value=\"yearly\" className=\"bg-card\">ANNUAL_SYNC</option>\r\n                            </select>\r\n                            <CaretRight weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 rotate-90 text-muted-foreground/40 pointer-events-none\" />\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"space-y-2\">\r\n                        <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Lead Attribution Matrix</label>\r\n                        <div className=\"relative\">\r\n                          <Target weight=\"bold\" className=\"absolute left-5 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40\" />\r\n                          <select\r\n                            value={newClinic.leadSource}\r\n                            onChange={(e) => setNewClinic(prev => ({ ...prev, leadSource: e.target.value }))}\r\n                            className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-12 pr-6 text-[10px] text-foreground focus:border-primary outline-none transition-all appearance-none font-black uppercase tracking-widest\"\r\n                          >\r\n                            <option value=\"\" className=\"bg-card\">SELECT_SOURCE</option>\r\n                            <option value=\"google_ads\" className=\"bg-card\">GOOGLE_ENGINE_ADS</option>\r\n                            <option value=\"facebook_ads\" className=\"bg-card\">META_SOCIAL_ADS</option>\r\n                            <option value=\"instagram\" className=\"bg-card\">IG_VISUAL_NODE</option>\r\n                            <option value=\"referral\" className=\"bg-card\">NETWORK_REFERRAL</option>\r\n                            <option value=\"walk_in\" className=\"bg-card\">PHYSICAL_WALK_IN</option>\r\n                          </select>\r\n                          <CaretRight weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 rotate-90 text-muted-foreground/40 pointer-events-none\" />\r\n                        </div>\r\n                      </div>\r\n                    </motion.div>\r\n                  )}\r\n\r\n                  {/* Step 4: Technical Stack Integration */}\r\n                  {registerStep === 4 && (\r\n                    <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} className=\"space-y-6\">\r\n                      <div className=\"space-y-2\">\r\n                        <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Current Legacy Architecture</label>\r\n                        <textarea\r\n                          value={newClinic.currentSystem}\r\n                          onChange={(e) => setNewClinic(prev => ({ ...prev, currentSystem: e.target.value }))}\r\n                          placeholder=\"Describe current system topography...\"\r\n                          rows={3}\r\n                          className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold resize-none\"\r\n                        />\r\n                      </div>\r\n\r\n                      <div className=\"space-y-2\">\r\n                        <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Cross-system Link Requirements</label>\r\n                        <textarea\r\n                          value={newClinic.integrationNeeds}\r\n                          onChange={(e) => setNewClinic(prev => ({ ...prev, integrationNeeds: e.target.value }))}\r\n                          placeholder=\"List required API endpoints and system links...\"\r\n                          rows={3}\r\n                          className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold resize-none\"\r\n                        />\r\n                      </div>\r\n\r\n                      <div className=\"space-y-2\">\r\n                        <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Synchronisation Velocity</label>\r\n                        <div className=\"relative\">\r\n                          <Lightning weight=\"bold\" className=\"absolute left-5 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40\" />\r\n                          <select\r\n                            value={newClinic.timeline}\r\n                            onChange={(e) => setNewClinic(prev => ({ ...prev, timeline: e.target.value }))}\r\n                            className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-12 pr-6 text-[10px] text-foreground focus:border-primary outline-none transition-all appearance-none font-black uppercase tracking-widest\"\r\n                          >\r\n                            <option value=\"urgent\" className=\"bg-card\">HIGH_PRIORITY (1 WEEK)</option>\r\n                            <option value=\"normal\" className=\"bg-card\">STANDARD_SYNC (2-4 WEEKS)</option>\r\n                            <option value=\"flexible\" className=\"bg-card\">EXTENDED_WINDOW (1-2 MONTHS)</option>\r\n                          </select>\r\n                          <CaretRight weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 rotate-90 text-muted-foreground/40 pointer-events-none\" />\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"p-5 bg-primary/5 border border-primary/20 rounded-3xl flex gap-4 mt-6\">\r\n                        <ShieldCheck weight=\"fill\" className=\"w-6 h-6 text-primary flex-shrink-0\" />\r\n                        <div className=\"space-y-1\">\r\n                          <p className=\"text-[10px] font-black text-primary uppercase tracking-widest\">Protocol Confirmation</p>\r\n                          <p className=\"text-[9px] text-muted-foreground font-medium italic\">Parameters can be refined in cluster settings post-initialization.</p>\r\n                        </div>\r\n                      </div>\r\n                    </motion.div>\r\n                  )}\r\n\r\n                  <div className=\"flex gap-4 pt-6\">\r\n                    {registerStep > 1 && (\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"outline\"\r\n                        onClick={() => setRegisterStep(prev => prev - 1)}\r\n                        className=\"flex-1 py-6 rounded-[24px] text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\"\r\n                      >\r\n                        Back Cycle\r\n                      </Button>\r\n                    )}\r\n                    \r\n                    {registerStep < 4 ? (\r\n                      <Button\r\n                        type=\"button\"\r\n                        onClick={() => setRegisterStep(prev => prev + 1)}\r\n                        className=\"flex-1 py-6 rounded-[24px] text-[10px] font-black uppercase tracking-widest shadow-premium gap-3\"\r\n                      >\r\n                        Advance Protocol\r\n                        <CaretRight weight=\"bold\" className=\"w-4 h-4\" />\r\n                      </Button>\r\n                    ) : (\r\n                      <Button\r\n                        type=\"submit\"\r\n                        disabled={registering}\r\n                        className=\"flex-[2] py-6 rounded-[24px] text-[10px] font-black uppercase tracking-widest shadow-premium gap-3\"\r\n                      >\r\n                        {registering ? (\r\n                          <>\r\n                            <SpinnerGap weight=\"bold\" className=\"w-4 h-4 animate-spin\" />\r\n                            Initializing...\r\n                          </>\r\n                        ) : (\r\n                          <>\r\n                            <Buildings weight=\"bold\" className=\"w-4 h-4\" />\r\n                            Initialize Cluster\r\n                          </>\r\n                        )}\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                </form>\r\n              </div>\r\n            </motion.div>\r\n          </div>\r\n        )}\r\n      </AnimatePresence>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\permissions\\components\\NavigationTabs.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Icon' is defined but never used.","line":3,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":35,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Icon"},"fix":{"range":[43,49],"text":""},"desc":"Remove unused variable \"Icon\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { Shield, Users, Lock, Icon } from '@phosphor-icons/react';\nimport { usePermissionsContext } from '../context';\nimport { useTranslations } from 'next-intl';\nimport { cn } from '@/lib/utils';\nimport { motion } from 'framer-motion';\n\nexport default function NavigationTabs() {\n  const { activeTab, setActiveTab } = usePermissionsContext();\n  const t = useTranslations('admin.permissions');\n\n  const tabs = [\n    { id: 'roles' as const, label: t('roles'), icon: Shield },\n    { id: 'users' as const, label: t('users'), icon: Users },\n    { id: 'permissions' as const, label: t('permissions_list'), icon: Lock }\n  ];\n\n  return (\n    <div className=\"flex bg-secondary/50 border border-border/50 p-1.5 rounded-[24px] shadow-inner relative overflow-hidden\">\n      <div className=\"flex w-full items-center gap-2 relative z-10\">\n        {tabs.map((tab) => (\n          <button\n            key={tab.id}\n            onClick={() => setActiveTab(tab.id)}\n            className={cn(\n              \"flex-1 flex items-center justify-center gap-3 py-3 px-6 rounded-2xl transition-all text-[10px] font-black uppercase tracking-widest border relative group\",\n              activeTab === tab.id\n                ? \"bg-card text-primary border-border/50 shadow-sm\"\n                : \"text-muted-foreground border-transparent hover:text-foreground hover:bg-secondary/50\"\n            )}\n          >\n            <tab.icon weight={activeTab === tab.id ? \"fill\" : \"bold\"} className={cn(\"w-4 h-4 transition-transform group-hover:scale-110\", activeTab === tab.id ? \"text-primary\" : \"opacity-60\")} />\n            <span className=\"relative z-10\">{tab.label}</span>\n            {activeTab === tab.id && (\n              <motion.div \n                layoutId=\"active-permission-tab\"\n                className=\"absolute inset-0 bg-primary/5 rounded-2xl z-[-1]\"\n                transition={{ type: \"spring\", stiffness: 500, damping: 35 }}\n              />\n            )}\n          </button>\n        ))}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\permissions\\components\\PermissionsHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\permissions\\components\\PermissionsList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pulse' is defined but never used.","line":6,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":40,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pulse"},"fix":{"range":[191,198],"text":""},"desc":"Remove unused variable \"Pulse\"."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Buildings' is not defined.","line":13,"column":30,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":13,"endColumn":39},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Users' is not defined.","line":14,"column":29,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":14,"endColumn":34},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'CalendarDots' is not defined.","line":15,"column":36,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":15,"endColumn":48},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'ChartBar' is not defined.","line":16,"column":31,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":16,"endColumn":39},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Lightning' is not defined.","line":17,"column":26,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":17,"endColumn":35},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Shield' is not defined.","line":18,"column":29,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":18,"endColumn":35},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Lock' is not defined.","line":19,"column":24,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":19,"endColumn":28},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":44,"column":6,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":44,"endColumn":12},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":69,"column":18,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":69,"endColumn":24}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { Card, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { cn } from '@/lib/utils';\r\nimport { CaretRight, ShieldCheck, Pulse } from '@phosphor-icons/react';\r\n\r\nexport default function PermissionsList() {\r\n  const { permissions } = usePermissionsContext();\r\n\r\n  const getPermissionIcon = (category: string) => {\r\n    switch (category) {\r\n      case 'Clinic': return <Buildings className=\"w-4 h-4 text-blue-400\" />;\r\n      case 'Staff': return <Users className=\"w-4 h-4 text-green-400\" />;\r\n      case 'Appointments': return <CalendarDots className=\"w-4 h-4 text-purple-400\" />;\r\n      case 'Reports': return <ChartBar className=\"w-4 h-4 text-amber-400\" />;\r\n      case 'AI': return <Lightning className=\"w-4 h-4 text-orange-400\" />;\r\n      case 'Sales': return <Shield className=\"w-4 h-4 text-cyan-400\" />;\r\n      default: return <Lock className=\"w-4 h-4 text-gray-400\" />;\r\n    }\r\n  };\r\n\r\n  const getCategoryColor = (category: string) => {\r\n    switch (category) {\r\n      case 'Clinic': return 'bg-blue-500/20 text-blue-400';\r\n      case 'Staff': return 'bg-green-500/20 text-green-400';\r\n      case 'Appointments': return 'bg-purple-500/20 text-purple-400';\r\n      case 'Reports': return 'bg-amber-500/20 text-amber-400';\r\n      case 'AI': return 'bg-orange-500/20 text-orange-400';\r\n      case 'Sales': return 'bg-cyan-500/20 text-cyan-400';\r\n      default: return 'bg-gray-500/20 text-gray-400';\r\n    }\r\n  };\r\n\r\n  const groupedPermissions = permissions.reduce((acc, permission) => {\r\n    if (!acc[permission.category]) {\r\n      acc[permission.category] = [];\r\n    }\r\n    acc[permission.category].push(permission);\r\n    return acc;\r\n  }, {} as Record<string, typeof permissions>);\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0, y: 20 }}\r\n      animate={{ opacity: 1, y: 0 }}\r\n      className=\"space-y-10\"\r\n    >\r\n      {Object.entries(groupedPermissions).map(([category, categoryPermissions], idx) => (\r\n        <Card key={category} className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n          <CardContent className=\"p-8 md:p-10 space-y-10\">\r\n            <div className=\"flex items-center justify-between relative z-10\">\r\n              <div className=\"flex items-center gap-5\">\r\n                <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm transition-all group-hover:bg-primary/20\">\r\n                  {getPermissionIcon(category)}\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"text-2xl font-black uppercase tracking-tight text-foreground\">{category} Protocol</h3>\r\n                  <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] mt-1\">Access control nodes for clinical operations</p>\r\n                </div>\r\n              </div>\r\n              <Badge variant=\"ghost\" className={cn(\"border-none font-black text-[10px] tracking-[0.2em] px-4 py-2 rounded-full uppercase shadow-sm\", getCategoryColor(category))}>\r\n                {categoryPermissions.length} NODES_ENABLED\r\n              </Badge>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8 relative z-10\">\r\n              {categoryPermissions.map((permission, pIdx) => (\r\n                <motion.div\r\n                  key={permission.id}\r\n                  initial={{ opacity: 0, scale: 0.95 }}\r\n                  animate={{ opacity: 1, scale: 1 }}\r\n                  transition={{ delay: (idx * 0.1) + (pIdx * 0.05) }}\r\n                  whileHover={{ y: -2 }}\r\n                  className=\"p-6 bg-secondary/30 rounded-[32px] border border-border/50 hover:border-primary/30 transition-all flex flex-col justify-between group/perm shadow-inner\"\r\n                >\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"flex items-start justify-between gap-4\">\r\n                      <h4 className=\"font-bold text-foreground group-hover/perm:text-primary transition-colors uppercase tracking-tight leading-tight\">{permission.name}</h4>\r\n                      <Badge variant=\"ghost\" className=\"font-mono text-[9px] text-primary/60 bg-primary/5 border-none px-2 py-0.5 tracking-tighter\">\r\n                        {permission.id}\r\n                      </Badge>\r\n                    </div>\r\n                    <p className=\"text-xs text-muted-foreground font-medium italic leading-relaxed opacity-80\">{permission.description}</p>\r\n                  </div>\r\n                  \r\n                  <div className=\"pt-5 mt-5 border-t border-border/30 flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <div className=\"w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.6)]\" />\r\n                      <span className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest\">Active Link</span>\r\n                    </div>\r\n                    <CaretRight weight=\"bold\" className=\"w-3 h-3 text-muted-foreground opacity-0 group-hover/perm:opacity-100 group-hover/perm:translate-x-1 transition-all\" />\r\n                  </div>\r\n                </motion.div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      ))}\r\n\r\n      {/* Protocol Integrity Node */}\r\n      <Card className=\"p-8 rounded-[40px] border-primary/10 bg-primary/[0.02] flex flex-col md:flex-row items-center gap-8 relative overflow-hidden group shadow-inner\">\r\n        <div className=\"absolute -bottom-12 -right-12 w-48 h-48 bg-primary/5 blur-[60px] rounded-full group-hover:bg-primary/10 transition-all duration-700\" />\r\n        <div className=\"w-16 h-16 rounded-[28px] bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner group-hover:scale-110 transition-transform\">\r\n          <ShieldCheck weight=\"duotone\" className=\"w-8 h-8\" />\r\n        </div>\r\n        <div className=\"flex-1 space-y-1 relative z-10 text-center md:text-left\">\r\n          <h4 className=\"text-[10px] font-black text-foreground uppercase tracking-[0.3em]\">Protocol Verification Node</h4>\r\n          <p className=\"text-xs text-muted-foreground font-medium italic leading-relaxed opacity-80\">\r\n            System permissions are strictly governed by the clinical orchestration layer. All modifications propagate across 128-bit encrypted neural channels.\r\n          </p>\r\n        </div>\r\n        <Badge variant=\"success\" size=\"sm\" className=\"font-black text-[9px] tracking-[0.2em] px-5 py-2 rounded-full shadow-sm relative z-10\">SECURE_PARITY</Badge>\r\n      </Card>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\permissions\\components\\RolesGrid.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":3,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AnimatePresence"},"fix":{"range":[32,49],"text":""},"desc":"Remove unused variable \"AnimatePresence\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pulse' is defined but never used.","line":4,"column":104,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":109,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pulse"},"fix":{"range":[176,183],"text":""},"desc":"Remove unused variable \"Pulse\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":4,"column":111,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":130,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[183,204],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sparkle' is defined but never used.","line":4,"column":132,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":139,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Sparkle"},"fix":{"range":[204,213],"text":""},"desc":"Remove unused variable \"Sparkle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Icon' is defined but never used.","line":4,"column":141,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":145,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Icon"},"fix":{"range":[213,219],"text":""},"desc":"Remove unused variable \"Icon\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":7,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[365,376],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[520,553],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { Shield, Users, Buildings, Gear, ChartBar, Lock, PencilSimple, Trash, MagnifyingGlass, Funnel, Pulse, IdentificationBadge, Sparkle, Icon } from '@phosphor-icons/react';\r\nimport { usePermissionsContext } from '../context';\r\nimport { Role } from '../types';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { cn } from '@/lib/utils';\r\n\r\ninterface RolesGridProps {\r\n  onEditRole: (role: Role) => void;\r\n}\r\n\r\nexport default function RolesGrid({ onEditRole }: RolesGridProps) {\r\n  const { roles, searchTerm, setSearchTerm } = usePermissionsContext();\r\n\r\n  const getRoleIcon = (roleId: string) => {\r\n    switch (roleId) {\r\n      case 'super_admin': return <Shield className=\"w-5 h-5 text-red-400\" />;\r\n      case 'clinic_owner': return <Buildings className=\"w-5 h-5 text-purple-400\" />;\r\n      case 'clinic_admin': return <Users className=\"w-5 h-5 text-blue-400\" />;\r\n      case 'clinic_staff': return <Gear className=\"w-5 h-5 text-green-400\" />;\r\n      case 'sales_staff': return <ChartBar className=\"w-5 h-5 text-amber-400\" />;\r\n      default: return <Lock className=\"w-5 h-5 text-gray-400\" />;\r\n    }\r\n  };\r\n\r\n  const filteredRoles = roles.filter(role =>\r\n    role.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    role.description.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0, y: 20 }}\r\n      animate={{ opacity: 1, y: 0 }}\r\n      className=\"space-y-8\"\r\n    >\r\n      {/* Search & Intelligence Controls */}\r\n      <Card className=\"p-6 rounded-[32px] border-border/50 shadow-card relative overflow-hidden group\">\r\n        <div className=\"flex flex-col md:flex-row gap-6 relative z-10\">\r\n          <div className=\"relative flex-1 group/input\">\r\n            <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\r\n            <MagnifyingGlass weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Query protocol role designation or description...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              className=\"w-full pl-12 pr-4 py-3.5 bg-secondary/50 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10 font-bold\"\r\n            />\r\n          </div>\r\n          <Button variant=\"outline\" className=\"gap-2 px-8 py-3.5 rounded-2xl text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary shrink-0\">\r\n            <Funnel weight=\"bold\" className=\"w-4 h-4\" />\r\n            Registry Filter\r\n          </Button>\r\n        </div>\r\n      </Card>\r\n\r\n      {/* Roles Matrix Grid */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\r\n        {filteredRoles.map((role, idx) => (\r\n          <motion.div\r\n            key={role.id}\r\n            initial={{ opacity: 0, scale: 0.95 }}\r\n            animate={{ opacity: 1, scale: 1 }}\r\n            transition={{ delay: idx * 0.05 }}\r\n          >\r\n            <Card className=\"h-full border-border/50 hover:border-primary/30 transition-all group/role overflow-hidden flex flex-col shadow-card hover:shadow-premium\">\r\n              <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover/role:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                <Shield weight=\"fill\" className=\"w-32 h-32 text-primary\" />\r\n              </div>\r\n\r\n              <CardHeader className=\"pb-4 relative z-10\">\r\n                <div className=\"flex justify-between items-start\">\r\n                  <div className=\"flex items-center gap-4\">\r\n                    <div className=\"w-12 h-12 rounded-2xl bg-secondary border border-border/50 flex items-center justify-center text-primary group-hover/role:bg-primary/10 group-hover/role:border-primary/20 transition-all duration-500 shadow-inner\">\r\n                      {getRoleIcon(role.id)}\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"font-black text-foreground uppercase tracking-tight group-hover/role:text-primary transition-colors\">{role.name}</h3>\r\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-0.5 opacity-60\">\r\n                        {role.userCount} Active Nodes\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {!role.isSystem && (\r\n                    <div className=\"flex gap-1 opacity-0 group-hover/role:opacity-100 transition-opacity\">\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => onEditRole(role)}\r\n                        className=\"h-8 w-8 p-0 rounded-lg hover:bg-primary/10 text-muted-foreground hover:text-primary transition-all\"\r\n                      >\r\n                        <PencilSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n                      </Button>\r\n                      <Button \r\n                        variant=\"ghost\" \r\n                        size=\"sm\" \r\n                        className=\"h-8 w-8 p-0 rounded-lg hover:bg-rose-500/10 text-muted-foreground hover:text-rose-500 transition-all\"\r\n                      >\r\n                        <Trash weight=\"bold\" className=\"w-4 h-4\" />\r\n                      </Button>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </CardHeader>\r\n\r\n              <CardContent className=\"flex-1 space-y-6 relative z-10 flex flex-col justify-between\">\r\n                <p className=\"text-xs text-muted-foreground font-medium italic leading-relaxed line-clamp-2 opacity-80\">{role.description}</p>\r\n\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"flex items-center justify-between border-t border-border/30 pt-4\">\r\n                    <span className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">Protocol Capacity</span>\r\n                    <span className=\"text-[10px] font-bold text-primary tabular-nums\">\r\n                      {role.permissions.length === 1 && role.permissions[0] === '*' \r\n                        ? 'GLOBAL_ACCESS' \r\n                        : `${role.permissions.length} NODES_AUTHORIZED`}\r\n                    </span>\r\n                  </div>\r\n                  \r\n                  <div className=\"flex flex-wrap gap-1.5\">\r\n                    {role.permissions.slice(0, 3).map((permission, index) => (\r\n                      <Badge\r\n                        key={index}\r\n                        variant=\"ghost\"\r\n                        className=\"px-2.5 py-1 bg-secondary/50 border border-border/50 text-foreground font-black text-[8px] uppercase tracking-tighter\"\r\n                      >\r\n                        {permission === '*' ? 'GLOBAL' : permission.split(':')[0].toUpperCase()}\r\n                      </Badge>\r\n                    ))}\r\n                    {role.permissions.length > 3 && (\r\n                      <Badge variant=\"ghost\" className=\"px-2.5 py-1 bg-primary/5 text-primary border-none font-black text-[8px] tracking-widest\">\r\n                        +{role.permissions.length - 3} MORE\r\n                      </Badge>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </motion.div>\r\n        ))}\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\permissions\\components\\UsersTable.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle"},"fix":{"range":[232,247],"text":""},"desc":"Remove unused variable \"CheckCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningCircle' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WarningCircle"},"fix":{"range":[247,264],"text":""},"desc":"Remove unused variable \"WarningCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Monitor' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Monitor"},"fix":{"range":[264,275],"text":""},"desc":"Remove unused variable \"Monitor\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pulse' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pulse"},"fix":{"range":[290,299],"text":""},"desc":"Remove unused variable \"Pulse\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":27,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[574,607],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":31,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[665,668],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[665,668],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":32,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[688,691],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[688,691],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":34,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[740,743],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[740,743],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":35,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[778,781],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[778,781],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":259,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":259,"endColumn":39}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  Shield, \n  Users, \n  Buildings, \n  Gear, \n  ChartBar, \n  Lock, \n  PencilSimple, \n  Eye, \n  X,\n  IdentificationCard,\n  CheckCircle,\n  WarningCircle,\n  Monitor,\n  ShieldCheck,\n  Pulse,\n  CaretDown\n} from '@phosphor-icons/react';\nimport { usePermissionsContext } from '../context';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport { cn } from '@/lib/utils';\n\ninterface User {\n  userId: string;\n  userName: string | any;\n  email: string | any;\n  currentRole: string;\n  clinicName?: string | any;\n  customPermissions?: string[] | any;\n}\n\nexport default function UsersTable() {\n  const { users, roles } = usePermissionsContext();\n  const [editingUser, setEditingUser] = useState<User | null>(null);\n\n  const handleEditUser = (user: User) => {\n    setEditingUser(user);\n    console.log('Editing user:', user);\n  };\n\n  const getRoleBadge = (roleId: string) => {\n    switch (roleId) {\n      case 'super_admin': \n        return <Badge variant=\"destructive\" size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2 py-0.5 gap-1.5\"><Shield weight=\"bold\" className=\"w-3 h-3\" /> SUPER_ADMIN</Badge>;\n      case 'clinic_owner': \n        return <Badge variant=\"ghost\" size=\"sm\" className=\"bg-purple-500/10 text-purple-500 border-none font-black text-[8px] tracking-widest px-2 py-0.5 gap-1.5\"><Buildings weight=\"bold\" className=\"w-3 h-3\" /> OWNER</Badge>;\n      case 'clinic_admin': \n        return <Badge variant=\"primary\" size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2 py-0.5 gap-1.5\"><Users weight=\"bold\" className=\"w-3 h-3\" /> ADMIN</Badge>;\n      case 'clinic_staff': \n        return <Badge variant=\"success\" size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2 py-0.5 gap-1.5\"><Gear weight=\"bold\" className=\"w-3 h-3\" /> STAFF</Badge>;\n      case 'sales_staff': \n        return <Badge variant=\"warning\" size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2 py-0.5 gap-1.5\"><ChartBar weight=\"bold\" className=\"w-3 h-3\" /> SALES</Badge>;\n      default: \n        return <Badge variant=\"secondary\" size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2 py-0.5 gap-1.5\"><Lock weight=\"bold\" className=\"w-3 h-3\" /> GUEST</Badge>;\n    }\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      className=\"space-y-6\"\n    >\n      <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n        <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 relative\">\n          <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n            <ShieldCheck weight=\"fill\" className=\"w-48 h-48 text-primary\" />\n          </div>\n          <div className=\"flex items-center gap-5 relative z-10\">\n            <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\n              <ShieldCheck weight=\"duotone\" className=\"w-7 h-7\" />\n            </div>\n            <div>\n              <CardTitle className=\"text-2xl font-black uppercase tracking-tight\">Identity Access Hub</CardTitle>\n              <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.3em] font-black mt-1\">Global permission & role orchestration registry</p>\n            </div>\n          </div>\n        </CardHeader>\n\n        <CardContent className=\"p-0\">\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full\">\n              <thead>\n                <tr className=\"bg-secondary/20 border-b border-border/30\">\n                  <th className=\"px-8 py-5 text-left text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Identity Node</th>\n                  <th className=\"px-8 py-5 text-left text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Protocol Tier</th>\n                  <th className=\"px-8 py-5 text-left text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Cluster Link</th>\n                  <th className=\"px-8 py-5 text-left text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Custom Nodes</th>\n                  <th className=\"px-8 py-5 text-right text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Oversight</th>\n                </tr>\n              </thead>\n              <tbody className=\"divide-y divide-border/20\">\n                {users.map((user) => (\n                  <tr key={user.userId} className=\"hover:bg-primary/[0.02] transition-colors group/row\">\n                    <td className=\"px-8 py-6\">\n                      <div className=\"flex items-center gap-4\">\n                        <div className=\"w-10 h-10 rounded-xl bg-secondary border border-border/50 flex items-center justify-center text-primary group-hover/row:bg-primary/10 transition-all shadow-inner\">\n                          <span className=\"text-sm font-black\">{typeof user.userName === 'string' ? user.userName.charAt(0).toUpperCase() : '?'}</span>\n                        </div>\n                        <div className=\"min-w-0\">\n                          <p className=\"font-bold text-foreground truncate uppercase tracking-tight\">\n                            {typeof user.userName === 'string' ? user.userName : String(user.userName || 'Unknown')}\n                          </p>\n                          <p className=\"text-[10px] text-muted-foreground font-medium truncate italic\">\n                            {typeof user.email === 'string' ? user.email : String(user.email || 'Unknown')}\n                          </p>\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"px-8 py-6\">\n                      {getRoleBadge(user.currentRole)}\n                    </td>\n                    <td className=\"px-8 py-6\">\n                      <div className=\"flex items-center gap-2 text-muted-foreground\">\n                        <Buildings weight=\"bold\" className=\"w-3.5 h-3.5 opacity-40\" />\n                        <span className=\"text-xs font-bold uppercase tracking-tight\">\n                          {typeof user.clinicName === 'string' ? user.clinicName : String(user.clinicName || 'STANDALONE_NODE')}\n                        </span>\n                      </div>\n                    </td>\n                    <td className=\"px-8 py-6\">\n                      <div className=\"flex flex-wrap gap-1.5\">\n                        {user.customPermissions && Array.isArray(user.customPermissions) && user.customPermissions.length > 0 ? (\n                          user.customPermissions.map((permission, index) => (\n                            <Badge\n                              key={index}\n                              variant=\"ghost\"\n                              className=\"bg-amber-500/5 text-amber-500 border border-amber-500/10 font-black text-[7px] tracking-tighter px-1.5\"\n                            >\n                              {typeof permission === 'string' ? permission.toUpperCase() : String(permission).toUpperCase()}\n                            </Badge>\n                          ))\n                        ) : (\n                          <span className=\"text-[9px] font-black text-muted-foreground/30 uppercase tracking-widest italic\">Baseline</span>\n                        )}\n                      </div>\n                    </td>\n                    <td className=\"px-8 py-6\">\n                      <div className=\"flex items-center justify-end gap-2 opacity-40 group-hover/row:opacity-100 transition-opacity\">\n                        <Button variant=\"outline\" size=\"sm\" className=\"h-10 w-10 p-0 border-border/50 rounded-xl hover:bg-secondary\">\n                          <Eye weight=\"bold\" className=\"w-4 h-4\" />\n                        </Button>\n                        <Button \n                          variant=\"outline\" \n                          size=\"sm\" \n                          className=\"h-10 w-10 p-0 border-border/50 rounded-xl hover:bg-secondary text-primary\"\n                          onClick={() => handleEditUser(user)}\n                        >\n                          <PencilSimple weight=\"bold\" className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Edit User Modal Protocol */}\n      <AnimatePresence>\n        {editingUser && (\n          <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[200] p-4\">\n            <motion.div\n              initial={{ scale: 0.95, opacity: 0, y: 20 }}\n              animate={{ scale: 1, opacity: 1, y: 0 }}\n              exit={{ scale: 0.95, opacity: 0, y: 20 }}\n              className=\"bg-card border border-border rounded-[40px] w-full max-w-md shadow-premium relative overflow-hidden group p-10\"\n              onClick={(e) => e.stopPropagation()}\n            >\n              <div className=\"absolute top-0 right-0 p-10 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n                <ShieldCheck weight=\"fill\" className=\"w-48 h-48 text-primary\" />\n              </div>\n\n              <div className=\"relative z-10 space-y-10\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-5\">\n                    <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm shadow-inner\">\n                      <IdentificationCard weight=\"duotone\" className=\"w-7 h-7\" />\n                    </div>\n                    <div>\n                      <h3 className=\"text-2xl font-bold text-foreground tracking-tight uppercase leading-tight\">Protocol Update</h3>\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Modifying identity clearance node</p>\n                    </div>\n                  </div>\n                  <Button variant=\"ghost\" onClick={() => setEditingUser(null)} className=\"h-10 w-10 p-0 rounded-xl hover:bg-secondary\">\n                    <X weight=\"bold\" className=\"w-5 h-5\" />\n                  </Button>\n                </div>\n\n                <div className=\"space-y-8\">\n                  <div className=\"p-6 bg-secondary/30 rounded-[32px] border border-border/50 shadow-inner group/user\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"w-12 h-12 rounded-2xl bg-card border border-border/50 flex items-center justify-center text-primary text-xl font-black group-hover/user:scale-110 transition-transform\">\n                        {editingUser.userName?.charAt(0).toUpperCase()}\n                      </div>\n                      <div className=\"min-w-0\">\n                        <p className=\"text-base font-bold text-foreground truncate uppercase tracking-tight\">{editingUser.userName}</p>\n                        <p className=\"text-[10px] text-muted-foreground font-medium italic truncate\">{editingUser.email}</p>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-3\">\n                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Assigned Protocol Tier</label>\n                    <div className=\"relative group/input\">\n                      <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\n                      <select\n                        className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-6 text-xs font-black uppercase tracking-widest text-foreground focus:border-primary outline-none transition-all appearance-none shadow-inner relative z-10\"\n                        value={editingUser.currentRole}\n                        onChange={(e) => setEditingUser({...editingUser, currentRole: e.target.value})}\n                      >\n                        {roles.map((role) => (\n                          <option key={role.id} value={role.id} className=\"bg-card\">\n                            {role.name.toUpperCase()}\n                          </option>\n                        ))}\n                      </select>\n                      <CaretDown weight=\"bold\" className=\"absolute right-6 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 pointer-events-none z-20\" />\n                    </div>\n                  </div>\n\n                  <div className=\"flex gap-4 pt-4\">\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => setEditingUser(null)}\n                      className=\"flex-1 py-7 rounded-[24px] font-black uppercase tracking-widest text-[10px] border-border/50 hover:bg-secondary\"\n                    >\n                      Abort\n                    </Button>\n                    <Button\n                      className=\"flex-[2] py-7 rounded-[24px] font-black uppercase tracking-widest text-[10px] shadow-premium gap-3\"\n                      onClick={async () => {\n                        // Keep original save logic\n                        try {\n                          const response = await fetch('/api/admin/permissions', {\n                            method: 'POST',\n                            headers: { 'Content-Type': 'application/json' },\n                            body: JSON.stringify({\n                              action: 'updateUserRole',\n                              userId: editingUser.userId,\n                              newRole: editingUser.currentRole,\n                              oldRole: users.find(u => u.userId === editingUser.userId)?.currentRole\n                            }),\n                          });\n                          const result = await response.json();\n                          if (result.success) {\n                            setEditingUser(null);\n                          } else {\n                            alert('Failed to update user role: ' + result.error);\n                          }\n                        } catch (error) {\n                          alert('Error updating user role');\n                        }\n                      }}\n                    >\n                      Commit Protocol\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </motion.div>\n          </div>\n        )}\n      </AnimatePresence>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\permissions\\context.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'supabase' is assigned a value but never used.","line":7,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport { createClient } from '@/lib/supabase/client';\nimport { PermissionsContextType, Role, UserRole, Permission, TabType } from './types';\n\nconst supabase = createClient();\n\nconst PermissionsContext = createContext<PermissionsContextType | undefined>(undefined);\n\nexport const usePermissionsContext = () => {\n  const context = useContext(PermissionsContext);\n  if (!context) {\n    throw new Error('usePermissionsContext must be used within PermissionsProvider');\n  }\n  return context;\n};\n\nexport const PermissionsProvider = ({ children }: { children: ReactNode }) => {\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [users, setUsers] = useState<UserRole[]>([]);\n  const [permissions, setPermissions] = useState<Permission[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [activeTab, setActiveTab] = useState<TabType>('roles');\n\n  useEffect(() => {\n    fetchPermissionsData();\n  }, []);\n\n  const fetchPermissionsData = async () => {\n    try {\n      setLoading(true);\n      \n      // Get token from localStorage the same way we did in Support/Security pages\n      let token = null;\n      \n      try {\n        const sessionStr = localStorage.getItem('sb-sb-royeyoxaaieipdajijni-auth-token');\n        \n        if (sessionStr) {\n          const base64Data = sessionStr.replace('base64-', '');\n          const decodedSession = JSON.parse(atob(base64Data));\n          token = decodedSession.access_token;\n        }\n      } catch (tokenError) {\n        console.warn('Failed to get token from localStorage:', tokenError);\n      }\n      \n      // Fallback: Try to get session from Supabase client\n      if (!token) {\n        try {\n          const { createClient } = await import('@/lib/supabase/client');\n          const supabase = createClient();\n          const { data: { session } } = await supabase.auth.getSession();\n          token = session?.access_token;\n        } catch (supabaseError) {\n          console.warn('Failed to get token from Supabase client:', supabaseError);\n        }\n      }\n      \n      const headers: Record<string, string> = {\n        'Content-Type': 'application/json'\n      };\n      \n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n      }\n      \n      const res = await fetch('/api/admin/permissions?type=all', {\n        method: 'GET',\n        headers\n      });\n      \n      if (!res.ok) throw new Error('Failed to fetch permissions data');\n      const { data } = await res.json();\n      \n      setRoles(data.roles || []);\n      setUsers(data.users || []);\n      setPermissions(data.permissions || []);\n    } catch (error) {\n      console.error('Error fetching permissions data:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const value: PermissionsContextType = {\n    roles,\n    users,\n    permissions,\n    loading,\n    searchTerm,\n    activeTab,\n    setRoles,\n    setUsers,\n    setPermissions,\n    setSearchTerm,\n    setActiveTab\n  };\n\n  return (\n    <PermissionsContext.Provider value={value}>\n      {children}\n    </PermissionsContext.Provider>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\permissions\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[87,102],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Lock' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Lock"},"fix":{"range":[102,112],"text":""},"desc":"Remove unused variable \"Lock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":22,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[112,137],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pulse' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pulse"},"fix":{"range":[137,147],"text":""},"desc":"Remove unused variable \"Pulse\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Monitor' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Monitor"},"fix":{"range":[147,159],"text":""},"desc":"Remove unused variable \"Monitor\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Gear' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Gear"},"fix":{"range":[159,168],"text":""},"desc":"Remove unused variable \"Gear\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":4,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"X"},"fix":{"range":[168,174],"text":""},"desc":"Remove unused variable \"X\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowsClockwise' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":18,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowsClockwise"},"fix":{"range":[174,194],"text":""},"desc":"Remove unused variable \"ArrowsClockwise\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PermissionsProvider' is defined but never used.","line":18,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":29,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"PermissionsProvider"},"fix":{"range":[238,258],"text":""},"desc":"Remove unused variable \"PermissionsProvider\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PermissionsContent' is defined but never used.","line":32,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":33,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'showCreateRole' is assigned a value but never used.","line":35,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'editingRole' is assigned a value but never used.","line":36,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { \r\n  SpinnerGap, \r\n  ShieldCheck, \r\n  Users, \r\n  Key, \r\n  Plus, \r\n  ArrowLeft, \r\n  Lock, \r\n  IdentificationBadge,\r\n  Pulse,\r\n  Monitor,\r\n  Gear,\r\n  X,\r\n  ArrowsClockwise\r\n} from '@phosphor-icons/react';\r\nimport { PermissionsProvider, usePermissionsContext } from './context';\r\nimport RolesGrid from './components/RolesGrid';\r\nimport UsersTable from './components/UsersTable';\r\nimport PermissionsList from './components/PermissionsList';\r\nimport { Role } from './types';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { cn } from '@/lib/utils';\r\nimport { useState } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nfunction PermissionsContent() {\r\n  const { goBack } = useBackNavigation();\r\n  const { loading, activeTab } = usePermissionsContext();\r\n  const [showCreateRole, setShowCreateRole] = useState(false);\r\n  const [editingRole, setEditingRole] = useState<Role | null>(null);\r\n\r\n  const handleCreateRole = () => {\r\n    setEditingRole({\r\n      id: '',\r\n      name: '',\r\n      description: '',\r\n      permissions: [],\r\n      userCount: 0,\r\n      isSystem: false\r\n    });\r\n    setShowCreateRole(true);\r\n  };\r\n\r\n  const handleEditRole = (role: Role) => {\r\n    setEditingRole(role);\r\n    setShowCreateRole(true);\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-[400px] flex flex-col items-center justify-center space-y-4\">\r\n        <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n        <p className=\"text-muted-foreground animate-pulse text-xs uppercase tracking-widest text-center\">\r\n          Synchronizing Permission Matrix...\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <ShieldCheck weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Authority Management Node\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Roles & <span className=\"text-primary\">Permissions</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating system access levels, clinical role definitions, and identity security.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-3\">\r\n          <Button \r\n            onClick={handleCreateRole}\r\n            className=\"gap-3 shadow-premium px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest\"\r\n          >\r\n            <Plus weight=\"bold\" className=\"w-4 h-4\" />\r\n            Initialize Role Node\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Navigation Tabs */}\r\n      <div className=\"flex flex-col sm:flex-row items-center justify-between gap-6 px-2\">\r\n        <div className=\"flex bg-secondary/50 border border-border/50 p-1.5 rounded-[24px] w-full sm:w-auto shadow-inner\">\r\n          {[\r\n            { id: 'roles', label: 'Identity Roles', icon: ShieldCheck },\r\n            { id: 'users', label: 'Active Users', icon: Users },\r\n            { id: 'permissions', label: 'Permission Matrix', icon: Key }\r\n          ].map((tab) => (\r\n            <button\r\n              key={tab.id}\r\n              onClick={() => {}} // Active tab handled by context via component internal links or props if needed\r\n              className={cn(\r\n                \"flex-1 sm:flex-none flex items-center justify-center gap-3 px-8 py-3.5 rounded-2xl transition-all text-[10px] font-black uppercase tracking-widest border whitespace-nowrap\",\r\n                activeTab === tab.id\r\n                  ? \"bg-primary text-primary-foreground border-primary shadow-premium\"\r\n                  : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\r\n              )}\r\n            >\r\n              <tab.icon weight={activeTab === tab.id ? \"fill\" : \"bold\"} className=\"w-4 h-4\" />\r\n              {tab.label}\r\n            </button>\r\n          ))}\r\n        </div>\r\n        \r\n        <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[10px] tracking-widest uppercase px-4 py-2\">\r\n          Secure Authority Hub\r\n        </Badge>\r\n      </div>\r\n\r\n      {/* Content Hub */}\r\n      <div className=\"px-2\">\r\n        <AnimatePresence mode=\"wait\">\r\n          <motion.div\r\n            key={activeTab}\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, scale: 0.95 }}\r\n            transition={{ duration: 0.3 }}\r\n          >\r\n            {activeTab === 'roles' && (\r\n              <RolesGrid onEditRole={handleEditRole} />\r\n            )}\r\n\r\n            {activeTab === 'users' && (\r\n              <Card className=\"rounded-[40px] border-border/50 overflow-hidden shadow-premium\">\r\n                <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30\">\r\n                  <div className=\"flex items-center gap-4\">\r\n                    <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n                      <ShieldCheck weight=\"duotone\" className=\"w-6 h-6\" />\r\n                    </div>\r\n                    <div>\r\n                      <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Identity Registry</CardTitle>\r\n                      <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Assigned roles and access status</p>\r\n                    </div>\r\n                  </div>\r\n                </CardHeader>\r\n                <CardContent className=\"p-0\">\r\n                  <UsersTable />\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n\r\n            {activeTab === 'permissions' && (\r\n              <PermissionsList />\r\n            )}\r\n          </motion.div>\r\n        </AnimatePresence>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\security\\components\\APIKeyManagement.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Invalid character.","line":352,"column":65}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  Key, \n  Plus, \n  Trash, \n  Copy, \n  Check, \n  Eye, \n  EyeSlash, \n  Shield, \n  Clock, \n  WarningCircle, \n  ArrowsClockwise, \n  SpinnerGap,\n  Monitor,\n  Lightning,\n  CheckCircle,\n  X,\n  DotsThreeVertical,\n  IdentificationBadge\n} from '@phosphor-icons/react';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport { cn } from '@/lib/utils';\n\ninterface APIKey {\n  id: string;\n  name: string;\n  key: string;\n  prefix: string;\n  scopes: string[];\n  status: 'active' | 'revoked' | 'expired';\n  created_at: string;\n  last_used_at: string | null;\n  expires_at: string | null;\n}\n\nexport default function APIKeyManagement() {\n  const [keys, setKeys] = useState<APIKey[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [copiedId, setCopiedId] = useState<string | null>(null);\n  const [visibleKeys, setVisibleKeys] = useState<Record<string, boolean>>({});\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [newKeyData, setNewKeyData] = useState({\n    name: '',\n    scopes: [] as string[],\n    expiresIn: 'never',\n    rateLimit: 1000\n  });\n\n  const fetchKeys = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      let token = null;\n      try {\n        const sessionStr = localStorage.getItem('sb-sb-royeyoxaaieipdajijni-auth-token');\n        if (sessionStr) {\n          const base64Data = sessionStr.replace('base64-', '');\n          const decodedSession = JSON.parse(atob(base64Data));\n          token = decodedSession.access_token;\n        }\n      } catch (tokenError) {\n        console.warn('Failed to get token from localStorage:', tokenError);\n      }\n      \n      if (!token) {\n        try {\n          const { createClient } = await import('@/lib/supabase/client');\n          const supabase = createClient();\n          const { data: { session } } = await supabase.auth.getSession();\n          token = session?.access_token;\n        } catch (supabaseError) {\n          console.warn('Failed to get token from Supabase client:', supabaseError);\n        }\n      }\n      \n      const headers: Record<string, string> = {\n        'Content-Type': 'application/json'\n      };\n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n      }\n      \n      const response = await fetch('/api/admin/security/api-keys', {\n        method: 'GET',\n        headers\n      });\n      \n      const data = await response.json();\n      if (data.success) {\n        setKeys(data.data.keys);\n      } else {\n        setError(data.error || 'Failed to fetch API keys');\n      }\n    } catch (err) {\n      setError('An error occurred while fetching API keys');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchKeys();\n  }, []);\n\n  const availableScopes = [\n    { id: 'read:clinics', label: 'Read Clinics' },\n    { id: 'write:clinics', label: 'Write Clinics' },\n    { id: 'read:customers', label: 'Read Customers' },\n    { id: 'write:analytics', label: 'Write Analytics' },\n    { id: 'send:notifications', label: 'Send Notifications' },\n    { id: 'admin:all', label: 'Full Admin Access' }\n  ];\n\n  const handleCopy = (id: string, text: string) => {\n    navigator.clipboard.writeText(text);\n    setCopiedId(id);\n    setTimeout(() => setCopiedId(null), 2000);\n  };\n\n  const toggleKeyVisibility = (id: string) => {\n    setVisibleKeys(prev => ({ ...prev, [id]: !prev[id] }));\n  };\n\n  const handleCreateKey = async () => {\n    setIsProcessing(true);\n    setError(null);\n    try {\n      let token = null;\n      try {\n        const sessionStr = localStorage.getItem('sb-sb-royeyoxaaieipdajijni-auth-token');\n        if (sessionStr) {\n          const base64Data = sessionStr.replace('base64-', '');\n          const decodedSession = JSON.parse(atob(base64Data));\n          token = decodedSession.access_token;\n        }\n      } catch (tokenError) {\n        console.warn('Failed to get token from localStorage:', tokenError);\n      }\n      \n      if (!token) {\n        try {\n          const { createClient } = await import('@/lib/supabase/client');\n          const supabase = createClient();\n          const { data: { session } } = await supabase.auth.getSession();\n          token = session?.access_token;\n        } catch (supabaseError) {\n          console.warn('Failed to get token from Supabase client:', supabaseError);\n        }\n      }\n      \n      const headers: Record<string, string> = {\n        'Content-Type': 'application/json'\n      };\n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n      }\n      \n      const response = await fetch('/api/admin/security/api-keys', {\n        method: 'POST',\n        headers,\n        body: JSON.stringify({\n          action: 'create',\n          name: newKeyData.name,\n          scopes: newKeyData.scopes,\n          expiresIn: newKeyData.expiresIn,\n          rateLimit: newKeyData.rateLimit\n        })\n      });\n      const data = await response.json();\n      if (data.success) {\n        setKeys([data.data.key, ...keys]);\n        setShowCreateModal(false);\n        setNewKeyData({ name: '', scopes: [], expiresIn: 'never', rateLimit: 1000 });\n      } else {\n        setError(data.error || 'Failed to create API key');\n      }\n    } catch (err) {\n      setError('An error occurred while creating the API key');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleRevokeKey = async (id: string) => {\n    if (!confirm('Are you sure you want to revoke this API key? This action cannot be undone.')) return;\n    \n    setIsProcessing(true);\n    try {\n      let token = null;\n      try {\n        const sessionStr = localStorage.getItem('sb-sb-royeyoxaaieipdajijni-auth-token');\n        if (sessionStr) {\n          const base64Data = sessionStr.replace('base64-', '');\n          const decodedSession = JSON.parse(atob(base64Data));\n          token = decodedSession.access_token;\n        }\n      } catch (tokenError) {\n        console.warn('Failed to get token from localStorage:', tokenError);\n      }\n      \n      if (!token) {\n        try {\n          const { createClient } = await import('@/lib/supabase/client');\n          const supabase = createClient();\n          const { data: { session } } = await supabase.auth.getSession();\n          token = session?.access_token;\n        } catch (supabaseError) {\n          console.warn('Failed to get token from Supabase client:', supabaseError);\n        }\n      }\n      \n      const headers: Record<string, string> = {\n        'Content-Type': 'application/json'\n      };\n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n      }\n      \n      const response = await fetch('/api/admin/security/api-keys', {\n        method: 'POST',\n        headers,\n        body: JSON.stringify({ action: 'revoke', id })\n      });\n      const data = await response.json();\n      if (data.success) {\n        setKeys(keys.map(k => k.id === id ? { ...k, status: 'revoked' as const } : k));\n      } else {\n        setError(data.error || 'Failed to revoke API key');\n      }\n    } catch (err) {\n      setError('An error occurred while revoking the API key');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"p-12 flex flex-col items-center justify-center space-y-6\">\n        <SpinnerGap className=\"w-12 h-12 text-primary animate-spin\" />\n        <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] animate-pulse text-center\">Synchronizing Encryption Keys...</p>\n      </div>\n    );\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      className=\"space-y-8\"\n    >\n      <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n        <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 relative overflow-hidden\">\n          <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n            <Key weight=\"fill\" className=\"w-64 h-64 text-primary\" />\n          </div>\n          <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 relative z-10\">\n            <div className=\"flex items-center gap-5\">\n              <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\n                <Key weight=\"duotone\" className=\"w-7 h-7\" />\n              </div>\n              <div>\n                <CardTitle className=\"text-2xl font-black uppercase tracking-tight\">API Key Management</CardTitle>\n                <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.3em] font-black mt-1\">Global external access nodes</p>\n              </div>\n            </div>\n            <div className=\"flex gap-3\">\n              <Button\n                variant=\"outline\"\n                onClick={fetchKeys}\n                className=\"p-4 h-14 w-14 border-border/50 rounded-2xl text-muted-foreground hover:text-primary transition-all\"\n              >\n                <ArrowsClockwise weight=\"bold\" className={cn(\"w-5 h-5\", isProcessing && \"animate-spin\")} />\n              </Button>\n              <Button\n                onClick={() => setShowCreateModal(true)}\n                className=\"gap-3 shadow-premium px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest group\"\n              >\n                <Plus weight=\"bold\" className=\"w-4 h-4 group-hover:scale-110 transition-transform\" />\n                Generate Access Token\n              </Button>\n            </div>\n          </div>\n        </CardHeader>\n\n        <CardContent className=\"p-8 md:p-10 space-y-8 relative z-10\">\n          {error && (\n            <div className=\"p-4 bg-rose-500/10 border border-rose-500/20 rounded-2xl flex items-center gap-3\">\n              <WarningCircle weight=\"fill\" className=\"w-5 h-5 text-rose-500\" />\n              <p className=\"text-rose-500 text-xs font-black uppercase tracking-widest\">Exception: {error}</p>\n            </div>\n          )}\n\n          {keys.length === 0 ? (\n            <div className=\"text-center py-20 bg-secondary/20 border-2 border-dashed border-border/50 rounded-[40px] opacity-40\">\n              <Key weight=\"duotone\" className=\"w-16 h-16 text-muted-foreground mx-auto mb-6 shadow-inner\" />\n              <div className=\"space-y-2\">\n                <h3 className=\"text-xl font-black text-foreground uppercase tracking-widest\">Registry Empty</h3>\n                <p className=\"text-sm text-muted-foreground font-medium italic max-w-sm mx-auto\">No API keys establishing external links in current node.</p>\n              </div>\n            </div>\n          ) : (\n            <div className=\"grid grid-cols-1 gap-6\">\n              {keys.map((apiKey) => (\n                <div\n                  key={apiKey.id}\n                  className={cn(\n                    \"p-6 rounded-[32px] border transition-all duration-500 group/item relative overflow-hidden\",\n                    apiKey.status === 'revoked' \n                      ? 'bg-secondary/10 border-border/30 opacity-60 grayscale' \n                      : 'bg-secondary/20 border-border/50 hover:border-primary/30 shadow-card hover:shadow-card-hover'\n                  )}\n                >\n                  <div className=\"absolute top-0 right-0 p-6 opacity-[0.02] group-hover/item:scale-110 transition-transform duration-700 pointer-events-none\">\n                    <Lightning weight=\"fill\" className=\"w-32 h-32 text-primary\" />\n                  </div>\n\n                  <div className=\"flex flex-col xl:flex-row xl:items-center justify-between gap-8 relative z-10\">\n                    <div className=\"flex-1 space-y-6\">\n                      <div className=\"flex items-center gap-4\">\n                        <div className={cn(\n                          \"w-12 h-12 rounded-2xl flex items-center justify-center border transition-all duration-500 shadow-inner\",\n                          apiKey.status === 'active' ? \"bg-primary/10 border-primary/20 text-primary\" : \"bg-secondary border-border text-muted-foreground\"\n                        )}>\n                          <Shield weight=\"duotone\" className=\"w-6 h-6\" />\n                        </div>\n                        <div className=\"min-w-0\">\n                          <div className=\"flex items-center gap-3 mb-1\">\n                            <h3 className=\"text-lg font-black text-foreground uppercase tracking-tight truncate\">{apiKey.name}</h3>\n                            <Badge variant={apiKey.status === 'active' ? 'success' : apiKey.status === 'expired' ? 'warning' : 'secondary'} size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2.5 py-1\">\n                              {apiKey.status.toUpperCase()}\n                            </Badge>\n                          </div>\n                          <div className=\"flex items-center gap-4 text-[9px] font-black text-muted-foreground uppercase tracking-widest opacity-60\">\n                            <span className=\"flex items-center gap-1.5\"><Clock weight=\"bold\" className=\"w-3 h-3\" /> Initialized: {new Date(apiKey.created_at).toLocaleDateString()}</span>\n                            <span className=\"flex items-center gap-1.5\"><Lightning weight=\"bold\" className=\"w-3 h-3\" /> Last Payload: {apiKey.last_used_at ? new Date(apiKey.last_used_at).toLocaleDateString() : 'Never'}</span>\n                          </div>\n                        </div>\n                      </div>\n                      \n                      <div className=\"flex items-center gap-3 bg-card border border-border/50 p-4 rounded-2xl shadow-inner group/key relative overflow-hidden\">\n                        <div className=\"absolute inset-0 bg-primary/5 opacity-0 group-focus-within/key:opacity-100 transition-opacity\" />\n                        <code className=\"text-xs font-mono text-primary flex-1 truncate relative z-10 font-bold tracking-wider\">\n                          {visibleKeys[apiKey.id] ? apiKey.key : \\\\_\\}\n                        </code>\n                        <div className=\"flex items-center gap-1.5 relative z-10\">\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => toggleKeyVisibility(apiKey.id)}\n                            className=\"h-9 w-9 p-0 rounded-xl hover:bg-primary/10 text-muted-foreground hover:text-primary transition-all\"\n                          >\n                            {visibleKeys[apiKey.id] ? <EyeSlash weight=\"bold\" className=\"w-4.5 h-4.5\" /> : <Eye weight=\"bold\" className=\"w-4.5 h-4.5\" />}\n                          </Button>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => handleCopy(apiKey.id, apiKey.key)}\n                            className=\"h-9 w-9 p-0 rounded-xl hover:bg-primary/10 text-muted-foreground hover:text-primary transition-all\"\n                          >\n                            {copiedId === apiKey.id ? <CheckCircle weight=\"bold\" className=\"w-4.5 h-4.5 text-emerald-500\" /> : <Copy weight=\"bold\" className=\"w-4.5 h-4.5\" />}\n                          </Button>\n                        </div>\n                      </div>\n\n                      <div className=\"flex flex-wrap gap-2\">\n                        {apiKey.scopes.map(scope => (\n                          <Badge key={scope} variant=\"ghost\" className=\"bg-primary/5 text-primary border border-primary/10 font-black text-[7px] tracking-widest px-2.5 py-1\">\n                            {scope.toUpperCase()}\n                          </Badge>\n                        ))}\n                      </div>\n                    </div>\n\n                    <div className=\"flex xl:flex-col items-center xl:items-end gap-4 shrink-0\">\n                      {apiKey.status === 'active' && (\n                        <Button\n                          variant=\"outline\"\n                          onClick={() => handleRevokeKey(apiKey.id)}\n                          className=\"px-6 py-3 h-auto rounded-xl text-[9px] font-black uppercase tracking-widest border-rose-500/20 text-rose-500 hover:bg-rose-500/10 hover:border-rose-500/30 transition-all gap-2\"\n                        >\n                          <Trash weight=\"bold\" className=\"w-3.5 h-3.5\" />\n                          Revoke Access\n                        </Button>\n                      )}\n                      <div className=\"hidden xl:flex items-center gap-2 text-[8px] font-black text-muted-foreground uppercase tracking-widest opacity-40\">\n                        <IdentificationBadge weight=\"bold\" className=\"w-3 h-3\" />\n                        ID-{apiKey.id.slice(0, 8).toUpperCase()}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Create Key Modal Protocol */}\n      <AnimatePresence>\n        {showCreateModal && (\n          <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[200] p-4\">\n            <motion.div\n              initial={{ scale: 0.95, opacity: 0, y: 20 }}\n              animate={{ scale: 1, opacity: 1, y: 0 }}\n              exit={{ scale: 0.95, opacity: 0, y: 20 }}\n              className=\"bg-card border border-border rounded-[40px] w-full max-w-lg shadow-premium relative overflow-hidden group p-10\"\n              onClick={(e) => e.stopPropagation()}\n            >\n              <div className=\"absolute top-0 right-0 p-10 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n                <Shield weight=\"fill\" className=\"w-48 h-48 text-primary\" />\n              </div>\n\n              <div className=\"relative z-10 space-y-10\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-5\">\n                    <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm shadow-inner\">\n                      <Key weight=\"duotone\" className=\"w-7 h-7\" />\n                    </div>\n                    <div>\n                      <h3 className=\"text-2xl font-bold text-foreground tracking-tight uppercase leading-tight\">Key Synthesis</h3>\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Initialize external access node</p>\n                    </div>\n                  </div>\n                  <Button variant=\"ghost\" onClick={() => setShowCreateModal(false)} className=\"h-10 w-10 p-0 rounded-xl hover:bg-secondary\">\n                    <X weight=\"bold\" className=\"w-5 h-5\" />\n                  </Button>\n                </div>\n\n                <div className=\"space-y-8\">\n                  <div className=\"space-y-3\">\n                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Key Designation *</label>\n                    <div className=\"relative group/input\">\n                      <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\n                      <input\n                        type=\"text\"\n                        value={newKeyData.name}\n                        onChange={(e) => setNewKeyData({ ...newKeyData, name: e.target.value })}\n                        placeholder=\"e.g. Clinical Widget Protocol\"\n                        className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner relative z-10\"\n                      />\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-3\">\n                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Consumption Limit (Req/Hour)</label>\n                    <input\n                      type=\"number\"\n                      value={newKeyData.rateLimit}\n                      onChange={(e) => setNewKeyData({ ...newKeyData, rateLimit: parseInt(e.target.value) })}\n                      className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold tabular-nums shadow-inner\"\n                    />\n                  </div>\n\n                  <div className=\"space-y-4\">\n                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Authorized Protocol Scopes</label>\n                    <div className=\"grid grid-cols-2 gap-3\">\n                      {availableScopes.map(scope => (\n                        <label\n                          key={scope.id}\n                          className={cn(\n                            \"flex items-center gap-3 p-3.5 rounded-xl border-2 cursor-pointer transition-all\",\n                            newKeyData.scopes.includes(scope.id)\n                              ? \"bg-primary/10 border-primary text-primary shadow-glow-sm\"\n                              : \"bg-secondary/30 border-border/50 text-muted-foreground hover:bg-secondary/50\"\n                          )}\n                        >\n                          <input\n                            type=\"checkbox\"\n                            className=\"hidden\"\n                            checked={newKeyData.scopes.includes(scope.id)}\n                            onChange={() => {\n                              const scopes = newKeyData.scopes.includes(scope.id)\n                                ? newKeyData.scopes.filter(s => s !== scope.id)\n                                : [...newKeyData.scopes, scope.id];\n                              setNewKeyData({ ...newKeyData, scopes });\n                            }}\n                          />\n                          <span className=\"text-[10px] font-black uppercase tracking-tight\">{scope.label}</span>\n                        </label>\n                      ))}\n                    </div>\n                  </div>\n\n                  <div className=\"p-5 bg-amber-500/5 rounded-[28px] border border-amber-500/10 flex gap-4 shadow-inner relative overflow-hidden group/warning\">\n                    <div className=\"absolute top-0 right-0 p-4 opacity-[0.03] group-hover/warning:scale-110 transition-transform\">\n                      <WarningCircle weight=\"fill\" className=\"w-10 h-10 text-amber-500\" />\n                    </div>\n                    <WarningCircle weight=\"duotone\" className=\"w-5 h-5 text-amber-500 flex-shrink-0 relative z-10\" />\n                    <p className=\"text-[10px] text-muted-foreground font-medium italic leading-relaxed relative z-10 uppercase tracking-widest\">\n                      Encryption keys grant global level access. Protocol requires secure vault storage only. Never distribute via public channels.\n                    </p>\n                  </div>\n\n                  <div className=\"flex gap-4 pt-4\">\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => setShowCreateModal(false)}\n                      className=\"flex-1 py-7 rounded-[24px] font-black uppercase tracking-widest text-[10px] border-border/50 hover:bg-secondary\"\n                    >\n                      Abort\n                    </Button>\n                    <Button\n                      onClick={handleCreateKey}\n                      disabled={!newKeyData.name || newKeyData.scopes.length === 0 || isProcessing}\n                      className=\"flex-[2] py-7 rounded-[24px] font-black uppercase tracking-widest text-[10px] shadow-premium gap-3 relative overflow-hidden group/btn\"\n                    >\n                      <div className=\"absolute inset-0 bg-white/20 -translate-x-full group-hover/btn:translate-x-full transition-transform duration-1000\" />\n                      {isProcessing ? <SpinnerGap className=\"w-4 h-4 animate-spin\" /> : <Shield weight=\"bold\" className=\"w-4 h-4 group-hover/btn:scale-110 transition-transform\" />}\n                      Commit Synthesis\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </motion.div>\n          </div>\n        )}\n      </AnimatePresence>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\security\\components\\PasswordStrength.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Lightning' is defined but never used.","line":4,"column":57,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":66,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Lightning"},"fix":{"range":[109,120],"text":""},"desc":"Remove unused variable \"Lightning\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { motion } from 'framer-motion';\nimport { ShieldCheck, Info, CheckCircle, WarningCircle, Lightning, LockKey, Sparkle } from '@phosphor-icons/react';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { cn } from '@/lib/utils';\n\ninterface PasswordStrengthProps {\n  score: number;\n  requirements: {\n    length: boolean;\n    uppercase: boolean;\n    lowercase: boolean;\n    number: boolean;\n    special: boolean;\n  };\n}\n\nexport default function PasswordStrength({ score, requirements }: PasswordStrengthProps) {\n  const getStrengthLabel = () => {\n    if (score >= 4) return { label: 'CRITICAL_SECURITY', color: 'text-emerald-500', bg: 'bg-emerald-500/10' };\n    if (score >= 3) return { label: 'ENHANCED_PARITY', color: 'text-primary', bg: 'bg-primary/10' };\n    if (score >= 2) return { label: 'NOMINAL_ACCESS', color: 'text-amber-500', bg: 'bg-amber-500/10' };\n    return { label: 'VULNERABLE_NODE', color: 'text-rose-500', bg: 'bg-rose-500/10' };\n  };\n\n  const strength = getStrengthLabel();\n\n  return (\n    <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n      <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 relative\">\n        <div className=\"absolute top-0 right-0 p-10 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n          <LockKey weight=\"fill\" className=\"w-48 h-48 text-primary\" />\n        </div>\n        <div className=\"flex items-center gap-4 relative z-10\">\n          <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm transition-all group-hover:bg-primary/20\">\n            <ShieldCheck weight=\"duotone\" className=\"w-6 h-6\" />\n          </div>\n          <div>\n            <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Identity Encryption</CardTitle>\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Neural password complexity matrix</p>\n          </div>\n        </div>\n      </CardHeader>\n\n      <CardContent className=\"p-8 md:p-10 space-y-10 relative z-10\">\n        <div className=\"space-y-6\">\n          <div className=\"flex items-center justify-between px-1\">\n            <span className={cn(\"text-[10px] font-black uppercase tracking-[0.3em]\", strength.color)}>{strength.label}</span>\n            <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest opacity-60\">Level {score}/4</span>\n          </div>\n          \n          <div className=\"flex gap-2.5 h-2\">\n            {[...Array(4)].map((_, i) => (\n              <div key={i} className=\"flex-1 bg-secondary rounded-full overflow-hidden p-0.5 border border-border/30 shadow-inner\">\n                <motion.div\n                  initial={{ width: 0 }}\n                  animate={{ width: i < score ? '100%' : '0%' }}\n                  className={cn(\n                    \"h-full rounded-full transition-all duration-500\",\n                    score >= 4 ? 'bg-emerald-500' : \n                    score >= 3 ? 'bg-primary' : \n                    score >= 2 ? 'bg-amber-500' : 'bg-rose-500'\n                  )}\n                />\n              </div>\n            ))}\n          </div>\n        </div>\n\n        <div className=\"space-y-4\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-1.5 h-1.5 rounded-full bg-primary animate-pulse\" />\n            <h4 className=\"text-[10px] font-black text-foreground uppercase tracking-[0.3em]\">Protocol Requirements</h4>\n          </div>\n          \n          <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n            {[\n              { key: 'length', label: 'Minimum 12 Nodes' },\n              { key: 'uppercase', label: 'Alpha Upper Node' },\n              { key: 'lowercase', label: 'Alpha Lower Node' },\n              { key: 'number', label: 'Numeric Registry' },\n              { key: 'special', label: 'Symbolic Encryption' }\n            ].map((req) => {\n              const isMet = requirements[req.key as keyof typeof requirements];\n              return (\n                <div \n                  key={req.key}\n                  className={cn(\n                    \"flex items-center gap-3 p-4 rounded-2xl border transition-all duration-500\",\n                    isMet ? \"bg-emerald-500/5 border-emerald-500/20 text-emerald-500\" : \"bg-secondary/20 border-border/50 text-muted-foreground opacity-60\"\n                  )}\n                >\n                  {isMet ? (\n                    <CheckCircle weight=\"fill\" className=\"w-4 h-4 shadow-glow-sm\" />\n                  ) : (\n                    <WarningCircle weight=\"bold\" className=\"w-4 h-4\" />\n                  )}\n                  <span className=\"text-[10px] font-black uppercase tracking-widest\">{req.label}</span>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n\n        <div className=\"p-5 bg-primary/5 rounded-[32px] border border-primary/10 flex gap-4 relative overflow-hidden group/tip\">\n          <div className=\"absolute top-0 right-0 p-4 opacity-[0.03] group-hover/tip:scale-110 transition-transform\">\n            <Sparkle weight=\"fill\" className=\"w-16 h-16 text-primary\" />\n          </div>\n          <Info weight=\"duotone\" className=\"w-5 h-5 text-primary flex-shrink-0 relative z-10\" />\n          <p className=\"text-[10px] text-muted-foreground font-medium italic leading-relaxed relative z-10 uppercase tracking-widest\">\n            Encryption standards require cyclic identity updates every 90 planetary rotations to maintain global node integrity.\n          </p>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\security\\components\\SecurityAlerts.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'XCircle' is defined but never used.","line":4,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"XCircle"},"fix":{"range":[71,80],"text":""},"desc":"Remove unused variable \"XCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Info' is defined but never used.","line":4,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":32,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Info"},"fix":{"range":[80,86],"text":""},"desc":"Remove unused variable \"Info\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ShieldCheck' is defined but never used.","line":4,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":52,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ShieldCheck"},"fix":{"range":[93,106],"text":""},"desc":"Remove unused variable \"ShieldCheck\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[350,383],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { motion } from 'framer-motion';\nimport { Warning, XCircle, Info, Pulse, ShieldCheck, Clock, CaretRight, ShieldWarning } from '@phosphor-icons/react';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport { cn } from '@/lib/utils';\n\ninterface SecurityAlert {\n  id: string;\n  type: 'brute_force' | 'unusual_access' | 'data_breach' | 'malware' | 'phishing';\n  severity: 'low' | 'medium' | 'high' | 'critical';\n  title: string;\n  description: string;\n  affectedUsers: number;\n  timestamp: string;\n  status: 'active' | 'investigating' | 'resolved';\n}\n\ninterface SecurityAlertsProps {\n  alerts: SecurityAlert[];\n  onAlertClick?: (alert: SecurityAlert) => void;\n}\n\nexport default function SecurityAlerts({ alerts, onAlertClick }: SecurityAlertsProps) {\n  const getSeverityBadge = (severity: string) => {\n    switch (severity) {\n      case 'critical': return <Badge variant=\"destructive\" size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2.5 py-1 uppercase shadow-sm\">CRITICAL_NODE</Badge>;\n      case 'high': return <Badge variant=\"warning\" size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2.5 py-1 uppercase shadow-sm\">HIGH_ALERT</Badge>;\n      case 'medium': return <Badge variant=\"secondary\" className=\"bg-amber-500/10 text-amber-500 border-none font-black text-[8px] tracking-widest px-2.5 py-1 uppercase\">MEDIUM_VAL</Badge>;\n      default: return <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[8px] tracking-widest px-2.5 py-1 uppercase\">NORMAL_SYNC</Badge>;\n    }\n  };\n\n  const formatTime = (timestamp: string) => {\n    const date = new Date(timestamp);\n    const now = new Date();\n    const diff = now.getTime() - date.getTime();\n    const minutes = Math.floor(diff / 60000);\n    \n    if (minutes < 1) return 'JUST NOW';\n    if (minutes < 60) return `${minutes}M AGO`;\n    const hours = Math.floor(minutes / 60);\n    if (hours < 24) return `${hours}H AGO`;\n    const days = Math.floor(hours / 24);\n    return `${days}D AGO`;\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      className=\"space-y-6\"\n    >\n      <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n        <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 relative overflow-hidden\">\n          <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n            <ShieldWarning weight=\"fill\" className=\"w-48 h-48 text-primary\" />\n          </div>\n          <div className=\"flex items-center justify-between relative z-10\">\n            <div className=\"flex items-center gap-4\">\n              <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm transition-all group-hover:bg-primary/20\">\n                <Warning weight=\"duotone\" className=\"w-6 h-6\" />\n              </div>\n              <div>\n                <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Security Alerts</CardTitle>\n                <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Real-time anomaly detection nodes</p>\n              </div>\n            </div>\n            <Badge variant=\"destructive\" size=\"sm\" className=\"font-black text-[10px] tracking-widest px-4 py-1.5 shadow-glow-sm\">\n              {alerts.filter(a => a.status === 'active').length} ACTIVE_PAYLOADS\n            </Badge>\n          </div>\n        </CardHeader>\n        \n        <CardContent className=\"p-8 md:p-10 space-y-4 relative z-10\">\n          {alerts.length === 0 ? (\n            <div className=\"text-center py-12 bg-secondary/20 border-2 border-dashed border-border/50 rounded-[32px] opacity-40\">\n              <Pulse weight=\"duotone\" className=\"w-12 h-12 text-muted-foreground mx-auto mb-4 animate-pulse\" />\n              <p className=\"text-xs font-black uppercase tracking-[0.2em]\">Matrix Status: Nominal</p>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {alerts.map((alert, idx) => (\n                <motion.div\n                  key={alert.id}\n                  initial={{ opacity: 0, x: -20 }}\n                  animate={{ opacity: 1, x: 0 }}\n                  transition={{ delay: idx * 0.05 }}\n                  onClick={() => onAlertClick?.(alert)}\n                  className=\"p-6 bg-secondary/30 rounded-[32px] border border-border/50 hover:border-primary/30 transition-all group/alert cursor-pointer relative overflow-hidden shadow-inner\"\n                >\n                  <div className=\"absolute inset-0 bg-primary/5 opacity-0 group-hover/alert:opacity-100 transition-opacity\" />\n                  \n                  <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 relative z-10\">\n                    <div className=\"flex-1 space-y-4\">\n                      <div className=\"flex items-center gap-3\">\n                        {getSeverityBadge(alert.severity)}\n                        <Badge variant={alert.status === 'active' ? 'destructive' : 'secondary'} className=\"font-black text-[8px] uppercase tracking-widest px-2 py-0.5\">\n                          {alert.status.toUpperCase()}\n                        </Badge>\n                      </div>\n                      <div>\n                        <h4 className=\"text-base font-black text-foreground uppercase tracking-tight group-hover/alert:text-primary transition-colors\">{alert.title}</h4>\n                        <p className=\"text-[11px] text-muted-foreground font-medium italic leading-relaxed mt-1\">{alert.description}</p>\n                      </div>\n                      <div className=\"flex items-center gap-6 text-[9px] font-black text-muted-foreground uppercase tracking-widest opacity-60\">\n                        <div className=\"flex items-center gap-2\">\n                          <Clock weight=\"bold\" className=\"w-3 h-3\" />\n                          <span>{formatTime(alert.timestamp)}</span>\n                        </div>\n                        <div className=\"flex items-center gap-2 border-l border-border/50 pl-6\">\n                          <Pulse weight=\"bold\" className=\"w-3 h-3\" />\n                          <span>{alert.affectedUsers} Affected Nodes</span>\n                        </div>\n                      </div>\n                    </div>\n                    <Button \n                      variant=\"ghost\" \n                      size=\"sm\" \n                      className=\"h-10 w-10 p-0 rounded-xl hover:bg-primary/10 text-muted-foreground hover:text-primary transition-all self-end md:self-center border border-transparent hover:border-primary/20\"\n                    >\n                      <CaretRight weight=\"bold\" className=\"w-4 h-4 group-hover/alert:translate-x-1 transition-transform\" />\n                    </Button>\n                  </div>\n                </motion.div>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\security\\components\\SecurityEvents.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'motion' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"motion"},"fix":{"range":[24,31],"text":""},"desc":"Remove unused variable \"motion\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":3,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":33,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"AnimatePresence"},"fix":{"range":[15,71],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Globe' is defined but never used.","line":4,"column":54,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":59,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Globe"},"fix":{"range":[123,130],"text":""},"desc":"Remove unused variable \"Globe\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Icon' is defined but never used.","line":4,"column":98,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":102,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Icon"},"fix":{"range":[167,173],"text":""},"desc":"Remove unused variable \"Icon\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Pulse, CheckCircle, XCircle, Warning, User, Globe, Clock, MapPin, Monitor, ShieldCheck, Icon } from '@phosphor-icons/react';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { cn } from '@/lib/utils';\nimport ResponsiveTable from '@/components/ui/ResponsiveTable';\n\ninterface SecurityEvent {\n  id: string;\n  type: 'login' | 'password_change' | '2fa_enabled' | 'suspicious' | 'security_alert';\n  user: string;\n  email: string;\n  ip: string;\n  location: string;\n  timestamp: string;\n  status: 'success' | 'failed' | 'warning' | 'critical';\n  details: string;\n}\n\ninterface SecurityEventsProps {\n  events: SecurityEvent[];\n}\n\nexport default function SecurityEvents({ events }: SecurityEventsProps) {\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'success': return <CheckCircle className=\"w-4 h-4 text-emerald-400\" />;\n      case 'failed': return <XCircle className=\"w-4 h-4 text-red-400\" />;\n      case 'warning': return <Warning className=\"w-4 h-4 text-yellow-400\" />;\n      case 'critical': return <Pulse className=\"w-4 h-4 text-red-400\" />;\n      default: return <Pulse className=\"w-4 h-4 text-gray-400\" />;\n    }\n  };\n\n  const formatTime = (timestamp: string) => {\n    const date = new Date(timestamp);\n    const now = new Date();\n    const diff = now.getTime() - date.getTime();\n    const minutes = Math.floor(diff / 60000);\n    \n    if (minutes < 1) return 'Just now';\n    if (minutes < 60) return `${minutes}m ago`;\n    const hours = Math.floor(minutes / 60);\n    if (hours < 24) return `${hours}h ago`;\n    const days = Math.floor(hours / 24);\n    return `${days}d ago`;\n  };\n\n  const columns = [\n    {\n      header: 'Event Node',\n      accessor: (event: SecurityEvent) => (\n        <div className=\"flex items-center gap-4\">\n          <div className={cn(\n            \"w-10 h-10 rounded-xl flex items-center justify-center border shadow-sm transition-all duration-500\",\n            event.status === 'critical' ? \"bg-rose-500/10 border-rose-500/20 text-rose-500\" :\n            event.status === 'warning' ? \"bg-amber-500/10 border-amber-500/20 text-amber-500\" :\n            \"bg-emerald-500/10 border-emerald-500/20 text-emerald-500\"\n          )}>\n            <Pulse weight=\"duotone\" className=\"w-5 h-5\" />\n          </div>\n          <div className=\"min-w-0\">\n            <p className=\"font-bold text-foreground truncate uppercase tracking-tight leading-tight\">{event.type.replace('_', ' ')}</p>\n            <p className=\"text-[10px] text-muted-foreground font-medium truncate italic leading-relaxed opacity-60\">{event.details}</p>\n          </div>\n        </div>\n      )\n    },\n    {\n      header: 'Identity origin',\n      accessor: (event: SecurityEvent) => (\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-8 h-8 rounded-lg bg-secondary flex items-center justify-center text-muted-foreground shadow-inner\">\n            <User weight=\"bold\" className=\"w-4 h-4\" />\n          </div>\n          <div className=\"min-w-0\">\n            <p className=\"text-xs font-bold text-foreground truncate\">{event.user}</p>\n            <p className=\"text-[9px] text-muted-foreground truncate font-mono uppercase opacity-60\">{event.email}</p>\n          </div>\n        </div>\n      )\n    },\n    {\n      header: 'IP Network',\n      accessor: (event: SecurityEvent) => (\n        <div className=\"flex items-center gap-2\">\n          <Monitor weight=\"duotone\" className=\"w-4 h-4 text-primary/60\" />\n          <code className=\"text-[10px] font-mono font-bold text-primary/80\">{event.ip}</code>\n        </div>\n      )\n    },\n    {\n      header: 'Coordinate',\n      accessor: (event: SecurityEvent) => (\n        <div className=\"flex items-center gap-2\">\n          <MapPin weight=\"bold\" className=\"w-3.5 h-3.5 text-muted-foreground/40\" />\n          <span className=\"text-xs font-bold text-foreground uppercase tracking-tight truncate\">{event.location}</span>\n        </div>\n      )\n    },\n    {\n      header: 'Temporal',\n      accessor: (event: SecurityEvent) => (\n        <div className=\"flex items-center gap-2 text-muted-foreground\">\n          <Clock weight=\"bold\" className=\"w-3.5 h-3.5 opacity-40\" />\n          <span className=\"text-[10px] font-bold tabular-nums uppercase tracking-widest\">{formatTime(event.timestamp)}</span>\n        </div>\n      )\n    },\n    {\n      header: 'Integrity',\n      accessor: (event: SecurityEvent) => (\n        <div className=\"flex items-center gap-2\">\n          {getStatusIcon(event.status)}\n          <span className={cn(\"text-[9px] font-black uppercase tracking-widest\",\n            event.status === 'success' ? \"text-emerald-500\" : \n            event.status === 'failed' || event.status === 'critical' ? \"text-rose-500\" : \n            \"text-amber-500\"\n          )}>{event.status}</span>\n        </div>\n      )\n    }\n  ];\n\n  return (\n    <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n      <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 relative\">\n        <div className=\"absolute top-0 right-0 p-10 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n          <ShieldCheck weight=\"fill\" className=\"w-48 h-48 text-primary\" />\n        </div>\n        <div className=\"flex items-center justify-between relative z-10\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm transition-all group-hover:bg-primary/20\">\n              <Pulse weight=\"duotone\" className=\"w-6 h-6\" />\n            </div>\n            <div>\n              <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Security Event Registry</CardTitle>\n              <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.3em] font-black mt-1\">Global audit log of neural identity transmissions</p>\n            </div>\n          </div>\n          <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[10px] tracking-widest uppercase px-4 py-1.5\">\n            {events.length} NODES_LOGGED\n          </Badge>\n        </div>\n      </CardHeader>\n\n      <CardContent className=\"p-0\">\n        <ResponsiveTable\n          columns={columns}\n          data={events}\n          rowKey={(e) => e.id}\n          emptyMessage=\"Zero security events detected in current operational matrix.\"\n          mobileCard={(event) => (\n            <div className=\"space-y-5\">\n              <div className=\"flex justify-between items-start\">\n                <div className=\"flex items-center gap-4\">\n                  <div className={cn(\n                    \"w-12 h-12 rounded-2xl border flex items-center justify-center shadow-inner\",\n                    event.status === 'critical' ? \"bg-rose-500/10 border-rose-500/20 text-rose-500\" :\n                    event.status === 'warning' ? \"bg-amber-500/10 border-amber-500/20 text-amber-500\" :\n                    \"bg-emerald-500/10 border-emerald-500/20 text-emerald-500\"\n                  )}>\n                    <Pulse weight=\"duotone\" className=\"w-6 h-6\" />\n                  </div>\n                  <div className=\"min-w-0\">\n                    <p className=\"font-bold text-foreground truncate uppercase tracking-tight leading-tight\">{event.type.replace('_', ' ')}</p>\n                    <div className=\"flex items-center gap-2 mt-1\">\n                      <Badge variant={event.status === 'critical' ? 'destructive' : event.status === 'warning' ? 'warning' : 'success'} size=\"sm\" className=\"font-black text-[7px] tracking-widest px-1.5 py-0.5 uppercase shadow-sm\">\n                        {event.status}\n                      </Badge>\n                      <span className=\"text-[9px] font-mono text-muted-foreground opacity-60\">ID-{event.id.slice(0, 4).toUpperCase()}</span>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"text-right\">\n                  <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest opacity-40\">Temporal Node</p>\n                  <p className=\"text-[10px] font-black text-foreground tabular-nums tracking-widest\">{formatTime(event.timestamp)}</p>\n                </div>\n              </div>\n              \n              <div className=\"p-4 bg-secondary/30 rounded-2xl border border-border/50 shadow-inner group-hover/row:border-primary/20 transition-all\">\n                <p className=\"text-[10px] text-muted-foreground font-medium italic leading-relaxed\">{event.details}</p>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-6 py-4 border-y border-border/20\">\n                <div className=\"space-y-1\">\n                  <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em]\">Identity Origin</p>\n                  <p className=\"text-xs font-bold text-foreground truncate\">{event.user}</p>\n                </div>\n                <div className=\"space-y-1 text-right\">\n                  <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em]\">Coordinate</p>\n                  <p className=\"text-xs font-bold text-foreground truncate uppercase\">{event.location}</p>\n                </div>\n              </div>\n\n              <div className=\"flex justify-between items-center pt-1\">\n                <div className=\"flex items-center gap-2 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\n                  <Monitor weight=\"bold\" className=\"w-3.5 h-3.5 opacity-40\" />\n                  IP_{event.ip}\n                </div>\n                <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-mono text-[8px] px-2 py-0.5 tracking-tighter uppercase\">Verified_Node</Badge>\n              </div>\n            </div>\n          )}\n        />\n      </CardContent>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\security\\components\\SecurityIncidents.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'motion' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"motion"},"fix":{"range":[15,54],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Warning' is defined but never used.","line":4,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":58,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Warning"},"fix":{"range":[103,112],"text":""},"desc":"Remove unused variable \"Warning\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":15,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Badge"},"fix":{"range":[233,279],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[280,313],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { motion } from 'framer-motion';\nimport { ShieldCheck, ShieldWarning, CheckCircle, Warning, Pulse } from '@phosphor-icons/react';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { cn } from '@/lib/utils';\n\ninterface SecurityIncidentsProps {\n  resolvedIncidents: number;\n  activeIncidents: number;\n}\n\nexport default function SecurityIncidents({ resolvedIncidents, activeIncidents }: SecurityIncidentsProps) {\n  return (\n    <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n      <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 relative\">\n        <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n          <ShieldCheck weight=\"fill\" className=\"w-48 h-48 text-primary\" />\n        </div>\n        <div className=\"flex items-center gap-4 relative z-10\">\n          <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm transition-all group-hover:bg-primary/20\">\n            <ShieldCheck weight=\"duotone\" className=\"w-6 h-6\" />\n          </div>\n          <div>\n            <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Incident Oversight</CardTitle>\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Global security breach monitoring</p>\n          </div>\n        </div>\n      </CardHeader>\n      \n      <CardContent className=\"p-8 md:p-10 relative z-10\">\n        <div className=\"grid grid-cols-2 gap-8\">\n          <div className=\"text-center p-8 bg-emerald-500/5 rounded-[32px] border border-emerald-500/10 shadow-inner group/node relative overflow-hidden transition-all hover:bg-emerald-500/10\">\n            <div className=\"absolute top-0 right-0 p-4 opacity-0 group-hover/node:opacity-5 transition-opacity\">\n              <CheckCircle weight=\"fill\" className=\"w-16 h-16 text-emerald-500\" />\n            </div>\n            <p className=\"text-5xl font-black text-emerald-500 tabular-nums tracking-tighter mb-2\">{resolvedIncidents}</p>\n            <div className=\"flex items-center justify-center gap-2\">\n              <CheckCircle weight=\"bold\" className=\"w-3.5 h-3.5 text-emerald-500/60\" />\n              <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Settled Nodes</p>\n            </div>\n          </div>\n          <div className=\"text-center p-8 bg-rose-500/5 rounded-[32px] border border-rose-500/10 shadow-inner group/node relative overflow-hidden transition-all hover:bg-rose-500/10\">\n            <div className=\"absolute top-0 right-0 p-4 opacity-0 group-hover/node:opacity-5 transition-opacity\">\n              <ShieldWarning weight=\"fill\" className=\"w-16 h-16 text-rose-500\" />\n            </div>\n            <p className=\"text-5xl font-black text-rose-500 tabular-nums tracking-tighter mb-2\">{activeIncidents}</p>\n            <div className=\"flex items-center justify-center gap-2\">\n              <Pulse weight=\"bold\" className=\"w-3.5 h-3.5 text-rose-500/60 animate-pulse\" />\n              <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Active Threats</p>\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\security\\components\\SecurityMetrics.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'motion' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"motion"},"fix":{"range":[17,56],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendUp' is defined but never used.","line":4,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":55,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TrendUp"},"fix":{"range":[103,112],"text":""},"desc":"Remove unused variable \"TrendUp\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":4,"column":57,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":68,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle"},"fix":{"range":[112,125],"text":""},"desc":"Remove unused variable \"CheckCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Warning' is defined but never used.","line":4,"column":70,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":77,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Warning"},"fix":{"range":[125,134],"text":""},"desc":"Remove unused variable \"Warning\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Icon' is defined but never used.","line":4,"column":79,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":83,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Icon"},"fix":{"range":[134,140],"text":""},"desc":"Remove unused variable \"Icon\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pulse' is defined but never used.","line":4,"column":85,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":90,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pulse"},"fix":{"range":[140,147],"text":""},"desc":"Remove unused variable \"Pulse\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ShieldCheck' is defined but never used.","line":4,"column":92,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":103,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ShieldCheck"},"fix":{"range":[147,160],"text":""},"desc":"Remove unused variable \"ShieldCheck\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'timeRange' is assigned a value but never used.","line":20,"column":52,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":61},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'index' is defined but never used.","line":60,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":60,"endColumn":36},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":65,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":65,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1903,1906],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1903,1906],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { motion } from 'framer-motion';\r\nimport { Users, XCircle, Shield, DeviceMobile, TrendUp, CheckCircle, Warning, Icon, Pulse, ShieldCheck } from '@phosphor-icons/react';\r\nimport { useTranslations } from 'next-intl';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\n\r\ninterface SecurityMetrics {\r\n  activeSessions: number;\r\n  failedLogins: number;\r\n  securityAlerts: number;\r\n  twoFactorEnabled: number;\r\n}\r\n\r\ninterface SecurityMetricsProps {\r\n  metrics: SecurityMetrics;\r\n  timeRange?: '24h' | '7d' | '30d';\r\n}\r\n\r\nexport default function SecurityMetrics({ metrics, timeRange = '24h' }: SecurityMetricsProps) {\r\n  const t = useTranslations('admin.security');\r\n  \r\n  const metricCards = [\r\n    {\r\n      title: t('active_sessions'),\r\n      value: metrics.activeSessions,\r\n      trend: '+12% from yesterday',\r\n      trendType: 'up' as const,\r\n      icon: Users,\r\n      iconColor: 'text-blue-500'\r\n    },\r\n    {\r\n      title: t('failed_logins'),\r\n      value: metrics.failedLogins,\r\n      trend: '+5% from yesterday',\r\n      trendType: 'down' as const, // For security, more failed logins is bad\r\n      icon: XCircle,\r\n      iconColor: 'text-rose-500'\r\n    },\r\n    {\r\n      title: t('security_alerts_count'),\r\n      value: metrics.securityAlerts,\r\n      trend: '2 require attention',\r\n      trendType: 'down' as const,\r\n      icon: Shield,\r\n      iconColor: 'text-amber-500'\r\n    },\r\n    {\r\n      title: t('two_factor_enabled'),\r\n      value: metrics.twoFactorEnabled,\r\n      trend: '42% of users',\r\n      trendType: 'up' as const,\r\n      icon: DeviceMobile,\r\n      iconColor: 'text-emerald-500'\r\n    }\r\n  ];\r\n\r\n  return (\r\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8\">\r\n      {metricCards.map((card, index) => (\r\n        <StatCard\r\n          key={card.title}\r\n          title={card.title}\r\n          value={card.value}\r\n          icon={card.icon as any}\r\n          iconColor={card.iconColor}\r\n          trend={card.trendType}\r\n          className=\"p-4\"\r\n        />\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\security\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Shield' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":9,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Shield"},"fix":{"range":[142,149],"text":""},"desc":"Remove unused variable \"Shield\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":22,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[184,208],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Clock"},"fix":{"range":[234,243],"text":""},"desc":"Remove unused variable \"Clock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[243,256],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Briefcase"},"fix":{"range":[295,308],"text":""},"desc":"Remove unused variable \"Briefcase\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pulse' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pulse"},"fix":{"range":[363,372],"text":""},"desc":"Remove unused variable \"Pulse\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SecurityMetrics' is defined but never used.","line":32,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":23,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"SecurityMetrics"},"fix":{"range":[796,855],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":79,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":79,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":80,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":80,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'timeRange' is assigned a value but never used.","line":99,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":99,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setTimeRange' is assigned a value but never used.","line":99,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":99,"endColumn":33},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is assigned a value but never used.","line":102,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":102,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  Shield, \n  XCircle, \n  SpinnerGap, \n  Lock, \n  IdentificationBadge, \n  Key, \n  WarningCircle,\n  Clock,\n  ArrowLeft,\n  ShieldCheck,\n  Lightning,\n  Monitor,\n  Briefcase,\n  ArrowsClockwise,\n  Fingerprint,\n  Detective,\n  Icon,\n  Pulse\n} from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { useTranslations } from 'next-intl';\nimport SecurityMetrics from './components/SecurityMetrics';\nimport SecurityAlerts from './components/SecurityAlerts';\nimport SecurityEvents from './components/SecurityEvents';\nimport PasswordStrength from './components/PasswordStrength';\nimport APIKeyManagement from './components/APIKeyManagement';\nimport { cn } from '@/lib/utils';\n\ninterface SecurityMetricsData {\n  totalUsers: number;\n  activeSessions: number;\n  failedLogins: number;\n  suspiciousActivities: number;\n  securityAlerts: number;\n  passwordStrength: {\n    strong: number;\n    medium: number;\n    weak: number;\n  };\n  twoFactorEnabled: number;\n  activeIncidents: number;\n  resolvedIncidents: number;\n}\n\ninterface SecurityEvent {\n  id: string;\n  type: 'login' | 'password_change' | '2fa_enabled' | 'suspicious' | 'security_alert';\n  user: string;\n  email: string;\n  ip: string;\n  location: string;\n  timestamp: string;\n  status: 'success' | 'failed' | 'warning' | 'critical';\n  details: string;\n}\n\ninterface SecurityAlert {\n  id: string;\n  type: 'brute_force' | 'unusual_access' | 'data_breach' | 'malware' | 'phishing';\n  severity: 'low' | 'medium' | 'high' | 'critical';\n  title: string;\n  description: string;\n  affectedUsers: number;\n  timestamp: string;\n  status: 'active' | 'investigating' | 'resolved';\n}\n\nexport default function SecurityDashboard() {\n  const { goBack } = useBackNavigation();\n  const t = useTranslations('admin.security');\n  const [metrics, setMetrics] = useState<SecurityMetricsData>({\n    totalUsers: 0,\n    activeSessions: 0,\n    failedLogins: 0,\n    suspiciousActivities: 0,\n    securityAlerts: 0,\n    passwordStrength: {\n      strong: 0,\n      medium: 0,\n      weak: 0\n    },\n    twoFactorEnabled: 0,\n    activeIncidents: 0,\n    resolvedIncidents: 0\n  });\n\n  const [events, setEvents] = useState<SecurityEvent[]>([]);\n  const [alerts, setAlerts] = useState<SecurityAlert[]>([]);\n  const [timeRange, setTimeRange] = useState<'24h' | '7d' | '30d'>('24h');\n  const [selectedAlert, setSelectedAlert] = useState<SecurityAlert | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetchSecurityData = useCallback(async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      // Simulate API call\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      setMetrics({\n        totalUsers: 1250,\n        activeSessions: 42,\n        failedLogins: 15,\n        suspiciousActivities: 2,\n        securityAlerts: 3,\n        passwordStrength: { strong: 850, medium: 300, weak: 100 },\n        twoFactorEnabled: 65,\n        activeIncidents: 1,\n        resolvedIncidents: 24\n      });\n      setEvents([]);\n      setAlerts([]);\n    } catch (err) {\n      console.error('Error fetching security data:', err);\n      setError('Failed to load security registry.');\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchSecurityData();\n  }, [fetchSecurityData]);\n\n  if (loading && metrics.totalUsers === 0) {\n    return (\n      <div className=\"h-[80vh] flex flex-col items-center justify-center space-y-6\">\n        <SpinnerGap className=\"w-12 h-12 text-primary animate-spin\" />\n        <p className=\"text-sm font-black uppercase tracking-[0.3em] text-muted-foreground animate-pulse\">Accessing Security Core...</p>\n      </div>\n    );\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header Section */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <ShieldCheck weight=\"duotone\" className=\"w-4 h-4\" />\n            Fortress Intelligence Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n          >\n            System <span className=\"text-primary\">Security</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Orchestrating global security protocols, encryption nodes, and threat mitigation matrices.\n          </motion.p>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <Button \n            variant=\"outline\"\n            onClick={fetchSecurityData}\n            disabled={loading}\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\n          >\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\n            Sync Defense\n          </Button>\n          <Button className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\">\n            <Detective weight=\"bold\" className=\"w-4 h-4\" />\n            Threat Audit\n          </Button>\n        </div>\n      </div>\n\n      {/* Quick Stats Summary */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\n        <StatCard\n          title=\"Security Index\"\n          value={98.4}\n          suffix=\"%\"\n          decimals={1}\n          icon={ShieldCheck as Icon}\n          iconColor=\"text-emerald-500\"\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Active Identities\"\n          value={metrics.activeSessions}\n          icon={Fingerprint as Icon}\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Blocked Payloads\"\n          value={metrics.failedLogins}\n          icon={XCircle as Icon}\n          iconColor=\"text-rose-500\"\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Protocol Health\"\n          value={100}\n          suffix=\"%\"\n          icon={Lightning as Icon}\n          iconColor=\"text-amber-500\"\n          className=\"p-4\"\n        />\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-10 px-2\">\n        {/* Main Security Hub */}\n        <div className=\"lg:col-span-2 space-y-10\">\n          <SecurityAlerts alerts={alerts} />\n          \n          <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n            <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\n                  <Monitor weight=\"duotone\" className=\"w-6 h-6\" />\n                </div>\n                <div>\n                  <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Access Registry Node</CardTitle>\n                  <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Real-time identity transmission logs</p>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent className=\"p-0\">\n              <SecurityEvents events={events} />\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Sidebar Security Parameters */}\n        <div className=\"space-y-8\">\n          <Card className=\"p-8 rounded-[40px] border-border shadow-card relative overflow-hidden group\">\n            <div className=\"absolute -top-12 -right-12 w-48 h-48 bg-primary/10 blur-[60px] rounded-full group-hover:bg-primary/20 transition-all duration-700\" />\n            <h4 className=\"text-[10px] font-black text-primary uppercase tracking-[0.3em] flex items-center gap-3 mb-8 relative z-10\">\n              <Lock weight=\"duotone\" className=\"w-5 h-5\" />\n              Identity Protocol\n            </h4>\n            <div className=\"space-y-6 relative z-10\">\n              <PasswordStrength data={metrics.passwordStrength} />\n              <div className=\"pt-6 border-t border-border/30\">\n                <div className=\"flex justify-between items-center px-1\">\n                  <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">2FA Node Coverage</span>\n                  <Badge variant=\"ghost\" className=\"bg-emerald-500/5 text-emerald-500 border-none font-black text-[9px] uppercase px-3\">{metrics.twoFactorEnabled}% SYNC</Badge>\n                </div>\n              </div>\n            </div>\n          </Card>\n\n          <Card className=\"p-8 rounded-[40px] border-border shadow-card overflow-hidden group\">\n            <h4 className=\"text-[10px] font-black text-foreground uppercase tracking-[0.3em] flex items-center gap-3 mb-6\">\n              <Key weight=\"duotone\" className=\"w-5 h-5 text-primary\" />\n              API Uplink Matrix\n            </h4>\n            <div className=\"space-y-4\">\n              <APIKeyManagement />\n            </div>\n          </Card>\n\n          <Card className=\"p-8 rounded-[40px] border-rose-500/10 bg-rose-500/[0.02] space-y-4 group\">\n            <h4 className=\"text-[10px] font-black text-rose-400 uppercase tracking-[0.3em] flex items-center gap-3\">\n              <WarningCircle weight=\"duotone\" className=\"w-5 h-5 group-hover:scale-110 transition-transform\" />\n              Containment Status\n            </h4>\n            <div className=\"space-y-3\">\n              <div className=\"flex justify-between items-center\">\n                <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Active Incidents</span>\n                <span className=\"text-sm font-black text-rose-500 tabular-nums\">{metrics.activeIncidents} Nodes</span>\n              </div>\n              <p className=\"text-[10px] text-muted-foreground font-medium italic leading-relaxed\">\n                Critical system vulnerabilities are automatically isolated in sector delta.\n              </p>\n            </div>\n          </Card>\n        </div>\n      </div>\n\n      <AnimatePresence>\n        {selectedAlert && (\n          <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-[200] p-4 flex items-center justify-center\">\n            <motion.div\n              initial={{ scale: 0.95, opacity: 0 }}\n              animate={{ scale: 1, opacity: 1 }}\n              exit={{ scale: 0.95, opacity: 0 }}\n              className=\"bg-card border border-border rounded-[40px] p-10 max-w-lg w-full relative overflow-hidden\"\n            >\n              <div className=\"flex items-center justify-between mb-8\">\n                <h3 className=\"text-2xl font-black uppercase tracking-tight\">Alert Protocol</h3>\n                <Button variant=\"ghost\" onClick={() => setSelectedAlert(null)}>\n                  <XCircle weight=\"bold\" className=\"w-6 h-6\" />\n                </Button>\n              </div>\n              <div className=\"space-y-4\">\n                <p className=\"text-lg font-bold\">{selectedAlert.title}</p>\n                <p className=\"text-sm text-muted-foreground\">{selectedAlert.description}</p>\n              </div>\n            </motion.div>\n          </div>\n        )}\n      </AnimatePresence>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\settings\\components\\CompanySettings.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":5,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":30,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"X"},"fix":{"range":[130,133],"text":""},"desc":"Remove unused variable \"X\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Headset' is defined but never used.","line":5,"column":55,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":62,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Headset"},"fix":{"range":[156,165],"text":""},"desc":"Remove unused variable \"Headset\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":5,"column":150,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":159,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Briefcase"},"fix":{"range":[251,262],"text":""},"desc":"Remove unused variable \"Briefcase\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Button"},"fix":{"range":[426,474],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[476,509],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":13,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[627,630],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[627,630],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":217,"column":23,"nodeType":"JSXOpeningElement","endLine":217,"endColumn":109}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { Buildings, Upload, X, EnvelopeSimple, Phone, Headset, IdentificationBadge, Sparkle, Globe, MapPin, Camera, CloudArrowUp, CheckCircle, Info, Briefcase } from '@phosphor-icons/react';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { cn } from '@/lib/utils';\r\nimport { useSettingsContext } from '../context';\r\n\r\ninterface CompanySettingsProps {\r\n  onSettingsChange: (updates: any) => void;\r\n}\r\n\r\nexport default function CompanySettings({ onSettingsChange }: CompanySettingsProps) {\r\n  const { settings } = useSettingsContext();\r\n  const [formData, setFormData] = useState({\r\n    companyName: '',\r\n    registrationNumber: '',\r\n    supportEmail: '',\r\n    supportPhone: '',\r\n    address: '',\r\n    websiteUrl: '',\r\n    logoUrl: '',\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (settings) {\r\n      setFormData({\r\n        companyName: settings.companyName || '',\r\n        registrationNumber: settings.registrationNumber || '',\r\n        supportEmail: settings.supportEmail || '',\r\n        supportPhone: settings.supportPhone || '',\r\n        address: settings.address || '',\r\n        websiteUrl: settings.websiteUrl || '',\r\n        logoUrl: settings.logoUrl || '',\r\n      });\r\n    }\r\n  }, [settings]);\r\n\r\n  const handleChange = (field: string, value: string) => {\r\n    const newData = { ...formData, [field]: value };\r\n    setFormData(newData);\r\n    onSettingsChange(newData);\r\n  };\r\n\r\n  const handleLogoUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0];\r\n    if (file) {\r\n      // In a real app, you'd upload to storage and get URL\r\n      const url = URL.createObjectURL(file);\r\n      handleChange('logoUrl', url);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0, y: 20 }}\r\n      animate={{ opacity: 1, y: 0 }}\r\n      className=\"space-y-10\"\r\n    >\r\n      <div className=\"grid grid-cols-1 xl:grid-cols-3 gap-10\">\r\n        {/* Core Identity Matrix */}\r\n        <div className=\"xl:col-span-2 space-y-10\">\r\n          <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n            <CardHeader className=\"p-10 border-b border-border/50 bg-secondary/30 relative overflow-hidden\">\r\n              <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                <Buildings className=\"w-64 h-64 text-primary\" />\r\n              </div>\r\n              <div className=\"flex items-center gap-5 relative z-10\">\r\n                <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\r\n                  <Buildings weight=\"duotone\" className=\"w-7 h-7\" />\r\n                </div>\r\n                <div>\r\n                  <CardTitle className=\"text-2xl font-black uppercase tracking-tight\">Organization Node</CardTitle>\r\n                  <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] mt-1\">Core company metadata registry</p>\r\n                </div>\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent className=\"p-10 space-y-10 relative z-10\">\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10\">\r\n                <div className=\"space-y-3\">\r\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Company Designation</label>\r\n                  <div className=\"relative group/input\">\r\n                    <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-2xl\" />\r\n                    <Buildings weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\r\n                    <input\r\n                      type=\"text\"\r\n                      value={formData.companyName}\r\n                      onChange={(e) => handleChange('companyName', e.target.value)}\r\n                      className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-bold tracking-tight relative z-10\"\r\n                      placeholder=\"e.g. BioCore Aesthetic\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-3\">\r\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Registration Node</label>\r\n                  <div className=\"relative group/input\">\r\n                    <IdentificationBadge weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\r\n                    <input\r\n                      type=\"text\"\r\n                      value={formData.registrationNumber}\r\n                      onChange={(e) => handleChange('registrationNumber', e.target.value)}\r\n                      className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-mono text-xs relative z-10\"\r\n                      placeholder=\"TAX-ID-XXXX-XXXX\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-3\">\r\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Neural Mail Domain</label>\r\n                  <div className=\"relative group/input\">\r\n                    <EnvelopeSimple weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\r\n                    <input\r\n                      type=\"email\"\r\n                      value={formData.supportEmail}\r\n                      onChange={(e) => handleChange('supportEmail', e.target.value)}\r\n                      className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-medium italic\"\r\n                      placeholder=\"ops@biocore.network\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-3\">\r\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Comm Channel Link</label>\r\n                  <div className=\"relative group/input\">\r\n                    <Phone weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\r\n                    <input\r\n                      type=\"tel\"\r\n                      value={formData.supportPhone}\r\n                      onChange={(e) => handleChange('supportPhone', e.target.value)}\r\n                      className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-bold tabular-nums\"\r\n                      placeholder=\"+66 00-000-0000\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"space-y-3 pt-4\">\r\n                <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Headquarters Coordinate</label>\r\n                <div className=\"relative group/input\">\r\n                  <MapPin weight=\"bold\" className=\"absolute left-4 top-4 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\r\n                  <textarea\r\n                    value={formData.address}\r\n                    onChange={(e) => handleChange('address', e.target.value)}\r\n                    className=\"w-full pl-12 pr-6 py-4 bg-secondary/30 border border-border rounded-[28px] text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all resize-none font-medium leading-relaxed italic h-32\"\r\n                    placeholder=\"Full physical headquarters coordinate...\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n            <CardHeader className=\"p-10 border-b border-border/50 bg-secondary/30\">\r\n              <div className=\"flex items-center gap-5\">\r\n                <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\r\n                  <Globe weight=\"duotone\" className=\"w-7 h-7\" />\r\n                </div>\r\n                <div>\r\n                  <CardTitle className=\"text-2xl font-black uppercase tracking-tight\">Digital Horizon</CardTitle>\r\n                  <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] mt-1\">Web presence & social uplink nodes</p>\r\n                </div>\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent className=\"p-10 space-y-8\">\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                <div className=\"space-y-3\">\r\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Main Uplink URL</label>\r\n                  <div className=\"relative group/input\">\r\n                    <Globe weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\r\n                    <input\r\n                      type=\"url\"\r\n                      value={formData.websiteUrl}\r\n                      onChange={(e) => handleChange('websiteUrl', e.target.value)}\r\n                      className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-medium italic\"\r\n                      placeholder=\"https://biocore.network\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"space-y-3\">\r\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Social Matrix Link</label>\r\n                  <div className=\"relative group/input\">\r\n                    <IdentificationBadge weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\r\n                    <input\r\n                      type=\"text\"\r\n                      value={formData.socialMatrixLink}\r\n                      onChange={(e) => handleChange('socialMatrixLink', e.target.value)}\r\n                      className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary transition-all font-medium\"\r\n                      placeholder=\"@biocore_aesthetic\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* Branding & Media Sidebar */}\r\n        <div className=\"space-y-10\">\r\n          <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n            <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n                  <Camera weight=\"duotone\" className=\"w-5 h-5\" />\r\n                </div>\r\n                <CardTitle className=\"text-sm font-black uppercase tracking-tight\">Visual Identity</CardTitle>\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent className=\"p-8 space-y-8\">\r\n              <div className=\"flex flex-col items-center gap-6\">\r\n                <div className=\"relative group/logo\">\r\n                  <div className=\"w-40 h-40 rounded-[48px] bg-secondary border-2 border-dashed border-border flex items-center justify-center overflow-hidden transition-all group-hover/logo:border-primary/50 shadow-inner\">\r\n                    {formData.logoUrl ? (\r\n                      <img src={formData.logoUrl} alt=\"Logo\" className=\"w-full h-full object-contain p-4\" />\r\n                    ) : (\r\n                      <div className=\"flex flex-col items-center gap-3 opacity-20 group-hover/logo:opacity-40 transition-opacity\">\r\n                        <Buildings className=\"w-12 h-12\" />\r\n                        <span className=\"text-[8px] font-black uppercase tracking-widest\">Logo Placeholder</span>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  <button className=\"absolute -bottom-3 -right-3 w-12 h-12 rounded-2xl bg-primary text-primary-foreground flex items-center justify-center shadow-premium hover:scale-110 transition-all active:scale-95 border-4 border-card\">\r\n                    <CloudArrowUp weight=\"bold\" className=\"w-5 h-5\" />\r\n                    <input\r\n                      type=\"file\"\r\n                      id=\"logo-upload\"\r\n                      accept=\"image/*\"\r\n                      onChange={handleLogoUpload}\r\n                      className=\"hidden\"\r\n                    />\r\n                    <label\r\n                      htmlFor=\"logo-upload\"\r\n                      className=\"inline-flex items-center gap-3 px-6 py-3 bg-primary text-primary-foreground rounded-2xl font-black uppercase tracking-widest text-[10px] shadow-premium hover:brightness-110 transition-all cursor-pointer active:scale-95\"\r\n                    >\r\n                      <Upload weight=\"bold\" className=\"w-4 h-4\" />\r\n                      Upload Identity Asset\r\n                    </label>\r\n                  </button>\r\n                </div>\r\n                <div className=\"text-center space-y-1\">\r\n                  <p className=\"text-[10px] font-black text-foreground uppercase tracking-widest\">Master Asset Node</p>\r\n                  <p className=\"text-[9px] text-muted-foreground uppercase tracking-widest leading-relaxed\">SVG, PNG or WebP max 5MB<br/>Preferred resolution 512x512</p>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"pt-8 border-t border-border/30 space-y-6\">\r\n                <div className=\"flex items-center justify-between px-1\">\r\n                  <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Cluster Status</span>\r\n                  <Badge variant=\"success\" size=\"sm\" className=\"font-black text-[8px] uppercase px-3 py-1 tracking-widest shadow-sm\">VERIFIED_NODE</Badge>\r\n                </div>\r\n                <div className=\"p-5 bg-primary/5 rounded-[32px] border border-primary/10 space-y-3 group/brief overflow-hidden relative\">\r\n                  <div className=\"absolute top-0 right-0 p-4 opacity-[0.03] group-hover/brief:scale-110 transition-transform\">\r\n                    <Sparkle weight=\"fill\" className=\"w-16 h-16 text-primary\" />\r\n                  </div>\r\n                  <h4 className=\"text-[10px] font-black text-primary uppercase tracking-[0.2em] relative z-10 flex items-center gap-2\">\r\n                    <Info weight=\"bold\" className=\"w-3 h-3\" />\r\n                    Node Protocol\r\n                  </h4>\r\n                  <p className=\"text-[10px] text-muted-foreground italic font-medium leading-relaxed relative z-10 opacity-80\">\r\n                    Company metadata is propagated across all clinical terminal points within this regional administrative sector.\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card className=\"p-8 rounded-[40px] border-border shadow-card overflow-hidden group\">\r\n            <h4 className=\"text-[10px] font-black text-foreground uppercase tracking-[0.3em] flex items-center gap-3 mb-6\">\r\n              <CheckCircle weight=\"duotone\" className=\"w-5 h-5 text-primary\" />\r\n              Integrity Sync\r\n            </h4>\r\n            <div className=\"space-y-4\">\r\n              <div className=\"flex items-center justify-between p-4 bg-secondary/30 rounded-2xl border border-border/50 hover:bg-secondary/50 transition-all\">\r\n                <span className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">Metadata Hash</span>\r\n                <span className=\"text-[9px] font-mono text-primary font-bold\">SHA-256_SYNC</span>\r\n              </div>\r\n              <p className=\"text-[10px] text-muted-foreground font-medium italic leading-relaxed text-center opacity-60\">\r\n                Authorized administrative clearance required for core record modifications.\r\n              </p>\r\n            </div>\r\n          </Card>\r\n        </div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\settings\\components\\EmailTemplates.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Invalid character.","line":58,"column":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { \n  FloppyDisk, \n  Eye, \n  PaperPlaneTilt, \n  Plus, \n  Trash, \n  PencilSimple, \n  EnvelopeSimple, \n  Code, \n  FileText, \n  User, \n  CalendarDots, \n  CurrencyDollar, \n  WarningCircle,\n  Sparkle,\n  Info,\n  CaretRight,\n  ArrowsClockwise,\n  X,\n  CheckCircle,\n  Copy,\n  Archive,\n  Lightning,\n  Monitor,\n  Icon\n} from '@phosphor-icons/react';\nimport { useSettingsContext } from '../context';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/Badge';\nimport { cn } from '@/lib/utils';\nimport { useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\ninterface EmailTemplate {\n  id: string;\n  name: string;\n  subject: string;\n  html_content: string;\n  text_content: string;\n  variables: string[];\n  category: 'transactional' | 'marketing' | 'notification' | 'system';\n  is_active: boolean;\n  created_at: string;\n  updated_at: string;\n}\n\ninterface EmailTemplatesProps {\n  onSettingsChange?: (updates: any) => void;\n}\n\nconst defaultTemplates: Omit<EmailTemplate, 'id' | 'created_at' | 'updated_at'>[] = [\n  {\n    name: 'Welcome Email',\n    subject: 'Welcome to BN-Aura! Let\\'s get started',\n    html_content: \\\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h1 style=\"color: #6366f1;\">Welcome to BN-Aura, {{user_name}}!</h1>\n        <p>Thank you for joining us. Your account is now ready to use.</p>\n        <div style=\"background: #f3f4f6; padding: 20px; border-radius: 8px; margin: 20px 0;\">\n          <h3>Your Account Details:</h3>\n          <p>Email: {{user_email}}</p>\n          <p>Plan: {{subscription_plan}}</p>\n          <p>Clinic: {{clinic_name}}</p>\n        </div>\n        <a href=\"{{login_url}}\" style=\"background: #6366f1; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block;\">\n          Get Started\n        </a>\n        <p style=\"margin-top: 30px; color: #6b7280; font-size: 12px;\">\n           2026 BN-Aura. All rights reserved.\n        </p>\n      </div>\n    \\,\n    text_content: \\Welcome to BN-Aura, {{user_name}}!\n\nThank you for joining us. Your account is now ready to use.\n\nAccount Details:\nEmail: {{user_email}}\nPlan: {{subscription_plan}}\nClinic: {{clinic_name}}\n\nGet started here: {{login_url}}\n\n 2026 BN-Aura. All rights reserved.\\,\n    variables: ['user_name', 'user_email', 'subscription_plan', 'clinic_name', 'login_url'],\n    category: 'transactional',\n    is_active: true\n  },\n  {\n    name: 'Invoice Reminder',\n    subject: 'Invoice #{{invoice_number}} - Payment Due',\n    html_content: \\\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h1 style=\"color: #ef4444;\">Invoice Reminder</h1>\n        <p>Hi {{user_name}},</p>\n        <p>This is a reminder that your invoice is due for payment.</p>\n        <div style=\"background: #fef2f2; border: 1px solid #fecaca; padding: 20px; border-radius: 8px; margin: 20px 0;\">\n          <h3>Invoice Details:</h3>\n          <p>Invoice Number: {{invoice_number}}</p>\n          <p>Amount: {{amount}}</p>\n          <p>Due Date: {{due_date}}</p>\n          <p>Status: {{status}}</p>\n        </div>\n        <a href=\"{{payment_url}}\" style=\"background: #ef4444; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block;\">\n          Pay Now\n        </a>\n        <p style=\"margin-top: 30px; color: #6b7280; font-size: 12px;\">\n           2026 BN-Aura. All rights reserved.\n        </p>\n      </div>\n    \\,\n    text_content: \\Invoice Reminder\n\nHi {{user_name}},\n\nThis is a reminder that your invoice is due for payment.\n\nInvoice Details:\nInvoice Number: {{invoice_number}}\nAmount: {{amount}}\nDue Date: {{due_date}}\nStatus: {{status}}\n\nPay here: {{payment_url}}\n\n 2026 BN-Aura. All rights reserved.\\,\n    variables: ['user_name', 'invoice_number', 'amount', 'due_date', 'status', 'payment_url'],\n    category: 'transactional',\n    is_active: true\n  },\n  {\n    name: 'Password Reset',\n    subject: 'Reset your BN-Aura password',\n    html_content: \\\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h1 style=\"color: #6366f1;\">Password Reset Request</h1>\n        <p>Hi {{user_name}},</p>\n        <p>We received a request to reset your password. Click the button below to reset it.</p>\n        <div style=\"background: #f3f4f6; padding: 20px; border-radius: 8px; margin: 20px 0;\">\n          <p style=\"color: #ef4444;\"><strong>This link will expire in 1 hour.</strong></p>\n        </div>\n        <a href=\"{{reset_url}}\" style=\"background: #6366f1; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block;\">\n          Reset Password\n        </a>\n        <p style=\"margin-top: 30px; color: #6b7280; font-size: 12px;\">\n          If you didn't request this, please ignore this email.\n           2026 BN-Aura. All rights reserved.\n        </p>\n      </div>\n    \\,\n    text_content: \\Password Reset Request\n\nHi {{user_name}},\n\nWe received a request to reset your password. Click the link below to reset it.\n\nThis link will expire in 1 hour.\n\nReset password: {{reset_url}}\n\nIf you didn't request this, please ignore this email.\n 2026 BN-Aura. All rights reserved.\\,\n    variables: ['user_name', 'reset_url'],\n    category: 'system',\n    is_active: true\n  }\n];\n\nexport default function EmailTemplates({ onSettingsChange }: EmailTemplatesProps) {\n  const { settings, updateSettings, loading } = useSettingsContext();\n  const [templates, setTemplates] = useState<EmailTemplate[]>([\n    {\n      id: 'welcome',\n      ...defaultTemplates[0],\n      created_at: new Date().toISOString(),\n      updated_at: new Date().toISOString()\n    },\n    {\n      id: 'invoice',\n      ...defaultTemplates[1],\n      created_at: new Date().toISOString(),\n      updated_at: new Date().toISOString()\n    },\n    {\n      id: 'password_reset',\n      ...defaultTemplates[2],\n      created_at: new Date().toISOString(),\n      updated_at: new Date().toISOString()\n    }\n  ]);\n  \n  const [selectedTemplate, setSelectedTemplate] = useState<EmailTemplate | null>(null);\n  const [editingTemplate, setEditingTemplate] = useState<EmailTemplate | null>(null);\n  const [showPreview, setShowPreview] = useState(false);\n  const [activeTab, setActiveTab] = useState<'html' | 'text' | 'preview'>('html');\n  const [testEmail, setTestEmail] = useState('');\n  const [showTestDialog, setShowTestDialog] = useState(false);\n\n  const categories = [\n    { value: 'transactional', label: 'Transactional', icon: CurrencyDollar, color: 'text-blue-400' },\n    { value: 'marketing', label: 'Marketing', icon: EnvelopeSimple, color: 'text-purple-400' },\n    { value: 'notification', label: 'Notification', icon: WarningCircle, color: 'text-yellow-400' },\n    { value: 'system', label: 'System', icon: Code, color: 'text-green-400' }\n  ];\n\n  const handleSaveTemplate = async () => {\n    if (!editingTemplate) return;\n    \n    setTemplates(prev => prev.map(t => \n      t.id === editingTemplate.id \n        ? { ...editingTemplate, updated_at: new Date().toISOString() }\n        : t\n    ));\n    \n    setEditingTemplate(null);\n    \n    // TODO: Save to backend\n    console.log('Template saved:', editingTemplate);\n  };\n\n  const handleDeleteTemplate = (id: string) => {\n    if (confirm('Are you sure you want to delete this template?')) {\n      setTemplates(prev => prev.filter(t => t.id !== id));\n      if (selectedTemplate?.id === id) {\n        setSelectedTemplate(null);\n      }\n    }\n  };\n\n  const handleDuplicateTemplate = (template: EmailTemplate) => {\n    const newTemplate: EmailTemplate = {\n      ...template,\n      id: \\\\_copy_\\\\,\n      name: \\\\ (Copy)\\,\n      created_at: new Date().toISOString(),\n      updated_at: new Date().toISOString()\n    };\n    setTemplates(prev => [...prev, newTemplate]);\n  };\n\n  const handleSendTest = async () => {\n    if (!selectedTemplate || !testEmail) return;\n    \n    // TODO: Send test email\n    console.log('Sending test email:', {\n      to: testEmail,\n      template: selectedTemplate\n    });\n    \n    alert(\\Test email sent to \\\\);\n    setShowTestDialog(false);\n    setTestEmail('');\n  };\n\n  const renderPreview = (content: string) => {\n    let preview = content;\n    if (selectedTemplate) {\n      selectedTemplate.variables.forEach(variable => {\n        const value = {\n          user_name: 'John Doe',\n          user_email: 'john@example.com',\n          subscription_plan: 'Professional',\n          clinic_name: 'Test Clinic',\n          login_url: 'https://app.bnaura.com/login',\n          invoice_number: 'INV-001',\n          amount: '๏ฟฝ4,900',\n          due_date: '2026-02-15',\n          status: 'Pending',\n          payment_url: 'https://app.bnaura.com/pay/INV-001',\n          reset_url: 'https://app.bnaura.com/reset/abc123'\n        }[variable] || \\[\\]\\;\n        preview = preview.replace(new RegExp(\\{{\\}}\\, 'g'), value);\n      });\n    }\n    return { __html: preview };\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      className=\"space-y-8\"\n    >\n      <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n        <div className=\"absolute top-0 right-0 p-12 opacity-[0.02] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n          <EnvelopeSimple className=\"w-64 h-64 text-primary\" />\n        </div>\n\n        <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 flex flex-row items-center justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\n              <EnvelopeSimple weight=\"duotone\" className=\"w-6 h-6\" />\n            </div>\n            <div>\n              <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Communications Matrix</CardTitle>\n              <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Template management and automated payload orchestration</p>\n            </div>\n          </div>\n          <Button\n            onClick={() => {\n              const newTemplate: EmailTemplate = {\n                id: \\\template_\\\\,\n                name: 'New Node Protocol',\n                subject: '',\n                html_content: '',\n                text_content: '',\n                variables: [],\n                category: 'transactional',\n                is_active: true,\n                created_at: new Date().toISOString(),\n                updated_at: new Date().toISOString()\n              };\n              setTemplates(prev => [...prev, newTemplate]);\n              setEditingTemplate(newTemplate);\n              setSelectedTemplate(newTemplate);\n            }}\n            className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\"\n          >\n            <Plus weight=\"bold\" className=\"w-4 h-4\" />\n            Initialize Template\n          </Button>\n        </CardHeader>\n\n        <CardContent className=\"p-8 md:p-10 relative z-10\">\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-10\">\n            {/* Template List Node */}\n            <div className=\"lg:col-span-1 space-y-8\">\n              <div className=\"flex items-center justify-between px-2\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-1.5 h-1.5 rounded-full bg-primary shadow-[0_0_8px_hsl(var(--primary)/0.6)]\" />\n                  <h3 className=\"text-[11px] font-black text-foreground uppercase tracking-[0.3em]\">Identity Hub</h3>\n                </div>\n                <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[8px] tracking-widest uppercase\">\n                  {templates.length} Protocol Nodes\n                </Badge>\n              </div>\n              \n              <div className=\"space-y-6 max-h-[700px] overflow-y-auto pr-2 custom-scrollbar\">\n                {categories.map(category => (\n                  <div key={category.value} className=\"space-y-3\">\n                    <div className=\"flex items-center gap-2 px-2\">\n                      <category.icon weight=\"bold\" className={cn(\"w-3.5 h-3.5\", category.color)} />\n                      <span className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">{category.label} Node</span>\n                    </div>\n                    <div className=\"space-y-2\">\n                      {templates\n                        .filter(t => t.category === category.value)\n                        .map(template => (\n                          <motion.div\n                            key={template.id}\n                            whileHover={{ x: 4 }}\n                            onClick={() => {\n                              setSelectedTemplate(template);\n                              setEditingTemplate(null);\n                              setActiveTab('html');\n                            }}\n                            className={cn(\n                              \"p-4 rounded-2xl border transition-all cursor-pointer group/node relative overflow-hidden\",\n                              selectedTemplate?.id === template.id\n                                ? \"bg-primary/5 border-primary/30 shadow-sm\"\n                                : \"bg-secondary/20 border-border/50 hover:border-primary/20\"\n                            )}\n                          >\n                            <div className=\"flex items-center justify-between relative z-10\">\n                              <div className=\"space-y-0.5 min-w-0 flex-1\">\n                                <p className={cn(\n                                  \"text-sm font-bold uppercase tracking-tight truncate transition-colors\",\n                                  selectedTemplate?.id === template.id ? \"text-primary\" : \"text-foreground\"\n                                )}>{template.name}</p>\n                                <p className=\"text-[9px] text-muted-foreground font-medium italic truncate opacity-60\">{template.subject || 'Payload not defined'}</p>\n                              </div>\n                              <div className=\"flex items-center gap-1 ml-3\">\n                                <Button\n                                  variant=\"ghost\"\n                                  size=\"sm\"\n                                  onClick={(e) => {\n                                    e.stopPropagation();\n                                    handleDuplicateTemplate(template);\n                                  }}\n                                  className=\"h-7 w-7 p-0 opacity-0 group-hover/node:opacity-100 hover:bg-primary/10 hover:text-primary rounded-lg transition-all\"\n                                >\n                                  <Copy weight=\"bold\" className=\"w-3 h-3\" />\n                                </Button>\n                                <Button\n                                  variant=\"ghost\"\n                                  size=\"sm\"\n                                  onClick={(e) => {\n                                    e.stopPropagation();\n                                    handleDeleteTemplate(template.id);\n                                  }}\n                                  className=\"h-7 w-7 p-0 opacity-0 group-hover/node:opacity-100 hover:bg-rose-500/10 hover:text-rose-500 rounded-lg transition-all\"\n                                >\n                                  <Trash weight=\"bold\" className=\"w-3 h-3\" />\n                                </Button>\n                              </div>\n                            </div>\n                          </motion.div>\n                        ))}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n\n            {/* Template Editor Node */}\n            <div className=\"lg:col-span-2\">\n              <AnimatePresence mode=\"wait\">\n                {selectedTemplate ? (\n                  <motion.div\n                    key={selectedTemplate.id}\n                    initial={{ opacity: 0, scale: 0.98 }}\n                    animate={{ opacity: 1, scale: 1 }}\n                    exit={{ opacity: 0, scale: 0.98 }}\n                    className=\"space-y-8\"\n                  >\n                    <Card className=\"rounded-[32px] border-border/50 bg-secondary/10 shadow-inner overflow-hidden\">\n                      <div className=\"p-8 space-y-8\">\n                        {/* Editor Header */}\n                        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-6\">\n                          <div className=\"flex-1 min-w-0\">\n                            {editingTemplate ? (\n                              <div className=\"relative group\">\n                                <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-xl\" />\n                                <input\n                                  type=\"text\"\n                                  value={editingTemplate.name}\n                                  onChange={(e) => setEditingTemplate({ ...editingTemplate, name: e.target.value })}\n                                  className=\"text-xl font-black text-foreground bg-card border border-border rounded-xl py-2 px-4 w-full focus:border-primary outline-none transition-all shadow-inner uppercase tracking-tight relative z-10\"\n                                />\n                              </div>\n                            ) : (\n                              <div className=\"flex items-center gap-4\">\n                                <h3 className=\"text-2xl font-black text-foreground uppercase tracking-tight truncate\">{selectedTemplate.name}</h3>\n                                <Badge variant={selectedTemplate.is_active ? 'success' : 'secondary'} size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2\">\n                                  {selectedTemplate.is_active ? 'OPERATIONAL' : 'OFFLINE'}\n                                </Badge>\n                              </div>\n                            )}\n                          </div>\n                          \n                          <div className=\"flex items-center gap-3 shrink-0\">\n                            {editingTemplate ? (\n                              <div className=\"flex items-center gap-2\">\n                                <Button\n                                  onClick={handleSaveTemplate}\n                                  className=\"gap-2 px-6 py-3 rounded-xl text-[10px] font-black uppercase tracking-widest shadow-premium\"\n                                >\n                                  <CheckCircle weight=\"bold\" className=\"w-4 h-4\" />\n                                  Commit\n                                </Button>\n                                <Button\n                                  variant=\"outline\"\n                                  onClick={() => {\n                                    setEditingTemplate(null);\n                                    setSelectedTemplate(templates.find(t => t.id === selectedTemplate.id) || null);\n                                  }}\n                                  className=\"gap-2 px-6 py-3 rounded-xl text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\"\n                                >\n                                  <X weight=\"bold\" className=\"w-4 h-4\" />\n                                  Abort\n                                </Button>\n                              </div>\n                            ) : (\n                              <div className=\"flex items-center gap-2\">\n                                <Button\n                                  onClick={() => setEditingTemplate(selectedTemplate)}\n                                  className=\"gap-2 px-6 py-3 rounded-xl text-[10px] font-black uppercase tracking-widest shadow-premium\"\n                                >\n                                  <PencilSimple weight=\"bold\" className=\"w-4 h-4\" />\n                                  Modify\n                                </Button>\n                                <Button\n                                  variant=\"outline\"\n                                  onClick={() => setShowTestDialog(true)}\n                                  className=\"gap-2 px-6 py-3 rounded-xl text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\"\n                                >\n                                  <PaperPlaneTilt weight=\"bold\" className=\"w-4 h-4\" />\n                                  Ping Test\n                                </Button>\n                              </div>\n                            )}\n                          </div>\n                        </div>\n\n                        {/* Subject Parameter */}\n                        <div className=\"space-y-2\">\n                          <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Payload Subject Protocol</label>\n                          {editingTemplate ? (\n                            <input\n                              type=\"text\"\n                              value={editingTemplate.subject}\n                              onChange={(e) => setEditingTemplate({ ...editingTemplate, subject: e.target.value })}\n                              className=\"w-full bg-card border border-border rounded-xl py-3 px-4 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner\"\n                              placeholder=\"Transmission identity header...\"\n                            />\n                          ) : (\n                            <div className=\"p-4 bg-secondary/30 border border-border/50 rounded-xl text-sm font-bold text-foreground/80 italic\">\n                              {selectedTemplate.subject}\n                            </div>\n                          )}\n                        </div>\n\n                        {/* Available Logic Nodes */}\n                        <div className=\"space-y-3\">\n                          <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1 flex items-center gap-2\">\n                            <Code weight=\"bold\" className=\"w-3.5 h-3.5 text-primary/60\" />\n                            Synchronized Logic Nodes\n                          </label>\n                          <div className=\"flex flex-wrap gap-2\">\n                            {selectedTemplate.variables.map(variable => (\n                              <Badge\n                                key={variable}\n                                variant=\"ghost\"\n                                className=\"bg-primary/5 text-primary border-none font-mono text-[9px] px-2.5 py-1 tracking-widest\"\n                              >\n                                {'{{' + variable.toUpperCase() + '}}'}\n                              </Badge>\n                            ))}\n                          </div>\n                        </div>\n\n                        {/* Payload Editor Hub */}\n                        <div className=\"space-y-6\">\n                          <div className=\"flex items-center gap-2 bg-secondary/50 p-1.5 rounded-2xl border border-border/50 w-full sm:w-auto\">\n                            {[\n                              { key: 'html', label: 'HTML Payload', icon: Code },\n                              { key: 'text', label: 'Plain Logic', icon: FileText },\n                              { key: 'preview', label: 'Visual Output', icon: Eye }\n                            ].map(tab => (\n                              <button\n                                key={tab.key}\n                                onClick={() => setActiveTab(tab.key as any)}\n                                className={cn(\n                                  \"flex-1 sm:flex-none flex items-center justify-center gap-3 px-6 py-2.5 rounded-xl transition-all text-[10px] font-black uppercase tracking-widest border whitespace-nowrap\",\n                                  activeTab === tab.key\n                                    ? \"bg-primary text-primary-foreground border-primary shadow-premium\"\n                                    : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\n                                )}\n                              >\n                                <tab.icon weight={activeTab === tab.key ? \"fill\" : \"bold\"} className=\"w-4 h-4\" />\n                                {tab.label}\n                              </button>\n                            ))}\n                          </div>\n\n                          <div className=\"min-h-[450px] relative\">\n                            {activeTab === 'html' && (\n                              <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className=\"h-full\">\n                                {editingTemplate ? (\n                                  <textarea\n                                    value={editingTemplate.html_content}\n                                    onChange={(e) => setEditingTemplate({ ...editingTemplate, html_content: e.target.value })}\n                                    className=\"w-full h-[450px] bg-card border border-border rounded-2xl py-4 px-6 text-foreground font-mono text-xs focus:border-primary outline-none transition-all shadow-inner resize-none custom-scrollbar\"\n                                    placeholder=\"Execute HTML injection...\"\n                                  />\n                                ) : (\n                                  <div className=\"bg-card border border-border/50 rounded-2xl p-6 h-[450px] overflow-auto shadow-inner custom-scrollbar relative\">\n                                    <div className=\"absolute top-0 right-0 p-4 opacity-[0.02]\">\n                                      <Code weight=\"bold\" className=\"w-32 h-32 text-primary\" />\n                                    </div>\n                                    <pre className=\"text-muted-foreground text-xs font-mono whitespace-pre-wrap relative z-10\">\n                                      {selectedTemplate.html_content}\n                                    </pre>\n                                  </div>\n                                )}\n                              </motion.div>\n                            )}\n\n                            {activeTab === 'text' && (\n                              <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className=\"h-full\">\n                                {editingTemplate ? (\n                                  <textarea\n                                    value={editingTemplate.text_content}\n                                    onChange={(e) => setEditingTemplate({ ...editingTemplate, text_content: e.target.value })}\n                                    className=\"w-full h-[450px] bg-card border border-border rounded-2xl py-4 px-6 text-foreground font-mono text-xs focus:border-primary outline-none transition-all shadow-inner resize-none custom-scrollbar\"\n                                    placeholder=\"Define plain text node registry...\"\n                                  />\n                                ) : (\n                                  <div className=\"bg-card border border-border/50 rounded-2xl p-6 h-[450px] overflow-auto shadow-inner custom-scrollbar relative\">\n                                    <div className=\"absolute top-0 right-0 p-4 opacity-[0.02]\">\n                                      <FileText weight=\"bold\" className=\"w-32 h-32 text-primary\" />\n                                    </div>\n                                    <pre className=\"text-muted-foreground text-xs font-mono whitespace-pre-wrap relative z-10\">\n                                      {selectedTemplate.text_content}\n                                    </pre>\n                                  </div>\n                                )}\n                              </motion.div>\n                            )}\n\n                            {activeTab === 'preview' && (\n                              <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className=\"h-full\">\n                                <Card className=\"bg-white border border-border/50 rounded-2xl h-[450px] overflow-auto shadow-premium custom-scrollbar\">\n                                  <div className=\"p-8\" dangerouslySetInnerHTML={renderPreview(selectedTemplate.html_content)} />\n                                </Card>\n                              </motion.div>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    </Card>\n                  </motion.div>\n                ) : (\n                  <Card variant=\"ghost\" className=\"py-48 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-8 opacity-40 rounded-[40px]\">\n                    <div className=\"w-24 h-24 rounded-[48px] bg-secondary flex items-center justify-center text-muted-foreground shadow-inner\">\n                      <Monitor weight=\"duotone\" className=\"w-12 h-12\" />\n                    </div>\n                    <div className=\"text-center space-y-2\">\n                      <h3 className=\"text-2xl font-black text-foreground uppercase tracking-widest\">Awaiting Identity Node</h3>\n                      <p className=\"text-sm text-muted-foreground font-medium italic max-w-sm mx-auto\">\n                        Select a communications protocol from the identity hub to initialize the orchestration terminal.\n                      </p>\n                    </div>\n                  </Card>\n                )}\n              </AnimatePresence>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Test Ping Terminal */}\n      <AnimatePresence>\n        {showTestDialog && selectedTemplate && (\n          <div className=\"fixed inset-0 z-[300] flex items-center justify-center p-4 overflow-y-auto\">\n            <motion.div\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n              className=\"absolute inset-0 bg-black/60 backdrop-blur-sm\"\n              onClick={() => setShowTestDialog(false)}\n            />\n            \n            <motion.div\n              initial={{ scale: 0.95, opacity: 0, y: 20 }}\n              animate={{ scale: 1, opacity: 1, y: 0 }}\n              exit={{ scale: 0.95, opacity: 0, y: 20 }}\n              className=\"relative w-full max-w-md bg-card border border-border rounded-[40px] overflow-hidden shadow-premium group p-10\"\n              onClick={e => e.stopPropagation()}\n            >\n              <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n                <PaperPlaneTilt weight=\"fill\" className=\"w-64 h-64 text-primary\" />\n              </div>\n\n              <div className=\"relative z-10 space-y-10\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-5\">\n                    <div className=\"w-16 h-16 rounded-2xl bg-emerald-500/10 flex items-center justify-center text-emerald-500 border border-emerald-500/20 shadow-sm\">\n                      <PaperPlaneTilt weight=\"duotone\" className=\"w-8 h-8\" />\n                    </div>\n                    <div>\n                      <h3 className=\"text-2xl font-bold text-foreground tracking-tight uppercase\">Protocol Ping</h3>\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Execute test transmission</p>\n                    </div>\n                  </div>\n                  <Button variant=\"ghost\" size=\"sm\" onClick={() => setShowTestDialog(false)} className=\"h-10 w-10 p-0 rounded-xl hover:bg-secondary\">\n                    <X weight=\"bold\" className=\"w-5 h-5\" />\n                  </Button>\n                </div>\n\n                <div className=\"space-y-6\">\n                  <div className=\"space-y-2\">\n                    <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Target Endpoint Node *</label>\n                    <div className=\"relative group/input\">\n                      <EnvelopeSimple weight=\"bold\" className=\"absolute left-5 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\n                      <input\n                        type=\"email\"\n                        value={testEmail}\n                        onChange={(e) => setTestEmail(e.target.value)}\n                        placeholder=\"recipient@terminal.network\"\n                        className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-12 pr-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner\"\n                        required\n                      />\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"flex gap-4 pt-4\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => setShowTestDialog(false)}\n                    className=\"flex-1 py-6 rounded-[24px] text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\"\n                  >\n                    Abort\n                  </Button>\n                  <Button\n                    onClick={handleSendTest}\n                    className=\"flex-[2] py-6 rounded-[24px] text-[10px] font-black uppercase tracking-widest shadow-premium gap-3\"\n                  >\n                    <PaperPlaneTilt weight=\"bold\" className=\"w-4 h-4\" />\n                    Dispatch\n                  </Button>\n                </div>\n              </div>\n            </motion.div>\n          </div>\n        )}\n      </AnimatePresence>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\settings\\components\\FeatureFlags.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Gear' is defined but never used.","line":3,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":44,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Gear"},"fix":{"range":[52,58],"text":""},"desc":"Remove unused variable \"Gear\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ShieldCheck' is defined but never used.","line":3,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":57,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ShieldCheck"},"fix":{"range":[58,71],"text":""},"desc":"Remove unused variable \"ShieldCheck\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretDown' is defined but never used.","line":3,"column":65,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":74,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretDown"},"fix":{"range":[77,88],"text":""},"desc":"Remove unused variable \"CaretDown\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ToggleLeft' is defined but never used.","line":3,"column":83,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":93,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ToggleLeft"},"fix":{"range":[95,107],"text":""},"desc":"Remove unused variable \"ToggleLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ToggleRight' is defined but never used.","line":3,"column":95,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":106,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ToggleRight"},"fix":{"range":[107,120],"text":""},"desc":"Remove unused variable \"ToggleRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Button"},"fix":{"range":[367,415],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":10,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AnimatePresence"},"fix":{"range":[510,527],"text":""},"desc":"Remove unused variable \"AnimatePresence\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":13,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[613,616],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[613,616],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { Lightning, Check, X, Sparkle, Gear, ShieldCheck, Info, CaretDown, Pulse, ToggleLeft, ToggleRight, WarningCircle, CheckCircle, XCircle } from '@phosphor-icons/react';\nimport { useSettingsContext } from '../context';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport { cn } from '@/lib/utils';\nimport { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\ninterface FeatureFlagsProps {\n  onSettingsChange: (updates: any) => void;\n}\n\nexport default function FeatureFlags({ onSettingsChange }: FeatureFlagsProps) {\n  const { settings } = useSettingsContext();\n  const [features, setFeatures] = useState({\n    ai_analysis_enabled: true,\n    subscription_billing: true,\n    multi_branch_support: true,\n    appointment_booking: true,\n    inventory_management: true,\n    analytics_dashboard: true,\n    support_tickets: true,\n    audit_logs: true\n  });\n\n  useEffect(() => {\n    if (settings?.features) {\n      setFeatures(settings.features);\n    }\n  }, [settings]);\n\n  const handleToggle = (featureKey: string) => {\n    const newFeatures = { ...features, [featureKey]: !features[featureKey as keyof typeof features] };\n    setFeatures(newFeatures);\n    onSettingsChange({ features: newFeatures });\n  };\n\n  const featureList = [\n    {\n      key: 'ai_analysis_enabled',\n      name: 'AI Skin Analysis',\n      description: 'Enable AI-powered skin analysis and recommendations',\n      category: 'Core Features'\n    },\n    {\n      key: 'subscription_billing',\n      name: 'Subscription Billing',\n      description: 'Enable subscription management and billing system',\n      category: 'Business'\n    },\n    {\n      key: 'multi_branch_support',\n      name: 'Multi-Branch Support',\n      description: 'Allow clinics to manage multiple branch locations',\n      category: 'Business'\n    },\n    {\n      key: 'appointment_booking',\n      name: 'Appointment Booking',\n      description: 'Enable online appointment booking system',\n      category: 'Core Features'\n    },\n    {\n      key: 'inventory_management',\n      name: 'Inventory Management',\n      description: 'Enable product and stock management',\n      category: 'Operations'\n    },\n    {\n      key: 'analytics_dashboard',\n      name: 'Analytics Dashboard',\n      description: 'Enable advanced analytics and reporting',\n      category: 'Analytics'\n    },\n    {\n      key: 'support_tickets',\n      name: 'Support Tickets',\n      description: 'Enable customer support ticket system',\n      category: 'Support'\n    },\n    {\n      key: 'audit_logs',\n      name: 'Audit Logs',\n      description: 'Enable system activity logging and audit trails',\n      category: 'Security'\n    }\n  ];\n\n  const categories = [...new Set(featureList.map(f => f.category))];\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      className=\"space-y-8\"\n    >\n      <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n        <div className=\"absolute top-0 right-0 p-12 opacity-[0.02] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n          <Lightning weight=\"fill\" className=\"w-64 h-64 text-primary\" />\n        </div>\n\n        <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\n              <Lightning weight=\"duotone\" className=\"w-6 h-6\" />\n            </div>\n            <div>\n              <CardTitle className=\"text-xl font-black uppercase tracking-tight\">System Feature Matrix</CardTitle>\n              <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Enable or disable operational protocol nodes</p>\n            </div>\n          </div>\n        </CardHeader>\n\n        <CardContent className=\"p-8 md:p-10 space-y-12 relative z-10\">\n          {categories.map((category) => (\n            <div key={category} className=\"space-y-6\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-1.5 h-1.5 rounded-full bg-primary shadow-[0_0_8px_hsl(var(--primary)/0.6)]\" />\n                <h3 className=\"text-[11px] font-black text-foreground uppercase tracking-[0.3em]\">{category}</h3>\n              </div>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                {featureList\n                  .filter(feature => feature.category === category)\n                  .map((feature) => {\n                    const isEnabled = features[feature.key as keyof typeof features];\n                    \n                    return (\n                      <motion.div\n                        key={feature.key}\n                        whileHover={{ y: -2 }}\n                        className=\"p-6 bg-secondary/20 rounded-[32px] border border-border/50 hover:border-primary/30 transition-all flex items-start justify-between gap-6 group/feature\"\n                      >\n                        <div className=\"space-y-2 flex-1 min-w-0\">\n                          <div className=\"flex items-center gap-3\">\n                            <h4 className=\"text-sm font-bold text-foreground group-hover/feature:text-primary transition-colors truncate uppercase tracking-tight\">{feature.name}</h4>\n                            <Badge \n                              variant={isEnabled ? 'success' : 'secondary'} \n                              size=\"sm\" \n                              className=\"font-black text-[8px] tracking-widest px-2 py-0.5\"\n                            >\n                              {isEnabled ? 'ACTIVE' : 'OFFLINE'}\n                            </Badge>\n                          </div>\n                          <p className=\"text-xs text-muted-foreground font-medium italic leading-relaxed opacity-80\">\n                            {feature.description}\n                          </p>\n                        </div>\n\n                        <button\n                          onClick={() => handleToggle(feature.key)}\n                          className={cn(\n                            \"relative w-14 h-8 rounded-2xl transition-all duration-500 shadow-inner overflow-hidden\",\n                            isEnabled ? \"bg-primary shadow-glow-sm\" : \"bg-card border border-border/50\"\n                          )}\n                        >\n                          <motion.div\n                            className={cn(\n                              \"absolute top-1 w-6 h-6 rounded-xl bg-white shadow-lg flex items-center justify-center transition-all duration-500\",\n                              isEnabled ? \"left-7\" : \"left-1\"\n                            )}\n                            layout\n                          >\n                            {isEnabled ? (\n                              <Check weight=\"bold\" className=\"w-3.5 h-3.5 text-primary\" />\n                            ) : (\n                              <X weight=\"bold\" className=\"w-3.5 h-3.5 text-muted-foreground/40\" />\n                            )}\n                          </motion.div>\n                        </button>\n                      </motion.div>\n                    );\n                  })}\n              </div>\n            </div>\n          ))}\n\n          {/* Critical Impact Notification */}\n          <div className=\"p-6 bg-amber-500/5 rounded-[32px] border border-amber-500/10 flex gap-5 relative overflow-hidden group/warning\">\n            <div className=\"absolute top-0 right-0 p-4 opacity-[0.03] group-hover/warning:scale-110 transition-transform\">\n              <WarningCircle weight=\"fill\" className=\"w-12 h-12 text-amber-500\" />\n            </div>\n            <div className=\"w-12 h-12 rounded-2xl bg-amber-500/10 flex items-center justify-center text-amber-500 border border-amber-500/20 shadow-inner shrink-0\">\n              <Info weight=\"bold\" className=\"w-6 h-6\" />\n            </div>\n            <div className=\"space-y-1 relative z-10\">\n              <h4 className=\"text-xs font-black text-amber-600 uppercase tracking-widest\">Protocol Integrity Notice</h4>\n              <p className=\"text-[11px] text-muted-foreground font-medium leading-relaxed italic\">\n                Modifying feature flags affects all connected clinical nodes globally. Changes may require immediate synchronization or identity node regeneration to manifest correctly.\n              </p>\n            </div>\n          </div>\n\n          {/* Matrix Summary */}\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-6 pt-10 border-t border-border/50\">\n            {[\n              { label: 'Active Nodes', value: Object.values(features).filter(Boolean).length, icon: CheckCircle, color: 'text-emerald-500', bg: 'bg-emerald-500/10' },\n              { label: 'Offline Nodes', value: Object.values(features).filter(f => !f).length, icon: XCircle, color: 'text-rose-500', bg: 'bg-rose-500/10' },\n              { label: 'Total Capacity', value: featureList.length, icon: Pulse, color: 'text-primary', bg: 'bg-primary/10' },\n              { label: 'Registry Clusters', value: categories.length, icon: Sparkle, color: 'text-purple-500', bg: 'bg-purple-500/10' }\n            ].map((stat, i) => (\n              <div key={i} className=\"p-5 bg-secondary/20 rounded-[24px] border border-border/50 flex flex-col items-center text-center gap-3 group/stat hover:bg-secondary/40 transition-all\">\n                <div className={cn(\"w-10 h-10 rounded-xl flex items-center justify-center shadow-inner group-hover/stat:scale-110 transition-all\", stat.bg, stat.color)}>\n                  <stat.icon weight=\"duotone\" className=\"w-5 h-5\" />\n                </div>\n                <div>\n                  <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest mb-1\">{stat.label}</p>\n                  <p className=\"text-lg font-black text-foreground tabular-nums\">{stat.value}</p>\n                </div>\n              </div>\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\settings\\components\\PricingSettings.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":3,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":29,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useEffect"},"fix":{"range":[34,45],"text":""},"desc":"Remove unused variable \"useEffect\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningCircle' is defined but never used.","line":4,"column":108,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":121,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WarningCircle"},"fix":{"range":[167,182],"text":""},"desc":"Remove unused variable \"WarningCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Info' is defined but never used.","line":4,"column":132,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":136,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Info"},"fix":{"range":[191,197],"text":""},"desc":"Remove unused variable \"Info\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretDown' is defined but never used.","line":4,"column":138,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":147,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretDown"},"fix":{"range":[197,208],"text":""},"desc":"Remove unused variable \"CaretDown\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onSettingsChange' is defined but never used.","line":41,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":59},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":103,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":103,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3000,3003],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3000,3003],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3179,3182],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3179,3182],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":184,"column":6,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":184,"endColumn":12},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":235,"column":20,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":235,"endColumn":26},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":264,"column":32,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":264,"endColumn":38},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'AnimatePresence' is not defined.","line":501,"column":8,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":501,"endColumn":23},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":504,"column":14,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":504,"endColumn":20},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":512,"column":14,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":512,"endColumn":20},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'X' is not defined.","line":535,"column":22,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":535,"endColumn":23},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'AnimatePresence' is not defined.","line":616,"column":8,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":616,"endColumn":23},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":619,"column":14,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":619,"endColumn":20},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":627,"column":14,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":627,"endColumn":20},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'X' is not defined.","line":650,"column":22,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":650,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":684,"column":104,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":684,"endColumn":107,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[37105,37108],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[37105,37108],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'CaretRight' is not defined.","line":691,"column":26,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":691,"endColumn":36}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\nimport { FloppyDisk, Plus, Trash, PencilSimple, CurrencyDollar, Users, Lightning, Package, Percent, Clock, WarningCircle, Sparkle, Info, CaretDown, Check } from '@phosphor-icons/react';\r\nimport { useSettingsContext } from '../context';\r\nimport { SystemSettings } from '../types';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { cn } from '@/lib/utils';\r\n\r\ninterface Plan {\r\n  name: string;\r\n  price_monthly: number;\r\n  price_yearly: number;\r\n  features: string[];\r\n  limits: {\r\n    max_users: number;\r\n    max_branches: number;\r\n    max_ai_requests: number;\r\n    storage_gb: number;\r\n  };\r\n  is_active: boolean;\r\n  trial_days: number;\r\n  discount_yearly: number;\r\n}\r\n\r\ninterface AddOn {\r\n  id: string;\r\n  name: string;\r\n  price: number;\r\n  billing_cycle: 'monthly' | 'yearly' | 'one_time';\r\n  description: string;\r\n  is_active: boolean;\r\n}\r\n\r\ninterface PricingSettingsProps {\r\n  onSettingsChange?: (updates: Partial<SystemSettings>) => void;\r\n}\r\n\r\nexport default function PricingSettings({ onSettingsChange }: PricingSettingsProps) {\r\n  const { settings, updateSettings, loading } = useSettingsContext();\r\n  const [editingPlan, setEditingPlan] = useState<string | null>(null);\r\n  const [showAddPlan, setShowAddPlan] = useState(false);\r\n  const [showAddOn, setShowAddOn] = useState(false);\r\n\r\n  const [plans, setPlans] = useState<Record<string, Plan>>((settings?.subscription_plans as unknown) as Record<string, Plan> || {});\r\n  const [addOns, setAddOns] = useState<AddOn[]>([\r\n    {\r\n      id: 'extra_ai',\r\n      name: 'Extra AI Requests',\r\n      price: 1000,\r\n      billing_cycle: 'monthly',\r\n      description: 'Additional 100 AI analysis requests per month',\r\n      is_active: true\r\n    },\r\n    {\r\n      id: 'priority_support',\r\n      name: 'Priority Support',\r\n      price: 5000,\r\n      billing_cycle: 'monthly',\r\n      description: '24/7 priority support with dedicated account manager',\r\n      is_active: true\r\n    },\r\n    {\r\n      id: 'custom_integration',\r\n      name: 'Custom Integration',\r\n      price: 50000,\r\n      billing_cycle: 'one_time',\r\n      description: 'One-time setup for custom API integrations',\r\n      is_active: false\r\n    }\r\n  ]);\r\n\r\n  const [newPlan, setNewPlan] = useState<Plan>({\r\n    name: '',\r\n    price_monthly: 0,\r\n    price_yearly: 0,\r\n    features: [],\r\n    limits: {\r\n      max_users: 1,\r\n      max_branches: 1,\r\n      max_ai_requests: 100,\r\n      storage_gb: 5\r\n    },\r\n    is_active: true,\r\n    trial_days: 14,\r\n    discount_yearly: 20\r\n  });\r\n\r\n  const [newAddOn, setNewAddOn] = useState<AddOn>({\r\n    id: '',\r\n    name: '',\r\n    price: 0,\r\n    billing_cycle: 'monthly',\r\n    description: '',\r\n    is_active: true\r\n  });\r\n\r\n  const handleSavePlans = async () => {\r\n    try {\r\n      await updateSettings({\r\n        subscription_plans: (plans as unknown) as any\r\n      });\r\n    } catch (error) {\r\n      console.error('Failed to save plans:', error);\r\n    }\r\n  };\r\n\r\n  const handleUpdatePlan = (planKey: string, field: keyof Plan, value: any) => {\r\n    setPlans(prev => ({\r\n      ...prev,\r\n      [planKey]: {\r\n        ...prev[planKey],\r\n        [field]: value\r\n      }\r\n    }));\r\n  };\r\n\r\n  const handleAddPlan = () => {\r\n    if (newPlan.name) {\r\n      const key = newPlan.name.toLowerCase().replace(/\\s+/g, '_');\r\n      setPlans(prev => ({\r\n        ...prev,\r\n        [key]: newPlan\r\n      }));\r\n      setNewPlan({\r\n        name: '',\r\n        price_monthly: 0,\r\n        price_yearly: 0,\r\n        features: [],\r\n        limits: {\r\n          max_users: 1,\r\n          max_branches: 1,\r\n          max_ai_requests: 100,\r\n          storage_gb: 5\r\n        },\r\n        is_active: true,\r\n        trial_days: 14,\r\n        discount_yearly: 20\r\n      });\r\n      setShowAddPlan(false);\r\n    }\r\n  };\r\n\r\n  const handleDeletePlan = (planKey: string) => {\r\n    if (confirm(`Are you sure you want to delete the ${planKey} plan?`)) {\r\n      setPlans(prev => {\r\n        const newPlans = { ...prev };\r\n        delete newPlans[planKey];\r\n        return newPlans;\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleAddAddOn = () => {\r\n    if (newAddOn.name) {\r\n      setAddOns(prev => [...prev, { ...newAddOn, id: newAddOn.name.toLowerCase().replace(/\\s+/g, '_') }]);\r\n      setNewAddOn({\r\n        id: '',\r\n        name: '',\r\n        price: 0,\r\n        billing_cycle: 'monthly',\r\n        description: '',\r\n        is_active: true\r\n      });\r\n      setShowAddOn(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteAddOn = (id: string) => {\r\n    setAddOns(prev => prev.filter(addon => addon.id !== id));\r\n  };\r\n\r\n  const formatPrice = (price: number) => {\r\n    return new Intl.NumberFormat('th-TH', {\r\n      style: 'currency',\r\n      currency: 'THB',\r\n      minimumFractionDigits: 0\r\n    }).format(price);\r\n  };\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0, y: 20 }}\r\n      animate={{ opacity: 1, y: 0 }}\r\n      className=\"space-y-8\"\r\n    >\r\n      <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n        <div className=\"absolute top-0 right-0 p-12 opacity-[0.02] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n          <CurrencyDollar className=\"w-64 h-64 text-primary\" />\r\n        </div>\r\n\r\n        <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 flex flex-row items-center justify-between\">\r\n          <div className=\"flex items-center gap-4\">\r\n            <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n              <CurrencyDollar weight=\"duotone\" className=\"w-6 h-6\" />\r\n            </div>\r\n            <div>\r\n              <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Pricing Architecture</CardTitle>\r\n              <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Subscription tiers and automated add-on logic</p>\r\n            </div>\r\n          </div>\r\n          <Button\r\n            onClick={handleSavePlans}\r\n            disabled={loading}\r\n            className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\"\r\n          >\r\n            <FloppyDisk weight=\"bold\" className=\"w-4 h-4\" />\r\n            Sync Parameters\r\n          </Button>\r\n        </CardHeader>\r\n\r\n        <CardContent className=\"p-8 md:p-10 space-y-12 relative z-10\">\r\n          {/* Subscription Plans Section */}\r\n          <div className=\"space-y-8\">\r\n            <div className=\"flex items-center justify-between px-2\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"w-1.5 h-1.5 rounded-full bg-primary shadow-[0_0_8px_hsl(var(--primary)/0.6)]\" />\r\n                <h3 className=\"text-[11px] font-black text-foreground uppercase tracking-[0.3em]\">Protocol Tiers</h3>\r\n              </div>\r\n              <Button \r\n                variant=\"outline\"\r\n                onClick={() => setShowAddPlan(true)}\r\n                className=\"gap-2 px-4 py-3 rounded-xl text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\"\r\n              >\r\n                <Plus weight=\"bold\" className=\"w-3 h-3\" />\r\n                Initialize Tier\r\n              </Button>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 gap-6\">\r\n              {Object.entries(plans).map(([key, plan]) => (\r\n                <div key={key} className=\"group/plan relative\">\r\n                  <motion.div\r\n                    layout\r\n                    className={cn(\r\n                      \"p-8 rounded-[32px] border transition-all duration-500\",\r\n                      editingPlan === key \r\n                        ? \"bg-primary/[0.02] border-primary/30 shadow-premium\" \r\n                        : \"bg-secondary/20 border-border/50 hover:border-primary/20\"\r\n                    )}\r\n                  >\r\n                    {editingPlan === key ? (\r\n                      <div className=\"space-y-8\">\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                          <div className=\"space-y-2\">\r\n                            <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Tier Designation</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={plan.name}\r\n                              onChange={(e) => handleUpdatePlan(key, 'name', e.target.value)}\r\n                              className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner\"\r\n                            />\r\n                          </div>\r\n                          <div className=\"flex items-center gap-6 pt-6\">\r\n                            <button\r\n                              onClick={() => handleUpdatePlan(key, 'is_active', !plan.is_active)}\r\n                              className={cn(\r\n                                \"relative w-12 h-6 rounded-full transition-all duration-500 shadow-inner\",\r\n                                plan.is_active ? \"bg-emerald-500 shadow-glow-sm\" : \"bg-card border border-border/50\"\r\n                              )}\r\n                            >\r\n                              <motion.div\r\n                                className=\"absolute top-0.5 w-5 h-5 rounded-full bg-white flex items-center justify-center transition-all duration-500\"\r\n                                animate={{ left: plan.is_active ? 24 : 2 }}\r\n                              />\r\n                            </button>\r\n                            <span className=\"text-[10px] font-black text-foreground uppercase tracking-widest\">Active Lifecycle</span>\r\n                            \r\n                            <div className=\"flex items-center gap-3 ml-auto px-4 py-2 bg-secondary/50 rounded-xl border border-border/50\">\r\n                              <Clock weight=\"bold\" className=\"w-4 h-4 text-primary/60\" />\r\n                              <input\r\n                                type=\"number\"\r\n                                value={plan.trial_days}\r\n                                onChange={(e) => handleUpdatePlan(key, 'trial_days', parseInt(e.target.value))}\r\n                                className=\"w-12 bg-transparent border-none text-center text-sm font-bold text-foreground focus:outline-none\"\r\n                              />\r\n                              <span className=\"text-[9px] font-black text-muted-foreground uppercase\">Trial Days</span>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                          <div className=\"space-y-2\">\r\n                            <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Monthly Valuation (THB)</label>\r\n                            <div className=\"relative group/input\">\r\n                              <CurrencyDollar weight=\"bold\" className=\"absolute left-5 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\r\n                              <input\r\n                                type=\"number\"\r\n                                value={plan.price_monthly}\r\n                                onChange={(e) => handleUpdatePlan(key, 'price_monthly', parseInt(e.target.value))}\r\n                                className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-12 pr-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner tabular-nums\"\r\n                              />\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"space-y-2\">\r\n                            <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Annual Valuation (THB)</label>\r\n                            <div className=\"relative group/input\">\r\n                              <CurrencyDollar weight=\"bold\" className=\"absolute left-5 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\r\n                              <input\r\n                                type=\"number\"\r\n                                value={plan.price_yearly}\r\n                                onChange={(e) => handleUpdatePlan(key, 'price_yearly', parseInt(e.target.value))}\r\n                                className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-12 pr-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner tabular-nums\"\r\n                              />\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2\">\r\n                          <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Feature Payload (New line delimited)</label>\r\n                          <textarea\r\n                            value={plan.features.join('\\n')}\r\n                            onChange={(e) => handleUpdatePlan(key, 'features', e.target.value.split('\\n').filter(f => f.trim()))}\r\n                            rows={4}\r\n                            className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-medium shadow-inner resize-none italic\"\r\n                          />\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-6\">\r\n                          {[\r\n                            { key: 'max_users', label: 'Max Identities', icon: Users },\r\n                            { key: 'max_branches', label: 'Cluster Nodes', icon: Package },\r\n                            { key: 'max_ai_requests', label: 'Neural Cycles', icon: Lightning },\r\n                            { key: 'storage_gb', label: 'Storage (GB)', icon: Package }\r\n                          ].map((limit) => (\r\n                            <div key={limit.key} className=\"space-y-2\">\r\n                              <label className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest flex items-center gap-2\">\r\n                                <limit.icon weight=\"bold\" className=\"w-3 h-3\" />\r\n                                {limit.label}\r\n                              </label>\r\n                              <input\r\n                                type=\"number\"\r\n                                value={plan.limits[limit.key as keyof typeof plan.limits]}\r\n                                onChange={(e) => handleUpdatePlan(key, 'limits', { ...plan.limits, [limit.key]: parseInt(e.target.value) })}\r\n                                className=\"w-full bg-secondary/50 border border-border rounded-xl py-3 px-4 text-xs text-foreground focus:border-primary outline-none transition-all font-bold tabular-nums\"\r\n                              />\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n\r\n                        <div className=\"flex justify-end pt-4\">\r\n                          <Button\r\n                            onClick={() => setEditingPlan(null)}\r\n                            className=\"gap-2 px-8 py-4 rounded-xl text-[10px] font-black uppercase tracking-widest shadow-premium\"\r\n                          >\r\n                            <Check weight=\"bold\" className=\"w-4 h-4\" />\r\n                            Seal Protocol\r\n                          </Button>\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-8\">\r\n                        <div className=\"flex items-center gap-6\">\r\n                          <div className={cn(\r\n                            \"w-16 h-16 rounded-2xl flex items-center justify-center border transition-all duration-500 shadow-inner\",\r\n                            plan.is_active ? \"bg-primary/10 border-primary/20 text-primary\" : \"bg-secondary border-border text-muted-foreground opacity-40\"\r\n                          )}>\r\n                            <Package weight=\"duotone\" className=\"w-8 h-8\" />\r\n                          </div>\r\n                          <div className=\"space-y-1.5\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                              <h4 className=\"text-xl font-black text-foreground uppercase tracking-tight\">{plan.name}</h4>\r\n                              <Badge variant={plan.is_active ? 'success' : 'secondary'} size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2\">\r\n                                {plan.is_active ? 'OPERATIONAL' : 'OFFLINE'}\r\n                              </Badge>\r\n                            </div>\r\n                            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em]\">\r\n                              {plan.trial_days} Day Evaluation Window โ€ข {plan.features.length} Payload Nodes\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 gap-10\">\r\n                          <div>\r\n                            <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest mb-1\">Cycle Value</p>\r\n                            <div className=\"flex items-baseline gap-1\">\r\n                              <span className=\"text-2xl font-black text-foreground tabular-nums tracking-tighter\">{formatPrice(plan.price_monthly)}</span>\r\n                              <span className=\"text-[9px] font-bold text-muted-foreground uppercase\">/Mo</span>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-3\">\r\n                            <Button \r\n                              variant=\"outline\" \r\n                              size=\"sm\" \r\n                              onClick={() => setEditingPlan(key)}\r\n                              className=\"h-11 w-11 p-0 rounded-2xl border-border/50 hover:bg-secondary\"\r\n                            >\r\n                              <PencilSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n                            </Button>\r\n                            <Button \r\n                              variant=\"outline\" \r\n                              size=\"sm\" \r\n                              onClick={() => handleDeletePlan(key)}\r\n                              className=\"h-11 w-11 p-0 rounded-2xl border-border/50 hover:bg-rose-500/10 hover:text-rose-500 hover:border-rose-500/20\"\r\n                            >\r\n                              <Trash weight=\"bold\" className=\"w-4 h-4\" />\r\n                            </Button>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </motion.div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Add-ons Architecture */}\r\n          <div className=\"space-y-8 pt-10 border-t border-border/50\">\r\n            <div className=\"flex items-center justify-between px-2\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.6)]\" />\r\n                <h3 className=\"text-[11px] font-black text-foreground uppercase tracking-[0.3em]\">Peripheral Nodes</h3>\r\n              </div>\r\n              <Button \r\n                variant=\"outline\"\r\n                onClick={() => setShowAddOn(true)}\r\n                className=\"gap-2 px-4 py-3 rounded-xl text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\"\r\n              >\r\n                <Plus weight=\"bold\" className=\"w-3 h-3\" />\r\n                Inject Add-on\r\n              </Button>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6\">\r\n              {addOns.map((addon) => (\r\n                <Card key={addon.id} className=\"p-6 bg-secondary/20 border-border/50 hover:border-primary/20 transition-all group/addon overflow-hidden\">\r\n                  <div className=\"absolute top-0 right-0 p-4 opacity-[0.03] group-hover/addon:scale-110 transition-transform\">\r\n                    <Sparkle weight=\"fill\" className=\"w-16 h-16 text-primary\" />\r\n                  </div>\r\n                  <div className=\"space-y-5 relative z-10\">\r\n                    <div className=\"flex items-start justify-between\">\r\n                      <div className=\"space-y-1.5\">\r\n                        <h4 className=\"text-sm font-bold text-foreground group-hover/addon:text-primary transition-colors uppercase tracking-tight\">{addon.name}</h4>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Badge variant={addon.is_active ? 'success' : 'secondary'} size=\"sm\" className=\"text-[7px] px-1.5 py-0.5\">\r\n                            {addon.is_active ? 'ACTIVE' : 'INACTIVE'}\r\n                          </Badge>\r\n                          <span className=\"text-[8px] font-black text-muted-foreground uppercase tracking-tighter opacity-60\">[{addon.billing_cycle}]</span>\r\n                        </div>\r\n                      </div>\r\n                      <Button \r\n                        variant=\"ghost\" \r\n                        size=\"sm\" \r\n                        onClick={() => handleDeleteAddOn(addon.id)}\r\n                        className=\"h-8 w-8 p-0 text-muted-foreground hover:text-rose-500 hover:bg-rose-500/5 rounded-lg\"\r\n                      >\r\n                        <Trash weight=\"bold\" className=\"w-3.5 h-3.5\" />\r\n                      </Button>\r\n                    </div>\r\n                    <p className=\"text-[11px] text-muted-foreground font-medium italic leading-relaxed opacity-80 h-8 line-clamp-2\">\r\n                      {addon.description}\r\n                    </p>\r\n                    <div className=\"pt-4 border-t border-border/30 flex items-center justify-between\">\r\n                      <p className=\"text-lg font-black text-foreground tabular-nums tracking-tighter\">{formatPrice(addon.price)}</p>\r\n                      <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none text-[8px] font-black tracking-widest uppercase\">Cycle Node</Badge>\r\n                    </div>\r\n                  </div>\r\n                </Card>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Regulatory & Discount Parameters */}\r\n          <div className=\"pt-10 border-t border-border/50\">\r\n            <h4 className=\"text-[10px] font-black text-foreground uppercase tracking-[0.3em] flex items-center gap-3 mb-8 px-2\">\r\n              <Percent weight=\"bold\" className=\"w-5 h-5 text-primary\" />\r\n              Valuation Modifiers\r\n            </h4>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8 px-2\">\r\n              {[\r\n                { label: 'Annual Lifecycle Yield', value: '20', desc: 'Standardized sync discount factor.', icon: TrendUp, color: 'text-emerald-500', bg: 'bg-emerald-500/10' },\r\n                { label: 'Multi-cluster Rebate', value: '15', desc: 'Active for 3+ clinical nodes.', icon: Buildings, color: 'text-blue-500', bg: 'bg-blue-500/10' },\r\n                { label: 'Non-profit Protocol', value: '25', desc: 'Humanitarian sector initialization.', icon: Sparkle, color: 'text-purple-500', bg: 'bg-purple-500/10' }\r\n              ].map((modifier, i) => (\r\n                <div key={i} className=\"p-6 bg-secondary/20 rounded-[32px] border border-border/50 flex flex-col items-center text-center gap-4 group/mod hover:bg-secondary/40 transition-all overflow-hidden relative\">\r\n                  <div className=\"absolute top-0 right-0 p-4 opacity-[0.03] group-hover/mod:scale-110 transition-transform\">\r\n                    <modifier.icon weight=\"fill\" className=\"w-16 h-16 text-primary\" />\r\n                  </div>\r\n                  <div className={cn(\"w-12 h-12 rounded-2xl flex items-center justify-center shadow-inner group-hover/mod:scale-110 transition-all\", modifier.bg, modifier.color)}>\r\n                    <modifier.icon weight=\"duotone\" className=\"w-6 h-6\" />\r\n                  </div>\r\n                  <div className=\"space-y-1 relative z-10\">\r\n                    <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">{modifier.label}</p>\r\n                    <div className=\"flex items-center justify-center gap-1.5\">\r\n                      <span className={cn(\"text-2xl font-black tabular-nums tracking-tighter\", modifier.color)}>{modifier.value}%</span>\r\n                      <Badge variant=\"ghost\" className=\"bg-white/5 border-none text-[8px] font-black text-muted-foreground uppercase\">Factor</Badge>\r\n                    </div>\r\n                    <p className=\"text-[10px] text-muted-foreground font-medium italic opacity-60 pt-2\">{modifier.desc}</p>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Add Plan Modal - Premiumized */}\r\n      <AnimatePresence>\r\n        {showAddPlan && (\r\n          <div className=\"fixed inset-0 z-[300] flex items-center justify-center p-4 overflow-y-auto\">\r\n            <motion.div\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              exit={{ opacity: 0 }}\r\n              className=\"absolute inset-0 bg-black/60 backdrop-blur-sm\"\r\n              onClick={() => setShowAddPlan(false)}\r\n            />\r\n            \r\n            <motion.div\r\n              initial={{ scale: 0.95, opacity: 0, y: 20 }}\r\n              animate={{ scale: 1, opacity: 1, y: 0 }}\r\n              exit={{ scale: 0.95, opacity: 0, y: 20 }}\r\n              className=\"relative w-full max-w-2xl bg-card border border-border rounded-[40px] overflow-hidden shadow-premium group p-10\"\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                <Plus className=\"w-64 h-64 text-primary\" />\r\n              </div>\r\n\r\n              <div className=\"relative z-10 space-y-10\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"flex items-center gap-5\">\r\n                    <div className=\"w-16 h-16 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\r\n                      <Package weight=\"duotone\" className=\"w-8 h-8\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-2xl font-bold text-foreground tracking-tight uppercase\">Protocol Synthesis</h3>\r\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Initialize new subscription tier node</p>\r\n                    </div>\r\n                  </div>\r\n                  <Button variant=\"ghost\" size=\"sm\" onClick={() => setShowAddPlan(false)} className=\"h-10 w-10 p-0 rounded-xl hover:bg-secondary\">\r\n                    <X weight=\"bold\" className=\"w-5 h-5\" />\r\n                  </Button>\r\n                </div>\r\n\r\n                <div className=\"space-y-8\">\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                    <div className=\"space-y-2\">\r\n                      <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Tier Identity *</label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={newPlan.name}\r\n                        onChange={(e) => setNewPlan({ ...newPlan, name: e.target.value })}\r\n                        placeholder=\"e.g. Enterprise Alpha\"\r\n                        className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner\"\r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Evaluation Window (Days)</label>\r\n                      <div className=\"relative\">\r\n                        <Clock weight=\"bold\" className=\"absolute left-5 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40\" />\r\n                        <input\r\n                          type=\"number\"\r\n                          value={newPlan.trial_days}\r\n                          onChange={(e) => setNewPlan({ ...newPlan, trial_days: parseInt(e.target.value) })}\r\n                          className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-12 pr-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner tabular-nums\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                    <div className=\"space-y-2\">\r\n                      <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Monthly Valuation (THB) *</label>\r\n                      <div className=\"relative group/input\">\r\n                        <CurrencyDollar weight=\"bold\" className=\"absolute left-5 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\r\n                        <input\r\n                          type=\"number\"\r\n                          value={newPlan.price_monthly}\r\n                          onChange={(e) => setNewPlan({ ...newPlan, price_monthly: parseInt(e.target.value) })}\r\n                          className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-12 pr-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner tabular-nums\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Annual Valuation (THB) *</label>\r\n                      <div className=\"relative group/input\">\r\n                        <CurrencyDollar weight=\"bold\" className=\"absolute left-5 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\r\n                        <input\r\n                          type=\"number\"\r\n                          value={newPlan.price_yearly}\r\n                          onChange={(e) => setNewPlan({ ...newPlan, price_yearly: parseInt(e.target.value) })}\r\n                          className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-12 pr-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner tabular-nums\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex gap-4 pt-4\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={() => setShowAddPlan(false)}\r\n                    className=\"flex-1 py-6 rounded-[24px] text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\"\r\n                  >\r\n                    Abort Synthesis\r\n                  </Button>\r\n                  <Button\r\n                    onClick={handleAddPlan}\r\n                    className=\"flex-[2] py-6 rounded-[24px] text-[10px] font-black uppercase tracking-widest shadow-premium gap-3\"\r\n                  >\r\n                    <Plus weight=\"bold\" className=\"w-4 h-4\" />\r\n                    Commit Tier\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </motion.div>\r\n          </div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Add Add-on Modal - Premiumized */}\r\n      <AnimatePresence>\r\n        {showAddOn && (\r\n          <div className=\"fixed inset-0 z-[300] flex items-center justify-center p-4 overflow-y-auto\">\r\n            <motion.div\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              exit={{ opacity: 0 }}\r\n              className=\"absolute inset-0 bg-black/60 backdrop-blur-sm\"\r\n              onClick={() => setShowAddOn(false)}\r\n            />\r\n            \r\n            <motion.div\r\n              initial={{ scale: 0.95, opacity: 0, y: 20 }}\r\n              animate={{ scale: 1, opacity: 1, y: 0 }}\r\n              exit={{ scale: 0.95, opacity: 0, y: 20 }}\r\n              className=\"relative w-full max-w-lg bg-card border border-border rounded-[40px] overflow-hidden shadow-premium group p-10\"\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                <Sparkle className=\"w-64 h-64 text-emerald-500\" />\r\n              </div>\r\n\r\n              <div className=\"relative z-10 space-y-10\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"flex items-center gap-5\">\r\n                    <div className=\"w-16 h-16 rounded-2xl bg-emerald-500/10 flex items-center justify-center text-emerald-500 border border-emerald-500/20 shadow-sm\">\r\n                      <Sparkle weight=\"duotone\" className=\"w-8 h-8\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-2xl font-bold text-foreground tracking-tight uppercase\">Peripheral Sync</h3>\r\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Inject new add-on protocol node</p>\r\n                    </div>\r\n                  </div>\r\n                  <Button variant=\"ghost\" size=\"sm\" onClick={() => setShowAddOn(false)} className=\"h-10 w-10 p-0 rounded-xl hover:bg-secondary\">\r\n                    <X weight=\"bold\" className=\"w-5 h-5\" />\r\n                  </Button>\r\n                </div>\r\n\r\n                <div className=\"space-y-8\">\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Add-on Identity *</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={newAddOn.name}\r\n                      onChange={(e) => setNewAddOn({ ...newAddOn, name: e.target.value })}\r\n                      placeholder=\"e.g. Extra Neural Capacity\"\r\n                      className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner\"\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                    <div className=\"space-y-2\">\r\n                      <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Node Valuation (THB) *</label>\r\n                      <div className=\"relative group/input\">\r\n                        <CurrencyDollar weight=\"bold\" className=\"absolute left-5 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\r\n                        <input\r\n                          type=\"number\"\r\n                          value={newAddOn.price}\r\n                          onChange={(e) => setNewAddOn({ ...newAddOn, price: parseInt(e.target.value) })}\r\n                          className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-12 pr-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner tabular-nums\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Settlement Cycle *</label>\r\n                      <div className=\"relative\">\r\n                        <select\r\n                          value={newAddOn.billing_cycle}\r\n                          onChange={(e) => setNewAddOn({ ...newAddOn, billing_cycle: e.target.value as any })}\r\n                          className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-xs text-foreground focus:border-primary outline-none transition-all appearance-none font-black uppercase tracking-widest\"\r\n                        >\r\n                          <option value=\"monthly\" className=\"bg-card\">MONTHLY_SYNC</option>\r\n                          <option value=\"yearly\" className=\"bg-card\">ANNUAL_SYNC</option>\r\n                          <option value=\"one_time\" className=\"bg-card\">INSTANT_CREDIT</option>\r\n                        </select>\r\n                        <CaretRight weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 rotate-90 text-muted-foreground/40 pointer-events-none\" />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Protocol Description</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={newAddOn.description}\r\n                      onChange={(e) => setNewAddOn({ ...newAddOn, description: e.target.value })}\r\n                      placeholder=\"Brief specification of the peripheral node...\"\r\n                      className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-medium shadow-inner italic\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex gap-4 pt-4\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={() => setShowAddOn(false)}\r\n                    className=\"flex-1 py-6 rounded-[24px] text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\"\r\n                  >\r\n                    Abort Injection\r\n                  </Button>\r\n                  <Button\r\n                    onClick={handleAddAddOn}\r\n                    className=\"flex-[2] py-6 rounded-[24px] text-[10px] font-black uppercase tracking-widest shadow-premium gap-3\"\r\n                  >\r\n                    <Plus weight=\"bold\" className=\"w-4 h-4\" />\r\n                    Commit Add-on\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </motion.div>\r\n          </div>\r\n        )}\r\n      </AnimatePresence>\r\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\settings\\components\\RegionalSettings.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":4,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AnimatePresence"},"fix":{"range":[75,92],"text":""},"desc":"Remove unused variable \"AnimatePresence\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Globe' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Globe"},"fix":{"range":[129,135],"text":""},"desc":"Remove unused variable \"Globe\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CurrencyDollar' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":17,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CurrencyDollar"},"fix":{"range":[144,163],"text":""},"desc":"Remove unused variable \"CurrencyDollar\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Percent' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Percent"},"fix":{"range":[163,175],"text":""},"desc":"Remove unused variable \"Percent\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":22,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[234,258],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Briefcase"},"fix":{"range":[258,272],"text":""},"desc":"Remove unused variable \"Briefcase\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MapPin' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":9,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"MapPin"},"fix":{"range":[286,297],"text":""},"desc":"Remove unused variable \"MapPin\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":24,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Button"},"fix":{"range":[502,550],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":25,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[551,584],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":29,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[699,702],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[699,702],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  Globe, \n  Clock, \n  CurrencyDollar, \n  Percent, \n  Sparkle, \n  Info, \n  CaretDown, \n  GlobeHemisphereWest, \n  IdentificationBadge, \n  Briefcase, \n  Translate, \n  MapPin, \n  CheckCircle, \n  CalendarDots, \n  Coins \n} from '@phosphor-icons/react';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport { cn } from '@/lib/utils';\nimport { useSettingsContext } from '../context';\n\ninterface RegionalSettingsProps {\n  onSettingsChange: (updates: any) => void;\n}\n\nexport default function RegionalSettings({ onSettingsChange }: RegionalSettingsProps) {\n  const { settings } = useSettingsContext();\n  const [formData, setFormData] = useState({\n    defaultLanguage: 'th',\n    timezone: 'Asia/Bangkok',\n    currency: 'THB',\n    dateFormat: 'DD/MM/YYYY'\n  });\n\n  useEffect(() => {\n    if (settings) {\n      setFormData({\n        defaultLanguage: settings.defaultLanguage || 'th',\n        timezone: settings.timezone || 'Asia/Bangkok',\n        currency: settings.currency || 'THB',\n        dateFormat: settings.dateFormat || 'DD/MM/YYYY'\n      });\n    }\n  }, [settings]);\n\n  const handleChange = (field: string, value: string) => {\n    const newData = { ...formData, [field]: value };\n    setFormData(newData);\n    onSettingsChange(newData);\n  };\n\n  const languages = [\n    { code: 'th', name: 'Thai' },\n    { code: 'en', name: 'English' }\n  ];\n\n  const timezones = [\n    { value: 'Asia/Bangkok', name: 'Asia/Bangkok (GMT+7)' },\n    { value: 'UTC', name: 'UTC' }\n  ];\n\n  const currencies = [\n    { code: 'THB', name: 'Thai Baht (๏ฟฝ)', symbol: '๏ฟฝ' },\n    { code: 'USD', name: 'US Dollar ($)', symbol: '$' }\n  ];\n\n  return (\n    <motion.div \n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      className=\"space-y-10\"\n    >\n      <div className=\"grid grid-cols-1 xl:grid-cols-3 gap-10\">\n        {/* Localization Matrix */}\n        <div className=\"xl:col-span-2 space-y-10\">\n          <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n            <CardHeader className=\"p-10 border-b border-border/50 bg-secondary/30 relative overflow-hidden\">\n              <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n                <GlobeHemisphereWest className=\"w-64 h-64 text-primary\" />\n              </div>\n              <div className=\"flex items-center gap-5 relative z-10\">\n                <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\n                  <Translate weight=\"duotone\" className=\"w-7 h-7\" />\n                </div>\n                <div>\n                  <h3 className=\"text-2xl font-black uppercase tracking-tight\">Localization Node</h3>\n                  <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] mt-1\">Language and regional parity registry</p>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent className=\"p-10 space-y-10 relative z-10\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10\">\n                <div className=\"space-y-3\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Universal Language Node</label>\n                  <div className=\"relative group/input\">\n                    <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-2xl\" />\n                    <Translate weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\n                    <select\n                      value={formData.defaultLanguage}\n                      onChange={(e) => handleChange('defaultLanguage', e.target.value)}\n                      className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-bold uppercase text-xs tracking-widest appearance-none relative z-10 shadow-inner\"\n                    >\n                      {languages.map(l => (\n                        <option key={l.code} value={l.code} className=\"bg-card\">{l.name.toUpperCase()} ({l.code.toUpperCase()})</option>\n                      ))}\n                    </select>\n                    <CaretDown weight=\"bold\" className=\"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 pointer-events-none z-20\" />\n                  </div>\n                </div>\n\n                <div className=\"space-y-3\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Temporal Alignment</label>\n                  <div className=\"relative group/input\">\n                    <Clock weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\n                    <select\n                      value={formData.timezone}\n                      onChange={(e) => handleChange('timezone', e.target.value)}\n                      className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-bold uppercase text-xs tracking-widest appearance-none shadow-inner\"\n                    >\n                      {timezones.map(tz => (\n                        <option key={tz.value} value={tz.value} className=\"bg-card\">{tz.name.toUpperCase()}</option>\n                      ))}\n                    </select>\n                    <CaretDown weight=\"bold\" className=\"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 pointer-events-none\" />\n                  </div>\n                </div>\n\n                <div className=\"space-y-3\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Fiscal Denomination</label>\n                  <div className=\"relative group/input\">\n                    <Coins weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\n                    <select\n                      value={formData.currency}\n                      onChange={(e) => handleChange('currency', e.target.value)}\n                      className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-bold uppercase text-xs tracking-widest appearance-none shadow-inner\"\n                    >\n                      {currencies.map(c => (\n                        <option key={c.code} value={c.code} className=\"bg-card\">{c.name.toUpperCase()}</option>\n                      ))}\n                    </select>\n                    <CaretDown weight=\"bold\" className=\"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 pointer-events-none\" />\n                  </div>\n                </div>\n\n                <div className=\"space-y-3\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Temporal Notation</label>\n                  <div className=\"relative group/input\">\n                    <CalendarDots weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\n                    <select\n                      value={formData.dateFormat}\n                      onChange={(e) => handleChange('dateFormat', e.target.value)}\n                      className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-bold uppercase text-xs tracking-widest appearance-none shadow-inner\"\n                    >\n                      <option value=\"DD/MM/YYYY\" className=\"bg-card\">DD/MM/YYYY</option>\n                      <option value=\"MM/DD/YYYY\" className=\"bg-card\">MM/DD/YYYY</option>\n                      <option value=\"YYYY-MM-DD\" className=\"bg-card\">YYYY-MM-DD</option>\n                    </select>\n                    <CaretDown weight=\"bold\" className=\"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 pointer-events-none\" />\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Intelligence Sidebar */}\n        <div className=\"space-y-10\">\n          <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n            <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\n                  <Info weight=\"duotone\" className=\"w-5 h-5\" />\n                </div>\n                <CardTitle className=\"text-sm font-black uppercase tracking-tight\">Regional Protocol</CardTitle>\n              </div>\n            </CardHeader>\n            <CardContent className=\"p-8 space-y-8\">\n              <div className=\"space-y-6\">\n                <div className=\"flex items-center justify-between px-1\">\n                  <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Localization Status</span>\n                  <Badge variant=\"success\" size=\"sm\" className=\"font-black text-[8px] uppercase px-3 py-1 tracking-widest shadow-sm\">PARITY_OK</Badge>\n                </div>\n                <div className=\"p-5 bg-primary/5 rounded-[32px] border border-primary/10 space-y-3 group/brief overflow-hidden relative shadow-inner\">\n                  <div className=\"absolute top-0 right-0 p-4 opacity-[0.03] group-hover/brief:scale-110 transition-transform\">\n                    <Sparkle weight=\"fill\" className=\"w-16 h-16 text-primary\" />\n                  </div>\n                  <h4 className=\"text-[10px] font-black text-primary uppercase tracking-[0.2em] relative z-10 flex items-center gap-2\">\n                    <Clock weight=\"bold\" className=\"w-3.5 h-3.5\" />\n                    Sync Node\n                  </h4>\n                  <p className=\"text-[10px] text-muted-foreground italic font-medium leading-relaxed relative z-10 opacity-80 uppercase tracking-widest\">\n                    System parameters are synchronized across all connected clinical terminals in this regional sector.\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"pt-8 border-t border-border/30 space-y-6\">\n                <h4 className=\"text-[10px] font-black text-foreground uppercase tracking-[0.3em] flex items-center gap-3\">\n                  <CheckCircle weight=\"duotone\" className=\"w-5 h-5 text-primary\" />\n                  Integrity Sync\n                </h4>\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center justify-between p-4 bg-secondary/30 rounded-2xl border border-border/50 hover:bg-secondary/50 transition-all shadow-inner\">\n                    <span className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">Region Hash</span>\n                    <span className=\"text-[9px] font-mono text-primary font-bold\">UTC+7_THB</span>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\settings\\components\\SettingsHeader.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Gear' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Gear"},"fix":{"range":[24,29],"text":""},"desc":"Remove unused variable \"Gear\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ShieldCheck' is defined but never used.","line":3,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":56,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ShieldCheck"},"fix":{"range":[57,70],"text":""},"desc":"Remove unused variable \"ShieldCheck\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":15,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Badge"},"fix":{"range":[159,205],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { Gear, FloppyDisk, ArrowsClockwise, ShieldCheck, Pulse } from '@phosphor-icons/react';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/Badge';\nimport { motion, AnimatePresence } from 'framer-motion';\n\ninterface SettingsHeaderProps {\n  onSave: () => void;\n  hasUnsavedChanges: boolean;\n}\n\nexport default function SettingsHeader({ onSave, hasUnsavedChanges }: SettingsHeaderProps) {\n  const { refreshSettings, loading } = useSettingsContext();\n\n  const handleRefresh = async () => {\n    await refreshSettings();\n  };\n\n  return (\n    <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n      <div className=\"space-y-1\">\n        <motion.div \n          initial={{ opacity: 0, x: -20 }}\n          animate={{ opacity: 1, x: 0 }}\n          className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n        >\n          <Pulse weight=\"duotone\" className=\"w-4 h-4\" />\n          System Control Node\n        </motion.div>\n        <motion.h1 \n          initial={{ opacity: 0, x: -20 }}\n          animate={{ opacity: 1, x: 0 }}\n          transition={{ delay: 0.1 }}\n          className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n        >\n          Global <span className=\"text-primary\">Settings</span>\n        </motion.h1>\n        <motion.p \n          initial={{ opacity: 0, x: -20 }}\n          animate={{ opacity: 1, x: 0 }}\n          transition={{ delay: 0.2 }}\n          className=\"text-muted-foreground font-light text-sm italic\"\n        >\n          Configuring global parameters, feature flags, and clinical orchestration.\n        </motion.p>\n      </div>\n      \n      <div className=\"flex items-center gap-3\">\n        <AnimatePresence>\n          {hasUnsavedChanges && (\n            <motion.div\n              initial={{ opacity: 0, scale: 0.9, x: 20 }}\n              animate={{ opacity: 1, scale: 1, x: 0 }}\n              exit={{ opacity: 0, scale: 0.9, x: 20 }}\n              className=\"flex items-center gap-3 bg-amber-500/10 border border-amber-500/20 px-4 py-2 rounded-xl\"\n            >\n              <div className=\"w-2 h-2 rounded-full bg-amber-500 animate-pulse\" />\n              <span className=\"text-xs font-bold text-amber-600 uppercase tracking-widest\">Unsaved Changes</span>\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n        <Button\n          variant=\"outline\"\n          onClick={handleRefresh}\n          disabled={loading}\n          className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\n        >\n          <ArrowsClockwise weight=\"bold\" className={`w-4 h-4 ${loading ? 'animate-spin' : ''}`} />\n          Sync Intel\n        </Button>\n\n        <Button\n          onClick={onSave}\n          disabled={!hasUnsavedChanges || loading}\n          className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium group\"\n        >\n          <FloppyDisk weight=\"bold\" className=\"w-4 h-4 group-hover:scale-110 transition-transform\" />\n          Commit Changes\n        </Button>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\settings\\components\\SettingsNavigation.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Invalid character.","line":88,"column":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { motion } from 'framer-motion';\nimport { \n  Buildings, \n  Globe, \n  Lightning, \n  Palette, \n  Bell, \n  Shield, \n  CreditCard, \n  Sparkle, \n  HardDrive, \n  PuzzlePiece, \n  CaretRight,\n  Monitor\n} from '@phosphor-icons/react';\nimport { cn } from '@/lib/utils';\nimport { useSettingsContext } from '../context';\n\nconst navigationSections = [\n  {\n    id: 'company',\n    label: 'Company Info',\n    icon: Buildings,\n    description: 'Basic company information and branding'\n  },\n  {\n    id: 'regional',\n    label: 'Regional Settings',\n    icon: Globe,\n    description: 'Language, timezone, and currency settings'\n  },\n  {\n    id: 'features',\n    label: 'Feature Flags',\n    icon: Lightning,\n    description: 'Enable or disable system features'\n  },\n  {\n    id: 'ai',\n    label: 'AI Configuration',\n    icon: Palette,\n    description: 'AI models and analysis settings'\n  },\n  {\n    id: 'email',\n    label: 'Email Settings',\n    icon: Bell,\n    description: 'SMTP configuration and templates'\n  },\n  {\n    id: 'security',\n    label: 'Security',\n    icon: Shield,\n    description: 'Authentication and access control'\n  },\n  {\n    id: 'subscriptions',\n    label: 'Subscription Plans',\n    icon: CreditCard,\n    description: 'Pricing and plan configuration'\n  },\n  {\n    id: 'storage',\n    label: 'Storage & Files',\n    icon: HardDrive,\n    description: 'File storage and upload settings'\n  },\n  {\n    id: 'integrations',\n    label: 'Integrations',\n    icon: PuzzlePiece,\n    description: 'Third-party service integrations'\n  },\n  {\n    id: 'monitoring',\n    label: 'Monitoring',\n    icon: Monitor,\n    description: 'System performance and health monitoring'\n  }\n];\n\nexport default function SettingsNavigation() {\n  const { activeSection, setActiveSection } = useSettingsContext();\n\n  return (\n    <div className=\\\"space-y-2\\\">\n      {navigationSections.map((item, i) => (\n        <motion.button\n          key={item.id}\n          initial={{ opacity: 0, x: -10 }}\n          animate={{ opacity: 1, x: 0 }}\n          transition={{ delay: i * 0.05 }}\n          onClick={() => setActiveSection(item.id)}\n          className={cn(\n            \\\"w-full flex items-center justify-between p-4 rounded-2xl transition-all group relative overflow-hidden\\\",\n            activeSection === item.id\n              ? \\\"bg-primary text-primary-foreground shadow-premium\\\"\n              : \\\"text-muted-foreground hover:bg-secondary hover:text-foreground\\\"\n          )}\n        >\n          {activeSection === item.id && (\n            <motion.div \n              layoutId=\\\"nav-active-glow\\\"\n              className=\\\"absolute inset-0 bg-gradient-to-r from-white/10 to-transparent pointer-events-none\\\"\n            />\n          )}\n          <div className=\\\"flex items-center gap-4 relative z-10\\\">\n            <div className={cn(\n              \\\"w-10 h-10 rounded-xl flex items-center justify-center transition-all duration-500 shadow-inner\\\",\n              activeSection === item.id ? \\\"bg-white/20\\\" : \\\"bg-secondary border border-border/50 group-hover:border-primary/20\\\"\n            )}>\n              <item.icon weight={activeSection === item.id ? \\\"fill\\\" : \\\"duotone\\\"} className=\\\"w-5 h-5\\\" />\n            </div>\n            <span className=\\\"text-[11px] font-black uppercase tracking-widest\\\">{item.label}</span>\n          </div>\n          <CaretRight \n            weight=\\\"bold\\\" \n            className={cn(\n              \\\"w-3.5 h-3.5 transition-transform duration-500\\\",\n              activeSection === item.id ? \\\"translate-x-0\\\" : \\\"opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0\\\"\n            )} \n          />\n        </motion.button>\n      ))}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\settings\\context.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\settings\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[139,153],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Bell' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Bell"},"fix":{"range":[178,187],"text":""},"desc":"Remove unused variable \"Bell\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Globe' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Globe"},"fix":{"range":[187,197],"text":""},"desc":"Remove unused variable \"Globe\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CreditCard' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CreditCard"},"fix":{"range":[223,238],"text":""},"desc":"Remove unused variable \"CreditCard\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PuzzlePiece' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"PuzzlePiece"},"fix":{"range":[238,254],"text":""},"desc":"Remove unused variable \"PuzzlePiece\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pulse' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pulse"},"fix":{"range":[254,263],"text":""},"desc":"Remove unused variable \"Pulse\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle"},"fix":{"range":[263,278],"text":""},"desc":"Remove unused variable \"CheckCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningCircle' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WarningCircle"},"fix":{"range":[278,295],"text":""},"desc":"Remove unused variable \"WarningCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SettingsHeader' is defined but never used.","line":21,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":22,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"SettingsHeader"},"fix":{"range":[394,451],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":33,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[1077,1110],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":36,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  SpinnerGap, \n  ArrowLeft, \n  Gear, \n  ShieldCheck, \n  Bell, \n  Globe, \n  Sparkle, \n  HardDrive, \n  CreditCard, \n  PuzzlePiece,\n  Pulse,\n  CheckCircle,\n  WarningCircle\n} from '@phosphor-icons/react';\nimport { SettingsProvider, useSettingsContext } from './context';\nimport SettingsHeader from './components/SettingsHeader';\nimport SettingsNavigation from './components/SettingsNavigation';\nimport CompanySettings from './components/CompanySettings';\nimport RegionalSettings from './components/RegionalSettings';\nimport FeatureFlags from './components/FeatureFlags';\nimport PricingSettings from './components/PricingSettings';\nimport EmailTemplates from './components/EmailTemplates';\nimport { SystemSettings } from './types';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/Card';\nimport { cn } from '@/lib/utils';\n\nfunction SettingsContent() {\n  const { goBack } = useBackNavigation();\n  const { settings, loading, activeSection, refreshSettings, updateSettings } = useSettingsContext();\n  const [pendingChanges, setPendingChanges] = useState<Partial<SystemSettings>>({});\n  const [hasUnsavedChanges, setHasUnsavedChanges] = useState(false);\n\n  useEffect(() => {\n    refreshSettings();\n  }, [refreshSettings]);\n\n  const handleSettingsChange = (updates: Partial<SystemSettings>) => {\n    setPendingChanges((prev: Partial<SystemSettings>) => ({ ...prev, ...updates }));\n    setHasUnsavedChanges(true);\n  };\n\n  const handleSave = async () => {\n    try {\n      await updateSettings(pendingChanges);\n      setPendingChanges({});\n      setHasUnsavedChanges(false);\n    } catch (error) {\n      console.error('Failed to save settings:', error);\n      // You could add a toast notification here\n    }\n  };\n\n  const renderActiveSection = () => {\n    switch (activeSection) {\n      case 'company':\n        return <CompanySettings onSettingsChange={handleSettingsChange} />;\n      case 'regional':\n        return <RegionalSettings onSettingsChange={handleSettingsChange} />;\n      case 'features':\n        return <FeatureFlags onSettingsChange={handleSettingsChange} />;\n      case 'ai':\n        return (\n          <Card className=\"p-8 rounded-[40px] border-border/50 shadow-premium group overflow-hidden relative\">\n            <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n              <Sparkle weight=\"fill\" className=\"w-48 h-48 text-primary\" />\n            </div>\n            <div className=\"relative z-10 space-y-6\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\n                  <Sparkle weight=\"duotone\" className=\"w-7 h-7\" />\n                </div>\n                <div>\n                  <h2 className=\"text-2xl font-black text-foreground uppercase tracking-tight\">AI Configuration</h2>\n                  <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.3em] font-black mt-1\">Machine learning model parameters</p>\n                </div>\n              </div>\n              <div className=\"p-6 bg-secondary/30 rounded-[32px] border border-border/50 shadow-inner\">\n                <p className=\"text-sm text-muted-foreground font-medium italic leading-relaxed\">\n                  Autonomous diagnostic nodes and cognitive processing parameters will be accessible in the next synchronization cycle.\n                </p>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse\" />\n                <span className=\"text-[10px] font-black text-amber-600 uppercase tracking-widest\">Protocol Pending Implementation</span>\n              </div>\n            </div>\n          </Card>\n        );\n      case 'email':\n        return <EmailTemplates onSettingsChange={handleSettingsChange} />;\n      case 'security':\n        return (\n          <Card className=\"p-8 rounded-[40px] border-border/50 shadow-premium group overflow-hidden relative\">\n            <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n              <ShieldCheck weight=\"fill\" className=\"w-48 h-48 text-primary\" />\n            </div>\n            <div className=\"relative z-10 space-y-6\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\n                  <ShieldCheck weight=\"duotone\" className=\"w-7 h-7\" />\n                </div>\n                <div>\n                  <h2 className=\"text-2xl font-black text-foreground uppercase tracking-tight\">Security Settings</h2>\n                  <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.3em] font-black mt-1\">Access control & identity encryption</p>\n                </div>\n              </div>\n              <div className=\"p-6 bg-secondary/30 rounded-[32px] border border-border/50 shadow-inner\">\n                <p className=\"text-sm text-muted-foreground font-medium italic leading-relaxed\">\n                  Global authentication protocols and regional access matrices are currently under administrative lock.\n                </p>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse\" />\n                <span className=\"text-[10px] font-black text-amber-600 uppercase tracking-widest\">Protocol Pending Implementation</span>\n              </div>\n            </div>\n          </Card>\n        );\n      case 'subscriptions':\n        return <PricingSettings onSettingsChange={handleSettingsChange} />;\n      case 'storage':\n        return (\n          <Card className=\"p-8 rounded-[40px] border-border/50 shadow-premium group overflow-hidden relative\">\n            <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n              <HardDrive weight=\"fill\" className=\"w-48 h-48 text-primary\" />\n            </div>\n            <div className=\"relative z-10 space-y-6\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\n                  <HardDrive weight=\"duotone\" className=\"w-7 h-7\" />\n                </div>\n                <div>\n                  <h2 className=\"text-2xl font-black text-foreground uppercase tracking-tight\">Storage & Files</h2>\n                  <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.3em] font-black mt-1\">Cloud asset & telemetry storage</p>\n                </div>\n              </div>\n              <div className=\"p-6 bg-secondary/30 rounded-[32px] border border-border/50 shadow-inner\">\n                <p className=\"text-sm text-muted-foreground font-medium italic leading-relaxed\">\n                  Distributed cloud storage nodes and asset retention policies will be synchronized in version 2.0.\n                </p>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse\" />\n                <span className=\"text-[10px] font-black text-amber-600 uppercase tracking-widest\">Protocol Pending Implementation</span>\n              </div>\n            </div>\n          </Card>\n        );\n      default:\n        return <CompanySettings onSettingsChange={handleSettingsChange} />;\n    }\n  };\n\n  if (loading && !settings) {\n    return (\n      <div className=\"min-h-[400px] flex flex-col items-center justify-center space-y-4\">\n        <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\n        <p className=\"text-muted-foreground animate-pulse text-xs uppercase tracking-widest text-center\">\n          Synchronizing System Configuration...\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <Gear weight=\"duotone\" className=\"w-4 h-4\" />\n            System Control Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight\"\n          >\n            Global <span className=\"text-primary\">Settings</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Configuring global parameters, feature flags, and clinical orchestration.\n          </motion.p>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <AnimatePresence>\n            {hasUnsavedChanges && (\n              <motion.div\n                initial={{ opacity: 0, scale: 0.9, x: 20 }}\n                animate={{ opacity: 1, scale: 1, x: 0 }}\n                exit={{ opacity: 0, scale: 0.9, x: 20 }}\n                className=\"flex items-center gap-3 bg-amber-500/10 border border-amber-500/20 px-4 py-2 rounded-xl\"\n              >\n                <div className=\"w-2 h-2 rounded-full bg-amber-500 animate-pulse\" />\n                <span className=\"text-xs font-bold text-amber-600 uppercase tracking-widest\">Unsaved Changes</span>\n              </motion.div>\n            )}\n          </AnimatePresence>\n          <Button \n            onClick={handleSave}\n            disabled={!hasUnsavedChanges || loading}\n            className=\"shadow-premium px-8\"\n          >\n            Save Configuration\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-8\">\n        {/* Settings Navigation - Takes 1 column */}\n        <div className=\"lg:col-span-1\">\n          <Card className=\"sticky top-28 border-border/50\">\n            <CardContent className=\"p-2\">\n              <SettingsNavigation />\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Settings Content - Takes 3 columns */}\n        <div className=\"lg:col-span-3 space-y-6\">\n          <AnimatePresence mode=\"wait\">\n            <motion.div\n              key={activeSection}\n              initial={{ opacity: 0, y: 10 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -10 }}\n              transition={{ duration: 0.2 }}\n            >\n              {renderActiveSection()}\n            </motion.div>\n          </AnimatePresence>\n        </div>\n      </div>\n    </motion.div>\n  );\n}\n\nexport default function SettingsPage() {\n  return (\n    <SettingsProvider>\n      <SettingsContent />\n    </SettingsProvider>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\support\\components\\SupportHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\support\\components\\SupportStats.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Invalid character.","line":82,"column":34}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { motion } from 'framer-motion';\nimport { Ticket, Clock, CheckCircle, Warning, Pulse, ChartBar, Icon } from '@phosphor-icons/react';\nimport { useSupportContext } from '../context';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { cn } from '@/lib/utils';\n\nexport default function SupportStats() {\n  const { stats } = useSupportContext();\n\n  if (!stats) return null;\n\n  const statsCards = [\n    {\n      title: 'Total Registry',\n      value: stats.total,\n      icon: Ticket as any,\n      color: 'text-blue-500'\n    },\n    {\n      title: 'Active Flux',\n      value: stats.open,\n      icon: Clock as any,\n      color: 'text-amber-500'\n    },\n    {\n      title: 'Processing Nodes',\n      value: stats.in_progress,\n      icon: Warning as any,\n      color: 'text-orange-500'\n    },\n    {\n      title: 'Settled Tickets',\n      value: stats.resolved,\n      icon: CheckCircle as any,\n      color: 'text-emerald-500'\n    }\n  ];\n\n  return (\n    <div className=\"space-y-8\">\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8\">\n        {statsCards.map((stat, index) => (\n          <StatCard\n            key={stat.title}\n            title={stat.title}\n            value={stat.value}\n            icon={stat.icon}\n            iconColor={stat.color}\n            className=\"p-4\"\n          />\n        ))}\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n        {/* Resolution Matrix Node */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.4 }}\n          className=\"p-8 rounded-[40px] border border-border/50 bg-secondary/30 shadow-inner group overflow-hidden relative\"\n        >\n          <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n            <ChartBar weight=\"fill\" className=\"w-32 h-32 text-primary\" />\n          </div>\n          <div className=\"relative z-10 space-y-6\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-3\">\n                <Pulse weight=\"duotone\" className=\"w-5 h-5 text-emerald-500\" />\n                <h4 className=\"text-[10px] font-black text-foreground uppercase tracking-[0.3em]\">Resolution Efficiency</h4>\n              </div>\n              <span className=\"text-2xl font-black text-emerald-500 tabular-nums\">\n                {stats.total > 0 ? Math.round((stats.resolved / stats.total) * 100) : 100}%\n              </span>\n            </div>\n            <div className=\"w-full bg-card border border-border/50 rounded-full h-2 overflow-hidden p-0.5 shadow-inner\">\n              <motion.div\n                initial={{ width: 0 }}\n                animate={{ width: \\\\%\\ }}\n                transition={{ delay: 0.6, duration: 1, ease: \"circOut\" }}\n                className=\"h-full bg-emerald-500 rounded-full shadow-[0_0_10px_rgba(16,185,129,0.4)]\"\n              />\n            </div>\n            <p className=\"text-[10px] text-muted-foreground font-medium italic opacity-60\">\n              Measuring the velocity of protocol resolution across global support nodes.\n            </p>\n          </div>\n        </motion.div>\n\n        {/* Priority Oversight Node */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.5 }}\n          className=\"p-8 rounded-[40px] border border-border/50 bg-secondary/30 shadow-inner group overflow-hidden relative\"\n        >\n          <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n            <Warning weight=\"fill\" className=\"w-32 h-32 text-rose-500\" />\n          </div>\n          <div className=\"relative z-10 space-y-6\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-3\">\n                <Warning weight=\"duotone\" className=\"w-5 h-5 text-rose-500\" />\n                <h4 className=\"text-[10px] font-black text-foreground uppercase tracking-[0.3em]\">Critical Oversight</h4>\n              </div>\n              <Badge variant=\"destructive\" size=\"sm\" className=\"font-black text-[10px] tracking-widest px-3 py-1\">\n                {stats.high_priority} EXCEPTIONS\n              </Badge>\n            </div>\n            <p className=\"text-sm text-muted-foreground font-medium italic leading-relaxed opacity-80\">\n              Currently monitoring {stats.high_priority} high-priority clinical tickets requiring immediate administrative synchronization.\n            </p>\n          </div>\n        </motion.div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\support\\components\\SupportTicketTable.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Funnel' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":9,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Funnel"},"fix":{"range":[357,368],"text":""},"desc":"Remove unused variable \"Funnel\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Plus"},"fix":{"range":[368,377],"text":""},"desc":"Remove unused variable \"Plus\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Clock"},"fix":{"range":[412,422],"text":""},"desc":"Remove unused variable \"Clock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle"},"fix":{"range":[440,456],"text":""},"desc":"Remove unused variable \"CheckCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'XCircle' is defined but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"XCircle"},"fix":{"range":[456,468],"text":""},"desc":"Remove unused variable \"XCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DotsThreeVertical' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":20,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"DotsThreeVertical"},"fix":{"range":[502,523],"text":""},"desc":"Remove unused variable \"DotsThreeVertical\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pulse' is defined but never used.","line":25,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pulse"},"fix":{"range":[539,548],"text":""},"desc":"Remove unused variable \"Pulse\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationCard' is defined but never used.","line":26,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":21,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationCard"},"fix":{"range":[548,570],"text":""},"desc":"Remove unused variable \"IdentificationCard\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":27,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":22,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[570,593],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useState } from 'react';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport { cn } from '@/lib/utils';\nimport ResponsiveTable from '@/components/ui/ResponsiveTable';\nimport { \n  MagnifyingGlass, \n  Funnel, \n  Plus, \n  Eye, \n  PencilSimple, \n  Trash, \n  Clock, \n  WarningCircle, \n  CheckCircle, \n  XCircle,\n  Buildings,\n  User,\n  CaretDown,\n  DotsThreeVertical,\n  CalendarDots,\n  Pulse,\n  IdentificationCard,\n  IdentificationBadge,\n  Monitor\n} from '@phosphor-icons/react';\nimport { SupportTicket } from '../types';\n\ninterface SupportTicketTableProps {\n  tickets: SupportTicket[];\n  onTicketSelect: (ticket: SupportTicket) => void;\n  onTicketEdit: (ticket: SupportTicket) => void;\n  onTicketDelete: (ticketId: string) => void;\n  loading?: boolean;\n}\n\nexport default function SupportTicketTable({ \n  tickets, \n  onTicketSelect, \n  onTicketEdit, \n  onTicketDelete, \n  loading = false \n}: SupportTicketTableProps) {\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filterStatus, setFilterStatus] = useState('all');\n  const [filterPriority, setFilterPriority] = useState('all');\n\n  // Filter tickets\n  const filteredTickets = tickets.filter(ticket => {\n    const matchesSearch = ticket.subject.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         ticket.description.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         ticket.user?.full_name.toLowerCase().includes(searchTerm.toLowerCase());\n    \n    const matchesStatus = filterStatus === 'all' || ticket.status === filterStatus;\n    const matchesPriority = filterPriority === 'all' || ticket.priority === filterPriority;\n    \n    return matchesSearch && matchesStatus && matchesPriority;\n  });\n\n  const columns = [\n    {\n      header: 'Ticket Node',\n      accessor: (ticket: SupportTicket) => (\n        <div className=\"flex items-center gap-4\">\n          <div className=\"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm shrink-0\">\n            <WarningCircle weight=\"duotone\" className=\"w-5 h-5\" />\n          </div>\n          <div className=\"min-w-0\">\n            <p className=\"font-bold text-foreground truncate uppercase tracking-tight leading-tight\">{ticket.subject}</p>\n            <p className=\"text-[10px] text-muted-foreground font-medium truncate italic\">{ticket.description}</p>\n          </div>\n        </div>\n      )\n    },\n    {\n      header: 'Identity Node',\n      accessor: (ticket: SupportTicket) => (\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-8 h-8 rounded-lg bg-secondary flex items-center justify-center text-muted-foreground shadow-inner\">\n            <User weight=\"bold\" className=\"w-4 h-4\" />\n          </div>\n          <div className=\"min-w-0\">\n            <p className=\"text-xs font-bold text-foreground truncate\">{ticket.user?.full_name || 'ANONYMOUS'}</p>\n            <p className=\"text-[9px] text-muted-foreground truncate font-mono uppercase opacity-60\">{ticket.user?.email || 'OFFLINE'}</p>\n          </div>\n        </div>\n      )\n    },\n    {\n      header: 'Cluster Link',\n      accessor: (ticket: SupportTicket) => (\n        <div className=\"flex items-center gap-2\">\n          <Buildings weight=\"duotone\" className=\"w-4 h-4 text-primary/60\" />\n          <span className=\"text-xs font-bold text-foreground uppercase tracking-tight\">{ticket.clinic_name || 'STANDALONE'}</span>\n        </div>\n      )\n    },\n    {\n      header: 'Protocol Priority',\n      accessor: (ticket: SupportTicket) => {\n        const priority = ticket.priority.toLowerCase();\n        return (\n          <Badge \n            variant={priority === 'urgent' ? 'destructive' : priority === 'high' ? 'warning' : 'secondary'} \n            size=\"sm\" \n            className=\"font-black text-[8px] tracking-widest px-2.5 py-1 uppercase shadow-sm\"\n          >\n            {priority}\n          </Badge>\n        );\n      }\n    },\n    {\n      header: 'Sync Status',\n      accessor: (ticket: SupportTicket) => {\n        const status = ticket.status.toLowerCase();\n        return (\n          <div className=\"flex items-center gap-2 px-3 py-1 bg-secondary/50 rounded-lg w-fit border border-border/30\">\n            <div className={cn(\"w-1.5 h-1.5 rounded-full animate-pulse\", \n              status === 'resolved' ? \"bg-emerald-500\" : \n              status === 'open' ? \"bg-rose-500\" : \n              status === 'in_progress' ? \"bg-amber-500\" : \"bg-muted\"\n            )} />\n            <span className={cn(\"text-[9px] font-black uppercase tracking-widest\",\n              status === 'resolved' ? \"text-emerald-500\" : \n              status === 'open' ? \"text-rose-500\" : \n              status === 'in_progress' ? \"text-amber-500\" : \"text-muted-foreground\"\n            )}>{status.replace('_', ' ')}</span>\n          </div>\n        );\n      }\n    },\n    {\n      header: 'Initialized',\n      accessor: (ticket: SupportTicket) => (\n        <span className=\"text-[10px] font-bold text-muted-foreground tabular-nums\">\n          {new Date(ticket.created_at).toLocaleDateString()}\n        </span>\n      )\n    },\n    {\n      header: '',\n      className: 'text-right',\n      accessor: (ticket: SupportTicket) => (\n        <div className=\"flex items-center justify-end gap-2 opacity-40 group-hover/row:opacity-100 transition-opacity\">\n          <Button \n            variant=\"outline\" \n            size=\"sm\" \n            onClick={(e) => { e.stopPropagation(); onTicketSelect(ticket); }}\n            className=\"h-9 w-9 p-0 rounded-xl border-border/50 hover:bg-secondary text-muted-foreground hover:text-primary transition-all\"\n          >\n            <Eye weight=\"bold\" className=\"w-4 h-4\" />\n          </Button>\n          <Button \n            variant=\"outline\" \n            size=\"sm\" \n            onClick={(e) => { e.stopPropagation(); onTicketEdit(ticket); }}\n            className=\"h-9 w-9 p-0 rounded-xl border-border/50 hover:bg-secondary text-muted-foreground hover:text-primary transition-all\"\n          >\n            <PencilSimple weight=\"bold\" className=\"w-4 h-4\" />\n          </Button>\n          <Button \n            variant=\"outline\" \n            size=\"sm\" \n            onClick={(e) => { e.stopPropagation(); onTicketDelete(ticket.id); }}\n            className=\"h-9 w-9 p-0 rounded-xl border-border/50 hover:bg-rose-500/10 text-muted-foreground hover:text-rose-500 hover:border-rose-500/30 transition-all\"\n          >\n            <Trash weight=\"bold\" className=\"w-4 h-4\" />\n          </Button>\n        </div>\n      )\n    }\n  ];\n\n  return (\n    <div className=\"space-y-8\">\n      {/* Table Hub */}\n      <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n        <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 relative\">\n          <div className=\"absolute top-0 right-0 p-10 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n            <Monitor weight=\"fill\" className=\"w-48 h-48 text-primary\" />\n          </div>\n          \n          <div className=\"flex flex-col lg:flex-row lg:items-center justify-between gap-8 relative z-10\">\n            <div className=\"flex items-center gap-5\">\n              <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\n                <Monitor weight=\"duotone\" className=\"w-7 h-7\" />\n              </div>\n              <div>\n                <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Support Ticket Registry</CardTitle>\n                <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.3em] font-black mt-1\">Global assistance protocol matrix</p>\n              </div>\n            </div>\n\n            <div className=\"flex flex-col sm:flex-row items-center gap-4 flex-1 lg:max-w-3xl justify-end\">\n              <div className=\"relative w-full sm:w-64 group/input\">\n                <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\n                <MagnifyingGlass weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\n                <input\n                  type=\"text\"\n                  placeholder=\"Query tickets...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  className=\"w-full pl-11 pr-4 py-3 bg-secondary/50 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10 font-bold text-sm\"\n                />\n              </div>\n              \n              <div className=\"flex items-center gap-3\">\n                <div className=\"relative w-full sm:w-40\">\n                  <select\n                    value={filterStatus}\n                    onChange={(e) => setFilterStatus(e.target.value)}\n                    className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3 px-6 pr-10 text-[10px] font-black uppercase tracking-widest text-foreground focus:border-primary outline-none transition-all appearance-none shadow-inner\"\n                  >\n                    <option value=\"all\">ALL_STATUS</option>\n                    <option value=\"open\">OPEN</option>\n                    <option value=\"in_progress\">PROCESSING</option>\n                    <option value=\"resolved\">SETTLED</option>\n                    <option value=\"closed\">ARCHIVED</option>\n                  </select>\n                  <CaretDown weight=\"bold\" className=\"absolute right-4 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-muted-foreground/40 pointer-events-none\" />\n                </div>\n\n                <div className=\"relative w-full sm:w-40\">\n                  <select\n                    value={filterPriority}\n                    onChange={(e) => setFilterPriority(e.target.value)}\n                    className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3 px-6 pr-10 text-[10px] font-black uppercase tracking-widest text-foreground focus:border-primary outline-none transition-all appearance-none shadow-inner\"\n                  >\n                    <option value=\"all\">ALL_PRIORITY</option>\n                    <option value=\"low\">LOW</option>\n                    <option value=\"medium\">MEDIUM</option>\n                    <option value=\"high\">HIGH</option>\n                    <option value=\"urgent\">URGENT</option>\n                  </select>\n                  <CaretDown weight=\"bold\" className=\"absolute right-4 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-muted-foreground/40 pointer-events-none\" />\n                </div>\n              </div>\n            </div>\n          </div>\n        </CardHeader>\n\n        <CardContent className=\"p-0\">\n          <ResponsiveTable\n            columns={columns}\n            data={filteredTickets}\n            loading={loading}\n            rowKey={(t) => t.id}\n            emptyMessage=\"Zero support nodes detected in current clinical registry.\"\n            onRowClick={onTicketSelect}\n            mobileCard={(ticket) => (\n              <div className=\"space-y-5\">\n                <div className=\"flex justify-between items-start\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"w-14 h-14 rounded-2xl bg-secondary border border-border flex items-center justify-center text-primary shadow-inner group-hover/row:bg-primary/10 transition-all\">\n                      <WarningCircle weight=\"duotone\" className=\"w-7 h-7\" />\n                    </div>\n                    <div className=\"min-w-0\">\n                      <p className=\"font-bold text-foreground truncate uppercase tracking-tight leading-tight\">{ticket.subject}</p>\n                      <div className=\"flex items-center gap-2 mt-1\">\n                        <Badge variant={ticket.priority.toLowerCase() === 'urgent' ? 'destructive' : ticket.priority.toLowerCase() === 'high' ? 'warning' : 'secondary'} size=\"sm\" className=\"font-black text-[7px] tracking-widest px-1.5 py-0.5 uppercase shadow-sm\">\n                          {ticket.priority}\n                        </Badge>\n                        <Badge variant=\"ghost\" size=\"sm\" className=\"bg-primary/5 text-primary border-none font-mono text-[8px] px-1.5 py-0.5 tracking-tighter\">NODE-{ticket.id.slice(0, 4)}</Badge>\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center gap-2 px-3 py-1 bg-secondary/50 rounded-lg border border-border/30 shadow-inner\">\n                    <div className={cn(\"w-1 h-1 rounded-full animate-pulse\", ticket.status === 'resolved' ? \"bg-emerald-500\" : \"bg-amber-500\")} />\n                    <span className=\"text-[8px] font-black uppercase tracking-widest\">{ticket.status.toUpperCase()}</span>\n                  </div>\n                </div>\n                \n                <div className=\"grid grid-cols-2 gap-6 py-4 border-y border-border/20\">\n                  <div className=\"space-y-1\">\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em]\">Identity Origin</p>\n                    <p className=\"text-xs font-bold text-foreground truncate\">{ticket.user?.full_name || 'ANONYMOUS'}</p>\n                  </div>\n                  <div className=\"space-y-1 text-right\">\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em]\">Cluster Node</p>\n                    <p className=\"text-xs font-bold text-foreground truncate uppercase\">{ticket.clinic_name || 'STANDALONE'}</p>\n                  </div>\n                </div>\n\n                <div className=\"flex justify-between items-center pt-1\">\n                  <div className=\"flex items-center gap-2 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\n                    <CalendarDots weight=\"bold\" className=\"w-3.5 h-3.5 opacity-40\" />\n                    Initialized: {new Date(ticket.created_at).toLocaleDateString()}\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button variant=\"outline\" size=\"sm\" className=\"h-10 w-10 p-0 rounded-xl border-border/50 hover:bg-secondary\">\n                      <Eye weight=\"bold\" className=\"w-4 h-4\" />\n                    </Button>\n                    <Button \n                      variant=\"outline\" \n                      size=\"sm\" \n                      className=\"h-10 w-10 p-0 border-border/50 rounded-xl hover:bg-secondary text-primary\"\n                      onClick={(e) => { e.stopPropagation(); onTicketEdit(ticket); }}\n                    >\n                      <PencilSimple weight=\"bold\" className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            )}\n          />\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\support\\components\\TicketFilters.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[136,169],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":91,"column":26,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[4824,4851],"text":"\n              Searching: &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[4824,4851],"text":"\n              Searching: &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[4824,4851],"text":"\n              Searching: &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[4824,4851],"text":"\n              Searching: &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":91,"column":43,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[4867,4883],"text":"&quot;\n              "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[4867,4883],"text":"&ldquo;\n              "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[4867,4883],"text":"&#34;\n              "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[4867,4883],"text":"&rdquo;\n              "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React from 'react';\nimport { Card } from '@/components/ui/Card';\nimport { Button } from '@/components/ui/button';\nimport { cn } from '@/lib/utils';\nimport { MagnifyingGlass, Funnel, CaretDown } from '@phosphor-icons/react';\nimport { useSupportContext } from '../context';\n\nexport default function TicketFilters() {\n  const { filters, updateFilters } = useSupportContext();\n\n  const handleSearchChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    updateFilters({ search: e.target.value, page: 1 });\n  };\n\n  const handleStatusChange = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    updateFilters({ status: e.target.value, page: 1 });\n  };\n\n  const handlePriorityChange = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    updateFilters({ priority: e.target.value, page: 1 });\n  };\n\n  return (\n    <Card className=\"p-6 rounded-[32px] border-border/50 shadow-premium overflow-hidden group\">\n      <div className=\"flex flex-wrap items-center gap-6 relative z-10\">\n        <div className=\"flex items-center gap-3 px-4 py-2 bg-primary/5 rounded-xl border border-primary/10\">\n          <Funnel weight=\"bold\" className=\"w-4 h-4 text-primary\" />\n          <span className=\"text-primary text-[10px] font-black uppercase tracking-widest\">Protocol Filters</span>\n        </div>\n        \n        <div className=\"relative flex-1 min-w-[300px] group/input\">\n          <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\n          <MagnifyingGlass weight=\"bold\" className=\"w-4 h-4 absolute left-4 top-1/2 transform -translate-y-1/2 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\n          <input\n            type=\"text\"\n            placeholder=\"Query tickets by subject, description, or identity...\"\n            value={filters.search}\n            onChange={handleSearchChange}\n            className=\"w-full pl-11 pr-4 py-3.5 bg-secondary/30 border border-border rounded-2xl text-foreground placeholder:text-muted-foreground/40 focus:outline-none focus:border-primary transition-all shadow-inner relative z-10 font-bold text-sm\"\n          />\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <div className=\"relative\">\n            <select\n              value={filters.status}\n              onChange={handleStatusChange}\n              className=\"bg-secondary/30 border border-border rounded-2xl py-3.5 px-6 pr-10 text-xs font-black uppercase tracking-widest text-foreground focus:border-primary outline-none transition-all appearance-none shadow-inner\"\n            >\n              <option value=\"all\" className=\"bg-card\">ALL_STATUS</option>\n              <option value=\"open\" className=\"bg-card\">OPEN_NODE</option>\n              <option value=\"in_progress\" className=\"bg-card\">PROCESSING</option>\n              <option value=\"resolved\" className=\"bg-card\">SETTLED</option>\n              <option value=\"closed\" className=\"bg-card\">ARCHIVED</option>\n            </select>\n            <CaretDown weight=\"bold\" className=\"absolute right-4 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-muted-foreground/40 pointer-events-none\" />\n          </div>\n\n          <div className=\"relative\">\n            <select\n              value={filters.priority}\n              onChange={handlePriorityChange}\n              className=\"bg-secondary/30 border border-border rounded-2xl py-3.5 px-6 pr-10 text-xs font-black uppercase tracking-widest text-foreground focus:border-primary outline-none transition-all appearance-none shadow-inner\"\n            >\n              <option value=\"all\" className=\"bg-card\">ALL_PRIORITY</option>\n              <option value=\"low\" className=\"bg-card\">LOW_VAL</option>\n              <option value=\"medium\" className=\"bg-card\">MEDIUM_VAL</option>\n              <option value=\"high\" className=\"bg-card\">HIGH_ALERT</option>\n              <option value=\"urgent\" className=\"bg-card\">URGENT_SYNC</option>\n            </select>\n            <CaretDown weight=\"bold\" className=\"absolute right-4 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-muted-foreground/40 pointer-events-none\" />\n          </div>\n\n          <Button\n            variant=\"outline\"\n            onClick={() => updateFilters({ search: '', status: 'all', priority: 'all', page: 1 })}\n            className=\"px-6 py-3.5 h-auto rounded-2xl border-border/50 hover:bg-secondary text-[10px] font-black uppercase tracking-widest transition-all\"\n          >\n            Clear Matrix\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"mt-6 flex items-center gap-3 px-1\">\n        <div className=\"w-1 h-1 rounded-full bg-primary/40\" />\n        <div className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\n          {filters.search ? (\n            <span>\n              Searching: \"{filters.search}\"\n              {(filters.status !== 'all' || filters.priority !== 'all') && ' | '}\n            </span>\n          ) : (\n            <span>Global Registry View</span>\n          )}\n          {filters.status !== 'all' && (\n            <span>\n              Status: {filters.status.toUpperCase()}\n              {filters.priority !== 'all' && ' | '}\n            </span>\n          )}\n          {filters.priority !== 'all' && (\n            <span>Priority: {filters.priority.toUpperCase()}</span>\n          )}\n        </div>\n      </div>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\support\\components\\TicketsList.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Invalid character.","line":70,"column":33}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { Card, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport { cn } from '@/lib/utils';\nimport { \n  SpinnerGap, \n  Clock, \n  User, \n  Buildings, \n  ChatCircle, \n  Eye, \n  PencilSimple,\n  Warning,\n  CheckCircle,\n  WarningCircle,\n  CaretRight\n} from '@phosphor-icons/react';\nimport { useSupportContext } from '../context';\nimport { SupportTicket } from '../types';\nimport { motion } from 'framer-motion';\n\ninterface TicketsListProps {\n  onViewTicket: (ticket: SupportTicket) => void;\n  onEditTicket: (ticket: SupportTicket) => void;\n}\n\nexport default function TicketsList({ onViewTicket, onEditTicket }: TicketsListProps) {\n  const { tickets, loading } = useSupportContext();\n\n  const getPriorityColor = (priority: string) => {\n    switch (priority.toLowerCase()) {\n      case 'urgent': return 'bg-rose-500/10 text-rose-500 border-rose-500/20';\n      case 'high': return 'bg-orange-500/10 text-orange-500 border-orange-500/20';\n      case 'medium': return 'bg-blue-500/10 text-blue-500 border-blue-500/20';\n      case 'low': return 'bg-secondary text-muted-foreground border-border';\n      default: return 'bg-secondary text-muted-foreground border-border';\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status.toLowerCase()) {\n      case 'open': return 'bg-rose-500/10 text-rose-500 border-rose-500/20';\n      case 'in_progress': return 'bg-amber-500/10 text-amber-500 border-amber-500/20';\n      case 'resolved': return 'bg-emerald-500/10 text-emerald-500 border-emerald-500/20';\n      case 'closed': return 'bg-secondary text-muted-foreground border-border';\n      default: return 'bg-secondary text-muted-foreground border-border';\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('th-TH', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  const getTimeAgo = (dateString: string) => {\n    const now = new Date();\n    const date = new Date(dateString);\n    const diffInMs = now.getTime() - date.getTime();\n    const diffInHours = diffInMs / (1000 * 60 * 60);\n    const diffInDays = diffInMs / (1000 * 60 * 60 * 24);\n\n    if (diffInHours < 1) return 'Just now';\n    if (diffInHours < 24) return \\\\h ago\\;\n    if (diffInDays < 7) return \\\\d ago\\;\n    return formatDate(dateString);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"space-y-6\">\n        {[...Array(5)].map((_, index) => (\n          <Card key={index} className=\"rounded-[32px] border-border/50 shadow-sm overflow-hidden\">\n            <CardContent className=\"p-8\">\n              <div className=\"animate-pulse space-y-6\">\n                <div className=\"flex justify-between items-start\">\n                  <div className=\"flex gap-3\">\n                    <div className=\"h-6 w-20 bg-secondary rounded-lg\"></div>\n                    <div className=\"h-6 w-20 bg-secondary rounded-lg\"></div>\n                  </div>\n                  <div className=\"h-8 w-8 bg-secondary rounded-xl\"></div>\n                </div>\n                <div className=\"space-y-3\">\n                  <div className=\"h-6 bg-secondary rounded-xl w-3/4\"></div>\n                  <div className=\"h-4 bg-secondary rounded-lg w-1/2\"></div>\n                </div>\n                <div className=\"grid grid-cols-3 gap-6 pt-4\">\n                  <div className=\"h-4 bg-secondary rounded-lg\"></div>\n                  <div className=\"h-4 bg-secondary rounded-lg\"></div>\n                  <div className=\"h-4 bg-secondary rounded-lg\"></div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n    );\n  }\n\n  if (tickets.length === 0) {\n    return (\n      <Card variant=\"ghost\" className=\"py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-8 opacity-40 rounded-[40px]\">\n        <div className=\"w-20 h-20 rounded-[40px] bg-secondary flex items-center justify-center text-muted-foreground shadow-inner\">\n          <ChatCircle weight=\"duotone\" className=\"w-10 h-10\" />\n        </div>\n        <div className=\"text-center space-y-2\">\n          <h3 className=\"text-2xl font-black text-foreground uppercase tracking-widest\">Support Nominal</h3>\n          <p className=\"text-sm text-muted-foreground font-medium italic max-w-sm mx-auto\">\n            Zero support tickets match your current operational filters.\n          </p>\n        </div>\n      </Card>\n    );\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-6\"\n    >\n      {tickets.map((ticket, index) => (\n        <motion.div\n          key={ticket.id}\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: index * 0.05 }}\n        >\n          <Card \n            className=\"rounded-[32px] border-border/50 hover:border-primary/30 transition-all cursor-pointer group shadow-card hover:shadow-card-hover overflow-hidden\"\n            onClick={() => onViewTicket(ticket)}\n          >\n            <CardContent className=\"p-8\">\n              <div className=\"flex items-start justify-between gap-8\">\n                <div className=\"flex-1 space-y-6\">\n                  <div className=\"flex flex-wrap items-center gap-3\">\n                    <Badge variant=\"ghost\" className={cn(\"font-black uppercase text-[8px] tracking-widest px-3 py-1 border\", getPriorityColor(ticket.priority))}>\n                      {ticket.priority.toUpperCase()} PRIORITY\n                    </Badge>\n                    <Badge variant=\"ghost\" className={cn(\"font-black uppercase text-[8px] tracking-widest px-3 py-1 border\", getStatusColor(ticket.status))}>\n                      {ticket.status.replace('_', ' ').toUpperCase()}\n                    </Badge>\n                    {ticket.category && (\n                      <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[8px] tracking-widest uppercase px-3 py-1\">\n                        {ticket.category.replace('_', ' ').toUpperCase()} NODE\n                      </Badge>\n                    )}\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <h3 className=\"text-xl font-black text-foreground uppercase tracking-tight group-hover:text-primary transition-colors\">\n                      {ticket.subject}\n                    </h3>\n                    <p className=\"text-muted-foreground text-sm font-medium italic leading-relaxed line-clamp-2\">\n                      {ticket.description}\n                    </p>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 pt-2\">\n                    <div className=\"flex items-center gap-3 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\n                      <div className=\"w-8 h-8 rounded-xl bg-secondary flex items-center justify-center\">\n                        <Buildings weight=\"bold\" className=\"w-4 h-4 opacity-60\" />\n                      </div>\n                      <span className=\"truncate\">{ticket.clinic_name || 'ANONYMOUS_CLINIC'}</span>\n                    </div>\n                    \n                    {ticket.user && (\n                      <div className=\"flex items-center gap-3 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\n                        <div className=\"w-8 h-8 rounded-xl bg-secondary flex items-center justify-center\">\n                          <User weight=\"bold\" className=\"w-4 h-4 opacity-60\" />\n                        </div>\n                        <span className=\"truncate\">{ticket.user.full_name}</span>\n                      </div>\n                    )}\n\n                    <div className=\"flex items-center gap-3 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\n                      <div className=\"w-8 h-8 rounded-xl bg-secondary flex items-center justify-center\">\n                        <Clock weight=\"bold\" className=\"w-4 h-4 opacity-60\" />\n                      </div>\n                      <span>{getTimeAgo(ticket.created_at)}</span>\n                    </div>\n\n                    {ticket.replies && (\n                      <div className=\"flex items-center gap-3 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\n                        <div className=\"w-8 h-8 rounded-xl bg-secondary flex items-center justify-center\">\n                          <ChatCircle weight=\"bold\" className=\"w-4 h-4 opacity-60\" />\n                        </div>\n                        <span>{ticket.replies.length} TRANSMISSIONS</span>\n                      </div>\n                    )}\n                  </div>\n\n                  {ticket.assigned_user && (\n                    <div className=\"mt-4 pt-4 border-t border-border/30\">\n                      <div className=\"flex items-center gap-3 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\n                        <span className=\"opacity-60\">Assigned Node:</span>\n                        <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[9px] px-3 py-1 shadow-inner\">\n                          {ticket.assigned_user.full_name.toUpperCase()}\n                        </Badge>\n                      </div>\n                    </div>\n                  )}\n                </div>\n\n                <div className=\"flex flex-col gap-2 shrink-0\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      onViewTicket(ticket);\n                    }}\n                    className=\"h-11 w-11 p-0 rounded-2xl border-border/50 hover:bg-secondary text-muted-foreground hover:text-primary transition-all shadow-sm\"\n                    title=\"View Protocol\"\n                  >\n                    <Eye weight=\"bold\" className=\"w-5 h-5\" />\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      onEditTicket(ticket);\n                    }}\n                    className=\"h-11 w-11 p-0 rounded-2xl border-border/50 hover:bg-secondary text-muted-foreground hover:text-primary transition-all shadow-sm\"\n                    title=\"Modify Node\"\n                  >\n                    <PencilSimple weight=\"bold\" className=\"w-5 h-5\" />\n                  </Button>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n      ))}\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\support\\context.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":152,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":152,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5138,5141],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5138,5141],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { createContext, useContext, useState, useCallback, useRef, ReactNode } from 'react';\nimport { SupportContextType, SupportTicket, SupportStats } from './types';\n\nconst SupportContext = createContext<SupportContextType | undefined>(undefined);\n\nexport const useSupportContext = () => {\n  const context = useContext(SupportContext);\n  if (!context) {\n    throw new Error('useSupportContext must be used within SupportProvider');\n  }\n  return context;\n};\n\nexport const SupportProvider = ({ children }: { children: ReactNode }) => {\n  const [tickets, setTickets] = useState<SupportTicket[]>([]);\n  const [stats, setStats] = useState<SupportStats | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [selectedTicket, setSelectedTicket] = useState<SupportTicket | null>(null);\n  const [filters, setFilters] = useState({\n    status: 'all',\n    priority: 'all',\n    search: '',\n    page: 1\n  });\n  const retryCountRef = useRef(0);\n\n  const updateFilters = useCallback((newFilters: Partial<typeof filters>) => {\n    setFilters(prev => ({ ...prev, ...newFilters }));\n  }, []);\n\n  const refreshTickets = useCallback(async () => {\n    try {\n      setLoading(true);\n      \n      // Get token from localStorage with fallback mechanisms\n      let token = null;\n      \n      try {\n        const sessionStr = localStorage.getItem('sb-sb-royeyoxaaieipdajijni-auth-token');\n        \n        if (sessionStr) {\n          const base64Data = sessionStr.replace('base64-', '');\n          const decodedSession = JSON.parse(atob(base64Data));\n          token = decodedSession.access_token;\n        }\n      } catch (tokenError) {\n        console.warn('Failed to get token from localStorage:', tokenError);\n      }\n      \n      // Fallback: Try to get session from Supabase client\n      if (!token) {\n        try {\n          const { createClient } = await import('@/lib/supabase/client');\n          const supabase = createClient();\n          const { data: { session } } = await supabase.auth.getSession();\n          token = session?.access_token;\n        } catch (supabaseError) {\n          console.warn('Failed to get token from Supabase client:', supabaseError);\n        }\n      }\n      \n      if (!token) {\n        console.warn('No authentication token available, using mock data');\n        // Use mock data as fallback\n        const mockData = {\n          tickets: [\n            {\n              id: '1',\n              clinic_id: '00000000-0000-0000-0000-000000000001',\n              user_id: 'b07c41f2-8171-4d2f-a4de-12c24cfe8cff',\n              subject: 'Login issue with Super Admin account',\n              description: 'Cannot login to Super Admin dashboard after recent update',\n              priority: 'high' as const,\n              status: 'open' as const,\n              category: 'technical' as const,\n              assigned_to: null,\n              resolved_at: null,\n              first_response_at: null,\n              metadata: {},\n              created_at: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString(),\n              updated_at: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000).toISOString(),\n              clinic_name: 'เธเธฒเธเธเธญเธ เธเธฃเธตเน€เธกเธตเธขเธก เธเธฅเธดเธเธดเธ',\n              user: {\n                id: 'b07c41f2-8171-4d2f-a4de-12c24cfe8cff',\n                full_name: 'Nuttapong - System Administrator',\n                email: 'nuttapong161@gmail.com'\n              }\n            }\n          ],\n          stats: {\n            total: 1,\n            open: 1,\n            in_progress: 0,\n            resolved: 0,\n            high_priority: 1\n          }\n        };\n        \n        setTickets(mockData.tickets);\n        setStats(mockData.stats);\n        return;\n      }\n      \n      const params = new URLSearchParams({\n        page: filters.page.toString(),\n        limit: '20'\n      });\n\n      if (filters.status !== 'all') {\n        params.append('status', filters.status);\n      }\n      if (filters.priority !== 'all') {\n        params.append('priority', filters.priority);\n      }\n      if (filters.search) {\n        params.append('search', filters.search);\n      }\n\n      const response = await fetch(`/api/admin/support/tickets?${params}`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (!response.ok) {\n        if (response.status === 401) {\n          throw new Error('Unauthorized: Invalid or expired token');\n        } else if (response.status === 403) {\n          throw new Error('Forbidden: Insufficient permissions');\n        } else if (response.status === 404) {\n          throw new Error('API endpoint not found');\n        } else {\n          throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n        }\n      }\n\n      const data = await response.json();\n\n      // Validate response structure\n      if (!data || typeof data !== 'object') {\n        throw new Error('Invalid response format');\n      }\n\n      if (data.success) {\n        const responseData = data.data as {\n          tickets?: SupportTicket[];\n          stats?: SupportStats;\n          pagination?: any;\n        };\n        \n        // Validate required fields\n        if (!responseData.tickets || !Array.isArray(responseData.tickets)) {\n          console.warn('Invalid tickets data in response, using empty array');\n          responseData.tickets = [];\n        }\n        \n        if (!responseData.stats || typeof responseData.stats !== 'object') {\n          console.warn('Invalid stats data in response, using default stats');\n          responseData.stats = {\n            total: responseData.tickets?.length || 0,\n            open: 0,\n            in_progress: 0,\n            resolved: 0,\n            high_priority: 0\n          };\n        }\n        \n        setTickets(responseData.tickets);\n        setStats(responseData.stats);\n      } else {\n        throw new Error(data.error?.message || data.error || 'Failed to fetch tickets');\n      }\n    } catch (error) {\n      console.error('Error fetching tickets:', error);\n      \n      // Retry mechanism for transient errors\n      const errorString = error instanceof Error ? error.message : String(error);\n      const isTransientError = \n        errorString.includes('Failed to fetch') ||\n        errorString.includes('NetworkError') ||\n        errorString.includes('timeout') ||\n        errorString.includes('HTTP 5');\n      \n      if (isTransientError && retryCountRef.current === 0) {\n        console.log('Retrying due to transient error...');\n        retryCountRef.current = 1;\n        setTimeout(() => {\n          refreshTickets();\n        }, 2000);\n        return;\n      }\n      \n      // Set empty data on error to prevent UI from breaking\n      setTickets([]);\n      setStats(null);\n      \n      // Reset retry count\n      retryCountRef.current = 0;\n    } finally {\n      setLoading(false);\n    }\n  }, [filters, retryCountRef]);\n\n  const value: SupportContextType = {\n    tickets,\n    stats,\n    loading,\n    selectedTicket,\n    filters,\n    setTickets,\n    setStats,\n    setSelectedTicket,\n    updateFilters,\n    refreshTickets\n  };\n\n  return (\n    <SupportContext.Provider value={value}>\n      {children}\n    </SupportContext.Provider>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\support\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[52,67],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DownloadSimple' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":17,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"DownloadSimple"},"fix":{"range":[67,86],"text":""},"desc":"Remove unused variable \"DownloadSimple\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[86,100],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Lifebuoy' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":11,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Lifebuoy"},"fix":{"range":[100,112],"text":""},"desc":"Remove unused variable \"Lifebuoy\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningCircle' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WarningCircle"},"fix":{"range":[112,129],"text":""},"desc":"Remove unused variable \"WarningCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Monitor' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Monitor"},"fix":{"range":[228,239],"text":""},"desc":"Remove unused variable \"Monitor\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":22,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[239,262],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pulse' is defined but never used.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pulse"},"fix":{"range":[262,271],"text":""},"desc":"Remove unused variable \"Pulse\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Briefcase"},"fix":{"range":[271,284],"text":""},"desc":"Remove unused variable \"Briefcase\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'StatCard' is defined but never used.","line":30,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":18,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"StatCard"},"fix":{"range":[524,576],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SupportProvider' is defined but never used.","line":33,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":25,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"SupportProvider"},"fix":{"range":[702,718],"text":""},"desc":"Remove unused variable \"SupportProvider\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SupportHeader' is defined but never used.","line":34,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":21,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"SupportHeader"},"fix":{"range":[757,812],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SupportTicket' is defined but never used.","line":38,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":23,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"SupportTicket"},"fix":{"range":[989,1029],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SupportContent' is defined but never used.","line":43,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":44,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'tickets' is assigned a value but never used.","line":45,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":27},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":47,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1425,1428],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1425,1428],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":58,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1679,1682],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1679,1682],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":63,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1792,1795],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1792,1795],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":19,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { \n  SpinnerGap, \n  Plus, \n  X, \n  CaretRight, \n  DownloadSimple, \n  ArrowLeft,\n  Lifebuoy,\n  WarningCircle,\n  CheckCircle,\n  ChatCircleText,\n  Clock,\n  User,\n  Buildings,\n  Tag,\n  ShieldCheck,\n  ArrowRight,\n  Monitor,\n  IdentificationBadge,\n  Pulse,\n  Briefcase,\n  ArrowsClockwise,\n  Headset\n} from '@phosphor-icons/react';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport { StatCard } from '@/components/ui/StatCard';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { SupportProvider, useSupportContext } from './context';\nimport SupportHeader from './components/SupportHeader';\nimport SupportStats from './components/SupportStats';\nimport TicketFilters from './components/TicketFilters';\nimport SupportTicketTable from './components/SupportTicketTable';\nimport { SupportTicket } from './types';\nimport { cn } from '@/lib/utils';\nimport { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nfunction SupportContent() {\n  const { goBack } = useBackNavigation();\n  const { loading, tickets, refreshTickets } = useSupportContext();\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [selectedTicket, setSelectedTicket] = useState<any>(null);\n  const [showDetailModal, setShowDetailModal] = useState(false);\n\n  useEffect(() => {\n    refreshTickets();\n  }, [refreshTickets]);\n\n  const handleCreateTicket = () => {\n    setShowCreateModal(true);\n  };\n\n  const handleViewTicket = (ticket: any) => {\n    setSelectedTicket(ticket);\n    setShowDetailModal(true);\n  };\n\n  const handleEditTicket = (ticket: any) => {\n    setSelectedTicket(ticket);\n    setShowDetailModal(true);\n  };\n\n  if (loading && !selectedTicket) {\n    return (\n      <div className=\"min-h-[400px] flex flex-col items-center justify-center space-y-4\">\n        <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\n        <p className=\"text-muted-foreground animate-pulse text-xs uppercase tracking-widest text-center\">\n          Synchronizing Support Registry...\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header Section */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <Headset weight=\"duotone\" className=\"w-4 h-4\" />\n            Support Intelligence Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n          >\n            Clinical <span className=\"text-primary\">Support</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Orchestrating multi-tenant support protocols and clinical issue resolution.\n          </motion.p>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <Button \n            variant=\"outline\"\n            onClick={refreshTickets}\n            disabled={loading}\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\n          >\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\n            Sync Registry\n          </Button>\n          <Button \n            onClick={handleCreateTicket}\n            className=\"gap-3 shadow-premium px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest\"\n          >\n            <Plus weight=\"bold\" className=\"w-4 h-4\" />\n            Initialize Ticket\n          </Button>\n        </div>\n      </div>\n\n      {/* Stats Summary Section */}\n      <div className=\"px-2\">\n        <SupportStats />\n      </div>\n\n      {/* Main Content Node */}\n      <div className=\"px-2 space-y-8\">\n        <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n          <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 flex flex-col md:flex-row md:items-center justify-between gap-6\">\n            <div className=\"flex items-center gap-4\">\n              <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\n                <ChatCircleText weight=\"duotone\" className=\"w-6 h-6\" />\n              </div>\n              <div>\n                <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Active Protocol Registry</CardTitle>\n                <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Real-time clinical support nodes</p>\n              </div>\n            </div>\n            <TicketFilters />\n          </CardHeader>\n          <CardContent className=\"p-0\">\n            <SupportTicketTable onViewTicket={handleViewTicket} onEditTicket={handleEditTicket} />\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Create Ticket Modal */}\n      <AnimatePresence>\n        {showCreateModal && (\n          <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-[200] flex items-center justify-center p-4\">\n            <motion.div\n              initial={{ opacity: 0, scale: 0.95, y: 20 }}\n              animate={{ opacity: 1, scale: 1 }}\n              exit={{ opacity: 0, scale: 0.95, y: 20 }}\n              className=\"bg-card p-8 rounded-[32px] border border-border shadow-premium w-full max-w-2xl max-h-[90vh] overflow-y-auto relative\"\n            >\n              <div className=\"flex items-center justify-between mb-8\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20\">\n                    <Plus weight=\"bold\" className=\"w-6 h-6\" />\n                  </div>\n                  <div>\n                    <h2 className=\"text-2xl font-bold text-foreground tracking-tight\">Create Support Ticket</h2>\n                    <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Initiate assistance node</p>\n                  </div>\n                </div>\n                <button \n                  onClick={() => setShowCreateModal(false)}\n                  className=\"p-2 text-muted-foreground hover:text-foreground hover:bg-secondary rounded-xl transition-all\"\n                >\n                  <X weight=\"bold\" className=\"w-6 h-6\" />\n                </button>\n              </div>\n              \n              <form className=\"space-y-6\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  <div className=\"space-y-2\">\n                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Target Clinic</label>\n                    <div className=\"relative group\">\n                      <Buildings className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary\" />\n                      <select className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 pl-12 pr-4 text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-medium appearance-none\">\n                        <option value=\"\" className=\"bg-card\">Select Clinic Instance</option>\n                        <option value=\"clinic-1\" className=\"bg-card\">Bangkok Premium Clinic</option>\n                        <option value=\"clinic-2\" className=\"bg-card\">Phuket Beauty Center</option>\n                      </select>\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Priority Level</label>\n                    <div className=\"relative group\">\n                      <Tag className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary\" />\n                      <select className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 pl-12 pr-4 text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-medium appearance-none\">\n                        <option value=\"low\" className=\"bg-card\">Low (Standard)</option>\n                        <option value=\"medium\" className=\"bg-card\" selected>Medium (Moderate)</option>\n                        <option value=\"high\" className=\"bg-card\">High (Accelerated)</option>\n                        <option value=\"urgent\" className=\"bg-card\">Urgent (Immediate)</option>\n                      </select>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Inquiry Category</label>\n                  <select className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-5 text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-medium appearance-none\">\n                    <option value=\"general\" className=\"bg-card\" selected>General Consultation</option>\n                    <option value=\"technical\" className=\"bg-card\">Technical Infrastructure</option>\n                    <option value=\"billing\" className=\"bg-card\">Financial / Billing</option>\n                    <option value=\"feature_request\" className=\"bg-card\">Feature Enhancement</option>\n                    <option value=\"bug_report\" className=\"bg-card\">Diagnostic / Bug Report</option>\n                  </select>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Subject</label>\n                  <input\n                    type=\"text\"\n                    className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-5 text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-medium placeholder:text-muted-foreground/40\"\n                    placeholder=\"Brief objective summary\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Description</label>\n                  <textarea\n                    rows={4}\n                    className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-5 text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-medium placeholder:text-muted-foreground/40\"\n                    placeholder=\"Detailed infrastructure or operational context\"\n                  />\n                </div>\n              </form>\n\n              <div className=\"flex flex-col sm:flex-row items-center gap-4 mt-10\">\n                <Button className=\"w-full sm:w-auto px-10 py-4 shadow-premium\">\n                  Initiate Ticket\n                </Button>\n                <Button \n                  variant=\"ghost\" \n                  onClick={() => setShowCreateModal(false)}\n                  className=\"w-full sm:w-auto text-xs font-black uppercase tracking-widest text-muted-foreground\"\n                >\n                  Cancel\n                </Button>\n              </div>\n            </motion.div>\n          </div>\n        )}\n      </AnimatePresence>\n\n      {/* Ticket Detail Modal */}\n      <AnimatePresence>\n        {showDetailModal && selectedTicket && (\n          <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-[200] flex items-center justify-center p-4\">\n            <motion.div\n              initial={{ opacity: 0, scale: 0.95, y: 20 }}\n              animate={{ opacity: 1, scale: 1 }}\n              exit={{ opacity: 0, scale: 0.95, y: 20 }}\n              className=\"bg-card p-8 rounded-[32px] border border-border shadow-premium w-full max-w-4xl max-h-[90vh] overflow-y-auto relative\"\n            >\n              <div className=\"flex items-center justify-between mb-8\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\n                    <ChatCircleText weight=\"duotone\" className=\"w-6 h-6\" />\n                  </div>\n                  <div>\n                    <h2 className=\"text-2xl font-bold text-foreground tracking-tight\">Ticket Node Analysis</h2>\n                    <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Status: {selectedTicket.status}</p>\n                  </div>\n                </div>\n                <button\n                  onClick={() => setShowDetailModal(false)}\n                  className=\"p-2 text-muted-foreground hover:text-foreground hover:bg-secondary rounded-xl transition-all\"\n                >\n                  <X weight=\"bold\" className=\"w-6 h-6\" />\n                </button>\n              </div>\n\n              <div className=\"space-y-8\">\n                <div className=\"flex flex-wrap gap-3\">\n                  <Badge variant={\n                    selectedTicket.priority === 'urgent' ? 'destructive' : \n                    selectedTicket.priority === 'high' ? 'warning' : 'default'\n                  } className=\"font-black uppercase tracking-widest px-4 py-1.5\">\n                    {selectedTicket.priority} Priority\n                  </Badge>\n                  <Badge variant={\n                    selectedTicket.status === 'open' ? 'warning' : \n                    selectedTicket.status === 'resolved' ? 'success' : 'secondary'\n                  } className=\"font-black uppercase tracking-widest px-4 py-1.5\">\n                    {selectedTicket.status.replace('_', ' ')}\n                  </Badge>\n                </div>\n\n                <div>\n                  <h3 className=\"text-2xl font-bold text-foreground tracking-tight mb-3\">{selectedTicket.subject}</h3>\n                  <Card className=\"bg-secondary/30 border-border/50\">\n                    <CardContent className=\"p-6\">\n                      <p className=\"text-foreground leading-relaxed font-medium\">{selectedTicket.description}</p>\n                    </CardContent>\n                  </Card>\n                </div>\n\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 p-6 bg-secondary/50 rounded-3xl border border-border shadow-inner\">\n                  <div className=\"space-y-1\">\n                    <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em]\">Source Clinic</p>\n                    <div className=\"flex items-center gap-2 text-foreground font-bold\">\n                      <Buildings weight=\"bold\" className=\"w-4 h-4 text-primary\" />\n                      <span className=\"text-sm truncate\">{selectedTicket.clinic?.name}</span>\n                    </div>\n                  </div>\n                  <div className=\"space-y-1\">\n                    <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em]\">Identity Origin</p>\n                    <div className=\"flex items-center gap-2 text-foreground font-bold\">\n                      <User weight=\"bold\" className=\"w-4 h-4 text-primary\" />\n                      <span className=\"text-sm truncate\">{selectedTicket.user?.full_name}</span>\n                    </div>\n                  </div>\n                  <div className=\"space-y-1\">\n                    <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em]\">Initiated At</p>\n                    <div className=\"flex items-center gap-2 text-foreground font-bold\">\n                      <Clock weight=\"bold\" className=\"w-4 h-4 text-primary\" />\n                      <span className=\"text-sm\">{new Date(selectedTicket.created_at).toLocaleDateString()}</span>\n                    </div>\n                  </div>\n                  <div className=\"space-y-1\">\n                    <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em]\">Handler Node</p>\n                    <div className=\"flex items-center gap-2 text-foreground font-bold\">\n                      <Badge variant=\"ghost\" size=\"sm\" className=\"font-bold\">\n                        {selectedTicket.assigned_user?.full_name || 'UNASSIGNED'}\n                      </Badge>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"space-y-6\">\n                  <h4 className=\"text-sm font-black text-foreground uppercase tracking-[0.2em] flex items-center gap-3\">\n                    <div className=\"w-1.5 h-1.5 rounded-full bg-primary animate-pulse shadow-[0_0_8px_hsl(var(--primary)/0.6)]\" />\n                    Communication Log\n                  </h4>\n                  \n                  <div className=\"space-y-4\">\n                    {/* Initial message */}\n                    <div className=\"p-5 bg-secondary/30 rounded-3xl border border-border/50 relative overflow-hidden\">\n                      <div className=\"flex items-center justify-between mb-3\">\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"w-8 h-8 rounded-xl bg-card border border-border flex items-center justify-center text-muted-foreground\">\n                            <User weight=\"bold\" className=\"w-4 h-4\" />\n                          </div>\n                          <span className=\"font-bold text-foreground text-sm\">{selectedTicket.user?.full_name}</span>\n                        </div>\n                        <span className=\"text-[10px] text-muted-foreground font-medium italic\">\n                          {new Date(selectedTicket.created_at).toLocaleString()}\n                        </span>\n                      </div>\n                      <p className=\"text-foreground/80 text-sm leading-relaxed\">{selectedTicket.description}</p>\n                    </div>\n\n                    {/* Simulation message */}\n                    <div className=\"p-5 bg-primary/5 rounded-3xl border border-primary/10 relative overflow-hidden ml-8\">\n                      <div className=\"absolute left-0 top-0 bottom-0 w-1 bg-primary/20\" />\n                      <div className=\"flex items-center justify-between mb-3\">\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"w-8 h-8 rounded-xl bg-primary/10 border border-primary/20 flex items-center justify-center text-primary shadow-sm\">\n                            <ShieldCheck weight=\"fill\" className=\"w-4 h-4\" />\n                          </div>\n                          <span className=\"font-bold text-foreground text-sm\">System Support Node</span>\n                          <Badge variant=\"default\" size=\"sm\" className=\"text-[8px] font-black\">ADMIN</Badge>\n                        </div>\n                        <span className=\"text-[10px] text-muted-foreground font-medium italic\">2 hours ago</span>\n                      </div>\n                      <p className=\"text-foreground/80 text-sm leading-relaxed\">Identity node processed. Diagnostic algorithms initiated for technical review.</p>\n                    </div>\n                  </div>\n\n                  {/* Reply form */}\n                  <div className=\"mt-8 p-6 bg-secondary/50 rounded-[32px] border border-border shadow-inner\">\n                    <textarea\n                      rows={3}\n                      className=\"w-full bg-card border border-border rounded-2xl py-4 px-5 text-foreground placeholder:text-muted-foreground/40 focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-medium text-sm\"\n                      placeholder=\"Input response node...\"\n                    />\n                    <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mt-6\">\n                      <label className=\"flex items-center gap-3 cursor-pointer group\">\n                        <div className=\"relative flex items-center justify-center\">\n                          <input type=\"checkbox\" className=\"peer sr-only\" />\n                          <div className=\"w-5 h-5 bg-card border border-border rounded transition-all peer-checked:bg-primary peer-checked:border-primary\" />\n                          <CheckCircle weight=\"fill\" className=\"absolute w-3.5 h-3.5 text-white opacity-0 peer-checked:opacity-100 transition-opacity\" />\n                        </div>\n                        <span className=\"text-xs font-bold text-muted-foreground group-hover:text-foreground transition-colors\">Internal diagnostic note (Encrypted)</span>\n                      </label>\n                      <Button className=\"px-8 shadow-premium gap-2\">\n                        Transmit Reply\n                        <ArrowRight weight=\"bold\" className=\"w-3.5 h-3.5\" />\n                      </Button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </motion.div>\n          </div>\n        )}\n      </AnimatePresence>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\system\\context.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":33,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[704,707],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[704,707],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setLoading' is assigned a value but never used.","line":78,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":78,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { createContext, useContext, useState, useCallback, ReactNode } from 'react';\n\nexport interface SystemMetric {\n  timestamp: string;\n  cpu: number;\n  memory: number;\n  disk: number;\n  network_in: number;\n  network_out: number;\n  active_connections: number;\n  response_time: number;\n  error_rate: number;\n}\n\nexport interface SystemAlert {\n  id: string;\n  type: 'error' | 'warning' | 'info';\n  title: string;\n  message: string;\n  timestamp: string;\n  resolved: boolean;\n  severity: 'low' | 'medium' | 'high' | 'critical';\n}\n\nexport interface SystemLog {\n  id: string;\n  level: 'debug' | 'info' | 'warn' | 'error';\n  message: string;\n  timestamp: string;\n  source: string;\n  metadata?: any;\n}\n\nexport interface SystemHealth {\n  status: 'healthy' | 'warning' | 'critical';\n  uptime: number;\n  last_check: string;\n  services: {\n    database: 'online' | 'offline' | 'degraded';\n    api: 'online' | 'offline' | 'degraded';\n    storage: 'online' | 'offline' | 'degraded';\n    cache: 'online' | 'offline' | 'degraded';\n  };\n}\n\nexport interface SystemMonitoringContextType {\n  metrics: SystemMetric[];\n  alerts: SystemAlert[];\n  logs: SystemLog[];\n  health: SystemHealth | null;\n  loading: boolean;\n  refreshing: boolean;\n  fetchMetrics: () => Promise<void>;\n  fetchAlerts: () => Promise<void>;\n  fetchLogs: () => Promise<void>;\n  fetchHealth: () => Promise<void>;\n  resolveAlert: (id: string) => Promise<void>;\n  clearLogs: () => Promise<void>;\n}\n\nconst SystemMonitoringContext = createContext<SystemMonitoringContextType | undefined>(undefined);\n\nexport const useSystemMonitoringContext = () => {\n  const context = useContext(SystemMonitoringContext);\n  if (!context) {\n    throw new Error('useSystemMonitoringContext must be used within SystemMonitoringProvider');\n  }\n  return context;\n};\n\nexport const SystemMonitoringProvider = ({ children }: { children: ReactNode }) => {\n  const [metrics, setMetrics] = useState<SystemMetric[]>([]);\n  const [alerts, setAlerts] = useState<SystemAlert[]>([]);\n  const [logs, setLogs] = useState<SystemLog[]>([]);\n  const [health, setHealth] = useState<SystemHealth | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [refreshing, setRefreshing] = useState(false);\n\n  const fetchMetrics = useCallback(async () => {\n    try {\n      setRefreshing(true);\n      const response = await fetch('/api/admin/system/metrics');\n      \n      if (response.status === 401) {\n        console.warn('User not authenticated for system metrics');\n        return;\n      }\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        setMetrics(data.data.metrics || []);\n      } else {\n        console.error('System metrics API error:', data.error);\n      }\n    } catch (error) {\n      console.error('Error fetching system metrics:', error);\n    } finally {\n      setRefreshing(false);\n    }\n  }, []);\n\n  const fetchAlerts = useCallback(async () => {\n    try {\n      const response = await fetch('/api/admin/system/alerts');\n      \n      if (response.status === 401) {\n        console.warn('User not authenticated for system alerts');\n        return;\n      }\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        setAlerts(data.data.alerts || []);\n      } else {\n        console.error('System alerts API error:', data.error);\n      }\n    } catch (error) {\n      console.error('Error fetching system alerts:', error);\n    }\n  }, []);\n\n  const fetchLogs = useCallback(async () => {\n    try {\n      const response = await fetch('/api/admin/system/logs');\n      \n      if (response.status === 401) {\n        console.warn('User not authenticated for system logs');\n        return;\n      }\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        setLogs(data.data.logs || []);\n      } else {\n        console.error('System logs API error:', data.error);\n      }\n    } catch (error) {\n      console.error('Error fetching system logs:', error);\n    }\n  }, []);\n\n  const fetchHealth = useCallback(async () => {\n    try {\n      const response = await fetch('/api/admin/system/health');\n      \n      if (response.status === 401) {\n        console.warn('User not authenticated for system health');\n        return;\n      }\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        setHealth(data.data);\n      } else {\n        console.error('System health API error:', data.error);\n      }\n    } catch (error) {\n      console.error('Error fetching system health:', error);\n    }\n  }, []);\n\n  const resolveAlert = useCallback(async (id: string) => {\n    try {\n      const response = await fetch('/api/admin/system/alerts', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ action: 'resolve', id })\n      });\n      \n      if (response.ok) {\n        setAlerts(prev => prev.map(alert => \n          alert.id === id ? { ...alert, resolved: true } : alert\n        ));\n      }\n    } catch (error) {\n      console.error('Error resolving alert:', error);\n    }\n  }, []);\n\n  const clearLogs = useCallback(async () => {\n    try {\n      const response = await fetch('/api/admin/system/logs', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ action: 'clear' })\n      });\n      \n      if (response.ok) {\n        setLogs([]);\n      }\n    } catch (error) {\n      console.error('Error clearing logs:', error);\n    }\n  }, []);\n\n  const value: SystemMonitoringContextType = {\n    metrics,\n    alerts,\n    logs,\n    health,\n    loading,\n    refreshing,\n    fetchMetrics,\n    fetchAlerts,\n    fetchLogs,\n    fetchHealth,\n    resolveAlert,\n    clearLogs\n  };\n\n  return (\n    <SystemMonitoringContext.Provider value={value}>\n      {children}\n    </SystemMonitoringContext.Provider>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\system\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":7,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":59,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[248,259],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":18,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'selectedMetric' is assigned a value but never used.","line":20,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setSelectedMetric' is assigned a value but never used.","line":20,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":43},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'AnimatePresence' is not defined.","line":161,"column":8,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":161,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport {\r\n  Pulse, HardDrives, CheckCircle, Cpu, HardDrive, Users, ArrowsClockwise, SpinnerGap,\r\n  Warning, Database, WifiHigh, WifiSlash, Clock, ArrowLeft, Activity, ChartLine, ShieldCheck\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { useSystemMonitoringContext, SystemMonitoringProvider } from './context';\r\n\r\nfunction SystemMonitoringContent() {\r\n  const { goBack } = useBackNavigation();\r\n  const { metrics, alerts, health, loading, refreshing, fetchMetrics, fetchAlerts, fetchHealth } = useSystemMonitoringContext();\r\n  const [selectedMetric, setSelectedMetric] = useState<'cpu' | 'memory' | 'disk'>('cpu');\r\n\r\n  useEffect(() => {\r\n    fetchMetrics();\r\n    fetchAlerts();\r\n    fetchHealth();\r\n\r\n    // Auto-refresh every 30 seconds\r\n    const interval = setInterval(() => {\r\n      fetchMetrics();\r\n      fetchAlerts();\r\n      fetchHealth();\r\n    }, 30000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [fetchMetrics, fetchAlerts, fetchHealth]);\r\n\r\n  const getStatusColor = (value: number, threshold: { good: number; warning: number }) => {\r\n    if (value <= threshold.good) return 'text-emerald-400';\r\n    if (value <= threshold.warning) return 'text-amber-400';\r\n    return 'text-red-400';\r\n  };\r\n\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'online':\r\n        return <CheckCircle className=\"w-5 h-5 text-emerald-400\" />;\r\n      case 'degraded':\r\n        return <Warning className=\"w-5 h-5 text-amber-400\" />;\r\n      case 'offline':\r\n        return <WifiSlash className=\"w-5 h-5 text-red-400\" />;\r\n      default:\r\n        return <WifiHigh className=\"w-5 h-5 text-gray-400\" />;\r\n    }\r\n  };\r\n\r\n  const currentMetric = metrics[0];\r\n  const criticalAlerts = alerts.filter(a => !a.resolved && a.severity === 'critical').length;\r\n  const warningAlerts = alerts.filter(a => !a.resolved && a.severity === 'high').length;\r\n\r\n  if (loading && metrics.length === 0) {\r\n    return (\r\n      <div className=\"min-h-[400px] flex items-center justify-center\">\r\n        <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Pulse weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Infrastructure Intelligence\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight\"\r\n          >\r\n            System <span className=\"text-primary\">Monitoring</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Real-time infrastructure performance, health nodes, and global sync status.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-3\">\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={() => {\r\n              fetchMetrics();\r\n              fetchAlerts();\r\n              fetchHealth();\r\n            }}\r\n            disabled={refreshing}\r\n            className=\"gap-2\"\r\n          >\r\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", refreshing && \"animate-spin\")} />\r\n            Sync Metrics\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* System Health Overview */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n        <StatCard\r\n          title=\"Global Uptime\"\r\n          value={health?.uptime || 99.9}\r\n          suffix=\"%\"\r\n          decimals={1}\r\n          icon={HardDrives}\r\n          trend={health?.status === 'healthy' ? 'up' : 'down'}\r\n          iconColor={health?.status === 'healthy' ? 'text-emerald-500' : 'text-rose-500'}\r\n        />\r\n        <StatCard\r\n          title=\"CPU Compute\"\r\n          value={currentMetric?.cpu || 0}\r\n          suffix=\"%\"\r\n          decimals={1}\r\n          icon={Cpu}\r\n          trend={(currentMetric?.cpu || 0) > 80 ? 'down' : 'neutral'}\r\n          iconColor={(currentMetric?.cpu || 0) > 80 ? 'text-rose-500' : 'text-blue-500'}\r\n        />\r\n        <StatCard\r\n          title=\"Memory Load\"\r\n          value={currentMetric?.memory || 0}\r\n          suffix=\"%\"\r\n          decimals={1}\r\n          icon={HardDrive}\r\n          trend={(currentMetric?.memory || 0) > 85 ? 'down' : 'neutral'}\r\n          iconColor={(currentMetric?.memory || 0) > 85 ? 'text-rose-500' : 'text-purple-500'}\r\n        />\r\n        <StatCard\r\n          title=\"Network Nodes\"\r\n          value={currentMetric?.active_connections || 0}\r\n          icon={Users}\r\n          trend=\"neutral\"\r\n          iconColor=\"text-amber-500\"\r\n        />\r\n      </div>\r\n\r\n      {/* Alerts Section */}\r\n      <AnimatePresence>\r\n        {(criticalAlerts > 0 || warningAlerts > 0) && (\r\n          <motion.div\r\n            initial={{ opacity: 0, y: -20, scale: 0.95 }}\r\n            animate={{ opacity: 1, y: 0, scale: 1 }}\r\n            exit={{ opacity: 0, scale: 0.95 }}\r\n          >\r\n            <Card className={cn(\r\n              \"border-none relative overflow-hidden\",\r\n              criticalAlerts > 0 ? \"bg-rose-500/10\" : \"bg-amber-500/10\"\r\n            )}>\r\n              <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-transparent to-card/5\" />\r\n              <CardContent className=\"p-6 relative z-10\">\r\n                <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-6\">\r\n                  <div className=\"flex items-center gap-4\">\r\n                    <div className={cn(\r\n                      \"w-12 h-12 rounded-2xl flex items-center justify-center shadow-sm\",\r\n                      criticalAlerts > 0 ? \"bg-rose-500/20 text-rose-500\" : \"bg-amber-500/20 text-amber-500\"\r\n                    )}>\r\n                      <Warning weight=\"fill\" className={cn(\"w-6 h-6\", criticalAlerts > 0 && \"animate-pulse\")} />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className={cn(\"text-lg font-bold uppercase tracking-tight\", criticalAlerts > 0 ? \"text-rose-500\" : \"text-amber-500\")}>\r\n                        Active Infrastructure Alerts\r\n                      </h3>\r\n                      <p className=\"text-muted-foreground text-sm font-medium\">Critical systems require immediate diagnostic review.</p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex gap-4\">\r\n                    {criticalAlerts > 0 && (\r\n                      <Badge variant=\"destructive\" pulse className=\"font-black px-4 py-1.5 uppercase\">\r\n                        {criticalAlerts} Critical Node\r\n                      </Badge>\r\n                    )}\r\n                    {warningAlerts > 0 && (\r\n                      <Badge variant=\"warning\" className=\"font-black px-4 py-1.5 uppercase\">\r\n                        {warningAlerts} Warning Node\r\n                      </Badge>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\r\n        {/* Services Status */}\r\n        <Card className=\"relative overflow-hidden group border-border/50\">\r\n          <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700\">\r\n            <Database className=\"w-48 h-48 text-primary\" />\r\n          </div>\r\n\r\n          <CardHeader className=\"border-b border-border/50 pb-6\">\r\n            <CardTitle className=\"text-sm font-black uppercase tracking-[0.2em] flex items-center gap-3\">\r\n              <Database weight=\"duotone\" className=\"w-5 h-5 text-primary\" />\r\n              Core Service Matrix\r\n            </CardTitle>\r\n          </CardHeader>\r\n          \r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n              {health?.services && Object.entries(health.services).map(([service, status]) => (\r\n                <div key={service} className=\"flex items-center justify-between p-4 bg-secondary/30 rounded-2xl border border-border/50 hover:bg-secondary/50 transition-all group/node\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className=\"w-1.5 h-1.5 rounded-full bg-border group-hover/node:bg-primary transition-colors\" />\r\n                    <span className=\"text-[11px] font-black text-foreground/80 uppercase tracking-widest\">{service}</span>\r\n                  </div>\r\n                  {getStatusIcon(status)}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Performance Metrics */}\r\n        <Card className=\"relative overflow-hidden group border-border/50\">\r\n          <div className=\"absolute -bottom-12 -left-12 w-48 h-48 bg-primary/5 blur-[60px] rounded-full\" />\r\n          \r\n          <CardHeader className=\"border-b border-border/50 pb-6\">\r\n            <CardTitle className=\"text-sm font-black uppercase tracking-[0.2em] flex items-center gap-3 text-primary\">\r\n              <ChartLine weight=\"duotone\" className=\"w-5 h-5\" />\r\n              Telemetry Analytics\r\n            </CardTitle>\r\n          </CardHeader>\r\n          \r\n          <CardContent className=\"pt-6 space-y-4\">\r\n            {[\r\n              { label: \"Mean Latency\", value: `${currentMetric?.response_time || 0}ms`, icon: Clock, threshold: { val: currentMetric?.response_time || 0, good: 200, warning: 500 } },\r\n              { label: \"Error Frequency\", value: `${(currentMetric?.error_rate || 0).toFixed(2)}%`, icon: Activity, threshold: { val: currentMetric?.error_rate || 0, good: 0.5, warning: 2 } },\r\n              { label: \"Disk Volume Load\", value: `${(currentMetric?.disk || 0).toFixed(1)}%`, icon: HardDrive, threshold: { val: currentMetric?.disk || 0, good: 70, warning: 85 } },\r\n            ].map((metric, i) => (\r\n              <div key={i} className=\"flex items-center justify-between p-4 bg-secondary/30 rounded-2xl border border-border/50\">\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div className=\"w-10 h-10 rounded-xl bg-card border border-border flex items-center justify-center text-muted-foreground\">\r\n                    <metric.icon weight=\"duotone\" className=\"w-5 h-5\" />\r\n                  </div>\r\n                  <span className=\"text-sm font-bold text-foreground tracking-tight\">{metric.label}</span>\r\n                </div>\r\n                <span className={cn(\r\n                  \"text-base font-black tabular-nums\",\r\n                  getStatusColor(metric.threshold.val, { good: metric.threshold.good, warning: metric.threshold.warning })\r\n                )}>\r\n                  {metric.value}\r\n                </span>\r\n              </div>\r\n            ))}\r\n            \r\n            <div className=\"pt-4 flex items-center justify-between border-t border-border/50 mt-4\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <ShieldCheck weight=\"duotone\" className=\"w-4 h-4 text-emerald-500\" />\r\n                <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Diagnostic Node: Healthy</span>\r\n              </div>\r\n              <span className=\"text-[10px] font-medium text-muted-foreground italic\">\r\n                Last heartbeat: {health?.last_check ? new Date(health.last_check).toLocaleTimeString() : 'N/A'}\r\n              </span>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n\r\nexport default function SystemMonitoringPage() {\r\n  return (\r\n    <SystemMonitoringProvider>\r\n      <SystemMonitoringContent />\r\n    </SystemMonitoringProvider>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\admin\\users\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationCard' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":21,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationCard"},"fix":{"range":[173,196],"text":""},"desc":"Remove unused variable \"IdentificationCard\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ShieldCheck' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ShieldCheck"},"fix":{"range":[196,212],"text":""},"desc":"Remove unused variable \"ShieldCheck\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[237,252],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'UserList' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":11,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"UserList"},"fix":{"range":[252,265],"text":""},"desc":"Remove unused variable \"UserList\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Eye' is defined but never used.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":6,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Eye"},"fix":{"range":[265,273],"text":""},"desc":"Remove unused variable \"Eye\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":25,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[395,407],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":25,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[407,418],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardContent' is defined but never used.","line":25,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":50,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardContent"},"fix":{"range":[418,431],"text":""},"desc":"Remove unused variable \"CardContent\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":48,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":67,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":67,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":93,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":93,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport {\r\n  Users,\r\n  MagnifyingGlass,\r\n  Plus,\r\n  WarningCircle,\r\n  CheckCircle,\r\n  SpinnerGap,\r\n  X,\r\n  Crown,\r\n  UserCheck,\r\n  UserMinus,\r\n  PencilSimple,\r\n  IdentificationCard,\r\n  ShieldCheck,\r\n  Lightning,\r\n  Funnel,\r\n  CaretRight,\r\n  UserList,\r\n  Eye,\r\n  ArrowsClockwise\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport ResponsiveTable from '@/components/ui/ResponsiveTable';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { cn } from '@/lib/utils';\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface User {\r\n  id: string;\r\n  email: string;\r\n  full_name: string;\r\n  role: 'super_admin' | 'premium_customer' | 'free_user';\r\n  tier: 'free' | 'premium' | 'clinical';\r\n  clinic_id?: string;\r\n  clinic_name?: string;\r\n  is_active: boolean;\r\n  created_at: string;\r\n}\r\n\r\nexport default function UserManagementPage() {\r\n  const { goBack } = useBackNavigation();\r\n  const [loading, setLoading] = useState(true);\r\n  const [isProcessing, setIsProcessing] = useState<string | null>(null);\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [success, setSuccess] = useState<string | null>(null);\r\n\r\n  const fetchData = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await fetch('/api/admin/management?type=users');\r\n      const data = await response.json();\r\n      \r\n      if (data.success) {\r\n        setUsers(data.data.users);\r\n      } else {\r\n        setError('Failed to load users');\r\n      }\r\n    } catch (err) {\r\n      setError('Failed to load users');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const handleUpdateStatus = async (userId: string, currentStatus: boolean) => {\r\n    setIsProcessing(userId);\r\n    try {\r\n      const response = await fetch('/api/admin/management', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          action: 'updateUserStatus',\r\n          userId,\r\n          status: !currentStatus\r\n        })\r\n      });\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        setUsers(prev => prev.map(u => u.id === userId ? { ...u, is_active: !currentStatus } : u));\r\n        setSuccess('Status updated successfully');\r\n      } else {\r\n        setError(data.error || 'Failed to update status');\r\n      }\r\n    } catch (err) {\r\n      setError('An error occurred');\r\n    } finally {\r\n      setIsProcessing(null);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, [fetchData]);\r\n\r\n  const filteredUsers = users.filter(user =>\r\n    user.full_name?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    user.email?.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  const getRoleBadge = (role: string) => {\r\n    const configs: Record<string, { bg: string; label: string }> = {\r\n      super_admin: { bg: 'bg-red-500/10 text-red-500', label: 'Super Admin' },\r\n      premium_customer: { bg: 'bg-purple-500/10 text-purple-500', label: 'Premium' },\r\n      free_user: { bg: 'bg-secondary text-muted-foreground', label: 'Free User' }\r\n    };\r\n    const config = configs[role] || configs.free_user;\r\n    return (\r\n      <span className={`px-2 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider ${config.bg}`}>\r\n        {config.label}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  const columns = [\r\n    {\r\n      header: 'User',\r\n      accessor: (user: User) => (\r\n        <div className=\"flex items-center gap-3\">\r\n          <div className=\"w-10 h-10 rounded-xl bg-primary/10 border border-primary/20 flex items-center justify-center text-primary shrink-0\">\r\n            {user.role === 'super_admin' ? (\r\n              <Crown className=\"w-5 h-5\" />\r\n            ) : (\r\n              <Users className=\"w-5 h-5\" />\r\n            )}\r\n          </div>\r\n          <div className=\"min-w-0\">\r\n            <p className=\"font-semibold text-foreground truncate\">{user.full_name || 'No Name'}</p>\r\n            <p className=\"text-xs text-muted-foreground truncate\">{user.email}</p>\r\n          </div>\r\n        </div>\r\n      )\r\n    },\r\n    {\r\n      header: 'Role',\r\n      accessor: (user: User) => getRoleBadge(user.role)\r\n    },\r\n    {\r\n      header: 'Status',\r\n      accessor: (user: User) => (\r\n        <span className={`px-2 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider ${\r\n          user.is_active ? 'bg-emerald-500/10 text-emerald-500' : 'bg-red-500/10 text-red-500'\r\n        }`}>\r\n          {user.is_active ? 'Active' : 'Inactive'}\r\n        </span>\r\n      )\r\n    },\r\n    {\r\n      header: 'Created',\r\n      accessor: (user: User) => (\r\n        <p className=\"text-sm text-muted-foreground\">\r\n          {new Date(user.created_at).toLocaleDateString()}\r\n        </p>\r\n      )\r\n    },\r\n    {\r\n      header: 'Actions',\r\n      className: 'text-right',\r\n      accessor: (user: User) => (\r\n        <div className=\"flex items-center justify-end gap-2\">\r\n          <button \r\n            disabled={isProcessing === user.id}\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              handleUpdateStatus(user.id, user.is_active);\r\n            }}\r\n            className={`p-2 rounded-lg transition-all border border-border bg-secondary ${\r\n              user.is_active \r\n                ? 'text-red-500 hover:bg-red-500/10' \r\n                : 'text-emerald-500 hover:bg-emerald-500/10'\r\n            }`}\r\n            title={user.is_active ? 'Suspend User' : 'Activate User'}\r\n          >\r\n            {isProcessing === user.id ? (\r\n              <SpinnerGap className=\"w-4 h-4 animate-spin\" />\r\n            ) : user.is_active ? (\r\n              <UserMinus className=\"w-4 h-4\" />\r\n            ) : (\r\n              <UserCheck className=\"w-4 h-4\" />\r\n            )}\r\n          </button>\r\n          <button \r\n            onClick={(e) => e.stopPropagation()}\r\n            className=\"p-2 bg-secondary border border-border text-muted-foreground hover:text-foreground rounded-lg transition-all\"\r\n            title=\"Edit User\"\r\n          >\r\n            <PencilSimple className=\"w-4 h-4\" />\r\n          </button>\r\n        </div>\r\n      )\r\n    }\r\n  ];\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-[400px] flex items-center justify-center\">\r\n        <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }} \r\n      animate={{ opacity: 1 }} \r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n      \r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Users weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Identity Management\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Network <span className=\"text-primary\">Entities</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating global system users, access credentials, and identity protocols.\r\n          </motion.p>\r\n        </div>\r\n        \r\n        <motion.div\r\n          initial={{ opacity: 0, scale: 0.9 }}\r\n          animate={{ opacity: 1, scale: 1 }}\r\n          transition={{ delay: 0.3 }}\r\n        >\r\n          <Button className=\"gap-3 shadow-premium px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest\">\r\n            <Plus weight=\"bold\" className=\"w-4 h-4\" />\r\n            <span>Initialize Identity</span>\r\n          </Button>\r\n        </motion.div>\r\n      </div>\r\n\r\n      {/* Stats Summary Section */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\r\n        <StatCard\r\n          title=\"Total Registry\"\r\n          value={users.length}\r\n          icon={Users}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Active Nodes\"\r\n          value={users.filter(u => u.is_active).length}\r\n          icon={UserCheck}\r\n          trend=\"up\"\r\n          change={4.2}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Privileged Access\"\r\n          value={users.filter(u => u.role === 'super_admin').length}\r\n          icon={Crown}\r\n          iconColor=\"text-red-500\"\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Live Sessions\"\r\n          value={Math.floor(users.length * 0.4)}\r\n          icon={Lightning}\r\n          iconColor=\"text-emerald-500\"\r\n          className=\"p-4\"\r\n        />\r\n      </div>\r\n\r\n      {/* Alerts */}\r\n      <AnimatePresence>\r\n        {error && (\r\n          <motion.div \r\n            initial={{ opacity: 0, y: -10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"mx-2 p-4 bg-destructive/10 border border-destructive/20 rounded-2xl flex items-center gap-3\"\r\n          >\r\n            <WarningCircle weight=\"fill\" className=\"w-5 h-5 text-destructive\" />\r\n            <p className=\"text-destructive text-xs font-bold uppercase tracking-widest\">Exception: {error}</p>\r\n            <Button variant=\"ghost\" size=\"sm\" onClick={() => setError(null)} className=\"ml-auto p-2 h-auto text-destructive hover:bg-destructive/10\">\r\n              <X weight=\"bold\" className=\"w-4 h-4\" />\r\n            </Button>\r\n          </motion.div>\r\n        )}\r\n        {success && (\r\n          <motion.div \r\n            initial={{ opacity: 0, y: -10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"mx-2 p-4 bg-emerald-500/10 border border-emerald-500/20 rounded-2xl flex items-center gap-3\"\r\n          >\r\n            <CheckCircle weight=\"fill\" className=\"w-5 h-5 text-emerald-500\" />\r\n            <p className=\"text-emerald-500 text-xs font-bold uppercase tracking-widest\">Sync Complete: {success}</p>\r\n            <Button variant=\"ghost\" size=\"sm\" onClick={() => setSuccess(null)} className=\"ml-auto p-2 h-auto text-emerald-500 hover:bg-emerald-500/10\">\r\n              <X weight=\"bold\" className=\"w-4 h-4\" />\r\n            </Button>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Search & Intelligence Controls */}\r\n      <div className=\"px-2\">\r\n        <Card className=\"p-6 rounded-[32px] border-border/50 shadow-card\">\r\n          <div className=\"flex flex-col md:flex-row gap-6\">\r\n            <div className=\"relative flex-1 group\">\r\n              <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-xl\" />\r\n              <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Query identity name, neural address, or access node...\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3.5 pl-12 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\r\n              />\r\n            </div>\r\n            \r\n            <div className=\"flex items-center gap-3\">\r\n              <Button variant=\"outline\" className=\"gap-2 px-6 py-3.5 rounded-2xl text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\">\r\n                <Funnel weight=\"bold\" className=\"w-4 h-4\" />\r\n                Filters\r\n              </Button>\r\n              <Button variant=\"outline\" onClick={() => fetchData()} className=\"p-3.5 border-border/50 rounded-2xl hover:bg-secondary transition-all\">\r\n                <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Users Table */}\r\n      <div className=\"px-2\">\r\n        <Card className=\"rounded-[40px] border-border/50 overflow-hidden shadow-premium\">\r\n          <ResponsiveTable\r\n            columns={columns}\r\n            data={filteredUsers}\r\n            loading={loading}\r\n            rowKey={(user) => user.id}\r\n            emptyMessage=\"No identity nodes detected in current neural registry.\"\r\n            mobileCard={(user) => (\r\n              <div className=\"space-y-5\">\r\n                <div className=\"flex justify-between items-start\">\r\n                  <div className=\"flex items-center gap-4\">\r\n                    <div className=\"w-14 h-14 rounded-2xl bg-secondary border border-border flex items-center justify-center text-primary shadow-inner\">\r\n                      {user.role === 'super_admin' ? (\r\n                        <Crown weight=\"duotone\" className=\"w-7 h-7 text-red-500\" />\r\n                      ) : (\r\n                        <Users weight=\"duotone\" className=\"w-7 h-7\" />\r\n                      )}\r\n                    </div>\r\n                    <div className=\"min-w-0\">\r\n                      <p className=\"font-bold text-foreground truncate uppercase tracking-tight\">{user.full_name || 'ANONYMOUS_NODE'}</p>\r\n                      <p className=\"text-[10px] font-black text-muted-foreground truncate uppercase tracking-widest\">{user.email}</p>\r\n                    </div>\r\n                  </div>\r\n                  {getRoleBadge(user.role)}\r\n                </div>\r\n                \r\n                <div className=\"grid grid-cols-2 gap-6 py-4 border-y border-border/50\">\r\n                  <div>\r\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Initialized</p>\r\n                    <p className=\"text-xs font-bold text-foreground tabular-nums\">{new Date(user.created_at).toLocaleDateString()}</p>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Status</p>\r\n                    <Badge variant={user.is_active ? 'success' : 'destructive'} size=\"sm\" className=\"font-black text-[8px] uppercase tracking-widest px-2\">\r\n                      {user.is_active ? 'OPERATIONAL' : 'OFFLINE'}\r\n                    </Badge>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-center\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className={cn(\"w-1.5 h-1.5 rounded-full\", user.is_active ? \"bg-emerald-500 animate-pulse shadow-[0_0_8px_rgba(16,185,129,0.6)]\" : \"bg-muted\")} />\r\n                    <span className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">{user.tier} Protocol</span>\r\n                  </div>\r\n                  <div className=\"flex gap-2\">\r\n                    <Button \r\n                      disabled={isProcessing === user.id}\r\n                      onClick={() => handleUpdateStatus(user.id, user.is_active)}\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      className={cn(\r\n                        \"h-10 w-10 p-0 border-border/50 rounded-xl transition-all\",\r\n                        user.is_active ? 'text-rose-500 hover:bg-rose-500/10' : 'text-emerald-500 hover:bg-emerald-500/10'\r\n                      )}\r\n                    >\r\n                      {isProcessing === user.id ? (\r\n                        <SpinnerGap weight=\"bold\" className=\"w-4 h-4 animate-spin\" />\r\n                      ) : user.is_active ? (\r\n                        <UserMinus weight=\"bold\" className=\"w-4 h-4\" />\r\n                      ) : (\r\n                        <UserCheck weight=\"bold\" className=\"w-4 h-4\" />\r\n                      )}\r\n                    </Button>\r\n                    <Button variant=\"outline\" size=\"sm\" className=\"h-10 w-10 p-0 border-border/50 rounded-xl hover:bg-secondary\">\r\n                      <PencilSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          />\r\n        </Card>\r\n      </div>\r\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\analytics\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: ')' expected.","line":288,"column":29}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { cn } from '@/lib/utils';\r\nimport { \r\n  Brain, \r\n  TrendUp, \r\n  Warning, \r\n  ChatCircle,\r\n  ChartBar,\r\n  Users,\r\n  CurrencyDollar,\r\n  Sparkle,\r\n  SpinnerGap,\r\n  CaretRight,\r\n  Lightning,\r\n  Monitor,\r\n  Pulse,\r\n  ArrowsClockwise\r\n} from '@phosphor-icons/react';\r\nimport AIAdvisorChat from '@/components/analytics/AIAdvisorChat';\r\nimport InsightCards from '@/components/analytics/InsightCards';\r\nimport AlertCenter from '@/components/analytics/AlertCenter';\r\nimport { useBusinessAdvisor, useBusinessMetrics, useBusinessAlerts } from '@/hooks/useBusinessAdvisor';\r\n\r\nexport default function AnalyticsDashboard() {\r\n  const [activeTab, setActiveTab] = useState<'overview' | 'advisor' | 'alerts'>('overview');\r\n  const [loading, setLoading] = useState(true);\r\n  \r\n  const { metrics, loading: metricsLoading } = useBusinessMetrics();\r\n  const { alerts, criticalCount, highCount } = useBusinessAlerts();\r\n\r\n  useEffect(() => {\r\n    // Simulate initial loading\r\n    setTimeout(() => setLoading(false), 1000);\r\n  }, []);\r\n\r\n  const tabs = [\r\n    {\r\n      id: 'overview' as const,\r\n      label: 'เธ เธฒเธเธฃเธงเธก',\r\n      icon: ChartBar,\r\n      badge: null\r\n    },\r\n    {\r\n      id: 'advisor' as const,\r\n      label: 'AI Advisor',\r\n      icon: Brain,\r\n      badge: null\r\n    },\r\n    {\r\n      id: 'alerts' as const,\r\n      label: 'เธเธฒเธฃเนเธเนเธเน€เธ•เธทเธญเธ',\r\n      icon: Warning,\r\n      badge: criticalCount + highCount > 0 ? criticalCount + highCount : null\r\n    }\r\n  ];\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-[80vh] flex flex-col items-center justify-center space-y-6\">\r\n        <div className=\"relative\">\r\n          <motion.div\r\n            animate={{ \r\n              scale: [1, 1.1, 1],\r\n              rotate: [0, 180, 360]\r\n            }}\r\n            transition={{ \r\n              duration: 3,\r\n              repeat: Infinity,\r\n              ease: \"easeInOut\"\r\n            }}\r\n            className=\"p-6 bg-primary/10 rounded-[32px] border border-primary/20 shadow-inner\"\r\n          >\r\n            <Brain weight=\"duotone\" className=\"w-16 h-16 text-primary\" />\r\n          </motion.div>\r\n          <div className=\"absolute -inset-4 bg-primary/5 blur-2xl rounded-full z-[-1] animate-pulse\" />\r\n        </div>\r\n        <div className=\"text-center space-y-3\">\r\n          <p className=\"text-xl font-black text-foreground uppercase tracking-widest\">\r\n            Establishing <span className=\"text-primary\">Intelligence</span>\r\n          </p>\r\n          <p className=\"text-xs font-black text-muted-foreground uppercase tracking-[0.3em] animate-pulse\">\r\n            Synchronizing global metrics & cognitive nodes...\r\n          </p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col lg:flex-row lg:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Brain weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Executive Intelligence Matrix\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            AI <span className=\"text-primary\">Business</span> Analytics\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic max-w-2xl leading-relaxed\"\r\n          >\r\n            Orchestrating autonomous diagnostic insights, predictive revenue modeling, and real-time risk mitigation protocols.\r\n          </motion.p>\r\n        </div>\r\n\r\n        {/* Neural Quick Stats */}\r\n        <motion.div \r\n          initial={{ opacity: 0, scale: 0.9 }}\r\n          animate={{ opacity: 1, scale: 1 }}\r\n          transition={{ delay: 0.3 }}\r\n          className=\"flex flex-wrap items-center gap-4\"\r\n        >\r\n          {metrics && (\r\n            <>\r\n              <Card className=\"px-6 py-4 bg-secondary/30 border-border/50 shadow-inner group overflow-hidden relative min-w-[160px]\">\r\n                <div className=\"absolute top-0 right-0 p-2 opacity-[0.03] group-hover:scale-110 transition-transform\">\r\n                  <CurrencyDollar weight=\"fill\" className=\"w-12 h-12 text-primary\" />\r\n                </div>\r\n                <div className=\"relative z-10\">\r\n                  <div className=\"text-xl font-black text-primary tabular-nums tracking-tighter\">\r\n                    {metrics.revenue?.formatted || 'เธฟ0'}\r\n                  </div>\r\n                  <div className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest mt-0.5\">\r\n                    Monthly Yield\r\n                  </div>\r\n                </div>\r\n              </Card>\r\n              <Card className=\"px-6 py-4 bg-secondary/30 border-border/50 shadow-inner group overflow-hidden relative min-w-[160px]\">\r\n                <div className=\"absolute top-0 right-0 p-2 opacity-[0.03] group-hover:scale-110 transition-transform\">\r\n                  <Users weight=\"fill\" className=\"w-12 h-12 text-emerald-500\" />\r\n                </div>\r\n                <div className=\"relative z-10\">\r\n                  <div className=\"text-xl font-black text-emerald-500 tabular-nums tracking-tighter\">\r\n                    {metrics.customers?.formatted || '0 เธเธ'}\r\n                  </div>\r\n                  <div className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest mt-0.5\">\r\n                    New Identity Links\r\n                  </div>\r\n                </div>\r\n              </Card>\r\n            </>\r\n          )}\r\n          {(criticalCount + highCount) > 0 && (\r\n            <Card className=\"px-6 py-4 bg-rose-500/5 border-rose-500/20 shadow-inner group overflow-hidden relative min-w-[120px]\">\r\n              <div className=\"absolute top-0 right-0 p-2 opacity-[0.05] group-hover:scale-110 transition-transform\">\r\n                <Warning weight=\"fill\" className=\"w-12 h-12 text-rose-500\" />\r\n              </div>\r\n              <div className=\"relative z-10 text-center\">\r\n                <div className=\"text-xl font-black text-rose-500 tabular-nums tracking-tighter\">\r\n                  {criticalCount + highCount}\r\n                </div>\r\n                <div className=\"text-[8px] font-black text-rose-400/60 uppercase tracking-widest mt-0.5\">\r\n                  Anomalies\r\n                </div>\r\n              </div>\r\n            </Card>\r\n          )}\r\n        </motion.div>\r\n      </div>\r\n\r\n      {/* Protocol Navigation Tabs */}\r\n      <div className=\"px-2\">\r\n        <div className=\"flex bg-secondary/50 border border-border p-1.5 rounded-[24px] w-fit shadow-inner\">\r\n          {tabs.map((tab) => (\r\n            <button\r\n              key={tab.id}\r\n              onClick={() => setActiveTab(tab.id)}\r\n              className={cn(\r\n                \"flex items-center gap-3 px-8 py-3 rounded-2xl transition-all text-[10px] font-black uppercase tracking-widest border whitespace-nowrap relative\",\r\n                activeTab === tab.id\r\n                  ? \"bg-primary text-primary-foreground border-primary shadow-premium\"\r\n                  : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\r\n              )}\r\n            >\r\n              <tab.icon weight={activeTab === tab.id ? \"fill\" : \"bold\"} className=\"w-4 h-4\" />\r\n              <span>{tab.label} Node</span>\r\n              {tab.badge && (\r\n                <span className=\"ml-2 w-5 h-5 bg-rose-500 text-white text-[9px] font-black rounded-full flex items-center justify-center shadow-glow-sm\">\r\n                  {tab.badge}\r\n                </span>\r\n              )}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Neural Content Hub */}\r\n      <div className=\"px-2\">\r\n        <AnimatePresence mode=\"wait\">\r\n          <motion.div\r\n            key={activeTab}\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, scale: 0.98 }}\r\n            transition={{ duration: 0.3 }}\r\n          >\r\n            {activeTab === 'overview' && (\r\n              <div className=\"space-y-10\">\r\n                {/* Global Metrics Node */}\r\n                <section className=\"space-y-6\">\r\n                  <div className=\"flex items-center gap-3 px-2\">\r\n                    <div className=\"w-1.5 h-1.5 rounded-full bg-primary animate-pulse\" />\r\n                    <h2 className=\"text-xl font-black text-foreground uppercase tracking-tight\">Critical Biomarkers</h2>\r\n                  </div>\r\n                  <InsightCards />\r\n                </section>\r\n\r\n                {/* Risk Mitigation Node */}\r\n                {alerts.length > 0 && (\r\n                  <section className=\"space-y-6\">\r\n                    <div className=\"flex items-center justify-between px-2\">\r\n                      <div className=\"flex items-center gap-3\">\r\n                        <div className=\"w-1.5 h-1.5 rounded-full bg-rose-500 animate-pulse\" />\r\n                        <h2 className=\"text-xl font-black text-foreground uppercase tracking-tight\">Anomaly Registry</h2>\r\n                      </div>\r\n                      <Badge variant=\"ghost\" className=\"bg-rose-500/5 text-rose-500 border-none font-black text-[10px] tracking-widest uppercase px-4 py-1.5 shadow-sm\">Real-time Detection</Badge>\r\n                    </div>\r\n                    <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n                      {alerts.slice(0, 4).map((alert, index) => (\r\n                        <Card \r\n                          key={index}\r\n                          className={cn(\r\n                            \"p-6 rounded-[32px] border transition-all hover:shadow-card-hover group/alert cursor-pointer overflow-hidden relative shadow-card\",\r\n                            alert.severity === 'critical' ? 'bg-rose-500/5 border-rose-500/20' :\r\n                            alert.severity === 'high' ? 'bg-amber-500/5 border-amber-500/20' :\r\n                            'bg-blue-500/5 border-blue-500/20'\r\n                          )}\r\n                        >\r\n                          <div className=\"absolute top-0 right-0 p-4 opacity-0 group-hover/alert:opacity-[0.03] transition-opacity\">\r\n                            <Warning weight=\"fill\" className=\"w-20 h-20\" />\r\n                          </div>\r\n                          <div className=\"flex items-start gap-5 relative z-10\">\r\n                            <div className={cn(\r\n                              \"w-12 h-12 rounded-2xl flex items-center justify-center border transition-all duration-500 shadow-inner\",\r\n                              alert.severity === 'critical' ? 'bg-rose-500/10 border-rose-500/20 text-rose-500' :\r\n                              alert.severity === 'high' ? 'bg-amber-500/10 border-amber-500/20 text-amber-500' :\r\n                              'bg-blue-500/10 border-blue-500/20 text-blue-500'\r\n                            )}>\r\n                              <Warning weight=\"duotone\" className=\"w-6 h-6 animate-pulse\" />\r\n                            </div>\r\n                            <div className=\"space-y-1 flex-1\">\r\n                              <h4 className=\"font-black text-foreground text-base uppercase tracking-tight leading-tight\">\r\n                                {alert.title}\r\n                              </h4>\r\n                              <p className=\"text-xs text-muted-foreground font-medium italic leading-relaxed line-clamp-2\">\r\n                                {alert.description}\r\n                              </p>\r\n                            </div>\r\n                            <CaretRight weight=\"bold\" className=\"w-4 h-4 text-muted-foreground opacity-0 group-hover/alert:opacity-100 group-hover/alert:translate-x-1 transition-all self-center\" />\r\n                          </div>\r\n                        </Card>\r\n                      ))}\r\n                    </div>\r\n                    {alerts.length > 4 && (\r\n                      <div className=\"flex justify-center pt-4\">\r\n                        <Button\r\n                          variant=\"ghost\"\r\n                          onClick={() => setActiveTab('alerts')}\r\n                          className=\"text-[10px] font-black uppercase tracking-[0.3em] text-primary hover:bg-primary/5 gap-3 rounded-xl px-8 py-4\"\r\n                        >\r\n                          Access Global Alert Center ({alerts.length})\r\n                          <CaretRight weight=\"bold\" className=\"w-3.5 h-3.5\" />\r\n                        </Button>\r\n                      </div>\r\n                    )}\r\n                  </section> section\r\n                )}\r\n\r\n                {/* Cognitive Action Nodes */}\r\n                <section className=\"space-y-6\">\r\n                  <div className=\"flex items-center gap-3 px-2\">\r\n                    <div className=\"w-1.5 h-1.5 rounded-full bg-primary animate-pulse\" />\r\n                    <h2 className=\"text-xl font-black text-foreground uppercase tracking-tight\">Intelligence Orchestration</h2>\r\n                  </div>\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                    <Card \r\n                      as=\"button\"\r\n                      onClick={() => setActiveTab('advisor')}\r\n                      className=\"p-8 border-border/50 hover:border-primary/40 hover:shadow-premium transition-all text-left group overflow-hidden relative shadow-card\"\r\n                    >\r\n                      <div className=\"absolute top-0 right-0 p-6 opacity-[0.02] group-hover:scale-110 transition-transform duration-700\">\r\n                        <Brain weight=\"fill\" className=\"w-32 h-32 text-primary\" />\r\n                      </div>\r\n                      <div className=\"relative z-10 space-y-6\">\r\n                        <div className=\"w-14 h-14 rounded-2xl bg-primary/10 border border-primary/20 flex items-center justify-center text-primary group-hover:scale-110 transition-transform shadow-inner\">\r\n                          <ChatCircle weight=\"duotone\" className=\"w-7 h-7\" />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                          <h3 className=\"text-xl font-black text-foreground uppercase tracking-tight group-hover:text-primary transition-colors\">Neural Advisor</h3>\r\n                          <p className=\"text-xs text-muted-foreground font-medium italic leading-relaxed\">\r\n                            Interact with high-fidelity cognitive models for real-time strategy synthesis.\r\n                          </p>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2 text-[9px] font-black text-primary uppercase tracking-widest pt-2\">\r\n                          Initialize Link <CaretRight weight=\"bold\" className=\"w-3 h-3 group-hover:translate-x-1 transition-transform\" />\r\n                        </div>\r\n                      </div>\r\n                    </Card>\r\n\r\n                    <Card \r\n                      as=\"button\"\r\n                      className=\"p-8 border-border/50 hover:border-emerald-500/40 hover:shadow-premium transition-all text-left group overflow-hidden relative shadow-card\"\r\n                    >\r\n                      <div className=\"absolute top-0 right-0 p-6 opacity-[0.02] group-hover:scale-110 transition-transform duration-700\">\r\n                        <TrendUp weight=\"fill\" className=\"w-32 h-32 text-emerald-500\" />\r\n                      </div>\r\n                      <div className=\"relative z-10 space-y-6\">\r\n                        <div className=\"w-14 h-14 rounded-2xl bg-emerald-500/10 border border-emerald-500/20 flex items-center justify-center text-emerald-500 group-hover:scale-110 transition-transform shadow-inner\">\r\n                          <ChartBar weight=\"duotone\" className=\"w-7 h-7\" />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                          <h3 className=\"text-xl font-black text-foreground uppercase tracking-tight group-hover:text-emerald-500 transition-colors\">Fiscal Reports</h3>\r\n                          <p className=\"text-xs text-muted-foreground font-medium italic leading-relaxed\">\r\n                            Access periodic audit payloads and predictive revenue trajectory nodes.\r\n                          </p>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2 text-[9px] font-black text-emerald-500 uppercase tracking-widest pt-2\">\r\n                          Scan Registry <CaretRight weight=\"bold\" className=\"w-3 h-3 group-hover:translate-x-1 transition-transform\" />\r\n                        </div>\r\n                      </div>\r\n                    </Card>\r\n\r\n                    <Card \r\n                      as=\"button\"\r\n                      className=\"p-8 border-border/50 hover:border-blue-500/40 hover:shadow-premium transition-all text-left group overflow-hidden relative shadow-card\"\r\n                    >\r\n                      <div className=\"absolute top-0 right-0 p-6 opacity-[0.02] group-hover:scale-110 transition-transform duration-700\">\r\n                        <Users weight=\"fill\" className=\"w-32 h-32 text-blue-500\" />\r\n                      </div>\r\n                      <div className=\"relative z-10 space-y-6\">\r\n                        <div className=\"w-14 h-14 rounded-2xl bg-blue-500/10 border border-blue-500/20 flex items-center justify-center text-blue-500 group-hover:scale-110 transition-transform shadow-inner\">\r\n                          <Users weight=\"duotone\" className=\"w-7 h-7\" />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                          <h3 className=\"text-xl font-black text-foreground uppercase tracking-tight group-hover:text-blue-500 transition-colors\">Staff Oversight</h3>\r\n                          <p className=\"text-xs text-muted-foreground font-medium italic leading-relaxed\">\r\n                            Monitor personnel efficiency nodes and establish functional task queues.\r\n                          </p>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2 text-[9px] font-black text-blue-500 uppercase tracking-widest pt-2\">\r\n                          Deploy Matrix <CaretRight weight=\"bold\" className=\"w-3 h-3 group-hover:translate-x-1 transition-transform\" />\r\n                        </div>\r\n                      </div>\r\n                    </Card>\r\n                  </div>\r\n                </section>\r\n              </div>\r\n            )}\r\n\r\n            {activeTab === 'advisor' && (\r\n              <motion.div initial={{ opacity: 0, scale: 0.98 }} animate={{ opacity: 1, scale: 1 }} className=\"max-w-4xl mx-auto\">\r\n                <AIAdvisorChat />\r\n              </motion.div>\r\n            )}\r\n\r\n            {activeTab === 'alerts' && (\r\n              <motion.div initial={{ opacity: 0, scale: 0.98 }} animate={{ opacity: 1, scale: 1 }} className=\"max-w-4xl mx-auto\">\r\n                <AlertCenter />\r\n              </motion.div>\r\n            )}\r\n          </motion.div>\r\n        </AnimatePresence>\r\n      </div>\r\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\beautician\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ClipboardText' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ClipboardText"},"fix":{"range":[251,269],"text":""},"desc":"Remove unused variable \"ClipboardText\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[319,334],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[334,348],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'StatCard' is defined but never used.","line":20,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":18,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"StatCard"},"fix":{"range":[383,435],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":23,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Button"},"fix":{"range":[567,615],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":36,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":37,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":37,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1372,1375],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1372,1375],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":50,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1956,1959],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1956,1959],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'tasksLoading' is assigned a value but never used.","line":55,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":55,"endColumn":59},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":76,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":76,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2959,2962],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2959,2962],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":107,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3903,3906],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3903,3906],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":108,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3963,3966],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3963,3966],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":109,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":109,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4039,4042],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4039,4042],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":113,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4208,4211],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4208,4211],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":117,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4420,4423],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4420,4423],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":16,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { \r\n  User, \r\n  ClockCounterClockwise, \r\n  ChatCircle, \r\n  SpinnerGap,\r\n  Stethoscope,\r\n  CheckCircle,\r\n  ClipboardText,\r\n  Pulse,\r\n  Lightning,\r\n  Camera,\r\n  ListChecks,\r\n  CaretRight,\r\n  ArrowLeft\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { useTranslations } from 'next-intl';\r\nimport { createClient } from '@/lib/supabase/client';\r\nimport TaskQueue from '@/components/beautician/TaskQueue';\r\nimport ProtocolInsights from '@/components/beautician/ProtocolInsights';\r\nimport ComparisonModal from '@/components/beautician/ComparisonModal';\r\nimport { cn } from '@/lib/utils';\r\nimport { useBeauticianTasks, useStartTreatment, useCompleteTreatment, useTaskRealtime } from '@/hooks/useBeauticianTasks';\r\nimport { toast } from 'sonner';\r\n\r\nexport default function BeauticianDashboard() {\r\n  const { goBack } = useBackNavigation();\r\n  const t = useTranslations('beautician' as any);\r\n  const [loading, setLoading] = useState(true);\r\n  const [userId, setUserId] = useState<string | null>(null);\r\n  const [staffName, setStaffName] = useState('');\r\n  const [isCompareModalOpen, setIsCompareModalOpen] = useState(false);\r\n  const [activeCase, setActiveCase] = useState<{\r\n    id: string;\r\n    customer_id: string;\r\n    treatment_name?: string;\r\n    priority?: 'high' | 'normal' | 'low';\r\n    customers?: { name: string };\r\n  } | null>(null);\r\n  const [throughput, setThroughput] = useState({ completed: 0, total: 0 });\r\n  const [checklist, setChecklist] = useState<any[]>([]);\r\n\r\n  const supabase = useMemo(() => createClient(), []);\r\n\r\n  // Real-time task management hooks\r\n  const { data: pendingTasks = [], isLoading: tasksLoading } = useBeauticianTasks('pending', 20);\r\n  const startTreatment = useStartTreatment();\r\n  const completeTreatment = useCompleteTreatment();\r\n  \r\n  // Setup real-time updates\r\n  useTaskRealtime(userId || '');\r\n\r\n  const fetchStaffData = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (user) {\r\n        setUserId(user.id);\r\n        \r\n        // Fetch real-time throughput and staff info\r\n        const [staffRes, reportRes] = await Promise.all([\r\n          supabase.from('clinic_staff').select('id, users:user_id(full_name)').eq('user_id', user.id).single(),\r\n          fetch('/api/reports?type=beautician_overview').then(res => res.json())\r\n        ]);\r\n        \r\n        if (staffRes.data?.users) {\r\n          setStaffName((staffRes.data.users as any).full_name);\r\n        }\r\n\r\n        if (reportRes.success) {\r\n          setThroughput({\r\n            completed: reportRes.data.completedCases,\r\n            total: reportRes.data.totalCases\r\n          });\r\n        }\r\n\r\n        // Fetch active journey for this beautician\r\n        const { data: journeys } = await supabase\r\n          .from('customer_treatment_journeys')\r\n          .select(`\r\n            *,\r\n            customers (\r\n              full_name\r\n            ),\r\n            treatments (\r\n              protocols\r\n            )\r\n          `)\r\n          .or('journey_status.eq.treatment_planned,journey_status.eq.in_progress')\r\n          .eq('assigned_beautician_id', user.id)\r\n          .limit(1);\r\n        \r\n        if (journeys && journeys.length > 0) {\r\n          const j = journeys[0];\r\n          setActiveCase({\r\n            id: j.id,\r\n            customer_id: j.customer_id,\r\n            treatment_name: (j.treatment_plan as any)?.treatment_name,\r\n            priority: (j.metadata as any)?.priority || 'normal',\r\n            customers: { name: (j.customers as any)?.full_name || 'Customer' }\r\n          });\r\n\r\n          // Initialize checklist from journey state or treatment protocols\r\n          const existingChecklist = (j as any).treatment_checklist;\r\n          if (Array.isArray(existingChecklist) && existingChecklist.length > 0) {\r\n            setChecklist(existingChecklist);\r\n          } else {\r\n            const protocols = (j as any).treatments?.protocols;\r\n            if (Array.isArray(protocols)) {\r\n              setChecklist(protocols.map(p => ({ ...p, completed: false })));\r\n            } else {\r\n              setChecklist([]);\r\n            }\r\n          }\r\n        } else {\r\n          setActiveCase(null);\r\n          setChecklist([]);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error('Beautician Dashboard Error:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [supabase]);\r\n\r\n  const handleToggleChecklist = async (index: number) => {\r\n    if (!activeCase) return;\r\n    \r\n    const newChecklist = [...checklist];\r\n    newChecklist[index].completed = !newChecklist[index].completed;\r\n    setChecklist(newChecklist);\r\n\r\n    // Save to database\r\n    try {\r\n      await supabase\r\n        .from('customer_treatment_journeys')\r\n        .update({ treatment_checklist: newChecklist })\r\n        .eq('id', activeCase.id);\r\n    } catch (err) {\r\n      console.error('Error saving checklist state:', err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchStaffData();\r\n  }, [fetchStaffData]);\r\n\r\n  const handleStartTreatment = async (taskId: string, workflowId: string) => {\r\n    if (!userId) return;\r\n    try {\r\n      await startTreatment.mutateAsync({\r\n        taskId,\r\n        workflowId,\r\n        beauticianId: userId\r\n      });\r\n      await fetchStaffData(); // Refresh dashboard state\r\n    } catch (error) {\r\n      console.error('Error starting treatment:', error);\r\n    }\r\n  };\r\n\r\n  const handleCompleteTreatment = async (journeyId: string) => {\r\n    // Find the task associated with this journey\r\n    const task = pendingTasks.find(t => t.workflow_id === journeyId);\r\n    if (!task) {\r\n      toast.error('Task not found');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await completeTreatment.mutateAsync({\r\n        taskId: task.id,\r\n        workflowId: journeyId,\r\n        notes: 'Treatment completed successfully according to protocol.'\r\n      });\r\n      await fetchStaffData(); // Refresh dashboard state\r\n    } catch (error) {\r\n      console.error('Error completing treatment:', error);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-[400px] flex flex-col items-center justify-center space-y-4\">\r\n        <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n        <p className=\"text-muted-foreground animate-pulse text-xs uppercase tracking-widest text-center\">\r\n          Syncing Protocol Node...\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n      \r\n      <ComparisonModal \r\n        isOpen={isCompareModalOpen}\r\n        onClose={() => setIsCompareModalOpen(false)}\r\n        onSuccess={() => {}} // Could refresh insights if needed\r\n        customerId={activeCase?.customer_id || ''}\r\n      />\r\n\r\n      {/* Welcome Header */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-emerald-500 text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Stethoscope weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Clinical Operations Node\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight\"\r\n          >\r\n            Systems <span className=\"text-primary\">Active</span>, {staffName || 'Operator'}\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Delivering high-precision aesthetic treatments via clinical cognitive protocols.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <motion.div \r\n          initial={{ opacity: 0, scale: 0.9 }}\r\n          animate={{ opacity: 1, scale: 1 }}\r\n          transition={{ delay: 0.3 }}\r\n          className=\"flex gap-3\"\r\n        >\r\n          <Card className=\"px-6 py-3 border-emerald-500/20 bg-emerald-500/5\">\r\n            <div className=\"flex items-center gap-8\">\r\n              <div className=\"flex flex-col\">\r\n                <span className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest mb-0.5\">Shift Status</span>\r\n                <span className=\"text-xs font-bold text-emerald-500 flex items-center gap-1.5 uppercase\">\r\n                  <div className=\"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse shadow-[0_0_8px_rgba(16,185,129,0.6)]\" />\r\n                  On Duty\r\n                </span>\r\n              </div>\r\n              <div className=\"h-8 w-px bg-emerald-500/10\" />\r\n              <div className=\"flex flex-col\">\r\n                <span className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest mb-0.5\">Session Output</span>\r\n                <span className=\"text-xs font-bold text-foreground uppercase tabular-nums\">{throughput.completed}/{throughput.total} Cases</span>\r\n              </div>\r\n            </div>\r\n          </Card>\r\n        </motion.div>\r\n      </div>\r\n\r\n      {/* Main Content Grid */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n        {/* Left: Task Queue */}\r\n        <div className=\"lg:col-span-1\">\r\n          {userId && (\r\n            <motion.div\r\n              initial={{ opacity: 0, x: -20 }}\r\n              animate={{ opacity: 1, x: 0 }}\r\n              transition={{ delay: 0.4 }}\r\n            >\r\n              <TaskQueue \r\n                staffId={userId} \r\n                onStartTreatment={handleStartTreatment}\r\n              />\r\n            </motion.div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Right: Protocol and Insights */}\r\n        <div className=\"lg:col-span-2 space-y-8\">\r\n          {/* Case Context Header */}\r\n          <AnimatePresence mode=\"wait\">\r\n            {activeCase ? (\r\n              <motion.div \r\n                key=\"active-case\"\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                exit={{ opacity: 0, y: -20 }}\r\n              >\r\n                <Card className=\"relative overflow-hidden group border-primary/20\">\r\n                  <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700\">\r\n                    <Pulse className=\"w-48 h-48 text-primary\" />\r\n                  </div>\r\n\r\n                  <CardContent className=\"p-8\">\r\n                    <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 relative z-10\">\r\n                      <div className=\"flex items-center gap-6\">\r\n                        <div className=\"w-16 h-16 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-premium\">\r\n                          <User weight=\"duotone\" className=\"w-8 h-8\" />\r\n                        </div>\r\n                        <div className=\"space-y-1\">\r\n                          <h3 className=\"text-2xl font-bold text-foreground tracking-tight\">\r\n                            {activeCase.customers?.name || 'Customer'}\r\n                          </h3>\r\n                          <div className=\"flex items-center gap-3\">\r\n                            <p className=\"text-xs text-muted-foreground font-bold uppercase tracking-widest flex items-center gap-2\">\r\n                              Protocol: <span className=\"text-primary\">{activeCase.treatment_name || 'Registry'}</span>\r\n                            </p>\r\n                            <div className=\"w-1 h-1 rounded-full bg-border\" />\r\n                            <span className=\"text-[10px] text-muted-foreground font-mono\">ID: {activeCase.id.slice(0,8)}</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <Badge variant={activeCase.priority === 'high' ? 'destructive' : 'default'} pulse={activeCase.priority === 'high'} className=\"font-black uppercase tracking-widest py-1.5 px-4\">\r\n                        <Lightning weight=\"fill\" className=\"w-3 h-3 mr-2\" />\r\n                        {activeCase.priority || 'Normal'} Priority\r\n                      </Badge>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </motion.div>\r\n            ) : (\r\n              <motion.div \r\n                key=\"no-case\"\r\n                initial={{ opacity: 0 }}\r\n                animate={{ opacity: 1 }}\r\n              >\r\n                <Card variant=\"ghost\" className=\"p-16 border-2 border-dashed border-border/50 text-center flex flex-col items-center justify-center space-y-6\">\r\n                  <div className=\"w-20 h-20 rounded-[30px] bg-secondary border border-border flex items-center justify-center text-muted-foreground opacity-20\">\r\n                    <ClockCounterClockwise weight=\"duotone\" className=\"w-10 h-10\" />\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <h4 className=\"text-xl font-black text-foreground/30 uppercase tracking-[0.2em]\">Awaiting Case Node</h4>\r\n                    <p className=\"text-xs text-muted-foreground italic font-light tracking-widest\">Assign a prioritized identity from your clinical registry to initiate protocol.</p>\r\n                  </div>\r\n                </Card>\r\n              </motion.div>\r\n            )}\r\n          </AnimatePresence>\r\n\r\n          {/* Clinical Protocols */}\r\n          <motion.div\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ delay: 0.6 }}\r\n            className=\"space-y-8\"\r\n          >\r\n            {activeCase && checklist.length > 0 && (\r\n              <Card className=\"relative overflow-hidden group border-primary/10\">\r\n                <CardHeader className=\"flex flex-row items-center justify-between border-b border-border/50 pb-6 px-8\">\r\n                  <div className=\"flex items-center gap-4\">\r\n                    <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\r\n                      <ListChecks weight=\"duotone\" className=\"w-6 h-6\" />\r\n                    </div>\r\n                    <div>\r\n                      <CardTitle>Active Protocol Checklist</CardTitle>\r\n                      <p className=\"text-[10px] font-bold text-muted-foreground uppercase tracking-widest mt-1\">Surgical precision tracking</p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mb-1\">Session Progress</p>\r\n                    <Badge variant=\"default\" className=\"font-black text-base\">\r\n                      {checklist.filter(c => c.completed).length}/{checklist.length}\r\n                    </Badge>\r\n                  </div>\r\n                </CardHeader>\r\n\r\n                <CardContent className=\"p-8\">\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 relative z-10\">\r\n                    {checklist.map((step, idx) => (\r\n                      <button\r\n                        key={idx}\r\n                        onClick={() => handleToggleChecklist(idx)}\r\n                        className={cn(\r\n                          \"flex items-center gap-4 p-5 rounded-3xl border transition-all duration-300 text-left group/step\",\r\n                          step.completed \r\n                            ? \"bg-emerald-500/5 border-emerald-500/20 text-emerald-600\" \r\n                            : \"bg-secondary/30 border-border/50 hover:border-primary/30 text-foreground/60 hover:text-foreground\"\r\n                        )}\r\n                      >\r\n                        <div className={cn(\r\n                          \"w-10 h-10 rounded-xl flex items-center justify-center text-xs font-black border transition-all shadow-sm shrink-0\",\r\n                          step.completed ? \"bg-emerald-500 text-white border-emerald-400\" : \"bg-card border-border group-hover/step:border-primary/30\"\r\n                        )}>\r\n                          {step.completed ? <CheckCircle weight=\"fill\" className=\"w-5 h-5\" /> : idx + 1}\r\n                        </div>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <p className={cn(\r\n                            \"text-sm font-bold uppercase tracking-tight truncate\",\r\n                            step.completed ? \"line-through opacity-50 text-muted-foreground\" : \"\"\r\n                          )}>{step.action}</p>\r\n                          <p className=\"text-[10px] opacity-60 font-medium italic truncate\">{step.notes}</p>\r\n                        </div>\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n\r\n            <ProtocolInsights \r\n              customerId={activeCase?.customer_id || ''} \r\n              journeyId={activeCase?.id}\r\n            />\r\n          </motion.div>\r\n\r\n          {/* Quick Actions for Beautician */}\r\n          <AnimatePresence>\r\n            {activeCase && (\r\n              <motion.div \r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                exit={{ opacity: 0, scale: 0.95 }}\r\n                className=\"grid grid-cols-1 md:grid-cols-3 gap-4\"\r\n              >\r\n                <button \r\n                  onClick={() => handleCompleteTreatment(activeCase.id)}\r\n                  className=\"p-8 bg-card border border-border rounded-[32px] hover:border-emerald-500/40 hover:shadow-card-hover transition-all group text-center relative overflow-hidden\"\r\n                >\r\n                  <div className=\"absolute inset-0 bg-emerald-500/0 group-hover:bg-emerald-500/[0.02] transition-colors\" />\r\n                  <div className=\"w-14 h-14 rounded-2xl bg-emerald-500/10 flex items-center justify-center text-emerald-500 mx-auto mb-4 group-hover:scale-110 transition-transform shadow-sm border border-emerald-500/20\">\r\n                    <CheckCircle weight=\"duotone\" className=\"w-7 h-7\" />\r\n                  </div>\r\n                  <span className=\"text-[10px] font-black text-foreground uppercase tracking-[0.2em] group-hover:text-emerald-600 transition-colors\">Finalize Session</span>\r\n                </button>\r\n\r\n                <button \r\n                  onClick={() => setIsCompareModalOpen(true)}\r\n                  className=\"p-8 bg-card border border-border rounded-[32px] hover:border-primary/40 hover:shadow-card-hover transition-all group text-center relative overflow-hidden\"\r\n                >\r\n                  <div className=\"absolute inset-0 bg-primary/0 group-hover:bg-primary/[0.02] transition-colors\" />\r\n                  <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary mx-auto mb-4 group-hover:scale-110 transition-transform shadow-sm border border-primary/20\">\r\n                    <Camera weight=\"duotone\" className=\"w-7 h-7\" />\r\n                  </div>\r\n                  <span className=\"text-[10px] font-black text-foreground uppercase tracking-[0.2em] group-hover:text-primary transition-colors\">Visual Evolution</span>\r\n                </button>\r\n\r\n                <button className=\"p-8 bg-card border border-border rounded-[32px] hover:border-rose-500/40 hover:shadow-card-hover transition-all group text-center relative overflow-hidden\">\r\n                  <div className=\"absolute inset-0 bg-rose-500/0 group-hover:bg-rose-500/[0.02] transition-colors\" />\r\n                  <div className=\"w-14 h-14 rounded-2xl bg-rose-500/10 flex items-center justify-center text-rose-500 mx-auto mb-4 group-hover:scale-110 transition-transform shadow-sm border border-rose-500/20\">\r\n                    <ChatCircle weight=\"duotone\" className=\"w-7 h-7\" />\r\n                  </div>\r\n                  <span className=\"text-[10px] font-black text-foreground uppercase tracking-[0.2em] group-hover:text-rose-600 transition-colors\">Sales Intel Node</span>\r\n                </button>\r\n              </motion.div>\r\n            )}\r\n          </AnimatePresence>\r\n        </div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\beautician\\workflow\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\analytics\\customers\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Invalid character.","line":57,"column":30}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  Users, \n  TrendUp, \n  Warning, \n  Star, \n  CurrencyDollar, \n  CalendarDots, \n  ArrowLeft, \n  MagnifyingGlass,\n  Funnel,\n  CaretRight,\n  Monitor,\n  Pulse,\n  IdentificationBadge,\n  ArrowsClockwise,\n  Icon,\n  Sparkle\n} from '@phosphor-icons/react';\nimport { cn } from '@/lib/utils';\nimport { useRouter } from '@/i18n/routing';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport ResponsiveTable from '@/components/ui/ResponsiveTable';\n\ninterface CustomerAnalytics {\n  id: string;\n  customer_id: string;\n  customer?: { full_name: string; phone: string };\n  lifetime_value: number;\n  total_visits: number;\n  average_order_value: number;\n  days_since_last_visit: number;\n  churn_risk_score: number;\n  customer_segment: string;\n}\n\nexport default function CustomerAnalyticsPage() {\n  const { goBack } = useBackNavigation();\n  const [analytics, setAnalytics] = useState<CustomerAnalytics[]>([]);\n  const [segmentCounts, setSegmentCounts] = useState<Record<string, number>>({});\n  const [loading, setLoading] = useState(true);\n  const [segment, setSegment] = useState<string>('');\n\n  const fetchData = useCallback(async () => {\n    setLoading(true);\n    try {\n      const params = new URLSearchParams();\n      if (segment) params.set('segment', segment);\n      const res = await fetch(\\/api/analytics/customers?\\\\);\n      const data = await res.json();\n      setAnalytics(data.analytics || []);\n      setSegmentCounts(data.segmentCounts || {});\n    } catch (e) { console.error(e); }\n    setLoading(false);\n  }, [segment]);\n\n  useEffect(() => { \n    fetchData(); \n  }, [fetchData]);\n\n  const formatPrice = (n: number) => new Intl.NumberFormat('th-TH', { style: 'currency', currency: 'THB', minimumFractionDigits: 0 }).format(n);\n\n  const getSegmentStyle = (s: string) => {\n    switch (s) {\n      case 'vip': return 'bg-purple-500/10 text-purple-500 border-purple-500/20';\n      case 'loyal': return 'bg-emerald-500/10 text-emerald-500 border-emerald-500/20';\n      case 'promising': return 'bg-blue-500/10 text-blue-500 border-blue-500/20';\n      case 'new': return 'bg-cyan-500/10 text-cyan-500 border-cyan-500/20';\n      case 'at_risk': return 'bg-amber-500/10 text-amber-500 border-amber-500/20';\n      case 'dormant': return 'bg-orange-500/10 text-orange-500 border-orange-500/20';\n      case 'lost': return 'bg-rose-500/10 text-rose-500 border-rose-500/20';\n      default: return 'bg-secondary text-muted-foreground border-border';\n    }\n  };\n\n  const getSegmentLabel = (s: string) => {\n    const labels: Record<string, string> = {\n      vip: 'VIP_ELITE', loyal: 'LOYALIST', promising: 'PROMISING', new: 'INITIAL',\n      at_risk: 'AT_RISK', dormant: 'DORMANT', lost: 'LOST_LINK'\n    };\n    return labels[s] || s.toUpperCase();\n  };\n\n  const totalCLV = useMemo(() => analytics.reduce((sum, a) => sum + (a.lifetime_value || 0), 0), [analytics]);\n  const avgCLV = useMemo(() => analytics.length ? totalCLV / analytics.length : 0, [analytics, totalCLV]);\n\n  const columns = [\n    {\n      header: 'Identity Node',\n      accessor: (a: CustomerAnalytics) => (\n        <div className=\"flex items-center gap-4\">\n          <div className=\"w-10 h-10 rounded-xl bg-primary/10 border border-primary/20 flex items-center justify-center text-primary group-hover/row:bg-primary/20 transition-all shadow-inner\">\n            <Users weight=\"duotone\" className=\"w-5 h-5\" />\n          </div>\n          <div className=\"min-w-0\">\n            <p className=\"font-bold text-foreground truncate uppercase tracking-tight leading-tight\">{a.customer?.full_name || 'ANONYMOUS_NODE'}</p>\n            <p className=\"text-[10px] text-muted-foreground font-black uppercase tracking-widest opacity-60 mt-0.5\">{a.customer?.phone || 'NO_CHANNEL'}</p>\n          </div>\n        </div>\n      )\n    },\n    {\n      header: 'Protocol Segment',\n      accessor: (a: CustomerAnalytics) => (\n        <Badge variant=\"ghost\" className={cn(\"font-black text-[8px] tracking-widest px-3 py-1 uppercase shadow-sm border\", getSegmentStyle(a.customer_segment))}>\n          {getSegmentLabel(a.customer_segment)}\n        </Badge>\n      )\n    },\n    {\n      header: 'LTV Valuation',\n      accessor: (a: CustomerAnalytics) => (\n        <span className=\"text-sm font-black text-emerald-500 tabular-nums tracking-tighter\">๏ฟฝ{a.lifetime_value.toLocaleString()}</span>\n      )\n    },\n    {\n      header: 'Node Visits',\n      accessor: (a: CustomerAnalytics) => (\n        <span className=\"text-xs font-bold text-foreground tabular-nums\">{a.total_visits} CYCLES</span>\n      )\n    },\n    {\n      header: 'AOV Gradient',\n      accessor: (a: CustomerAnalytics) => (\n        <span className=\"text-xs font-medium text-muted-foreground tabular-nums\">๏ฟฝ{a.average_order_value.toLocaleString()}</span>\n      )\n    },\n    {\n      header: 'Temporal Delta',\n      accessor: (a: CustomerAnalytics) => (\n        <div className=\"flex items-center gap-2 text-muted-foreground\">\n          <Clock weight=\"bold\" className=\"w-3 h-3 opacity-40\" />\n          <span className=\"text-[10px] font-bold tabular-nums uppercase\">{a.days_since_last_visit} DAYS</span>\n        </div>\n      )\n    },\n    {\n      header: 'Churn Probability',\n      accessor: (a: CustomerAnalytics) => (\n        <div className=\"flex items-center gap-3 w-32\">\n          <div className=\"h-1.5 flex-1 bg-secondary rounded-full overflow-hidden p-0.5 border border-border/50 shadow-inner\">\n            <div \n              className={cn(\n                \"h-full rounded-full transition-all duration-1000\",\n                a.churn_risk_score > 0.7 ? 'bg-rose-500 shadow-glow-sm' : a.churn_risk_score > 0.4 ? 'bg-amber-500 shadow-glow-sm' : 'bg-emerald-500 shadow-glow-sm'\n              )}\n              style={{ width: \\\\%\\ }}\n            />\n          </div>\n          <span className=\"text-[10px] font-black text-foreground tabular-nums\">{Math.round(a.churn_risk_score * 100)}%</span>\n        </div>\n      )\n    }\n  ];\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header Section */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <TrendUp weight=\"duotone\" className=\"w-4 h-4\" />\n            Identity Intelligence Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n          >\n            Customer <span className=\"text-primary\">Analytics</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Orchestrating identity lifecycles, cumulative valuation, and predictive retention matrices.\n          </motion.p>\n        </div>\n\n        <motion.div \n          initial={{ opacity: 0, scale: 0.9 }}\n          animate={{ opacity: 1, scale: 1 }}\n          transition={{ delay: 0.3 }}\n        >\n          <Button \n            variant=\"outline\"\n            onClick={fetchData}\n            disabled={loading}\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\n          >\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\n            Sync Intel\n          </Button>\n        </motion.div>\n      </div>\n\n      {/* Stats Summary */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\n        <StatCard\n          title=\"Consolidated CLV\"\n          value={totalCLV}\n          prefix=\"๏ฟฝ\"\n          icon={CurrencyDollar as Icon}\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Average Node Valuation\"\n          value={avgCLV}\n          prefix=\"๏ฟฝ\"\n          icon={TrendUp as Icon}\n          iconColor=\"text-emerald-500\"\n          trend=\"up\"\n          change={5.4}\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Elite Identities\"\n          value={segmentCounts.vip || 0}\n          icon={Star as Icon}\n          iconColor=\"text-purple-500\"\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Risk Delta\"\n          value={(segmentCounts.at_risk || 0) + (segmentCounts.dormant || 0)}\n          icon={Warning as Icon}\n          iconColor=\"text-rose-500\"\n          className=\"p-4\"\n        />\n      </div>\n\n      {/* Navigation Matrix Tabs */}\n      <div className=\"px-2\">\n        <Card className=\"p-6 rounded-[32px] border-border/50 shadow-card\">\n          <div className=\"flex flex-col md:flex-row items-center justify-between gap-6\">\n            <div className=\"flex bg-secondary/50 border border-border/50 p-1 rounded-[20px] shadow-inner overflow-x-auto max-w-full no-scrollbar\">\n              <button onClick={() => setSegment('')} className={cn(\n                \"px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap border\",\n                !segment ? \"bg-card text-primary border-border/50 shadow-sm\" : \"text-muted-foreground border-transparent hover:text-foreground\"\n              )}>\n                UNIVERSAL\n              </button>\n              {['vip', 'loyal', 'promising', 'new', 'at_risk', 'dormant', 'lost'].map(s => (\n                <button key={s} onClick={() => setSegment(s)} className={cn(\n                  \"px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all whitespace-nowrap border ml-1\",\n                  segment === s ? \"bg-card text-primary border-border/50 shadow-sm\" : \"text-muted-foreground border-transparent hover:text-foreground\"\n                )}>\n                  {getSegmentLabel(s)} ({segmentCounts[s] || 0})\n                </button>\n              ))}\n            </div>\n            \n            <div className=\"relative group/input w-full md:w-64\">\n              <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\n              <MagnifyingGlass weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\n              <input \n                type=\"text\" \n                placeholder=\"Query identity...\" \n                className=\"w-full pl-11 pr-4 py-2.5 bg-secondary/30 border border-border rounded-2xl text-xs font-black uppercase tracking-widest text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\n              />\n            </div>\n          </div>\n        </Card>\n      </div>\n\n      {/* Analytics Matrix Table */}\n      <div className=\"px-2\">\n        <Card className=\"rounded-[40px] border-border/50 overflow-hidden shadow-premium group\">\n          <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 relative\">\n            <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n              <Monitor weight=\"fill\" className=\"w-64 h-64 text-primary\" />\n            </div>\n            <div className=\"flex items-center gap-5 relative z-10\">\n              <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm shadow-inner group-hover:bg-primary/20 transition-all\">\n                <Pulse weight=\"duotone\" className=\"w-7 h-7\" />\n              </div>\n              <div>\n                <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Identity Intelligence Matrix</CardTitle>\n                <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] mt-1\">Granular behavioral telemetry</p>\n              </div>\n            </div>\n          </CardHeader>\n\n          <CardContent className=\"p-0\">\n            <ResponsiveTable\n              columns={columns}\n              data={analytics}\n              loading={loading}\n              rowKey={(a) => a.id}\n              emptyMessage=\"Zero intelligence nodes detected in current operational segment.\"\n              mobileCard={(a) => (\n                <div className=\"space-y-5\">\n                  <div className=\"flex justify-between items-start\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"w-14 h-14 rounded-2xl bg-secondary border border-border flex items-center justify-center text-primary shadow-inner\">\n                        <Users weight=\"duotone\" className=\"w-7 h-7\" />\n                      </div>\n                      <div className=\"min-w-0\">\n                        <p className=\"font-bold text-foreground truncate uppercase tracking-tight leading-tight\">{a.customer?.full_name || 'ANONYMOUS_NODE'}</p>\n                        <Badge variant=\"ghost\" className={cn(\"border-none font-black text-[7px] tracking-widest uppercase px-2 py-0.5 mt-1 shadow-sm\", getSegmentStyle(a.customer_segment))}>\n                          {getSegmentLabel(a.customer_segment)}\n                        </Badge>\n                      </div>\n                    </div>\n                    <div className=\"text-right\">\n                      <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest opacity-40\">Valuation</p>\n                      <p className=\"text-base font-black text-emerald-500 tabular-nums\">๏ฟฝ{a.lifetime_value.toLocaleString()}</p>\n                    </div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-6 py-4 border-y border-border/50\">\n                    <div className=\"space-y-1\">\n                      <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em]\">Risk Profile</p>\n                      <div className=\"flex items-center gap-2\">\n                        <div className=\"h-1.5 flex-1 bg-secondary rounded-full overflow-hidden p-0.5 border border-border/30 shadow-inner\">\n                          <div \n                            className={cn(\n                              \"h-full rounded-full transition-all duration-1000\",\n                              a.churn_risk_score > 0.7 ? 'bg-rose-500' : a.churn_risk_score > 0.4 ? 'bg-amber-500' : 'bg-emerald-500'\n                            )}\n                            style={{ width: \\\\%\\ }}\n                          />\n                        </div>\n                        <span className=\"text-[10px] font-black text-foreground tabular-nums\">{Math.round(a.churn_risk_score * 100)}%</span>\n                      </div>\n                    </div>\n                    <div className=\"space-y-1 text-right\">\n                      <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em]\">Temporal Delta</p>\n                      <p className=\"text-xs font-bold text-foreground tabular-nums uppercase\">{a.days_since_last_visit} DAYS</p>\n                    </div>\n                  </div>\n\n                  <div className=\"flex justify-between items-center pt-1 text-[9px] font-black text-muted-foreground uppercase tracking-widest\">\n                    <div className=\"flex items-center gap-2\">\n                      <Pulse weight=\"bold\" className=\"w-3 h-3 opacity-40\" />\n                      Activity: {a.total_visits} CYCLES\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <CurrencyDollar weight=\"bold\" className=\"w-3 h-3 opacity-40\" />\n                      AOV: ๏ฟฝ{a.average_order_value.toLocaleString()}\n                    </div>\n                  </div>\n                </div>\n              )}\n            />\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Intelligence Note */}\n      <Card className=\"mx-2 p-8 rounded-[40px] border-primary/10 bg-primary/[0.02] flex flex-col md:flex-row items-center gap-8 relative overflow-hidden group shadow-inner\">\n        <div className=\"absolute -bottom-12 -right-12 w-48 h-48 bg-primary/5 blur-[60px] rounded-full group-hover:bg-primary/10 transition-all duration-700\" />\n        <div className=\"w-16 h-16 rounded-[28px] bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner group-hover:scale-110 transition-transform\">\n          <Sparkle weight=\"duotone\" className=\"w-8 h-8\" />\n        </div>\n        <div className=\"flex-1 space-y-1 relative z-10 text-center md:text-left\">\n          <h4 className=\"text-[10px] font-black text-foreground uppercase tracking-[0.3em]\">Predictive Protocol Intelligence</h4>\n          <p className=\"text-xs text-muted-foreground font-medium italic leading-relaxed opacity-80\">\n            Identity segments are autonomously synthesized using multi-dimensional behavior nodes. CLV deltas propagate across the fiscal ledger in real-time.\n          </p>\n        </div>\n        <Badge variant=\"success\" size=\"sm\" className=\"font-black text-[9px] tracking-[0.2em] px-5 py-2 rounded-full shadow-sm relative z-10\">CORE_SYNC_ACTIVE</Badge>\n      </Card>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\appointments\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Invalid character.","line":70,"column":53}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { \n  CaretLeft, \n  CaretRight, \n  Plus, \n  Clock, \n  User,\n  DotsThree,\n  CalendarDots,\n  SpinnerGap,\n  Warning,\n  ArrowLeft,\n  Calendar,\n  CheckCircle,\n  Activity,\n  IdentificationBadge,\n  Briefcase,\n  Monitor,\n  ArrowsClockwise,\n  ArrowRight,\n  Sparkle,\n  Icon,\n  DotsThreeVertical\n} from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { useTranslations } from 'next-intl';\nimport { cn } from '@/lib/utils';\nimport { useState, useEffect, useCallback, Suspense, useMemo } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport AppointmentModal from '@/components/AppointmentModal';\n\ninterface Appointment {\n  id: string;\n  appointment_date: string;\n  start_time: string;\n  end_time: string;\n  status: string;\n  appointment_type: string;\n  customer: {\n    id: string;\n    full_name: string;\n    nickname?: string;\n    phone?: string;\n  };\n  staff: {\n    id: string;\n    full_name: string;\n  };\n}\n\nexport default function AppointmentPage() {\n  const { goBack } = useBackNavigation();\n  const t = useTranslations('clinic.appointments' as any);\n  const [appointments, setAppointments] = useState<Appointment[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [selectedAppointment, setSelectedAppointment] = useState<Appointment | undefined>(undefined);\n\n  const fetchAppointments = useCallback(async () => {\n    setLoading(true);\n    try {\n      const dateStr = selectedDate.toISOString().split('T')[0];\n      const res = await fetch(/api/appointments?date=\\);\n      const result = await res.json();\n      if (result.success) {\n        setAppointments(result.data);\n      }\n    } catch (err) {\n      console.error('Error fetching appointments:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [selectedDate]);\n\n  useEffect(() => {\n    fetchAppointments();\n  }, [fetchAppointments]);\n\n  const handleAddAppointment = () => {\n    setSelectedAppointment(undefined);\n    setIsModalOpen(true);\n  };\n\n  const handleEditAppointment = (apt: Appointment) => {\n    setSelectedAppointment(apt);\n    setIsModalOpen(true);\n  };\n\n  const changeDate = (days: number) => {\n    const newDate = new Date(selectedDate);\n    newDate.setDate(newDate.getDate() + days);\n    setSelectedDate(newDate);\n  };\n\n  // Calendar logic\n  const daysInMonth = (date: Date) => new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();\n  const startDayOfMonth = (date: Date) => new Date(date.getFullYear(), date.getMonth(), 1).getDay();\n  \n  const calendarDays = useMemo(() => {\n    const days = [];\n    const totalDays = daysInMonth(selectedDate);\n    const offset = startDayOfMonth(selectedDate);\n    for (let i = 0; i < offset; i++) days.push(null);\n    for (let i = 1; i <= totalDays; i++) days.push(i);\n    return days;\n  }, [selectedDate]);\n\n  const stats = useMemo(() => ({\n    total: appointments.length,\n    confirmed: appointments.filter(a => a.status === 'confirmed').length,\n    pending: appointments.filter(a => a.status === 'pending' || a.status === 'scheduled').length,\n    completed: appointments.filter(a => a.status === 'completed').length\n  }), [appointments]);\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\\\"space-y-8 pb-20 font-sans\\\"\n    >\n      <Breadcrumb />\n      \n      <AppointmentModal \n        isOpen={isModalOpen}\n        onClose={() => setIsModalOpen(false)}\n        onSuccess={fetchAppointments}\n        appointment={selectedAppointment}\n        selectedDate={selectedDate}\n      />\n\n      {/* Header Section */}\n      <div className=\\\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\\\">\n        <div className=\\\"space-y-1\\\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\\\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\\\"\n          >\n            <CalendarDots weight=\\\"duotone\\\" className=\\\"w-4 h-4\\\" />\n            Temporal Orchestration Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\\\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\\\"\n          >\n            Appointment <span className=\\\"text-primary\\\">Calendar</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\\\"text-muted-foreground font-light text-sm italic\\\"\n          >\n            Scheduling clinical transformations and cognitive consultations across temporal nodes.\n          </motion.p>\n        </div>\n\n        <div className=\\\"flex items-center gap-3\\\">\n          <Button \n            variant=\\\"outline\\\"\n            onClick={fetchAppointments}\n            disabled={loading}\n            className=\\\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\\\"\n          >\n            <ArrowsClockwise weight=\\\"bold\\\" className={cn(\\\"w-4 h-4\\\", loading && \\\"animate-spin\\\")} />\n            Sync Schedule\n          </Button>\n          <Button \n            onClick={handleAddAppointment}\n            className=\\\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\\\"\n          >\n            <Plus weight=\\\"bold\\\" className=\\\"w-4 h-4\\\" />\n            Initialize Node\n          </Button>\n        </div>\n      </div>\n\n      {/* Stats Summary */}\n      <div className=\\\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\\\">\n        <StatCard\n          title=\\\"Daily Node Load\\\"\n          value={stats.total}\n          icon={Monitor as Icon}\n          className=\\\"p-4\\\"\n        />\n        <StatCard\n          title=\\\"Confirmed Cycles\\\"\n          value={stats.confirmed}\n          icon={CheckCircle as Icon}\n          iconColor=\\\"text-emerald-500\\\"\n          className=\\\"p-4\\\"\n        />\n        <StatCard\n          title=\\\"Awaiting Sync\\\"\n          value={stats.pending}\n          icon={Clock as Icon}\n          iconColor=\\\"text-amber-500\\\"\n          className=\\\"p-4\\\"\n        />\n        <StatCard\n          title=\\\"Completed Nodes\\\"\n          value={stats.completed}\n          icon={CheckCircle as Icon}\n          iconColor=\\\"text-primary\\\"\n          className=\\\"p-4\\\"\n        />\n      </div>\n\n      <div className=\\\"grid grid-cols-1 xl:grid-cols-4 gap-10 px-2\\\">\n        {/* Calendar Sidebar */}\n        <div className=\\\"xl:col-span-1 space-y-8\\\">\n          <Card className=\\\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\\\">\n            <CardHeader className=\\\"p-8 border-b border-border/50 bg-secondary/30 flex flex-row items-center justify-between\\\">\n              <CardTitle className=\\\"text-sm font-black uppercase tracking-widest text-foreground truncate\\\">\n                {selectedDate.toLocaleString('default', { month: 'long', year: 'numeric' })}\n              </CardTitle>\n              <div className=\\\"flex gap-1\\\">\n                <Button \n                  variant=\\\"ghost\\\" \n                  size=\\\"sm\\\"\n                  onClick={() => {\n                    const d = new Date(selectedDate);\n                    d.setMonth(d.getMonth() - 1);\n                    setSelectedDate(d);\n                  }}\n                  className=\\\"h-8 w-8 p-0 rounded-xl hover:bg-primary/10 text-muted-foreground hover:text-primary\\\"\n                >\n                  <CaretLeft weight=\\\"bold\\\" className=\\\"w-4 h-4\\\" />\n                </Button>\n                <Button \n                  variant=\\\"ghost\\\" \n                  size=\\\"sm\\\"\n                  onClick={() => {\n                    const d = new Date(selectedDate);\n                    d.setMonth(d.getMonth() + 1);\n                    setSelectedDate(d);\n                  }}\n                  className=\\\"h-8 w-8 p-0 rounded-xl hover:bg-primary/10 text-muted-foreground hover:text-primary\\\"\n                >\n                  <CaretRight weight=\\\"bold\\\" className=\\\"w-4 h-4\\\" />\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent className=\\\"p-8\\\">\n              <div className=\\\"grid grid-cols-7 gap-1 text-center mb-4\\\">\n                {['S', 'M', 'T', 'W', 'T', 'F', 'S'].map((day, index) => (\n                  <span key={index} className=\\\"text-[10px] font-black text-muted-foreground/40 uppercase tracking-widest py-2\\\">{day}</span>\n                ))}\n                {calendarDays.map((day, i) => (\n                  <button \n                    key={i} \n                    onClick={() => {\n                      if (day) {\n                        const d = new Date(selectedDate);\n                        d.setDate(day);\n                        setSelectedDate(d);\n                      }\n                    }}\n                    className={cn(\n                      \\\"aspect-square text-[11px] font-black rounded-xl flex items-center justify-center transition-all border\\\",\n                      day === selectedDate.getDate() \n                        ? \\\"bg-primary text-white border-primary shadow-premium\\\" \n                        : day \n                          ? \\\"text-foreground hover:bg-secondary border-transparent hover:border-border/50\\\"\n                          : \\\"opacity-0 pointer-events-none\\\"\n                    )}\n                  >\n                    {day}\n                  </button>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\\\"p-8 rounded-[40px] border-primary/10 bg-primary/[0.02] space-y-4 group overflow-hidden relative\\\">\n            <div className=\\\"absolute -bottom-12 -right-12 w-32 h-32 bg-primary/5 blur-[50px] rounded-full group-hover:bg-primary/10 transition-all duration-700\\\" />\n            <div className=\\\"flex items-center gap-3 relative z-10\\\">\n              <Sparkle weight=\\\"duotone\\\" className=\\\"w-5 h-5 text-primary group-hover:scale-110 transition-transform\\\" />\n              <h4 className=\\\"text-[10px] font-black text-primary uppercase tracking-[0.3em]\\\">Temporal Intel</h4>\n            </div>\n            <p className=\\\"text-xs text-muted-foreground italic font-medium leading-relaxed relative z-10\\\">\n              Optimal diagnostic throughput detected in afternoon temporal slots. Protocol efficiency +12.4% during peak nodes.\n            </p>\n          </Card>\n        </div>\n\n        {/* Schedule List */}\n        <div className=\\\"xl:col-span-3 space-y-8\\\">\n          <div className=\\\"flex flex-col sm:flex-row sm:items-center justify-between gap-6 bg-secondary/30 p-2 rounded-[32px] border border-border/50 shadow-inner\\\">\n            <div className=\\\"flex items-center gap-1.5 overflow-x-auto pb-1 sm:pb-0 no-scrollbar px-2\\\">\n              {['All Nodes', 'Confirmed', 'Scheduled', 'Processing', 'Completed'].map((tab, i) => (\n                <button \n                  key={tab} \n                  className={cn(\n                    \\\"px-6 py-3 rounded-[20px] text-[10px] font-black uppercase tracking-widest whitespace-nowrap transition-all border\\\",\n                    i === 0 \n                      ? \\\"bg-card text-primary border-border/50 shadow-sm\\\" \n                      : \\\"text-muted-foreground border-transparent hover:bg-card/50 hover:text-foreground\\\"\n                  )}\n                >\n                  {tab}\n                </button>\n              ))}\n            </div>\n            <div className=\\\"flex items-center gap-6 bg-card border border-border/50 px-6 py-3 rounded-[24px] shadow-premium mr-2\\\">\n              <button onClick={() => changeDate(-1)} className=\\\"text-muted-foreground hover:text-primary transition-colors active:scale-90\\\"><CaretLeft weight=\\\"bold\\\" className=\\\"w-4 h-4\\\" /></button>\n              <span className=\\\"text-[11px] font-black uppercase tracking-widest text-foreground min-w-[140px] text-center\\\">\n                {selectedDate.toLocaleDateString(undefined, { weekday: 'short', day: 'numeric', month: 'short' })}\n              </span>\n              <button onClick={() => changeDate(1)} className=\\\"text-muted-foreground hover:text-primary transition-colors active:scale-90\\\"><CaretRight weight=\\\"bold\\\" className=\\\"w-4 h-4\\\" /></button>\n            </div>\n          </div>\n\n          <div className=\\\"grid grid-cols-1 gap-6\\\">\n            {loading ? (\n              <div className=\\\"py-32 flex flex-col items-center justify-center gap-4\\\">\n                <SpinnerGap className=\\\"w-10 h-10 text-primary animate-spin\\\" />\n                <p className=\\\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\\\">Synchronizing Temporal Grid...</p>\n              </div>\n            ) : appointments.length === 0 ? (\n              <Card variant=\\\"ghost\\\" className=\\\"py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-6 opacity-40 rounded-[40px]\\\">\n                <CalendarDots weight=\\\"duotone\\\" className=\\\"w-16 h-16 text-muted-foreground\\\" />\n                <p className=\\\"text-sm font-black uppercase tracking-widest text-center\\\">Zero Operational Nodes Detected In This Cycle</p>\n              </Card>\n            ) : (\n              <AnimatePresence mode=\\\"popLayout\\\">\n                {appointments.map((apt, i) => (\n                  <motion.div\n                    key={apt.id}\n                    layout\n                    initial={{ opacity: 0, x: 20 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    exit={{ opacity: 0, scale: 0.95 }}\n                    transition={{ delay: i * 0.05 }}\n                  >\n                    <Card className=\\\"rounded-[40px] border-border/50 hover:border-primary/30 transition-all group overflow-hidden bg-card/50\\\">\n                      <div className=\\\"absolute top-0 left-0 w-1.5 h-full bg-primary opacity-0 group-hover:opacity-100 transition-all duration-500\\\" />\n                      <div className=\\\"p-8 flex flex-col md:flex-row md:items-center justify-between gap-8 relative z-10\\\">\n                        <div className=\\\"flex items-center gap-10\\\">\n                          <div className=\\\"w-20 flex flex-col items-center gap-1.5\\\">\n                            <p className=\\\"text-2xl font-black text-foreground group-hover:text-primary transition-colors tracking-tighter tabular-nums\\\">\n                              {apt.start_time.substring(0, 5)}\n                            </p>\n                            <Badge variant=\\\"ghost\\\" className=\\\"bg-primary/5 text-primary border-none font-black text-[8px] tracking-widest uppercase px-2\\\">CYCLE_START</Badge>\n                          </div>\n                          \n                          <div className=\\\"h-14 w-px bg-border/50 hidden md:block\\\" />\n\n                          <div className=\\\"flex items-center gap-6 min-w-0\\\">\n                            <div className=\\\"w-16 h-16 rounded-3xl bg-secondary border border-border flex items-center justify-center text-primary group-hover:bg-primary/10 transition-all duration-500 shadow-inner\\\">\n                              <User weight=\\\"duotone\\\" className=\\\"w-8 h-8\\\" />\n                            </div>\n                            <div className=\\\"space-y-1.5 min-w-0\\\">\n                              <h3 className=\\\"text-xl font-black text-foreground tracking-tight truncate uppercase\\\">\n                                {apt.customer?.full_name} {apt.customer?.nickname ? <span className=\\\"text-muted-foreground/40 font-bold ml-1 text-sm\\\">[{apt.customer.nickname.toUpperCase()}]</span> : ''}\n                              </h3>\n                              <div className=\\\"flex flex-wrap items-center gap-3\\\">\n                                <Badge variant=\\\"ghost\\\" className=\\\"bg-secondary text-muted-foreground border-none font-black text-[8px] tracking-widest uppercase px-3 py-1\\\">\n                                  {apt.appointment_type}\n                                </Badge>\n                                <div className=\\\"flex items-center gap-2 text-[9px] font-black text-muted-foreground uppercase tracking-widest\\\">\n                                  <Clock weight=\\\"bold\\\" className=\\\"w-3.5 h-3.5 opacity-60\\\" />\n                                  60M Node\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n\n                        <div className=\\\"flex flex-wrap items-center gap-8 md:gap-12\\\">\n                          <div className=\\\"flex flex-col md:items-end gap-1.5 min-w-[120px]\\\">\n                            <p className=\\\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em]\\\">Practitioner</p>\n                            <div className=\\\"flex items-center gap-2.5\\\">\n                              <div className=\\\"w-2 h-2 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.6)]\\\" />\n                              <span className=\\\"text-sm font-bold text-foreground uppercase tracking-tight\\\">{apt.staff?.full_name}</span>\n                            </div>\n                          </div>\n\n                          <Badge variant={apt.status === 'confirmed' || apt.status === 'completed' ? 'success' : 'warning'} className=\\\"font-black uppercase tracking-[0.2em] px-6 py-2.5 text-[10px] rounded-full shadow-sm\\\">\n                            <div className=\\\"flex items-center gap-2.5\\\">\n                              <div className={cn(\\\"w-1.5 h-1.5 rounded-full\\\", apt.status === 'confirmed' || apt.status === 'completed' ? \\\"bg-emerald-500 animate-pulse\\\" : \\\"bg-amber-500\\\")} />\n                              {apt.status}\n                            </div>\n                          </Badge>\n\n                          <div className=\\\"flex items-center gap-2\\\">\n                            <Button \n                              variant=\\\"ghost\\\" \n                              size=\\\"sm\\\"\n                              onClick={() => handleEditAppointment(apt)}\n                              className=\\\"h-12 w-12 p-0 rounded-2xl hover:bg-secondary border border-border/50 text-muted-foreground hover:text-foreground transition-all\\\"\n                            >\n                              <DotsThreeVertical weight=\\\"bold\\\" className=\\\"w-6 h-6\\\" />\n                            </Button>\n                          </div>\n                        </div>\n                      </div>\n                    </Card>\n                  </motion.div>\n                ))}\n              </AnimatePresence>\n            )}\n          </div>\n        </div>\n      </div>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\branches\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":4,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AnimatePresence"},"fix":{"range":[101,118],"text":""},"desc":"Remove unused variable \"AnimatePresence\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DotsThreeVertical' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":20,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"DotsThreeVertical"},"fix":{"range":[249,272],"text":""},"desc":"Remove unused variable \"DotsThreeVertical\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle"},"fix":{"range":[288,304],"text":""},"desc":"Remove unused variable \"CheckCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[345,359],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":28,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[761,794],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":45,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":46,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":46,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1238,1241],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1238,1241],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect, useCallback, Suspense } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { \r\n  Buildings, \r\n  Plus, \r\n  MagnifyingGlass, \r\n  MapPin, \r\n  Phone, \r\n  PencilSimple, \r\n  Trash, \r\n  DotsThreeVertical, \r\n  SpinnerGap,\r\n  CheckCircle,\r\n  Clock,\r\n  SquaresFour,\r\n  MapTrifold,\r\n  ArrowLeft,\r\n  CaretRight\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { cn } from '@/lib/utils';\r\nimport BranchModal from '@/components/BranchModal';\r\nimport { useTranslations } from 'next-intl';\r\n\r\ninterface Branch {\r\n  id: string;\r\n  branch_name: string;\r\n  branch_code: string;\r\n  address: string;\r\n  city: string;\r\n  province: string;\r\n  phone?: string;\r\n  is_active: boolean;\r\n  created_at: string;\r\n}\r\n\r\nfunction BranchManagementContent() {\r\n  const { goBack } = useBackNavigation();\r\n  const t = useTranslations('clinic.branches' as any);\r\n  const [branches, setBranches] = useState<Branch[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [selectedBranch, setSelectedBranch] = useState<Branch | undefined>(undefined);\r\n\r\n  const fetchBranches = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch('/api/branches');\r\n      const result = await res.json();\r\n      if (result.success) {\r\n        setBranches(result.data || []);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching branches:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchBranches();\r\n  }, [fetchBranches]);\r\n\r\n  const handleAddBranch = () => {\r\n    setSelectedBranch(undefined);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleEditBranch = (branch: Branch) => {\r\n    setSelectedBranch(branch);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleDeleteBranch = async (id: string) => {\r\n    if (!confirm('Are you sure you want to terminate this branch node? This action cannot be reversed.')) return;\r\n    \r\n    try {\r\n      const res = await fetch(`/api/branches/${id}`, { method: 'DELETE' });\r\n      const result = await res.json();\r\n      if (result.success) {\r\n        fetchBranches();\r\n      }\r\n    } catch (err) {\r\n      console.error('Error deleting branch:', err);\r\n    }\r\n  };\r\n\r\n  const filteredBranches = branches.filter(branch => \r\n    branch.branch_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    branch.branch_code.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    branch.city.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n      \r\n      <BranchModal \r\n        isOpen={isModalOpen}\r\n        onClose={() => setIsModalOpen(false)}\r\n        onSuccess={fetchBranches}\r\n        branch={selectedBranch}\r\n      />\r\n\r\n      {/* Header */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Buildings weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Clinical Expansion Node\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight\"\r\n          >\r\n            Branch <span className=\"text-primary\">Orchestration</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Managing multi-geographic operational clusters and regional telemetry modules.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <Button \r\n          onClick={handleAddBranch}\r\n          className=\"gap-2 shadow-premium px-8\"\r\n        >\r\n          <Plus weight=\"bold\" className=\"w-4 h-4\" />\r\n          Initialize Branch\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Search & Stats */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-8\">\r\n        <div className=\"lg:col-span-3\">\r\n          <div className=\"relative group\">\r\n            <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-2xl\" />\r\n            <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\r\n            <input \r\n              type=\"text\" \r\n              placeholder=\"Filter by branch designation, code, or city...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3 pl-11 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\r\n            />\r\n          </div>\r\n        </div>\r\n        \r\n        <StatCard\r\n          title=\"Active Clusters\"\r\n          value={branches.length}\r\n          icon={SquaresFour}\r\n          trend=\"neutral\"\r\n          className=\"p-4\"\r\n        />\r\n      </div>\r\n\r\n      {/* Branch Grid */}\r\n      <div className=\"space-y-6\">\r\n        {loading ? (\r\n          <div className=\"py-32 flex flex-col items-center gap-4\">\r\n            <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Syncing Expansion Grid...</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8\">\r\n            {filteredBranches.map((branch, i) => (\r\n              <motion.div\r\n                key={branch.id}\r\n                initial={{ opacity: 0, scale: 0.95, y: 20 }}\r\n                animate={{ opacity: 1, scale: 1, y: 0 }}\r\n                transition={{ delay: i * 0.05 }}\r\n              >\r\n                <Card className=\"h-full border-border/50 hover:border-primary/30 transition-all group overflow-hidden flex flex-col\">\r\n                  <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                    <MapTrifold className=\"w-32 h-32 text-primary\" />\r\n                  </div>\r\n\r\n                  <CardHeader className=\"pb-4 relative z-10\">\r\n                    <div className=\"flex justify-between items-start gap-4\">\r\n                      <div className=\"flex items-center gap-4 min-w-0\">\r\n                        <div className=\"w-14 h-14 rounded-2xl bg-secondary/50 border border-border flex items-center justify-center text-primary group-hover:bg-primary/10 transition-all duration-500 shadow-sm\">\r\n                          <Buildings weight=\"duotone\" className=\"w-7 h-7\" />\r\n                        </div>\r\n                        <div className=\"min-w-0 space-y-1\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <Badge variant=\"ghost\" size=\"sm\" className=\"font-mono text-[9px] px-2 py-0.5 border-none bg-primary/5 text-primary\">{branch.branch_code}</Badge>\r\n                            <Badge variant={branch.is_active ? 'success' : 'secondary'} size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest\">\r\n                              {branch.is_active ? 'Operational' : 'Offline'}\r\n                            </Badge>\r\n                          </div>\r\n                          <CardTitle className=\"text-xl font-bold tracking-tight truncate\">{branch.branch_name}</CardTitle>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"flex gap-1\">\r\n                        <Button \r\n                          variant=\"ghost\" \r\n                          size=\"sm\" \r\n                          onClick={() => handleEditBranch(branch)}\r\n                          className=\"p-2 h-9 w-9 text-muted-foreground hover:text-primary\"\r\n                        >\r\n                          <PencilSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n                        </Button>\r\n                        <Button \r\n                          variant=\"ghost\" \r\n                          size=\"sm\" \r\n                          onClick={() => handleDeleteBranch(branch.id)}\r\n                          className=\"p-2 h-9 w-9 text-muted-foreground hover:text-rose-500 hover:bg-rose-500/5\"\r\n                        >\r\n                          <Trash weight=\"bold\" className=\"w-4 h-4\" />\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  </CardHeader>\r\n\r\n                  <CardContent className=\"flex-1 space-y-6 relative z-10 flex flex-col justify-between\">\r\n                    <div className=\"space-y-4\">\r\n                      <div className=\"flex items-start gap-3 p-4 bg-secondary/30 rounded-2xl border border-border/50 group-hover:border-primary/20 transition-all\">\r\n                        <MapPin weight=\"duotone\" className=\"w-5 h-5 text-primary shrink-0 mt-0.5\" />\r\n                        <p className=\"text-sm text-foreground/70 font-medium leading-relaxed italic\">\r\n                          {branch.address}, {branch.city}, {branch.province}\r\n                        </p>\r\n                      </div>\r\n                      {branch.phone && (\r\n                        <div className=\"flex items-center gap-3 px-4 py-2\">\r\n                          <Phone weight=\"duotone\" className=\"w-4 h-4 text-primary/60 shrink-0\" />\r\n                          <p className=\"text-sm text-foreground font-bold tabular-nums\">{branch.phone}</p>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    <div className=\"pt-6 border-t border-border/50 flex items-center justify-between\">\r\n                      <div className=\"flex items-center gap-2 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\r\n                        <Clock weight=\"bold\" className=\"w-3.5 h-3.5 opacity-60\" />\r\n                        Established: {new Date(branch.created_at).toLocaleDateString()}\r\n                      </div>\r\n                      <Button variant=\"ghost\" size=\"sm\" className=\"text-primary font-black uppercase text-[10px] tracking-widest gap-2\">\r\n                        View Node <CaretRight weight=\"bold\" className=\"w-3 h-3\" />\r\n                      </Button>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </motion.div>\r\n            ))}\r\n\r\n            {filteredBranches.length === 0 && !loading && (\r\n              <Card variant=\"ghost\" className=\"col-span-full py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-4 opacity-40\">\r\n                <Buildings weight=\"duotone\" className=\"w-16 h-16\" />\r\n                <p className=\"text-xs font-black uppercase tracking-widest\">Zero Operational Clusters Detected</p>\r\n              </Card>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n\r\nexport default function BranchManagement() {\r\n  return (\r\n    <Suspense fallback={\r\n      <div className=\"h-[80vh] flex flex-col items-center justify-center space-y-6\">\r\n        <SpinnerGap className=\"w-12 h-12 text-primary animate-spin\" />\r\n        <p className=\"text-sm font-black uppercase tracking-[0.3em] text-muted-foreground animate-pulse\">Initializing Expansion Grid...</p>\r\n      </div>\r\n    }>\r\n      <BranchManagementContent />\r\n    </Suspense>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\chat\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Monitor' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Monitor"},"fix":{"range":[153,165],"text":""},"desc":"Remove unused variable \"Monitor\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChatCircleText' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":17,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ChatCircleText"},"fix":{"range":[165,184],"text":""},"desc":"Remove unused variable \"ChatCircleText\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":22,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[184,208],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[208,222],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":4,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"X"},"fix":{"range":[222,228],"text":""},"desc":"Remove unused variable \"X\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":20,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":15,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Badge"},"fix":{"range":[345,391],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useTranslations' is defined but never used.","line":24,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":25,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"useTranslations"},"fix":{"range":[561,605],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":26,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":38,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useMemo"},"fix":{"range":[670,679],"text":""},"desc":"Remove unused variable \"useMemo\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SVGProps' is defined but never used.","line":26,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":48,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"SVGProps"},"fix":{"range":[679,689],"text":""},"desc":"Remove unused variable \"SVGProps\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":38,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { \r\n  PaperPlaneTilt, \r\n  Sparkle, \r\n  User, \r\n  Robot,\r\n  ClockCounterClockwise,\r\n  Info,\r\n  Pulse,\r\n  ShieldCheck,\r\n  Lightning,\r\n  Monitor,\r\n  ChatCircleText,\r\n  IdentificationBadge,\r\n  ArrowLeft,\r\n  X\r\n} from '@phosphor-icons/react';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { useTranslations } from 'next-intl';\r\nimport { cn } from '@/lib/utils';\r\nimport { useState, useEffect, useMemo, SVGProps } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\n// Format time consistently to avoid hydration mismatch\r\nfunction formatTime(timestamp: number): string {\r\n  const date = new Date(timestamp);\r\n  const hours = date.getHours().toString().padStart(2, '0');\r\n  const minutes = date.getMinutes().toString().padStart(2, '0');\r\n  return `${hours}:${minutes}`;\r\n}\r\n\r\nexport default function ChatAdvisor() {\r\n  const { goBack } = useBackNavigation();\r\n  const [isClient, setIsClient] = useState(false);\r\n  const [messages, setMessages] = useState([\r\n    { id: 1, role: 'assistant', content: 'เธชเธงเธฑเธชเธ”เธตเธเธฃเธฑเธ เธเธก BN-Aura AI Advisor เธขเธดเธเธ”เธตเธ—เธตเนเนเธ”เนเธเธฃเธดเธเธฒเธฃเธเธฃเธฑเธ เธงเธฑเธเธเธตเนเธกเธตเน€เธเธชเธฅเธนเธเธเนเธฒเธ—เนเธฒเธเนเธซเธเนเธซเนเธเธกเธเนเธงเธขเธงเธดเน€เธเธฃเธฒเธฐเธซเนเธเนเธญเธกเธนเธฅเธซเธฃเธทเธญเนเธเธฐเธเธณเนเธเธฃเนเธเธฃเธกเธเธฒเธฃเธฃเธฑเธเธฉเธฒเนเธซเธกเธเธฃเธฑเธ?' },\r\n  ]);\r\n  const [input, setInput] = useState('');\r\n  \r\n  useEffect(() => {\r\n    setIsClient(true);\r\n  }, []);\r\n\r\n  const handleSend = () => {\r\n    if (!input.trim()) return;\r\n    \r\n    const newMsg = { id: Date.now(), role: 'user', content: input };\r\n    setMessages(prev => [...prev, newMsg]);\r\n    setInput('');\r\n\r\n    // Simulate AI thinking\r\n    setTimeout(() => {\r\n      setMessages(prev => [...prev, { \r\n        id: Date.now() + 1, \r\n        role: 'assistant', \r\n        content: 'เธเธกเนเธ”เนเธฃเธฑเธเธเนเธญเธกเธนเธฅเนเธฅเนเธงเธเธฃเธฑเธ เธเธณเธฅเธฑเธเธเธฃเธฐเธกเธงเธฅเธเธฅเธเธงเธฒเธกเธชเธญเธ”เธเธฅเนเธญเธเธฃเธฐเธซเธงเนเธฒเธเธเธฅเธเธฒเธฃเธชเนเธเธเธเธดเธงเนเธฅเธฐเธเธฃเธฐเธงเธฑเธ•เธดเธซเธฑเธ•เธ–เธเธฒเธฃเน€เธ”เธดเธกเธเธญเธเธฅเธนเธเธเนเธฒเธเธฃเธนเนเธซเธเธถเนเธเธเธฃเธฑเธ...' \r\n      }]);\r\n    }, 1000);\r\n  };\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"h-[calc(100vh-120px)] flex flex-col space-y-8 pb-6 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"flex items-center gap-5\">\r\n          <div className=\"w-16 h-16 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-premium\">\r\n            <Robot weight=\"duotone\" className=\"w-9 h-9\" />\r\n          </div>\r\n          <div className=\"space-y-1\">\r\n            <motion.div \r\n              initial={{ opacity: 0, x: -20 }}\r\n              animate={{ opacity: 1, x: 0 }}\r\n              className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n            >\r\n              <Sparkle weight=\"bold\" className=\"w-3 h-3 animate-pulse\" />\r\n              Cognitive Reasoning Node\r\n            </motion.div>\r\n            <h1 className=\"text-3xl font-heading font-bold text-foreground uppercase tracking-tight\">AI Chat <span className=\"text-primary\">Advisor</span></h1>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex gap-3\">\r\n          <Button \r\n            variant=\"outline\"\r\n            className=\"p-3 h-12 w-12 border-border/50 rounded-2xl hover:bg-secondary group\"\r\n          >\r\n            <ClockCounterClockwise weight=\"bold\" className=\"w-5 h-5 group-hover:rotate-[-10deg] transition-transform\" />\r\n          </Button>\r\n          <Button \r\n            variant=\"outline\"\r\n            className=\"p-3 h-12 w-12 border-border/50 rounded-2xl hover:bg-secondary group\"\r\n          >\r\n            <Info weight=\"bold\" className=\"w-5 h-5 group-hover:scale-110 transition-transform\" />\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex-1 grid grid-cols-1 lg:grid-cols-4 gap-8 overflow-hidden px-2\">\r\n        {/* Chat Interface Node */}\r\n        <Card className=\"lg:col-span-3 rounded-[48px] border-border/50 flex flex-col overflow-hidden relative shadow-premium bg-secondary/10\">\r\n          <div className=\"absolute inset-0 bg-scanner-grid opacity-[0.02] pointer-events-none\" />\r\n          \r\n          {/* Messages Neural Area */}\r\n          <div className=\"flex-1 overflow-y-auto p-8 space-y-10 custom-scrollbar relative z-10\">\r\n            <AnimatePresence initial={false}>\r\n              {messages.map((msg) => (\r\n                <motion.div\r\n                  key={msg.id}\r\n                  initial={{ opacity: 0, y: 20, scale: 0.98 }}\r\n                  animate={{ opacity: 1, y: 0, scale: 1 }}\r\n                  transition={{ duration: 0.4 }}\r\n                  className={cn(\r\n                    \"flex w-full\",\r\n                    msg.role === 'user' ? \"justify-end\" : \"justify-start\"\r\n                  )}\r\n                >\r\n                  <div className={cn(\r\n                    \"flex gap-5 max-w-[85%]\",\r\n                    msg.role === 'user' ? \"flex-row-reverse\" : \"flex-row\"\r\n                  )}>\r\n                    <div className={cn(\r\n                      \"w-12 h-12 rounded-2xl flex-shrink-0 flex items-center justify-center border transition-all duration-500 shadow-inner\",\r\n                      msg.role === 'user' \r\n                        ? \"bg-primary text-primary-foreground border-primary/20\" \r\n                        : \"bg-card text-primary border-border/50\"\r\n                    )}>\r\n                      {msg.role === 'user' ? <User weight=\"duotone\" className=\"w-6 h-6\" /> : <Robot weight=\"duotone\" className=\"w-6 h-6\" />}\r\n                    </div>\r\n                    <div className={cn(\r\n                      \"p-6 rounded-[32px] text-sm leading-relaxed shadow-premium transition-all duration-500\",\r\n                      msg.role === 'user' \r\n                        ? \"bg-primary text-primary-foreground font-bold rounded-tr-none\" \r\n                        : \"bg-card border border-border/50 text-foreground rounded-tl-none hover:border-primary/20\"\r\n                    )}>\r\n                      {msg.content}\r\n                      <p className={cn(\r\n                        \"text-[9px] mt-3 opacity-40 font-black uppercase tracking-widest\",\r\n                        msg.role === 'user' ? \"text-right\" : \"text-left\"\r\n                      )}>\r\n                        {isClient ? formatTime(msg.id) : '--:--'} โ€ข SYNC_OK\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </motion.div>\r\n              ))}\r\n            </AnimatePresence>\r\n          </div>\r\n\r\n          {/* Input Transmission Area */}\r\n          <div className=\"p-8 bg-secondary/30 border-t border-border/50 backdrop-blur-xl relative z-20\">\r\n            <div className=\"relative group\">\r\n              <div className=\"absolute inset-0 bg-primary/5 blur-2xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-[32px]\" />\r\n              <input\r\n                type=\"text\"\r\n                value={input}\r\n                onChange={(e) => setInput(e.target.value)}\r\n                onKeyDown={(e) => e.key === 'Enter' && handleSend()}\r\n                placeholder=\"Inquire about clinical cases or treatment optimization protocol...\"\r\n                className=\"w-full bg-card border border-border/50 rounded-[32px] py-6 pl-10 pr-24 text-foreground placeholder:text-muted-foreground/30 focus:outline-none focus:border-primary transition-all shadow-inner relative z-10 font-bold\"\r\n              />\r\n              <Button \r\n                onClick={handleSend}\r\n                disabled={!input.trim()}\r\n                className=\"absolute right-3 top-1/2 -translate-y-1/2 w-14 h-14 rounded-2xl shadow-premium hover:scale-105 disabled:opacity-30 transition-all z-20\"\r\n              >\r\n                <PaperPlaneTilt weight=\"bold\" className=\"w-6 h-6\" />\r\n              </Button>\r\n            </div>\r\n            <div className=\"mt-6 flex items-center justify-center gap-3 opacity-40\">\r\n              <ShieldCheck weight=\"fill\" className=\"w-3.5 h-3.5 text-emerald-500\" />\r\n              <p className=\"text-[9px] text-center text-muted-foreground font-black tracking-[0.3em] uppercase\">\r\n                Secure Neural Encryption Active โ€ข End-to-End Clinical Verification\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </Card>\r\n\r\n        {/* Sidebar Context Hub */}\r\n        <div className=\"hidden lg:flex flex-col gap-8\">\r\n          <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n            <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30\">\r\n              <CardTitle className=\"text-xs font-black uppercase tracking-[0.3em] flex items-center gap-3 text-primary\">\r\n                <Pulse weight=\"duotone\" className=\"w-5 h-5\" />\r\n                Active Context\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"p-8 space-y-8 relative overflow-hidden\">\r\n              <div className=\"absolute -bottom-12 -right-12 w-32 h-32 bg-primary/5 blur-[50px] rounded-full group-hover:bg-primary/10 transition-all\" />\r\n              \r\n              <div className=\"space-y-6 relative z-10\">\r\n                <div className=\"p-6 bg-primary/5 rounded-[32px] border border-primary/10 shadow-inner group-hover:border-primary/20 transition-all duration-500\">\r\n                  <p className=\"text-[9px] font-black text-primary uppercase tracking-[0.2em] mb-2\">Subject Node Focus</p>\r\n                  <p className=\"text-base font-black text-foreground tracking-tight uppercase\">Identity Hub <span className=\"text-[10px] text-muted-foreground ml-1\">#SYNC-2026</span></p>\r\n                </div>\r\n                \r\n                <div className=\"space-y-4\">\r\n                  <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Transmission History</p>\r\n                  <div className=\"space-y-3\">\r\n                    {[\r\n                      \"Neural Analysis (91%)\",\r\n                      \"Protocol: Pico Rejuvenation\"\r\n                    ].map((activity, i) => (\r\n                      <div key={i} className=\"flex gap-3 items-center group/item\">\r\n                        <div className=\"w-1.5 h-1.5 rounded-full bg-primary/40 group-hover/item:scale-150 transition-transform shadow-[0_0_8px_rgba(var(--primary),0.4)]\" />\r\n                        <span className=\"text-[11px] text-muted-foreground font-black uppercase tracking-widest\">{activity}</span>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card className=\"rounded-[40px] border-border/50 shadow-premium p-8 space-y-6 relative overflow-hidden group\">\r\n            <div className=\"absolute top-0 right-0 p-6 opacity-[0.03] group-hover:scale-110 transition-transform\">\r\n              <Lightning weight=\"fill\" className=\"w-24 h-24 text-primary\" />\r\n            </div>\r\n            <h3 className=\"text-xs font-black text-foreground uppercase tracking-[0.2em] relative z-10\">Neural Prompt Links</h3>\r\n            <div className=\"flex flex-wrap gap-2.5 relative z-10\">\r\n              {['Compare Nodes', \r\n                'Optimize Delta', \r\n                'Neural Logic', \r\n                'Fiscal Analysis'\r\n              ].map((tag) => (\r\n                <button \r\n                  key={tag} \r\n                  className=\"px-4 py-2.5 rounded-xl bg-secondary border border-border/50 text-[9px] font-black text-muted-foreground hover:text-primary hover:border-primary/30 hover:bg-primary/5 transition-all uppercase tracking-widest shadow-sm active:scale-95\"\r\n                >\r\n                  {tag}\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </Card>\r\n        </div>\r\n      </div>\r\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\commissions\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendUp' is defined but never used.","line":5,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TrendUp"},"fix":{"range":[47,59],"text":""},"desc":"Remove unused variable \"TrendUp\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendDown' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TrendDown"},"fix":{"range":[59,73],"text":""},"desc":"Remove unused variable \"TrendDown\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'XCircle' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"XCircle"},"fix":{"range":[99,111],"text":""},"desc":"Remove unused variable \"XCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[160,174],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowsClockwise' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":18,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowsClockwise"},"fix":{"range":[187,206],"text":""},"desc":"Remove unused variable \"ArrowsClockwise\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sparkle' is defined but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Sparkle"},"fix":{"range":[249,260],"text":""},"desc":"Remove unused variable \"Sparkle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Monitor' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Monitor"},"fix":{"range":[260,271],"text":""},"desc":"Remove unused variable \"Monitor\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Briefcase"},"fix":{"range":[271,284],"text":""},"desc":"Remove unused variable \"Briefcase\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":25,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[391,403],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":25,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[403,414],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardContent' is defined but never used.","line":25,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":50,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardContent"},"fix":{"range":[414,427],"text":""},"desc":"Remove unused variable \"CardContent\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useCallback' is defined but never used.","line":32,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":42,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useCallback"},"fix":{"range":[778,791],"text":""},"desc":"Remove unused variable \"useCallback\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":33,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AnimatePresence"},"fix":{"range":[823,840],"text":""},"desc":"Remove unused variable \"AnimatePresence\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":49,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":50,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":10}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { \n  CurrencyCircleDollar, \n  TrendUp, \n  TrendDown, \n  Clock, \n  CheckCircle, \n  XCircle, \n  MagnifyingGlass, \n  Funnel,\n  DownloadSimple, \n  ArrowLeft, \n  Calendar,\n  ArrowsClockwise,\n  Coins,\n  Receipt,\n  IdentificationBadge,\n  Sparkle,\n  Monitor,\n  Briefcase,\n  Icon\n} from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { useTranslations } from 'next-intl';\nimport { cn } from '@/lib/utils';\nimport { useState, useEffect, useCallback } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport ResponsiveTable from '@/components/ui/ResponsiveTable';\n\ninterface CommissionRecord {\n  id: string;\n  date: string;\n  customer_name: string;\n  service_name: string;\n  amount: number;\n  commission_rate: number;\n  commission_amount: number;\n  status: 'pending' | 'approved' | 'paid' | 'rejected';\n  payment_date?: string;\n}\n\nexport default function CommissionsPage() {\n  const { goBack } = useBackNavigation();\n  const t = useTranslations('clinic.commissions');\n  const [loading, setLoading] = useState(true);\n  const [records, setRecords] = useState<CommissionRecord[]>([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [statusFilter, setStatusFilter] = useState<string>('all');\n  const [period, setPeriod] = useState('this_month');\n\n  // Mock data for initial implementation\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      setRecords([\n        {\n          id: '1',\n          date: '2024-02-01',\n          customer_name: 'เธเธธเธ“เธชเธกเธเธฒเธข เนเธเธ”เธต',\n          service_name: 'Ultra Lift Premium',\n          amount: 15000,\n          commission_rate: 5,\n          commission_amount: 750,\n          status: 'paid',\n          payment_date: '2024-02-03'\n        },\n        {\n          id: '2',\n          date: '2024-02-02',\n          customer_name: 'เธเธธเธ“เธชเธกเธซเธเธดเธ เธฃเธฑเธเธ”เธต',\n          service_name: 'V-Shape Botox',\n          amount: 8000,\n          commission_rate: 5,\n          commission_amount: 400,\n          status: 'approved'\n        },\n        {\n          id: '3',\n          date: '2024-02-03',\n          customer_name: 'เธเธธเธ“เธงเธดเธเธฑเธข เธฃเธธเนเธเน€เธฃเธทเธญเธ',\n          service_name: 'Skin Rejuvenation',\n          amount: 12000,\n          commission_rate: 5,\n          commission_amount: 600,\n          status: 'pending'\n        }\n      ]);\n      setLoading(false);\n    }, 1000);\n    return () => clearTimeout(timer);\n  }, []);\n\n  const filteredRecords = records.filter(record => {\n    const matchesSearch = record.customer_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         record.service_name.toLowerCase().includes(searchTerm.toLowerCase());\n    const matchesStatus = statusFilter === 'all' || record.status === statusFilter;\n    return matchesSearch && matchesStatus;\n  });\n\n  const getStatusStyle = (status: string) => {\n    switch (status) {\n      case 'paid': return 'bg-emerald-500/10 text-emerald-500 border-emerald-500/20';\n      case 'approved': return 'bg-blue-500/10 text-blue-500 border-blue-500/20';\n      case 'pending': return 'bg-amber-500/10 text-amber-500 border-amber-500/20';\n      case 'rejected': return 'bg-rose-500/10 text-rose-500 border-rose-500/20';\n      default: return 'bg-secondary text-muted-foreground border-border';\n    }\n  };\n\n  const columns = [\n    {\n      header: 'เธงเธฑเธเธ—เธตเน',\n      accessor: (record: CommissionRecord) => (\n        <span className=\"text-sm text-muted-foreground whitespace-nowrap\">\n          {new Date(record.date).toLocaleDateString('th-TH')}\n        </span>\n      )\n    },\n    {\n      header: 'เธฅเธนเธเธเนเธฒ / เธเธฃเธดเธเธฒเธฃ',\n      accessor: (record: CommissionRecord) => (\n        <div>\n          <p className=\"font-bold text-foreground\">{record.customer_name}</p>\n          <p className=\"text-[10px] text-muted-foreground font-medium\">{record.service_name}</p>\n        </div>\n      )\n    },\n    {\n      header: 'เธขเธญเธ”เธเธฒเธข',\n      accessor: (record: CommissionRecord) => (\n        <span className=\"text-sm font-bold text-foreground\">\n          เธฟ{record.amount.toLocaleString()}\n        </span>\n      )\n    },\n    {\n      header: 'เธเนเธฒเธเธญเธกเธกเธดเธเธเธฑเนเธ',\n      accessor: (record: CommissionRecord) => (\n        <div>\n          <p className=\"text-sm font-bold text-primary\">เธฟ{record.commission_amount.toLocaleString()}</p>\n          <p className=\"text-[10px] text-muted-foreground font-medium\">{record.commission_rate}% Rate</p>\n        </div>\n      )\n    },\n    {\n      header: 'เธชเธ–เธฒเธเธฐ',\n      accessor: (record: CommissionRecord) => (\n        <span className={cn(\n          \"px-2 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider border\",\n          getStatusStyle(record.status)\n        )}>\n          {record.status === 'paid' ? 'เธเนเธฒเธขเนเธฅเนเธง' : \n           record.status === 'approved' ? 'เธญเธเธธเธกเธฑเธ•เธดเนเธฅเนเธง' : \n           record.status === 'pending' ? 'เธฃเธญเธญเธเธธเธกเธฑเธ•เธด' : 'เธเธเธดเน€เธชเธ'}\n        </span>\n      )\n    }\n  ];\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header Section */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <CurrencyCircleDollar weight=\"duotone\" className=\"w-4 h-4\" />\n            Fiscal Incentive Registry\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n          >\n            Commission <span className=\"text-primary\">Ledger</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Orchestrating practitioner incentives, payout cycles, and clinical yield distributions.\n          </motion.p>\n        </div>\n\n        <div className=\"flex flex-wrap items-center gap-3\">\n          <div className=\"flex bg-secondary/50 border border-border/50 p-1.5 rounded-[24px] shadow-inner\">\n            {['this_month', 'last_month', 'all'].map((p) => (\n              <button\n                key={p}\n                onClick={() => setPeriod(p)}\n                className={cn(\n                  \"px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border whitespace-nowrap\",\n                  period === p\n                    ? \"bg-primary text-primary-foreground border-primary shadow-premium\"\n                    : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\n                )}\n              >\n                {p === 'this_month' ? 'This Cycle' : p === 'last_month' ? 'Prev Cycle' : 'Global'}\n              </button>\n            ))}\n          </div>\n          <Button \n            variant=\"outline\"\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\n          >\n            <DownloadSimple weight=\"bold\" className=\"w-4 h-4\" />\n            Export Vault\n          </Button>\n        </div>\n      </div>\n\n      {/* Stats Summary */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\n        <StatCard\n          title=\"Consolidated Earn\"\n          value={1750}\n          prefix=\"เธฟ\"\n          icon={Coins as Icon}\n          trend=\"up\"\n          change={12.5}\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Settled Nodes\"\n          value={750}\n          prefix=\"เธฟ\"\n          icon={CheckCircle as Icon}\n          iconColor=\"text-emerald-500\"\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Pending Payouts\"\n          value={1000}\n          prefix=\"เธฟ\"\n          icon={Clock as Icon}\n          iconColor=\"text-amber-500\"\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Node Population\"\n          value={filteredRecords.length}\n          icon={Receipt as Icon}\n          className=\"p-4\"\n        />\n      </div>\n\n      {/* Search & Intelligence Controls */}\n      <div className=\"px-2\">\n        <Card className=\"p-6 rounded-[32px] border-border/50 shadow-card\">\n          <div className=\"flex flex-col md:flex-row gap-6\">\n            <div className=\"relative flex-1 group\">\n              <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-xl\" />\n              <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\n              <input \n                type=\"text\" \n                placeholder=\"Query identity node name or protocol registry...\" \n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3.5 pl-12 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\n              />\n            </div>\n            \n            <div className=\"relative\">\n              <select\n                value={statusFilter}\n                onChange={(e) => setStatusFilter(e.target.value)}\n                className=\"w-full sm:w-48 bg-secondary/50 border border-border rounded-2xl py-3.5 px-6 text-xs font-black uppercase tracking-widest text-foreground focus:border-primary outline-none transition-all appearance-none\"\n              >\n                <option value=\"all\">Protocol: ALL</option>\n                <option value=\"pending\">PENDING</option>\n                <option value=\"approved\">APPROVED</option>\n                <option value=\"paid\">SETTLED</option>\n                <option value=\"rejected\">VOID</option>\n              </select>\n              <Funnel weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-muted-foreground/40 pointer-events-none\" />\n            </div>\n          </div>\n        </Card>\n      </div>\n\n      {/* Ledger Table */}\n      <div className=\"px-2\">\n        <Card className=\"rounded-[40px] border-border/50 overflow-hidden shadow-premium\">\n          <ResponsiveTable\n            columns={columns}\n            data={filteredRecords}\n            loading={loading}\n            rowKey={(record) => record.id}\n            emptyMessage=\"Zero commission telemetry detected in current cycle.\"\n            mobileCard={(record) => (\n              <div className=\"space-y-5\">\n                <div className=\"flex justify-between items-start\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"w-14 h-14 rounded-2xl bg-secondary border border-border flex items-center justify-center text-primary shadow-inner\">\n                      <IdentificationBadge weight=\"duotone\" className=\"w-7 h-7\" />\n                    </div>\n                    <div className=\"min-w-0\">\n                      <p className=\"font-bold text-foreground truncate uppercase tracking-tight\">{record.customer_name}</p>\n                      <p className=\"text-[10px] font-black text-muted-foreground truncate uppercase tracking-widest\">{record.service_name}</p>\n                    </div>\n                  </div>\n                  <Badge variant={\n                    record.status === 'paid' ? 'success' : \n                    record.status === 'approved' ? 'default' : \n                    record.status === 'pending' ? 'warning' : 'destructive'\n                  } size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3\">\n                    {record.status === 'paid' ? 'SETTLED' : \n                     record.status === 'approved' ? 'APPROVED' : \n                     record.status === 'pending' ? 'QUEUED' : 'VOID'}\n                  </Badge>\n                </div>\n                \n                <div className=\"grid grid-cols-2 gap-6 py-4 border-y border-border/50\">\n                  <div>\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Fiscal Yield</p>\n                    <p className=\"text-xs font-bold text-foreground tabular-nums\">เธฟ{record.amount.toLocaleString()}</p>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Incentive Delta</p>\n                    <p className=\"text-sm font-black text-primary tabular-nums\">เธฟ{record.commission_amount.toLocaleString()}</p>\n                  </div>\n                </div>\n\n                <div className=\"flex justify-between items-center pt-1\">\n                  <div className=\"flex items-center gap-2 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\n                    <Calendar weight=\"bold\" className=\"w-3.5 h-3.5 opacity-60\" />\n                    Sync: {new Date(record.date).toLocaleDateString()}\n                  </div>\n                  {record.status === 'paid' && record.payment_date && (\n                    <Badge variant=\"ghost\" className=\"bg-emerald-500/5 text-emerald-500 border-none font-black text-[8px] uppercase tracking-widest px-3\">\n                      Settled node confirmed\n                    </Badge>\n                  )}\n                </div>\n              </div>\n            )}\n          />\n        </Card>\n      </div>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\consultations\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Phone' is defined but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Phone"},"fix":{"range":[457,467],"text":""},"desc":"Remove unused variable \"Phone\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'EnvelopeSimple' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":17,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"EnvelopeSimple"},"fix":{"range":[467,486],"text":""},"desc":"Remove unused variable \"EnvelopeSimple\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationCard' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":21,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationCard"},"fix":{"range":[515,537],"text":""},"desc":"Remove unused variable \"IdentificationCard\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Icon' is defined but never used.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Icon"},"fix":{"range":[537,545],"text":""},"desc":"Remove unused variable \"Icon\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":45,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":46,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":46,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1176,1179],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1176,1179],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'StatCard' is not defined.","line":180,"column":10,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":180,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":183,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":183,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6755,6758],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6755,6758],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'StatCard' is not defined.","line":186,"column":10,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":186,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":189,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":189,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6961,6964],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6961,6964],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'StatCard' is not defined.","line":195,"column":10,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":195,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":198,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":198,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7287,7290],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7287,7290],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'SpinnerGap' is not defined.","line":230,"column":18,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":230,"endColumn":28},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'History' is not defined.","line":309,"column":20,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":309,"endColumn":27}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport { cn } from '@/lib/utils';\nimport { \n  VideoCamera, \n  CalendarDots, \n  Plus, \n  ArrowSquareOut, \n  Clock, \n  User, \n  ArrowsClockwise, \n  CheckCircle, \n  X, \n  Phone, \n  EnvelopeSimple,\n  MonitorPlay,\n  CaretRight,\n  IdentificationCard,\n  Icon,\n  Video\n} from '@phosphor-icons/react';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { useTranslations } from 'next-intl';\nimport { cn } from '@/lib/utils';\n\ninterface Consultation {\n  id: string;\n  room_id: string;\n  room_url: string;\n  status: string;\n  scheduled_at: string;\n  started_at?: string;\n  ended_at?: string;\n  notes?: string;\n  customer?: { full_name: string; phone: string; email: string };\n}\n\nexport default function ConsultationsPage() {\n  const { goBack } = useBackNavigation();\n  const t = useTranslations('clinic.consultations' as any);\n  const [consultations, setConsultations] = useState<Consultation[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [showModal, setShowModal] = useState(false);\n  const [formData, setFormData] = useState({ customerId: '', scheduledAt: '', notes: '' });\n  const [customers, setCustomers] = useState<{ id: string; full_name: string }[]>([]);\n\n  useEffect(() => { \n    fetchConsultations(); \n    fetchCustomers();\n  }, []);\n\n  const fetchConsultations = async () => {\n    setLoading(true);\n    try {\n      const res = await fetch('/api/consultations');\n      const data = await res.json();\n      setConsultations(data.consultations || []);\n    } catch (e) { console.error(e); }\n    setLoading(false);\n  };\n\n  const fetchCustomers = async () => {\n    try {\n      const res = await fetch('/api/customers?limit=100');\n      const data = await res.json();\n      setCustomers(data.customers || []);\n    } catch (e) { console.error(e); }\n  };\n\n  const createConsultation = async () => {\n    if (!formData.customerId || !formData.scheduledAt) return;\n    await fetch('/api/consultations', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        customerId: formData.customerId,\n        scheduledAt: formData.scheduledAt,\n        notes: formData.notes\n      })\n    });\n    setShowModal(false);\n    setFormData({ customerId: '', scheduledAt: '', notes: '' });\n    fetchConsultations();\n  };\n\n  const updateStatus = async (id: string, status: string) => {\n    await fetch('/api/consultations', {\n      method: 'PATCH',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ consultationId: id, status })\n    });\n    fetchConsultations();\n  };\n\n  const formatDateTime = (d: string) => new Date(d).toLocaleString('th-TH', { \n    day: 'numeric', month: 'short', hour: '2-digit', minute: '2-digit' \n  });\n\n  const getStatusBadge = (s: string) => {\n    switch (s) {\n      case 'scheduled': return <Badge variant=\"primary\" size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2.5 py-1\">SCHEDULED</Badge>;\n      case 'waiting': return <Badge variant=\"warning\" size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2.5 py-1\">WAITING</Badge>;\n      case 'in_progress': return <Badge variant=\"success\" size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2.5 py-1 animate-pulse\">LIVE_SYNC</Badge>;\n      case 'completed': return <Badge variant=\"secondary\" size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2.5 py-1\">ARCHIVED</Badge>;\n      case 'cancelled': return <Badge variant=\"destructive\" size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2.5 py-1\">ABORTED</Badge>;\n      default: return <Badge variant=\"secondary\" size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2.5 py-1\">{s.toUpperCase()}</Badge>;\n    }\n  };\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header Section */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <VideoCamera weight=\"duotone\" className=\"w-4 h-4\" />\n            Telemedicine Gateway Matrix\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n          >\n            Virtual <span className=\"text-primary\">Consultations</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Orchestrating remote clinical evaluations and real-time aesthetic guidance nodes.\n          </motion.p>\n        </div>\n\n        <motion.div \n          initial={{ opacity: 0, scale: 0.9 }}\n          animate={{ opacity: 1, scale: 1 }}\n          transition={{ delay: 0.3 }}\n          className=\"flex items-center gap-3\"\n        >\n          <Button \n            variant=\"outline\" \n            onClick={fetchConsultations}\n            disabled={loading}\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\n          >\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\n            Sync sessions\n          </Button>\n          <Button \n            onClick={() => setShowModal(true)}\n            className=\"gap-3 shadow-premium px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest group\"\n          >\n            <Plus weight=\"bold\" className=\"w-4 h-4 group-hover:scale-110 transition-transform\" />\n            Initialize node\n          </Button>\n        </motion.div>\n      </div>\n\n      {/* Metrics Summary Section */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 px-2\">\n        <StatCard\n          title=\"Scheduled Nodes\"\n          value={consultations.filter(c => c.status === 'scheduled' || c.status === 'waiting').length}\n          icon={CalendarDots as any}\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Successful Sessions\"\n          value={consultations.filter(c => c.status === 'completed').length}\n          icon={CheckCircle as any}\n          iconColor=\"text-emerald-500\"\n          trend=\"up\"\n          change={15.2}\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Temporal Horizon\"\n          value={consultations.filter(c => new Date(c.scheduled_at).toDateString() === new Date().toDateString()).length}\n          icon={Clock as any}\n          iconColor=\"text-amber-500\"\n          className=\"p-4\"\n        />\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-10 px-2\">\n        {/* Active Registry Node */}\n        <Card className=\"rounded-[48px] border-border/50 shadow-premium overflow-hidden group\">\n          <CardHeader className=\"p-8 md:p-10 border-b border-border/50 bg-secondary/30 relative\">\n            <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n              <MonitorPlay weight=\"fill\" className=\"w-64 h-64 text-primary\" />\n            </div>\n            <div className=\"flex items-center justify-between relative z-10\">\n              <div className=\"flex items-center gap-5\">\n                <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm shadow-inner group-hover:bg-primary/20 transition-all\">\n                  <Video weight=\"duotone\" className=\"w-7 h-7\" />\n                </div>\n                <div>\n                  <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Scheduled Nodes</CardTitle>\n                  <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] mt-1\">Pending virtual synchronizations</p>\n                </div>\n              </div>\n              <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[10px] tracking-widest uppercase px-4 py-1.5 shadow-sm\">\n                {consultations.filter(c => c.status === 'scheduled' || c.status === 'waiting').length} ACTIVE_REGISTRY\n              </Badge>\n            </div>\n          </CardHeader>\n\n          <CardContent className=\"p-8 md:p-10 relative z-10\">\n            {loading && !consultations.length ? (\n              <div className=\"py-32 flex flex-col items-center justify-center gap-6 opacity-40\">\n                <SpinnerGap weight=\"bold\" className=\"w-12 h-12 text-primary animate-spin\" />\n                <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em]\">Accessing Session Matrix...</p>\n              </div>\n            ) : consultations.filter(c => c.status === 'scheduled' || c.status === 'waiting').length === 0 ? (\n              <div className=\"py-32 text-center opacity-30 flex flex-col items-center gap-6\">\n                <VideoCamera weight=\"duotone\" className=\"w-20 h-20\" />\n                <p className=\"text-[10px] font-black uppercase tracking-[0.3em]\">Registry Nominal</p>\n              </div>\n            ) : (\n              <div className=\"space-y-6\">\n                {consultations.filter(c => c.status === 'scheduled' || c.status === 'waiting').map((c, i) => (\n                  <motion.div \n                    key={c.id} \n                    initial={{ opacity: 0, x: -20 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    transition={{ delay: i * 0.05 }}\n                    className=\"bg-secondary/20 rounded-[32px] border border-border/50 p-6 space-y-6 hover:border-primary/30 transition-all group/item shadow-sm\"\n                  >\n                    <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-8\">\n                      <div className=\"flex items-center gap-5\">\n                        <div className=\"w-16 h-16 bg-card border border-border/50 rounded-2xl flex items-center justify-center text-primary shadow-inner group-hover/item:bg-primary/5 transition-all\">\n                          <User weight=\"duotone\" className=\"w-8 h-8\" />\n                        </div>\n                        <div className=\"space-y-1.5\">\n                          <p className=\"text-lg font-black text-foreground uppercase tracking-tight leading-tight group-hover/item:text-primary transition-colors\">{c.customer?.full_name || 'ANONYMOUS_IDENTITY'}</p>\n                          <div className=\"flex items-center gap-3\">\n                            {getStatusBadge(c.status)}\n                            <div className=\"flex items-center gap-2 text-[10px] font-black text-muted-foreground uppercase tracking-widest opacity-60\">\n                              <Clock weight=\"bold\" className=\"w-3.5 h-3.5\" />\n                              {formatDateTime(c.scheduled_at)}\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"flex gap-3\">\n                        <a\n                          href={c.room_url}\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                          className=\"flex-1 sm:flex-none\"\n                        >\n                          <Button size=\"sm\" className=\"w-full gap-2 shadow-premium rounded-xl text-[10px] font-black uppercase tracking-widest px-6 h-11\">\n                            <ArrowSquareOut weight=\"bold\" className=\"w-4 h-4\" />\n                            Access Room\n                          </Button>\n                        </a>\n                        <Button\n                          size=\"sm\"\n                          variant=\"outline\"\n                          onClick={() => updateStatus(c.id, 'in_progress')}\n                          className=\"h-11 px-6 rounded-xl border-border/50 text-primary hover:bg-primary/5 font-black text-[10px] uppercase tracking-widest\"\n                        >\n                          Initialize\n                        </Button>\n                      </div>\n                    </div>\n                    {c.notes && (\n                      <div className=\"p-4 bg-secondary/30 rounded-2xl border border-border/50 shadow-inner\">\n                        <p className=\"text-[11px] text-muted-foreground font-medium italic leading-relaxed\">\n                          Node Notes: {c.notes}\n                        </p>\n                      </div>\n                    )}\n                  </motion.div>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Historical Matrix Node */}\n        <Card className=\"rounded-[48px] border-border/50 shadow-premium overflow-hidden group\">\n          <CardHeader className=\"p-8 md:p-10 border-b border-border/50 bg-secondary/30 relative\">\n            <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n              <CheckCircle weight=\"fill\" className=\"w-64 h-64 text-emerald-500\" />\n            </div>\n            <div className=\"flex items-center justify-between relative z-10\">\n              <div className=\"flex items-center gap-5\">\n                <div className=\"w-14 h-14 rounded-2xl bg-emerald-500/10 flex items-center justify-center text-emerald-500 border border-emerald-500/20 shadow-sm shadow-inner group-hover:bg-emerald-500/20 transition-all\">\n                  <History weight=\"duotone\" className=\"w-7 h-7\" />\n                </div>\n                <div>\n                  <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Archived Nodes</CardTitle>\n                  <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] mt-1\">Historical session logs</p>\n                </div>\n              </div>\n              <Badge variant=\"ghost\" className=\"bg-secondary text-muted-foreground border-none font-black text-[10px] tracking-widest uppercase px-4 py-1.5 shadow-sm\">\n                {consultations.filter(c => c.status === 'completed' || c.status === 'cancelled').length} LOGGED\n              </Badge>\n            </div>\n          </CardHeader>\n\n          <CardContent className=\"p-8 md:p-10 relative z-10\">\n            {consultations.filter(c => c.status === 'completed' || c.status === 'cancelled').length === 0 ? (\n              <div className=\"py-32 text-center opacity-30 flex flex-col items-center gap-6\">\n                <Clock weight=\"duotone\" className=\"w-20 h-20\" />\n                <p className=\"text-[10px] font-black uppercase tracking-[0.3em]\">Registry Nominal</p>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {consultations.filter(c => c.status === 'completed' || c.status === 'cancelled').map((item, i) => (\n                  <motion.div \n                    key={item.id} \n                    initial={{ opacity: 0, x: 20 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    transition={{ delay: i * 0.05 }}\n                    className=\"p-5 bg-secondary/20 rounded-[28px] border border-border/50 flex items-center justify-between group/past hover:bg-secondary/40 transition-all shadow-sm\"\n                  >\n                    <div className=\"flex items-center gap-5 min-w-0\">\n                      <div className=\"w-12 h-12 rounded-xl bg-card border border-border flex items-center justify-center text-muted-foreground group-hover/past:text-emerald-500 transition-colors shadow-inner\">\n                        <CheckCircle weight=\"duotone\" className=\"w-6 h-6\" />\n                      </div>\n                      <div className=\"min-w-0\">\n                        <p className=\"text-base font-black text-foreground truncate uppercase tracking-tight\">{item.customer?.full_name || 'IDENTITY_NODE'}</p>\n                        <p className=\"text-[10px] text-muted-foreground font-black uppercase tracking-widest opacity-60 mt-0.5\">{formatDateTime(item.scheduled_at)}</p>\n                      </div>\n                    </div>\n                    {getStatusBadge(item.status)}\n                  </motion.div>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Initialize Room Modal Protocol */}\n      <AnimatePresence>\n        {showModal && (\n          <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-[200] flex items-center justify-center p-4 overflow-y-auto\">\n            <motion.div\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n              onClick={() => setShowModal(false)}\n              className=\"absolute inset-0\"\n            />\n            <motion.div\n              initial={{ opacity: 0, scale: 0.95, y: 20 }}\n              animate={{ opacity: 1, scale: 1 }}\n              exit={{ opacity: 0, scale: 0.95, y: 20 }}\n              className=\"bg-card p-10 rounded-[40px] border border-border shadow-premium w-full max-w-lg relative overflow-hidden group\"\n              onClick={e => e.stopPropagation()}\n            >\n              <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n                <VideoCamera weight=\"fill\" className=\"w-64 h-64 text-primary\" />\n              </div>\n\n              <div className=\"flex items-center justify-between mb-10 relative z-10\">\n                <div className=\"flex items-center gap-5\">\n                  <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm shadow-inner\">\n                    <VideoCamera weight=\"duotone\" className=\"w-7 h-7\" />\n                  </div>\n                  <div>\n                    <h2 className=\"text-2xl font-black text-foreground uppercase tracking-tight leading-tight\">Initialize Room</h2>\n                    <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Configure virtual diagnostic node</p>\n                  </div>\n                </div>\n                <Button \n                  variant=\"ghost\"\n                  onClick={() => setShowModal(false)}\n                  className=\"h-11 w-11 p-0 rounded-xl hover:bg-secondary transition-all\"\n                >\n                  <X weight=\"bold\" className=\"w-6 h-6\" />\n                </Button>\n              </div>\n\n              <div className=\"space-y-10 relative z-10\">\n                <div className=\"space-y-3\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Target Identity Node *</label>\n                  <div className=\"relative group/select\">\n                    <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/select:opacity-100 transition-opacity rounded-xl\" />\n                    <select\n                      value={formData.customerId}\n                      onChange={e => setFormData({ ...formData, customerId: e.target.value })}\n                      className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner appearance-none relative z-10 uppercase tracking-tight\"\n                    >\n                      <option value=\"\" className=\"bg-card\">SELECT_CLIENT_NODE</option>\n                      {customers.map(c => (\n                        <option key={c.id} value={c.id} className=\"bg-card\">{c.full_name.toUpperCase()}</option>\n                      ))}\n                    </select>\n                    <CaretRight weight=\"bold\" className=\"absolute right-6 top-1/2 -translate-y-1/2 w-4 h-4 rotate-90 text-muted-foreground/40 pointer-events-none z-20\" />\n                  </div>\n                </div>\n\n                <div className=\"space-y-3\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1 flex items-center gap-2\">\n                    <CalendarDots weight=\"bold\" className=\"w-3.5 h-3.5 text-primary/60\" />\n                    Temporal Alignment *\n                  </label>\n                  <input\n                    type=\"datetime-local\"\n                    value={formData.scheduledAt}\n                    onChange={e => setFormData({ ...formData, scheduledAt: e.target.value })}\n                    className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-black tabular-nums shadow-inner relative z-10\"\n                  />\n                </div>\n\n                <div className=\"space-y-3\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Protocol Notes</label>\n                  <textarea\n                    value={formData.notes}\n                    onChange={e => setFormData({ ...formData, notes: e.target.value })}\n                    className=\"w-full bg-secondary/30 border border-border rounded-[28px] py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-medium placeholder:text-muted-foreground/40 resize-none italic shadow-inner relative z-10\"\n                    rows={4}\n                    placeholder=\"Input clinical context nodes...\"\n                  />\n                </div>\n\n                <div className=\"flex flex-col sm:flex-row items-center gap-4 pt-6 border-t border-border/30\">\n                  <Button \n                    onClick={createConsultation} \n                    disabled={!formData.customerId || !formData.scheduledAt}\n                    className=\"w-full sm:flex-[2] py-7 rounded-[24px] font-black uppercase tracking-widest text-[11px] shadow-premium gap-3\"\n                  >\n                    <CheckCircle weight=\"bold\" className=\"w-5 h-5\" />\n                    Authorize Node\n                  </Button>\n                  <Button \n                    type=\"button\"\n                    variant=\"outline\" \n                    onClick={() => setShowModal(false)}\n                    className=\"w-full sm:flex-1 py-7 rounded-[24px] font-black uppercase tracking-widest text-[11px] border-border/50 hover:bg-secondary\"\n                  >\n                    Abort\n                  </Button>\n                </div>\n              </div>\n            </motion.div>\n          </div>\n        )}\n      </AnimatePresence>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\customers\\[id]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":3,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":51,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useMemo"},"fix":{"range":[58,67],"text":""},"desc":"Remove unused variable \"useMemo\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Tag' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":6,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Tag"},"fix":{"range":[354,362],"text":""},"desc":"Remove unused variable \"Tag\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Briefcase"},"fix":{"range":[453,467],"text":""},"desc":"Remove unused variable \"Briefcase\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useTranslations' is defined but never used.","line":34,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":25,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"useTranslations"},"fix":{"range":[923,967],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRouter' is defined but never used.","line":36,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":19,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useRouter"},"fix":{"range":[1013,1023],"text":""},"desc":"Remove unused variable \"useRouter\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Link' is defined but never used.","line":37,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":14,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Link"},"fix":{"range":[1061,1099],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":51,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1380,1383],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1380,1383],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":52,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":52,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1409,1412],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1409,1412],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":53,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1449,1452],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1449,1452],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":54,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":54,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1473,1476],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1473,1476],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'compareRes' is assigned a value but never used.","line":70,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":70,"endColumn":36},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":378,"column":33,"nodeType":"JSXOpeningElement","endLine":378,"endColumn":141},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":381,"column":33,"nodeType":"JSXOpeningElement","endLine":381,"endColumn":118},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":470,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":470,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25034,25037],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25034,25037],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'FileText' is not defined.","line":485,"column":26,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":485,"endColumn":34}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect, useCallback, useMemo, Suspense } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { \r\n  User, \r\n  EnvelopeSimple, \r\n  Phone, \r\n  CalendarDots, \r\n  ClockCounterClockwise, \r\n  Sparkle, \r\n  CreditCard, \r\n  ShieldCheck, \r\n  CaretLeft,\r\n  SpinnerGap,\r\n  PencilSimple,\r\n  ChatCircle,\r\n  Tag,\r\n  Clock,\r\n  ArrowRight,\r\n  SquaresFour,\r\n  ArrowsCounterClockwise,\r\n  IdentificationCard,\r\n  Briefcase,\r\n  TrendUp\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/Button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport CustomerModal from '@/components/CustomerModal';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { useTranslations } from 'next-intl';\r\nimport { cn } from '@/lib/utils';\r\nimport { useRouter, useParams } from 'next/navigation';\r\nimport { Link } from '@/i18n/routing';\r\n\r\ninterface CustomerDetails {\r\n  id: string;\r\n  full_name: string;\r\n  nickname?: string;\r\n  email?: string;\r\n  phone?: string;\r\n  date_of_birth?: string;\r\n  gender?: string;\r\n  customer_type: string;\r\n  status: string;\r\n  notes?: string;\r\n  created_at: string;\r\n  skin_analyses: any[];\r\n  sales_commissions: any[];\r\n  customer_treatment_journeys?: any[];\r\n  comparisons?: any[];\r\n}\r\n\r\nfunction CustomerDetailPageContent() {\r\n  const { goBack } = useBackNavigation();\r\n  const params = useParams();\r\n  const customerId = params.id as string;\r\n  \r\n  const [loading, setLoading] = useState(true);\r\n  const [customer, setCustomer] = useState<CustomerDetails | null>(null);\r\n  const [activeTab, setActiveSection] = useState('overview');\r\n  const [isEditModalOpen, setIsEditModalOpen] = useState(false);\r\n\r\n  const fetchCustomerData = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const [detailsRes, compareRes] = await Promise.all([\r\n        fetch(`/api/customers/${customerId}`),\r\n        fetch(`/api/analysis/compare?userId=${customerId}`) // Actually we need the user_id linked to this customer\r\n      ]);\r\n      \r\n      const result = await detailsRes.json();\r\n      if (result.success) {\r\n        const customerData = result.data;\r\n        // The comparison API needs user_id, let's fetch it if we don't have it\r\n        if (customerData.user_id) {\r\n          const compRes = await fetch(`/api/analysis/compare?userId=${customerData.user_id}`);\r\n          const compResult = await compRes.json();\r\n          if (compResult.success) {\r\n            customerData.comparisons = compResult.data;\r\n          }\r\n        }\r\n        setCustomer(customerData);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching customer details:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [customerId]);\r\n\r\n  useEffect(() => {\r\n    fetchCustomerData();\r\n  }, [fetchCustomerData]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"h-[80vh] flex flex-col items-center justify-center space-y-6\">\r\n        <SpinnerGap className=\"w-12 h-12 text-primary animate-spin\" />\r\n        <p className=\"text-sm font-black uppercase tracking-[0.3em] text-muted-foreground animate-pulse\">Syncing Patient Identity Node...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!customer) {\r\n    return (\r\n      <div className=\"h-[80vh] flex flex-col items-center justify-center space-y-6\">\r\n        <ShieldCheck className=\"w-12 h-12 text-rose-500\" />\r\n        <p className=\"text-sm font-black uppercase tracking-[0.3em] text-muted-foreground\">Patient Node Not Detected</p>\r\n        <button onClick={() => goBack('/clinic/customers')} className=\"text-primary font-bold uppercase text-xs tracking-widest hover:underline\">Return to Cluster</button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb \r\n        customLabels={{ \r\n          [customerId]: customer?.full_name || 'Patient Detail'\r\n        }} \r\n      />\r\n\r\n      <CustomerModal \r\n        isOpen={isEditModalOpen}\r\n        onClose={() => setIsEditModalOpen(false)}\r\n        onSuccess={fetchCustomerData}\r\n        customer={customer}\r\n      />\r\n\r\n      {/* Header & Navigation */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\r\n        <div className=\"flex items-center gap-6\">\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={() => goBack('/clinic/customers')}\r\n            className=\"p-4 h-14 w-14 border-border rounded-2xl text-muted-foreground hover:text-foreground transition-all\"\r\n          >\r\n            <CaretLeft weight=\"bold\" className=\"w-5 h-5\" />\r\n          </Button>\r\n          <div className=\"space-y-1\">\r\n            <div className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\">\r\n              <User weight=\"duotone\" className=\"w-4 h-4\" />\r\n              Patient Identity Node\r\n            </div>\r\n            <h1 className=\"text-4xl font-bold text-foreground tracking-tight uppercase\">\r\n              {customer.full_name} \r\n              <span className=\"text-primary/40 font-light italic ml-3\">({customer.nickname || 'NODE'})</span>\r\n            </h1>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex gap-3\">\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={() => setIsEditModalOpen(true)}\r\n            className=\"flex items-center gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest\"\r\n          >\r\n            <PencilSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n            Modify Protocol\r\n          </Button>\r\n          <Button className=\"flex items-center gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\">\r\n            <ChatCircle weight=\"bold\" className=\"w-4 h-4\" />\r\n            Establish Direct Link\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 xl:grid-cols-4 gap-8\">\r\n        {/* Left Column: ID Card */}\r\n        <div className=\"xl:col-span-1 space-y-8\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n          >\r\n            <Card className=\"p-8 rounded-[40px] border-border shadow-premium relative overflow-hidden group\">\r\n              <div className=\"absolute -top-12 -left-12 w-48 h-48 bg-primary/10 blur-[60px] rounded-full group-hover:bg-primary/20 transition-all duration-700\" />\r\n              <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                <IdentificationCard className=\"w-32 h-32 text-primary\" />\r\n              </div>\r\n              \r\n              <div className=\"relative z-10 space-y-10\">\r\n                <div className=\"w-24 h-24 rounded-3xl bg-gradient-to-br from-primary/20 to-transparent border border-primary/20 flex items-center justify-center mx-auto text-4xl font-black text-primary shadow-premium group-hover:scale-105 transition-transform duration-500\">\r\n                  {customer.full_name.charAt(0)}\r\n                </div>\r\n\r\n                <div className=\"space-y-6\">\r\n                  <div className=\"space-y-1.5\">\r\n                    <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Temporal Node</p>\r\n                    <div className=\"flex items-center gap-3 p-3 bg-secondary/30 rounded-2xl border border-border/50\">\r\n                      <CalendarDots weight=\"duotone\" className=\"w-4 h-4 text-primary/60\" />\r\n                      <span className=\"text-sm font-bold text-foreground\">{customer.date_of_birth ? new Date(customer.date_of_birth).toLocaleDateString() : 'UNDEFINED'}</span>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-1.5\">\r\n                    <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Neural Address</p>\r\n                    <div className=\"flex items-center gap-3 p-3 bg-secondary/30 rounded-2xl border border-border/50\">\r\n                      <EnvelopeSimple weight=\"duotone\" className=\"w-4 h-4 text-primary/60\" />\r\n                      <span className=\"text-sm font-bold text-foreground truncate\">{customer.email || 'NONE'}</span>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-1.5\">\r\n                    <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Comm Channel</p>\r\n                    <div className=\"flex items-center gap-3 p-3 bg-secondary/30 rounded-2xl border border-border/50\">\r\n                      <Phone weight=\"duotone\" className=\"w-4 h-4 text-primary/60\" />\r\n                      <span className=\"text-sm font-bold text-foreground\">{customer.phone || 'NONE'}</span>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"pt-6 border-t border-border/50 space-y-4\">\r\n                    <div className=\"flex justify-between items-center px-1\">\r\n                      <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Security Tier</span>\r\n                      <Badge variant=\"ghost\" size=\"sm\" className=\"bg-primary/5 border-none text-primary font-black uppercase text-[9px] px-3\">\r\n                        {customer.customer_type}\r\n                      </Badge>\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center px-1\">\r\n                      <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Node Status</span>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <div className=\"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse shadow-[0_0_8px_rgba(16,185,129,0.6)]\" />\r\n                        <span className=\"text-[10px] font-black text-emerald-500 uppercase tracking-widest\">{customer.status}</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n          </motion.div>\r\n\r\n          {/* Clinical Alerts / Notes */}\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n          >\r\n            <Card className=\"p-8 rounded-[40px] border-rose-500/10 bg-rose-500/[0.02] space-y-4 group\">\r\n              <h4 className=\"text-[10px] font-black text-rose-400 uppercase tracking-[0.3em] flex items-center gap-3\">\r\n                <ShieldCheck weight=\"duotone\" className=\"w-5 h-5 group-hover:scale-110 transition-transform\" />\r\n                Critical Telemetry\r\n              </h4>\r\n              <p className=\"text-xs text-muted-foreground italic font-medium leading-relaxed\">\r\n                {customer.notes || 'No critical contraindications detected in current registry node.'}\r\n              </p>\r\n            </Card>\r\n          </motion.div>\r\n        </div>\r\n\r\n        {/* Right Column: Tabbed Content */}\r\n        <div className=\"xl:col-span-3 space-y-8\">\r\n          {/* Section Navigation */}\r\n          <div className=\"flex gap-2 overflow-x-auto pb-2 scrollbar-hide bg-secondary/30 p-1.5 rounded-[24px] border border-border/50\">\r\n            {[\r\n              { id: 'overview', label: 'Clinical Overview', icon: SquaresFour },\r\n              { id: 'journey', label: 'Treatment Cycles', icon: ClockCounterClockwise },\r\n              { id: 'analysis', label: 'Neural Diagnostics', icon: Sparkle },\r\n              { id: 'transactions', label: 'Fiscal Node', icon: CreditCard },\r\n            ].map((tab) => (\r\n              <button\r\n                key={tab.id}\r\n                onClick={() => setActiveSection(tab.id)}\r\n                className={cn(\r\n                  \"flex items-center gap-3 px-6 py-3.5 rounded-2xl transition-all text-[10px] font-black uppercase tracking-widest border whitespace-nowrap\",\r\n                  activeTab === tab.id \r\n                    ? \"bg-primary text-primary-foreground border-primary shadow-premium\" \r\n                    : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\r\n                )}\r\n              >\r\n                <tab.icon weight={activeTab === tab.id ? \"fill\" : \"bold\"} className=\"w-4 h-4\" />\r\n                {tab.label}\r\n              </button>\r\n            ))}\r\n          </div>\r\n\r\n          <AnimatePresence mode=\"wait\">\r\n            {activeTab === 'overview' && (\r\n              <motion.div\r\n                key=\"overview\"\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                exit={{ opacity: 0, y: -20 }}\r\n                className=\"space-y-8\"\r\n              >\r\n                {/* Stats Grid */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\r\n                  <StatCard\r\n                    title=\"Latest Aura Score\"\r\n                    value=\"84%\"\r\n                    icon={Sparkle}\r\n                    trend=\"up\"\r\n                    change={4.2}\r\n                    className=\"p-4\"\r\n                  />\r\n                  <StatCard\r\n                    title=\"Protocol Density\"\r\n                    value={customer.sales_commissions.length.toString()}\r\n                    icon={ClockCounterClockwise}\r\n                    className=\"p-4\"\r\n                  />\r\n                  <StatCard\r\n                    title=\"Lifetime Valuation\"\r\n                    value={`เธฟ${customer.sales_commissions.reduce((acc, c) => acc + Number(c.base_amount), 0).toLocaleString()}`}\r\n                    icon={CreditCard}\r\n                    trend=\"up\"\r\n                    change={12.5}\r\n                    className=\"p-4\"\r\n                  />\r\n                </div>\r\n\r\n                {/* Recent Activity */}\r\n                <Card className=\"rounded-[40px] border-border/50 overflow-hidden\">\r\n                  <CardHeader className=\"p-8 border-b border-border/50 flex flex-row items-center justify-between\">\r\n                    <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Recent Activity Stream</CardTitle>\r\n                    <Badge variant=\"ghost\" className=\"font-black text-[10px] tracking-widest uppercase bg-primary/5 text-primary border-none\">Live Sync</Badge>\r\n                  </CardHeader>\r\n                  <CardContent className=\"p-8\">\r\n                    <div className=\"space-y-8\">\r\n                      {customer.sales_commissions.slice(0, 5).map((txn, i) => (\r\n                        <div key={i} className=\"flex gap-8 group\">\r\n                          <div className=\"flex flex-col items-center gap-3\">\r\n                            <div className=\"w-12 h-12 rounded-2xl bg-secondary border border-border flex items-center justify-center text-primary group-hover:bg-primary/10 transition-all duration-500 shadow-inner shrink-0\">\r\n                              <Clock weight=\"duotone\" className=\"w-6 h-6\" />\r\n                            </div>\r\n                            {i !== (Math.min(customer.sales_commissions.length, 5) - 1) && <div className=\"w-0.5 h-full bg-border/50 group-hover:bg-primary/30 transition-colors\" />}\r\n                          </div>\r\n                          <div className=\"flex-1 pb-8 group-last:pb-0\">\r\n                            <div className=\"flex justify-between items-start mb-2\">\r\n                              <h4 className=\"text-base font-bold text-foreground uppercase tracking-tight group-hover:text-primary transition-colors\">{txn.transaction_type}</h4>\r\n                              <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">{new Date(txn.transaction_date).toLocaleDateString()}</span>\r\n                            </div>\r\n                            <p className=\"text-xs text-muted-foreground font-medium mb-4 italic opacity-80\">Execution confirmed at clinical terminal alpha-node.</p>\r\n                            <span className=\"text-2xl font-black text-foreground tabular-nums tracking-tight\">เธฟ{Number(txn.base_amount).toLocaleString()}</span>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                      {customer.sales_commissions.length === 0 && (\r\n                        <div className=\"py-20 text-center opacity-20 flex flex-col items-center gap-6\">\r\n                          <div className=\"w-20 h-20 rounded-[40px] bg-secondary flex items-center justify-center text-muted-foreground\">\r\n                            <ClockCounterClockwise weight=\"duotone\" className=\"w-10 h-10\" />\r\n                          </div>\r\n                          <p className=\"text-sm font-black uppercase tracking-[0.3em]\">No activity records detected in current sector.</p>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </motion.div>\r\n            )}\r\n\r\n            {activeTab === 'analysis' && (\r\n              <motion.div\r\n                key=\"analysis\"\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                exit={{ opacity: 0, y: -20 }}\r\n                className=\"space-y-10\"\r\n              >\r\n                {/* Comparison History */}\r\n                {customer.comparisons && customer.comparisons.length > 0 && (\r\n                  <div className=\"space-y-6\">\r\n                    <h3 className=\"text-xl font-black text-foreground uppercase tracking-[0.2em] px-4 flex items-center gap-4\">\r\n                      <ArrowsCounterClockwise weight=\"bold\" className=\"w-6 h-6 text-primary\" />\r\n                      Evolution Deltas\r\n                    </h3>\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                      {customer.comparisons.map((comp, i) => (\r\n                        <Card key={i} className=\"p-6 rounded-[32px] border-emerald-500/20 bg-emerald-500/[0.02] flex items-center justify-between hover:border-emerald-500/40 transition-all group/comp\">\r\n                          <div className=\"flex items-center gap-6\">\r\n                            <div className=\"flex -space-x-6\">\r\n                              <div className=\"w-16 h-16 rounded-2xl border-4 border-card overflow-hidden relative z-10 shadow-premium group-hover/comp:-translate-x-2 transition-transform duration-500\">\r\n                                <img src={comp.before.image_url} className=\"w-full h-full object-cover grayscale opacity-60\" alt=\"Before\" />\r\n                              </div>\r\n                              <div className=\"w-16 h-16 rounded-2xl border-4 border-card overflow-hidden relative z-20 shadow-premium group-hover/comp:translate-x-2 transition-transform duration-500\">\r\n                                <img src={comp.after.image_url} className=\"w-full h-full object-cover\" alt=\"After\" />\r\n                              </div>\r\n                            </div>\r\n                            <div>\r\n                              <p className=\"text-xs font-black text-foreground uppercase tracking-widest\">Aesthetic Delta</p>\r\n                              <p className=\"text-[10px] text-muted-foreground font-medium uppercase tracking-widest mt-1\">TS-{new Date(comp.created_at).toLocaleDateString()}</p>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"text-right\">\r\n                            <p className=\"text-[10px] font-black text-emerald-500 uppercase tracking-widest mb-1\">Improvement</p>\r\n                            <div className=\"flex items-center gap-2 justify-end\">\r\n                              <TrendUp weight=\"bold\" className=\"w-4 h-4 text-emerald-500\" />\r\n                              <p className=\"text-2xl font-black text-emerald-500\">+{comp.overall_improvement}%</p>\r\n                            </div>\r\n                          </div>\r\n                        </Card>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Individual Analyses */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                  {customer.skin_analyses.map((scan, i) => (\r\n                    <Card key={i} className=\"p-8 rounded-[40px] border-border/50 space-y-8 group hover:border-primary/30 transition-all\">\r\n                      <div className=\"flex justify-between items-start\">\r\n                        <div className=\"flex items-center gap-5\">\r\n                          <div className=\"w-14 h-14 rounded-2xl bg-secondary border border-border flex items-center justify-center text-primary group-hover:bg-primary/10 transition-all duration-500 shadow-inner\">\r\n                            <Sparkle weight=\"duotone\" className=\"w-7 h-7\" />\r\n                          </div>\r\n                          <div>\r\n                            <h4 className=\"text-base font-bold text-foreground uppercase tracking-tight\">Diagnostic Node</h4>\r\n                            <p className=\"text-[10px] text-muted-foreground font-black uppercase tracking-widest mt-1\">{new Date(scan.analyzed_at).toLocaleString()}</p>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"text-center\">\r\n                          <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest mb-1\">Aura Score</p>\r\n                          <p className=\"text-3xl font-black text-primary tracking-tighter\">{scan.overall_score}</p>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"grid grid-cols-3 gap-4 pt-6 border-t border-border/50\">\r\n                        {[\r\n                          { label: 'Pores', value: scan.pores_score },\r\n                          { label: 'Wrinkles', value: scan.wrinkles_score },\r\n                          { label: 'Texture', value: scan.texture_score }\r\n                        ].map((metric) => (\r\n                          <div key={metric.label} className=\"text-center p-4 bg-secondary/30 rounded-2xl border border-border/50\">\r\n                            <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest mb-1\">{metric.label}</p>\r\n                            <p className=\"text-lg font-black text-foreground\">{metric.value}</p>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n\r\n                      <Button variant=\"outline\" className=\"w-full py-6 rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] gap-3 border-border/50 hover:bg-secondary\">\r\n                        Access Full Diagnostic Payload\r\n                        <ArrowRight weight=\"bold\" className=\"w-4 h-4\" />\r\n                      </Button>\r\n                    </Card>\r\n                  ))}\r\n                </div>\r\n                {customer.skin_analyses.length === 0 && (\r\n                  <Card variant=\"ghost\" className=\"py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-6 opacity-40\">\r\n                    <div className=\"w-20 h-20 rounded-[40px] bg-secondary flex items-center justify-center text-muted-foreground\">\r\n                      <Sparkle weight=\"duotone\" className=\"w-10 h-10\" />\r\n                    </div>\r\n                    <p className=\"text-sm font-black uppercase tracking-[0.3em]\">Zero diagnostic data detected in sector.</p>\r\n                  </Card>\r\n                )}\r\n              </motion.div>\r\n            )}\r\n\r\n            {activeTab === 'journey' && (\r\n              <motion.div\r\n                key=\"journey\"\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                exit={{ opacity: 0, y: -20 }}\r\n                className=\"space-y-8\"\r\n              >\r\n                {customer.customer_treatment_journeys?.map((journey, i) => (\r\n                  <Card key={i} className=\"p-8 rounded-[40px] border-border/50 space-y-8 group\">\r\n                    <div className=\"flex justify-between items-start\">\r\n                      <div className=\"flex items-center gap-5\">\r\n                        <div className=\"w-14 h-14 rounded-2xl bg-emerald-500/10 border border-emerald-500/20 flex items-center justify-center text-emerald-500 shadow-inner group-hover:scale-105 transition-transform duration-500\">\r\n                          <ClockCounterClockwise weight=\"duotone\" className=\"w-7 h-7\" />\r\n                        </div>\r\n                        <div>\r\n                          <h4 className=\"text-lg font-bold text-foreground uppercase tracking-tight\">\r\n                            {(journey.treatment_plan as any)?.treatment_name || 'Protocol Execution Node'}\r\n                          </h4>\r\n                          <div className=\"flex items-center gap-3 mt-1\">\r\n                            <Badge variant=\"success\" size=\"sm\" className=\"bg-emerald-500/5 text-emerald-500 border-none font-black text-[8px] tracking-widest uppercase\">\r\n                              {journey.journey_status.replace('_', ' ')}\r\n                            </Badge>\r\n                            <div className=\"w-1 h-1 rounded-full bg-border\" />\r\n                            <p className=\"text-[10px] text-muted-foreground font-black uppercase tracking-widest\">Active Cycle</p>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-2\">{new Date(journey.created_at).toLocaleDateString()}</span>\r\n                    </div>\r\n                    <div className=\"p-6 bg-secondary/30 rounded-3xl border border-border/50 relative overflow-hidden\">\r\n                      <div className=\"absolute top-0 right-0 p-4 opacity-[0.03] pointer-events-none\">\r\n                        <FileText weight=\"duotone\" className=\"w-12 h-12 text-primary\" />\r\n                      </div>\r\n                      <p className=\"text-sm text-muted-foreground font-medium leading-relaxed italic relative z-10\">\r\n                        {journey.progress_notes || 'No operational notes recorded for this cycle execution node.'}\r\n                      </p>\r\n                    </div>\r\n                  </Card>\r\n                ))}\r\n                {(!customer.customer_treatment_journeys || customer.customer_treatment_journeys.length === 0) && (\r\n                  <Card variant=\"ghost\" className=\"py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-6 opacity-40\">\r\n                    <div className=\"w-20 h-20 rounded-[40px] bg-secondary flex items-center justify-center text-muted-foreground\">\r\n                      <ClockCounterClockwise weight=\"duotone\" className=\"w-10 h-10\" />\r\n                    </div>\r\n                    <p className=\"text-sm font-black uppercase tracking-[0.3em]\">Zero cycle history detected in neural registry.</p>\r\n                  </Card>\r\n                )}\r\n              </motion.div>\r\n            )}\r\n\r\n            {activeTab === 'transactions' && (\r\n              <motion.div\r\n                key=\"transactions\"\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                exit={{ opacity: 0, y: -20 }}\r\n              >\r\n                <Card className=\"rounded-[40px] border-border/50 overflow-hidden shadow-premium\">\r\n                  <div className=\"overflow-x-auto\">\r\n                    <table className=\"w-full text-left border-collapse\">\r\n                      <thead>\r\n                        <tr className=\"bg-secondary/50 border-b border-border/50\">\r\n                          <th className=\"px-10 py-6 text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em]\">TXN Identity</th>\r\n                          <th className=\"px-10 py-6 text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em]\">Protocol Node</th>\r\n                          <th className=\"px-10 py-6 text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em]\">Fiscal Valuation</th>\r\n                          <th className=\"px-10 py-6 text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em]\">Verification</th>\r\n                        </tr>\r\n                      </thead>\r\n                      <tbody className=\"divide-y divide-border/30\">\r\n                        {customer.sales_commissions.map((txn, i) => (\r\n                          <tr key={i} className=\"group hover:bg-primary/[0.02] transition-colors\">\r\n                            <td className=\"px-10 py-6\">\r\n                              <span className=\"text-xs font-mono font-black text-primary/40 group-hover:text-primary transition-colors\">TXN-{txn.id.slice(0, 8).toUpperCase()}</span>\r\n                            </td>\r\n                            <td className=\"px-10 py-6\">\r\n                              <p className=\"text-sm font-bold text-foreground uppercase tracking-tight\">{txn.transaction_type}</p>\r\n                              <p className=\"text-[9px] text-muted-foreground font-black uppercase tracking-widest mt-1\">Processed Node Alpha</p>\r\n                            </td>\r\n                            <td className=\"px-10 py-6\">\r\n                              <span className=\"text-lg font-black text-foreground tabular-nums tracking-tight\">เธฟ{Number(txn.base_amount).toLocaleString()}</span>\r\n                            </td>\r\n                            <td className=\"px-10 py-6\">\r\n                              <Badge \r\n                                variant={txn.payment_status === 'paid' ? 'success' : 'warning'}\r\n                                className=\"font-black uppercase text-[8px] tracking-[0.2em] px-3 py-1\"\r\n                              >\r\n                                {txn.payment_status}\r\n                              </Badge>\r\n                            </td>\r\n                          </tr>\r\n                        ))}\r\n                      </tbody>\r\n                    </table>\r\n                  </div>\r\n                  {customer.sales_commissions.length === 0 && (\r\n                    <div className=\"py-32 text-center opacity-20 flex flex-col items-center gap-6\">\r\n                      <div className=\"w-20 h-20 rounded-[40px] bg-secondary flex items-center justify-center text-muted-foreground\">\r\n                        <CreditCard weight=\"duotone\" className=\"w-10 h-10\" />\r\n                      </div>\r\n                      <p className=\"text-sm font-black uppercase tracking-[0.3em]\">Zero fiscal telemetry detected.</p>\r\n                    </div>\r\n                  )}\r\n                </Card>\r\n              </motion.div>\r\n            )}\r\n          </AnimatePresence>\r\n        </div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n\r\nexport default function CustomerDetailPage() {\r\n  return (\r\n    <Suspense fallback={\r\n      <div className=\"h-[80vh] flex flex-col items-center justify-center space-y-6\">\r\n        <SpinnerGap className=\"w-12 h-12 text-primary animate-spin\" />\r\n        <p className=\"text-sm font-black uppercase tracking-[0.3em] text-muted-foreground animate-pulse\">Initializing Interface node...</p>\r\n      </div>\r\n    }>\r\n      <CustomerDetailPageContent />\r\n    </Suspense>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\customers\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Plus"},"fix":{"range":[197,206],"text":""},"desc":"Remove unused variable \"Plus\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":41,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { motion } from 'framer-motion';\r\nimport {\r\n  Users,\r\n  MagnifyingGlass,\r\n  Funnel,\r\n  DotsThreeVertical,\r\n  EnvelopeSimple,\r\n  Phone,\r\n  UserPlus,\r\n  Sparkle,\r\n  SpinnerGap,\r\n  Plus\r\n} from '@phosphor-icons/react';\r\nimport { cn } from '@/lib/utils';\r\nimport { useEffect, useState, useCallback, Suspense } from 'react';\r\nimport { useSearchParams, usePathname } from 'next/navigation';\r\nimport { Link, useRouter } from '@/i18n/routing';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport ResponsiveTable from '@/components/ui/ResponsiveTable';\r\nimport CustomerModal from '@/components/CustomerModal';\r\n\r\ninterface Customer {\r\n  id: string;\r\n  full_name: string;\r\n  nickname?: string;\r\n  email?: string;\r\n  phone?: string;\r\n  status: string;\r\n  customer_type: string;\r\n  created_at: string;\r\n  metadata?: {\r\n    skinScore?: number;\r\n    lastScan?: string;\r\n  };\r\n}\r\n\r\nfunction CustomerManagementContent() {\r\n  const { goBack } = useBackNavigation();\r\n  const [customers, setCustomers] = useState<Customer[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [totalCount, setTotalCount] = useState(0);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [selectedCustomer, setSelectedCustomer] = useState<Customer | undefined>(undefined);\r\n  \r\n  const searchParams = useSearchParams();\r\n  const router = useRouter();\r\n  const pathname = usePathname();\r\n\r\n  const fetchCustomers = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const q = searchParams.get('q') || '';\r\n      const page = searchParams.get('page') || '1';\r\n      const res = await fetch(`/api/customers?q=${encodeURIComponent(q)}&page=${page}`);\r\n      const result = await res.json();\r\n      \r\n      if (result.success) {\r\n        setCustomers(result.data);\r\n        setTotalCount(result.pagination?.total || 0);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching customers:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [searchParams]);\r\n\r\n  useEffect(() => {\r\n    fetchCustomers();\r\n  }, [fetchCustomers]);\r\n\r\n  const handleSearch = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    const params = new URLSearchParams(searchParams.toString());\r\n    if (searchTerm) {\r\n      params.set('q', searchTerm);\r\n    } else {\r\n      params.delete('q');\r\n    }\r\n    params.set('page', '1');\r\n    router.push(`${pathname}?${params.toString()}`);\r\n  };\r\n\r\n  const handleAddCustomer = () => {\r\n    setSelectedCustomer(undefined);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleEditCustomer = (customer: Customer) => {\r\n    setSelectedCustomer(customer);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const columns = [\r\n    {\r\n      header: 'Patient Identity',\r\n      accessor: (customer: Customer) => (\r\n        <div className=\"flex items-center gap-4\">\r\n          <div className=\"w-12 h-12 rounded-full bg-primary/10 border border-primary/20 flex items-center justify-center text-primary font-bold shadow-sm shrink-0\">\r\n            {customer.full_name.charAt(0)}\r\n          </div>\r\n          <div className=\"min-w-0\">\r\n            <Link href={`/clinic/customers/${customer.id}`} className=\"font-bold text-foreground hover:text-primary transition-colors truncate block\">\r\n              {customer.full_name} {customer.nickname ? `(${customer.nickname})` : ''}\r\n            </Link>\r\n            <div className=\"flex flex-wrap items-center gap-3 text-[10px] text-muted-foreground mt-0.5\">\r\n              <span className=\"flex items-center gap-1\"><EnvelopeSimple className=\"w-3 h-3\" /> {customer.email || 'No Email'}</span>\r\n              <span className=\"flex items-center gap-1\"><Phone className=\"w-3 h-3\" /> {customer.phone || 'No Phone'}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )\r\n    },\r\n    {\r\n      header: 'Cutaneous Health',\r\n      accessor: (customer: Customer) => {\r\n        const skinScore = customer.metadata?.skinScore || 0;\r\n        return (\r\n          <div className=\"space-y-1.5 w-32\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-[10px] font-bold text-muted-foreground uppercase tracking-wider\">Score</span>\r\n              <span className=\"text-[10px] font-bold text-foreground\">{skinScore}%</span>\r\n            </div>\r\n            <div className=\"h-1 w-full bg-secondary rounded-full overflow-hidden border border-border\">\r\n              <motion.div \r\n                initial={{ width: 0 }}\r\n                animate={{ width: `${skinScore}%` }}\r\n                className={cn(\r\n                  \"h-full rounded-full\",\r\n                  skinScore > 80 ? \"bg-emerald-500\" : skinScore > 70 ? \"bg-primary\" : \"bg-rose-500\"\r\n                )} \r\n              />\r\n            </div>\r\n          </div>\r\n        );\r\n      }\r\n    },\r\n    {\r\n      header: 'Security Tier',\r\n      accessor: (customer: Customer) => (\r\n        <span className={cn(\r\n          \"px-3 py-1 rounded-full text-[9px] font-bold uppercase tracking-wider border\",\r\n          customer.customer_type === 'premium' \r\n            ? \"bg-primary/10 border-primary/20 text-primary\" \r\n            : \"bg-secondary border-border text-muted-foreground\"\r\n        )}>\r\n          {customer.customer_type}\r\n        </span>\r\n      )\r\n    },\r\n    {\r\n      header: 'Last Diagnostic',\r\n      accessor: (customer: Customer) => {\r\n        const lastScan = customer.metadata?.lastScan || customer.created_at;\r\n        return (\r\n          <div className=\"flex flex-col\">\r\n            <span className=\"text-[10px] font-bold text-primary uppercase tracking-wider flex items-center gap-1.5\">\r\n              <Sparkle className=\"w-3 h-3 animate-pulse\" /> AI Validated\r\n            </span>\r\n            <span className=\"text-xs text-muted-foreground mt-0.5\">\r\n              {new Date(lastScan).toLocaleDateString(undefined, { month: 'short', day: 'numeric', year: 'numeric' })}\r\n            </span>\r\n          </div>\r\n        );\r\n      }\r\n    },\r\n    {\r\n      header: '',\r\n      className: 'text-right',\r\n      accessor: (customer: Customer) => (\r\n        <button \r\n          onClick={() => handleEditCustomer(customer)}\r\n          className=\"p-2 text-muted-foreground hover:text-foreground hover:bg-accent rounded-xl transition-all\"\r\n        >\r\n          <DotsThreeVertical className=\"w-5 h-5\" />\r\n        </button>\r\n      )\r\n    }\r\n  ];\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-6 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      <CustomerModal \r\n        isOpen={isModalOpen} \r\n        onClose={() => setIsModalOpen(false)} \r\n        onSuccess={fetchCustomers}\r\n        customer={selectedCustomer}\r\n      />\r\n\r\n      {/* Header */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-xs font-bold uppercase tracking-[0.3em]\"\r\n          >\r\n            <Users className=\"w-4 h-4\" />\r\n            Patient Identity Management\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground uppercase tracking-tight\"\r\n          >\r\n            Customer <span className=\"text-primary\">Database</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Managing patient profiles, cutaneous history, and aesthetic progress nodes.\r\n          </motion.p>\r\n        </div>\r\n        <motion.button \r\n          whileHover={{ scale: 1.02 }}\r\n          whileTap={{ scale: 0.98 }}\r\n          onClick={handleAddCustomer}\r\n          className=\"flex items-center gap-3 px-8 py-4 bg-primary text-primary-foreground rounded-2xl font-bold uppercase tracking-[0.1em] shadow-premium hover:brightness-110 transition-all active:scale-95 text-xs\"\r\n        >\r\n          <UserPlus className=\"w-4 h-4 stroke-[3px]\" />\r\n          <span>Register New Patient</span>\r\n        </motion.button>\r\n      </div>\r\n\r\n      {/* Search & Stats */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-8\">\r\n        <div className=\"lg:col-span-3 flex flex-col sm:flex-row gap-6\">\r\n          <motion.form \r\n            onSubmit={handleSearch}\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ delay: 0.3 }}\r\n            className=\"relative flex-1 group\"\r\n          >\r\n            <div className=\"absolute inset-0 bg-primary/10 blur-2xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-3xl\" />\r\n            <MagnifyingGlass className=\"absolute left-5 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\r\n            <input \r\n              type=\"text\" \r\n              placeholder=\"Filter by identity, digital mail, or neural ID...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              className=\"w-full bg-secondary border border-border rounded-xl py-4 pl-14 pr-6 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner backdrop-blur-md relative z-10\"\r\n            />\r\n          </motion.form>\r\n          <motion.button \r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ delay: 0.4 }}\r\n            className=\"flex items-center gap-3 px-6 py-4 bg-secondary border border-border rounded-xl text-xs font-bold uppercase tracking-widest text-foreground hover:bg-accent transition-all backdrop-blur-md\"\r\n          >\r\n            <Funnel className=\"w-4 h-4 text-primary\" />\r\n            <span>Advanced Filters</span>\r\n          </motion.button>\r\n        </div>\r\n        <motion.div \r\n          initial={{ opacity: 0, x: 20 }}\r\n          animate={{ opacity: 1, x: 0 }}\r\n          transition={{ delay: 0.5 }}\r\n          whileHover={{ y: -5 }}\r\n          className=\"bg-card p-6 rounded-2xl border border-border shadow-card flex items-center justify-between group overflow-hidden relative\"\r\n        >\r\n          <div className=\"absolute -top-2 -right-2 opacity-5 group-hover:opacity-10 transition-opacity\">\r\n            <Users className=\"w-16 h-16 text-foreground\" />\r\n          </div>\r\n          <div>\r\n            <p className=\"text-[10px] font-bold text-muted-foreground uppercase tracking-[0.2em] mb-1\">Active Population</p>\r\n            <p className=\"text-3xl font-bold text-foreground tracking-tighter\">{totalCount.toLocaleString()}</p>\r\n          </div>\r\n          <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-premium group-hover:scale-110 transition-transform\">\r\n            <Users className=\"w-7 h-7\" />\r\n          </div>\r\n        </motion.div>\r\n      </div>\r\n\r\n      {/* Customer List Table */}\r\n      <ResponsiveTable\r\n        columns={columns}\r\n        data={customers}\r\n        loading={loading}\r\n        rowKey={(c) => c.id}\r\n        emptyMessage=\"No patients found in the neural database\"\r\n        onRowClick={(c) => router.push(`/clinic/customers/${c.id}`)}\r\n        mobileCard={(c) => (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <div className=\"w-12 h-12 rounded-full bg-primary/10 border border-primary/20 flex items-center justify-center text-primary font-bold\">\r\n                {c.full_name.charAt(0)}\r\n              </div>\r\n              <div className=\"min-w-0 flex-1\">\r\n                <p className=\"font-bold text-foreground truncate\">{c.full_name}</p>\r\n                <div className=\"flex items-center gap-2 mt-0.5\">\r\n                  <span className={cn(\r\n                    \"px-2 py-0.5 rounded-md text-[8px] font-bold uppercase tracking-wider border\",\r\n                    c.customer_type === 'premium' ? \"bg-primary/10 border-primary/20 text-primary\" : \"bg-secondary border-border text-muted-foreground\"\r\n                  )}>\r\n                    {c.customer_type}\r\n                  </span>\r\n                  <span className=\"text-[10px] text-muted-foreground\">{c.phone}</span>\r\n                </div>\r\n              </div>\r\n              <div className=\"text-right\">\r\n                <p className=\"text-[8px] font-bold text-muted-foreground uppercase tracking-widest\">Skin Score</p>\r\n                <p className=\"text-sm font-bold text-primary\">{c.metadata?.skinScore || 0}%</p>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex justify-between items-center pt-3 border-t border-border\">\r\n              <span className=\"text-[10px] text-muted-foreground italic\">\r\n                Last Diagnostic: {new Date(c.metadata?.lastScan || c.created_at).toLocaleDateString()}\r\n              </span>\r\n              <button \r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  handleEditCustomer(c);\r\n                }}\r\n                className=\"p-2 bg-secondary border border-border rounded-xl text-muted-foreground\"\r\n              >\r\n                <DotsThreeVertical className=\"w-4 h-4\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      />\r\n    </motion.div>\r\n  );\r\n}\r\n\r\nexport default function CustomerManagement() {\r\n  return (\r\n    <Suspense fallback={\r\n      <div className=\"h-[80vh] flex flex-col items-center justify-center space-y-6\">\r\n        <SpinnerGap className=\"w-12 h-12 text-primary animate-spin\" />\r\n        <p className=\"text-sm font-black uppercase tracking-[0.3em] text-muted-foreground animate-pulse\">Initializing Customer Interface...</p>\r\n      </div>\r\n    }>\r\n      <CustomerManagementContent />\r\n    </Suspense>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\email-campaigns\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Users"},"fix":{"range":[132,142],"text":""},"desc":"Remove unused variable \"Users\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendUp' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TrendUp"},"fix":{"range":[142,154],"text":""},"desc":"Remove unused variable \"TrendUp\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[154,167],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[167,181],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChartBar' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":11,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ChartBar"},"fix":{"range":[181,193],"text":""},"desc":"Remove unused variable \"ChartBar\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningCircle' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WarningCircle"},"fix":{"range":[193,210],"text":""},"desc":"Remove unused variable \"WarningCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle"},"fix":{"range":[210,225],"text":""},"desc":"Remove unused variable \"CheckCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":40,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":41,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":41,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1019,1022],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1019,1022],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getStatusStyle' is assigned a value but never used.","line":58,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":58,"endColumn":23},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":77,"column":6,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":77,"endColumn":12},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":87,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":87,"endColumn":18},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":95,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":95,"endColumn":18},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":103,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":103,"endColumn":18},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'SpinnerGap' is not defined.","line":169,"column":14,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":169,"endColumn":24},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":183,"column":16,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":183,"endColumn":22},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":208,"column":23,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[7933,7957],"text":"\n                      &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[7933,7957],"text":"\n                      &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[7933,7957],"text":"\n                      &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[7933,7957],"text":"\n                      &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":208,"column":42,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[7975,7997],"text":"&quot;\n                    "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[7975,7997],"text":"&ldquo;\n                    "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[7975,7997],"text":"&#34;\n                    "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[7975,7997],"text":"&rdquo;\n                    "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'AnimatePresence' is not defined.","line":236,"column":8,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":236,"endColumn":23},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":239,"column":14,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":239,"endColumn":20},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'X' is not defined.","line":259,"column":20,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":259,"endColumn":21}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { \n  EnvelopeSimple, \n  Plus, \n  PaperPlaneTilt, \n  Clock, \n  Eye, \n  Users, \n  TrendUp,\n  ArrowLeft,\n  CaretRight,\n  ChartBar,\n  WarningCircle,\n  CheckCircle,\n  Megaphone,\n  ArrowsClockwise\n} from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { useTranslations } from 'next-intl';\nimport { cn } from '@/lib/utils';\n\ninterface Campaign {\n  id: string;\n  name: string;\n  subject: string;\n  status: string;\n  scheduled_at?: string;\n  sent_at?: string;\n  created_at: string;\n}\n\nexport default function EmailCampaignsPage() {\n  const { goBack } = useBackNavigation();\n  const t = useTranslations('clinic.email-campaigns' as any);\n  const [campaigns, setCampaigns] = useState<Campaign[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [showCreate, setShowCreate] = useState(false);\n\n  useEffect(() => { fetchData(); }, []);\n\n  const fetchData = async () => {\n    setLoading(true);\n    try {\n      const res = await fetch('/api/email-campaigns');\n      const data = await res.json();\n      setCampaigns(data.campaigns || []);\n    } catch (e) { console.error(e); }\n    setLoading(false);\n  };\n\n  const getStatusStyle = (s: string) => {\n    if (s === 'sent') return 'bg-green-100 text-green-700';\n    if (s === 'scheduled') return 'bg-blue-100 text-blue-700';\n    if (s === 'sending') return 'bg-yellow-100 text-yellow-700';\n    if (s === 'draft') return 'bg-gray-100 text-gray-700';\n    return 'bg-gray-100 text-gray-700';\n  };\n\n  const getStatusLabel = (s: string) => {\n    if (s === 'sent') return 'เธชเนเธเนเธฅเนเธง';\n    if (s === 'scheduled') return 'เธเธณเธซเธเธ”เน€เธงเธฅเธฒ';\n    if (s === 'sending') return 'เธเธณเธฅเธฑเธเธชเนเธ';\n    if (s === 'draft') return 'เธฃเนเธฒเธ';\n    return s;\n  };\n\n  const formatDate = (d: string) => new Date(d).toLocaleDateString('th-TH', { day: 'numeric', month: 'short', year: 'numeric' });\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <Megaphone weight=\"duotone\" className=\"w-4 h-4\" />\n            Marketing Operations Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight\"\n          >\n            Email <span className=\"text-primary\">Campaigns</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Orchestrating targeted clinical outreach and automated engagement cycles.\n          </motion.p>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <Button \n            variant=\"outline\" \n            onClick={fetchData}\n            disabled={loading}\n            className=\"gap-2\"\n          >\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\n            Sync Intel\n          </Button>\n          <Button \n            onClick={() => setShowCreate(true)}\n            className=\"gap-2 shadow-premium px-8\"\n          >\n            <Plus weight=\"bold\" className=\"w-4 h-4\" />\n            Initiate Campaign\n          </Button>\n        </div>\n      </div>\n\n      {/* Campaign Metrics */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n        <StatCard\n          title=\"Total Campaigns\"\n          value={campaigns.length}\n          icon={EnvelopeSimple}\n          trend=\"neutral\"\n        />\n        <StatCard\n          title=\"Nodes Transmitted\"\n          value={campaigns.filter(c => c.status === 'sent').length}\n          icon={PaperPlaneTilt}\n          trend=\"up\"\n          change={12}\n          iconColor=\"text-emerald-500\"\n        />\n        <StatCard\n          title=\"Scheduled Cycles\"\n          value={campaigns.filter(c => c.status === 'scheduled').length}\n          icon={Clock}\n          trend=\"neutral\"\n          iconColor=\"text-blue-500\"\n        />\n        <StatCard\n          title=\"Draft Node Count\"\n          value={campaigns.filter(c => c.status === 'draft').length}\n          icon={Eye}\n          trend=\"neutral\"\n          iconColor=\"text-muted-foreground\"\n        />\n      </div>\n\n      {/* Campaigns Grid */}\n      <div className=\"space-y-6\">\n        {loading ? (\n          <div className=\"py-32 flex flex-col items-center gap-4\">\n            <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Syncing Campaign Matrix...</p>\n          </div>\n        ) : campaigns.length === 0 ? (\n          <Card variant=\"ghost\" className=\"py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-4 opacity-40\">\n            <EnvelopeSimple weight=\"duotone\" className=\"w-16 h-16\" />\n            <div className=\"text-center\">\n              <p className=\"text-xs font-black uppercase tracking-widest mb-2\">Zero Marketing Signals Detected</p>\n              <Button variant=\"ghost\" size=\"sm\" onClick={() => setShowCreate(true)} className=\"text-primary font-bold uppercase tracking-widest\">Initialize First Node</Button>\n            </div>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {campaigns.map((campaign, i) => (\n              <motion.div\n                key={campaign.id}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: i * 0.05 }}\n              >\n                <Card className=\"h-full border-border/50 hover:border-primary/30 transition-all group overflow-hidden flex flex-col\">\n                  <CardHeader className=\"pb-4\">\n                    <div className=\"flex justify-between items-start gap-4\">\n                      <div className=\"flex items-center gap-4 min-w-0\">\n                        <div className=\"w-12 h-12 rounded-2xl bg-secondary/50 border border-border flex items-center justify-center text-primary group-hover:bg-primary/10 transition-all duration-500\">\n                          <EnvelopeSimple weight=\"duotone\" className=\"w-6 h-6\" />\n                        </div>\n                        <div className=\"min-w-0\">\n                          <CardTitle className=\"truncate tracking-tight text-lg\">{campaign.name}</CardTitle>\n                          <Badge variant={campaign.status === 'sent' ? 'success' : campaign.status === 'scheduled' ? 'default' : 'secondary'} size=\"sm\" className=\"font-black uppercase tracking-widest mt-1\">\n                            {getStatusLabel(campaign.status)}\n                          </Badge>\n                        </div>\n                      </div>\n                    </div>\n                  </CardHeader>\n\n                  <CardContent className=\"flex-1 space-y-6\">\n                    <p className=\"text-sm text-foreground/70 line-clamp-2 font-medium bg-secondary/30 p-4 rounded-2xl border border-border/50\">\n                      \"{campaign.subject}\"\n                    </p>\n                    \n                    <div className=\"flex items-center justify-between pt-4 border-t border-border/50\">\n                      <div className=\"flex items-center gap-2 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\n                        <Clock weight=\"bold\" className=\"w-3.5 h-3.5\" />\n                        {formatDate(campaign.created_at)}\n                      </div>\n                      <div className=\"flex gap-2\">\n                        <Button variant=\"ghost\" size=\"sm\" className=\"p-2 text-muted-foreground hover:text-primary\">\n                          Edit\n                        </Button>\n                        {campaign.status === 'draft' && (\n                          <Button variant=\"ghost\" size=\"sm\" className=\"p-2 text-emerald-500 hover:bg-emerald-500/5\">\n                            Send\n                          </Button>\n                        )}\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Create Modal */}\n      <AnimatePresence>\n        {showCreate && (\n          <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-[200] flex items-center justify-center p-4\">\n            <motion.div\n              initial={{ opacity: 0, scale: 0.95, y: 20 }}\n              animate={{ opacity: 1, scale: 1 }}\n              exit={{ opacity: 0, scale: 0.95, y: 20 }}\n              className=\"bg-card p-8 rounded-[32px] border border-border shadow-premium w-full max-w-lg relative overflow-hidden\"\n            >\n              <div className=\"flex items-center justify-between mb-8\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20\">\n                    <Plus weight=\"bold\" className=\"w-6 h-6\" />\n                  </div>\n                  <div>\n                    <h2 className=\"text-2xl font-bold text-foreground tracking-tight\">New Marketing Node</h2>\n                    <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Initialize outreach protocol</p>\n                  </div>\n                </div>\n                <button \n                  onClick={() => setShowCreate(false)}\n                  className=\"p-2 text-muted-foreground hover:text-foreground hover:bg-secondary rounded-xl transition-all\"\n                >\n                  <X weight=\"bold\" className=\"w-6 h-6\" />\n                </button>\n              </div>\n\n              <form onSubmit={async e => {\n                e.preventDefault();\n                const fd = new FormData(e.currentTarget);\n                await fetch('/api/email-campaigns', {\n                  method: 'POST',\n                  headers: { 'Content-Type': 'application/json' },\n                  body: JSON.stringify({\n                    name: fd.get('name'),\n                    subject: fd.get('subject'),\n                    contentHtml: `<p>${fd.get('content')}</p>`\n                  })\n                });\n                setShowCreate(false);\n                fetchData();\n              }} className=\"space-y-6\">\n                <div className=\"space-y-2\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Campaign Node Identity</label>\n                  <input name=\"name\" required className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-5 text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-medium placeholder:text-muted-foreground/40\" placeholder=\"e.g. VIP Re-engagement Cycle\" />\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Transmission Subject</label>\n                  <input name=\"subject\" required className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-5 text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-medium placeholder:text-muted-foreground/40\" placeholder=\"Identity-validated subject line\" />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Payload Content</label>\n                  <textarea name=\"content\" rows={4} required className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-5 text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-medium placeholder:text-muted-foreground/40 resize-none\" placeholder=\"HTML or text-based transmission content...\" />\n                </div>\n\n                <div className=\"flex flex-col sm:flex-row items-center gap-4 mt-10\">\n                  <Button type=\"submit\" className=\"w-full sm:w-auto px-10 py-4 shadow-premium\">\n                    Authorize Node\n                  </Button>\n                  <Button \n                    type=\"button\"\n                    variant=\"ghost\" \n                    onClick={() => setShowCreate(false)}\n                    className=\"w-full sm:w-auto text-xs font-black uppercase tracking-widest text-muted-foreground\"\n                  >\n                    Abort\n                  </Button>\n                </div>\n              </form>\n            </motion.div>\n          </div>\n        )}\n      </AnimatePresence>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\gallery\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Funnel' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":9,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Funnel"},"fix":{"range":[124,135],"text":""},"desc":"Remove unused variable \"Funnel\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[170,183],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Clock"},"fix":{"range":[217,226],"text":""},"desc":"Remove unused variable \"Clock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"User"},"fix":{"range":[226,234],"text":""},"desc":"Remove unused variable \"User\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[234,248],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":22,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[358,370],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":22,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[370,381],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":56,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":56,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":57,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":57,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":57,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":57,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1405,1408],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1405,1408],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":96,"column":6,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":96,"endColumn":12},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":106,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":106,"endColumn":18},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":114,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":114,"endColumn":18},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":122,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":122,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":191,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":191,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5926,5929],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5926,5929],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'AnimatePresence' is not defined.","line":206,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":206,"endColumn":27},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":208,"column":16,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":208,"endColumn":22},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'AnimatePresence' is not defined.","line":256,"column":8,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":256,"endColumn":23},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":258,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":258,"endColumn":18},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'SpinnerGap' is not defined.","line":265,"column":14,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":265,"endColumn":24},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":269,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":269,"endColumn":18},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":285,"column":20,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":285,"endColumn":26},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":295,"column":29,"nodeType":"JSXOpeningElement","endLine":299,"endColumn":31},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":304,"column":29,"nodeType":"JSXOpeningElement","endLine":308,"endColumn":31},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":340,"column":31,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[14148,14180],"text":"\n                              &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[14148,14180],"text":"\n                              &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[14148,14180],"text":"\n                              &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[14148,14180],"text":"\n                              &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":340,"column":56,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[14204,14234],"text":"&quot;\n                            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[14204,14234],"text":"&ldquo;\n                            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[14204,14234],"text":"&#34;\n                            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[14204,14234],"text":"&rdquo;\n                            "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":365,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":365,"endColumn":18},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":383,"column":20,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":383,"endColumn":26},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":391,"column":25,"nodeType":"JSXOpeningElement","endLine":395,"endColumn":27},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":411,"column":27,"nodeType":"JSXOpeningElement","endLine":415,"endColumn":29}],"suppressedMessages":[],"errorCount":15,"fatalErrorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { \n  Image as ImageIcon, \n  Plus, \n  SquaresFour, \n  List, \n  Funnel, \n  Eye, \n  ShareNetwork, \n  Trash,\n  ArrowLeft,\n  ArrowsClockwise,\n  CheckCircle,\n  Clock,\n  User,\n  CaretRight,\n  Sparkle\n} from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { useTranslations } from 'next-intl';\nimport { cn } from '@/lib/utils';\n\ninterface Photo {\n  id: string;\n  photo_url: string;\n  thumbnail_url?: string;\n  type: 'before' | 'after' | 'progress';\n  taken_at: string;\n  notes?: string;\n  customer?: { id: string; full_name: string };\n  treatment?: { id: string; names: { th: string; en: string } };\n  customer_consent: boolean;\n  public_gallery_consent: boolean;\n}\n\ninterface Comparison {\n  id: string;\n  title?: string;\n  description?: string;\n  treatment_name?: string;\n  is_public: boolean;\n  featured: boolean;\n  view_count: number;\n  before_photo: Photo;\n  after_photo: Photo;\n}\n\nexport default function GalleryPage() {\n  const { goBack } = useBackNavigation();\n  const t = useTranslations('clinic.gallery' as any);\n  const [photos, setPhotos] = useState<Photo[]>([]);\n  const [comparisons, setComparisons] = useState<Comparison[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [activeTab, setActiveTab] = useState<'photos' | 'comparisons'>('comparisons');\n  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid');\n  const [typeFilter, setTypeFilter] = useState<'all' | 'before' | 'after' | 'progress'>('all');\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  const fetchData = async () => {\n    try {\n      setLoading(true);\n      const res = await fetch('/api/gallery');\n      const data = await res.json();\n      setPhotos(data.photos || []);\n      setComparisons(data.comparisons || []);\n    } catch (error) {\n      console.error('Failed to fetch gallery:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const formatDate = (dateStr: string) => {\n    return new Date(dateStr).toLocaleDateString('th-TH', {\n      day: 'numeric',\n      month: 'short',\n      year: 'numeric'\n    });\n  };\n\n  const filteredPhotos = typeFilter === 'all' \n    ? photos \n    : photos.filter(p => p.type === typeFilter);\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <ImageIcon weight=\"duotone\" className=\"w-4 h-4\" />\n            Visual Evidence Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight\"\n          >\n            Clinical <span className=\"text-primary\">Gallery</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Managing transformation benchmarks, evolution comparisons, and clinical visual records.\n          </motion.p>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <Button \n            variant=\"outline\" \n            onClick={fetchData}\n            disabled={loading}\n            className=\"gap-2\"\n          >\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\n            Sync Media\n          </Button>\n          <Button className=\"gap-2 shadow-premium px-8\">\n            <Plus weight=\"bold\" className=\"w-4 h-4\" />\n            Upload Evidence\n          </Button>\n        </div>\n      </div>\n\n      {/* Stats Summary */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n        <StatCard\n          title=\"Total Media Units\"\n          value={photos.length}\n          icon={ImageIcon}\n          trend=\"neutral\"\n        />\n        <StatCard\n          title=\"Transformation Pairs\"\n          value={comparisons.length}\n          icon={SquaresFour}\n          trend=\"up\"\n          change={5}\n          iconColor=\"text-primary\"\n        />\n        <StatCard\n          title=\"Public Portfolios\"\n          value={comparisons.filter(c => c.is_public).length}\n          icon={CheckCircle}\n          trend=\"neutral\"\n          iconColor=\"text-emerald-500\"\n        />\n        <StatCard\n          title=\"Global Visual Reach\"\n          value={comparisons.reduce((sum, c) => sum + c.view_count, 0)}\n          icon={Eye}\n          trend=\"up\"\n          change={12}\n          iconColor=\"text-purple-500\"\n        />\n      </div>\n\n      {/* Navigation Tabs & Controls */}\n      <div className=\"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6\">\n        <div className=\"flex bg-secondary/50 border border-border p-1 rounded-2xl w-fit shadow-inner\">\n          {[\n            { id: 'comparisons', label: 'Evolution Pairs', icon: SquaresFour },\n            { id: 'photos', label: 'Identity Registry', icon: ImageIcon }\n          ].map((tab) => (\n            <button\n              key={tab.id}\n              onClick={() => setActiveTab(tab.id as any)}\n              className={cn(\n                \"flex items-center gap-2 px-6 py-2.5 rounded-xl text-[11px] font-black uppercase tracking-widest transition-all border\",\n                activeTab === tab.id\n                  ? \"bg-card text-primary border-border/50 shadow-sm\"\n                  : \"text-muted-foreground border-transparent hover:text-foreground\"\n              )}\n            >\n              <tab.icon weight={activeTab === tab.id ? \"fill\" : \"duotone\"} className=\"w-4 h-4\" />\n              {tab.label}\n            </button>\n          ))}\n        </div>\n\n        <div className=\"flex items-center gap-4\">\n          <AnimatePresence mode=\"wait\">\n            {activeTab === 'photos' && (\n              <motion.div \n                initial={{ opacity: 0, x: 20 }}\n                animate={{ opacity: 1, x: 0 }}\n                exit={{ opacity: 0, x: 20 }}\n                className=\"flex items-center gap-3 bg-secondary/50 border border-border p-1 rounded-2xl shadow-inner\"\n              >\n                {(['all', 'before', 'after', 'progress'] as const).map((type) => (\n                  <button\n                    key={type}\n                    onClick={() => setTypeFilter(type)}\n                    className={cn(\n                      \"px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border\",\n                      typeFilter === type\n                        ? \"bg-card text-primary border-border/50 shadow-sm\"\n                        : \"text-muted-foreground border-transparent hover:text-foreground\"\n                    )}\n                  >\n                    {type === 'all' ? 'Universal' : type}\n                  </button>\n                ))}\n              </motion.div>\n            )}\n          </AnimatePresence>\n\n          <div className=\"flex bg-secondary/50 border border-border p-1 rounded-2xl shadow-inner\">\n            <button\n              onClick={() => setViewMode('grid')}\n              className={cn(\n                \"p-2 rounded-xl transition-all\",\n                viewMode === 'grid' ? \"bg-card text-primary shadow-sm\" : \"text-muted-foreground hover:text-foreground\"\n              )}\n            >\n              <SquaresFour weight=\"bold\" className=\"w-5 h-5\" />\n            </button>\n            <button\n              onClick={() => setViewMode('list')}\n              className={cn(\n                \"p-2 rounded-xl transition-all\",\n                viewMode === 'list' ? \"bg-card text-primary shadow-sm\" : \"text-muted-foreground hover:text-foreground\"\n              )}\n            >\n              <List weight=\"bold\" className=\"w-5 h-5\" />\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content Area */}\n      <AnimatePresence mode=\"wait\">\n        {loading ? (\n          <motion.div \n            key=\"loading\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"py-32 flex flex-col items-center gap-4\"\n          >\n            <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Decoding Media Matrix...</p>\n          </motion.div>\n        ) : activeTab === 'comparisons' ? (\n          <motion.div \n            key=\"comparisons\"\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -20 }}\n          >\n            {comparisons.length === 0 ? (\n              <Card variant=\"ghost\" className=\"py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-4 opacity-40\">\n                <SquaresFour weight=\"duotone\" className=\"w-16 h-16\" />\n                <p className=\"text-xs font-black uppercase tracking-widest\">Zero Evolution Benchmark Detected</p>\n              </Card>\n            ) : (\n              <div className={cn(\n                viewMode === 'grid' ? 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8' : 'space-y-4'\n              )}>\n                {comparisons.map((comparison, i) => (\n                  <motion.div\n                    key={comparison.id}\n                    initial={{ opacity: 0, scale: 0.95 }}\n                    animate={{ opacity: 1, scale: 1 }}\n                    transition={{ delay: i * 0.05 }}\n                  >\n                    <Card className=\"h-full border-border/50 hover:border-primary/30 transition-all group overflow-hidden flex flex-col\">\n                      <div className=\"relative aspect-[16/9] bg-secondary/50 overflow-hidden\">\n                        <div className=\"grid grid-cols-2 h-full gap-0.5\">\n                          <div className=\"relative group/before\">\n                            <img\n                              src={comparison.before_photo?.thumbnail_url || comparison.before_photo?.photo_url || '/placeholder.jpg'}\n                              alt=\"Before\"\n                              className=\"w-full h-full object-cover transition-transform duration-700 group-hover/before:scale-110\"\n                            />\n                            <div className=\"absolute inset-0 bg-black/20\" />\n                            <Badge variant=\"secondary\" size=\"sm\" className=\"absolute top-3 left-3 font-black uppercase text-[8px] bg-black/60 text-white border-none\">Node: Before</Badge>\n                          </div>\n                          <div className=\"relative group/after\">\n                            <img\n                              src={comparison.after_photo?.thumbnail_url || comparison.after_photo?.photo_url || '/placeholder.jpg'}\n                              alt=\"After\"\n                              className=\"w-full h-full object-cover transition-transform duration-700 group-hover/after:scale-110\"\n                            />\n                            <div className=\"absolute inset-0 bg-primary/10\" />\n                            <Badge variant=\"default\" size=\"sm\" className=\"absolute top-3 left-3 font-black uppercase text-[8px] border-none\">Node: After</Badge>\n                          </div>\n                        </div>\n\n                        {/* Overlay Controls */}\n                        <div className=\"absolute inset-0 bg-black/60 backdrop-blur-sm opacity-0 group-hover:opacity-100 transition-all flex items-center justify-center gap-3\">\n                          <Button size=\"sm\" variant=\"outline\" className=\"rounded-full w-10 h-10 p-0 border-white/20 text-white hover:bg-white/10\">\n                            <Eye weight=\"bold\" className=\"w-4 h-4\" />\n                          </Button>\n                          <Button size=\"sm\" variant=\"outline\" className=\"rounded-full w-10 h-10 p-0 border-white/20 text-white hover:bg-white/10\">\n                            <ShareNetwork weight=\"bold\" className=\"w-4 h-4\" />\n                          </Button>\n                          <Button size=\"sm\" variant=\"outline\" className=\"rounded-full w-10 h-10 p-0 border-white/20 text-rose-400 hover:bg-rose-500/10 hover:border-rose-500/30\">\n                            <Trash weight=\"bold\" className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      </div>\n\n                      <CardContent className=\"p-6 flex-1 flex flex-col justify-between\">\n                        <div className=\"space-y-3\">\n                          <div className=\"flex items-center justify-between\">\n                            <h3 className=\"text-lg font-bold text-foreground tracking-tight group-hover:text-primary transition-colors truncate\">\n                              {comparison.title || comparison.treatment_name || 'Protocol Node'}\n                            </h3>\n                            <Badge variant={comparison.is_public ? 'success' : 'secondary'} size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-2\">\n                              {comparison.is_public ? 'Public' : 'Encrypted'}\n                            </Badge>\n                          </div>\n                          {comparison.description && (\n                            <p className=\"text-xs text-muted-foreground font-medium line-clamp-2 italic leading-relaxed\">\n                              \"{comparison.description}\"\n                            </p>\n                          )}\n                        </div>\n\n                        <div className=\"pt-6 mt-6 border-t border-border/50 flex items-center justify-between\">\n                          <div className=\"flex items-center gap-2 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\n                            <Eye weight=\"bold\" className=\"w-3.5 h-3.5 opacity-60\" />\n                            {comparison.view_count} Interactions\n                          </div>\n                          {comparison.featured && (\n                            <Badge variant=\"warning\" size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest gap-1.5 px-3\">\n                              <Sparkle weight=\"fill\" className=\"w-3 h-3\" />\n                              Showcase\n                            </Badge>\n                          )}\n                        </div>\n                      </CardContent>\n                    </Card>\n                  </motion.div>\n                ))}\n              </div>\n            )}\n          </motion.div>\n        ) : (\n          <motion.div \n            key=\"photos\"\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -20 }}\n          >\n            {filteredPhotos.length === 0 ? (\n              <Card variant=\"ghost\" className=\"py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-4 opacity-40\">\n                <ImageIcon weight=\"duotone\" className=\"w-16 h-16\" />\n                <p className=\"text-xs font-black uppercase tracking-widest\">Media Registry Nominal</p>\n              </Card>\n            ) : (\n              <div className={cn(\n                viewMode === 'grid' \n                  ? 'grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4' \n                  : 'space-y-3'\n              )}>\n                {filteredPhotos.map((photo, i) => (\n                  <motion.div\n                    key={photo.id}\n                    initial={{ opacity: 0, scale: 0.9 }}\n                    animate={{ opacity: 1, scale: 1 }}\n                    transition={{ delay: i * 0.02 }}\n                  >\n                    {viewMode === 'grid' ? (\n                      <div className=\"relative aspect-square rounded-[20px] overflow-hidden group cursor-pointer border border-border/50 hover:border-primary/40 transition-all shadow-sm\">\n                        <img\n                          src={photo.thumbnail_url || photo.photo_url}\n                          alt={photo.type}\n                          className=\"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110\"\n                        />\n                        <div className=\"absolute inset-0 bg-black/60 backdrop-blur-[2px] opacity-0 group-hover:opacity-100 transition-all flex flex-col items-center justify-center gap-3\">\n                          <Eye weight=\"bold\" className=\"w-6 h-6 text-white\" />\n                          <span className=\"text-[8px] font-black text-white uppercase tracking-widest\">Analyze Node</span>\n                        </div>\n                        <Badge \n                          variant={photo.type === 'before' ? 'secondary' : photo.type === 'after' ? 'default' : 'warning'} \n                          size=\"sm\" \n                          className=\"absolute top-2 left-2 font-black uppercase text-[7px] tracking-widest px-2 opacity-90 border-none\"\n                        >\n                          {photo.type}\n                        </Badge>\n                      </div>\n                    ) : (\n                      <div className=\"flex items-center gap-5 p-4 bg-secondary/30 rounded-2xl border border-border/50 hover:bg-secondary/50 transition-all group/list\">\n                        <div className=\"w-16 h-16 rounded-xl overflow-hidden border border-border/50 flex-shrink-0 group-hover/list:border-primary/30 transition-all\">\n                          <img\n                            src={photo.thumbnail_url || photo.photo_url}\n                            alt={photo.type}\n                            className=\"w-full h-full object-cover\"\n                          />\n                        </div>\n                        <div className=\"flex-1 min-w-0\">\n                          <p className=\"font-bold text-foreground truncate tracking-tight\">{photo.customer?.full_name || 'Identity Unknown'}</p>\n                          <div className=\"flex items-center gap-3 mt-1\">\n                            <p className=\"text-[10px] text-muted-foreground font-medium uppercase tracking-widest truncate\">{photo.treatment?.names?.th || 'Registry Unlinked'}</p>\n                            <div className=\"w-1 h-1 rounded-full bg-border\" />\n                            <span className=\"text-[9px] text-muted-foreground font-bold tabular-nums uppercase\">{formatDate(photo.taken_at)}</span>\n                          </div>\n                        </div>\n                        <Badge \n                          variant={photo.type === 'before' ? 'secondary' : photo.type === 'after' ? 'default' : 'warning'} \n                          size=\"sm\" \n                          className=\"font-black uppercase text-[8px] tracking-widest px-3 border-none\"\n                        >\n                          {photo.type}\n                        </Badge>\n                      </div>\n                    )}\n                  </motion.div>\n                ))}\n              </div>\n            )}\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\gift-cards\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[243,257],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Ticket' is defined but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":9,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Ticket"},"fix":{"range":[328,339],"text":""},"desc":"Remove unused variable \"Ticket\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":22,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[453,464],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":45,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":46,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":46,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1272,1275],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1272,1275],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchGiftCards'. Either include it or remove the dependency array.","line":55,"column":6,"nodeType":"ArrayExpression","endLine":55,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [fetchGiftCards, filter]","fix":{"range":[1652,1660],"text":"[fetchGiftCards, filter]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatPrice' is assigned a value but never used.","line":77,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":77,"endColumn":20},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'SpinnerGap' is not defined.","line":226,"column":14,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":226,"endColumn":24},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'User' is not defined.","line":304,"column":30,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":304,"endColumn":34},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'X' is not defined.","line":363,"column":20,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":363,"endColumn":21}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { \r\n  Gift, \r\n  Plus, \r\n  MagnifyingGlass, \r\n  Copy, \r\n  EnvelopeSimple, \r\n  DownloadSimple, \r\n  Eye, \r\n  DotsThree,\r\n  ArrowLeft,\r\n  ArrowsClockwise,\r\n  CheckCircle,\r\n  Clock,\r\n  CurrencyCircleDollar,\r\n  Ticket\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { useTranslations } from 'next-intl';\r\nimport { cn } from '@/lib/utils';\r\n\r\ninterface GiftCard {\r\n  id: string;\r\n  code: string;\r\n  type: 'value' | 'service' | 'percentage';\r\n  initial_value: number;\r\n  current_balance: number;\r\n  valid_until: string;\r\n  is_active: boolean;\r\n  recipient_name?: string;\r\n  recipient_email?: string;\r\n  purchased_by?: { full_name: string };\r\n  created_at: string;\r\n}\r\n\r\nexport default function GiftCardsPage() {\r\n  const { goBack } = useBackNavigation();\r\n  const t = useTranslations('clinic.gift-cards' as any);\r\n  const [giftCards, setGiftCards] = useState<GiftCard[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [filter, setFilter] = useState<'all' | 'active' | 'expired' | 'depleted'>('all');\r\n\r\n  useEffect(() => {\r\n    fetchGiftCards();\r\n  }, [filter]);\r\n\r\n  const fetchGiftCards = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const params = new URLSearchParams();\r\n      if (filter !== 'all') params.set('status', filter);\r\n      \r\n      const res = await fetch(`/api/gift-cards?${params}`);\r\n      const data = await res.json();\r\n      setGiftCards(data.giftCards || []);\r\n    } catch (error) {\r\n      console.error('Failed to fetch gift cards:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const copyCode = (code: string) => {\r\n    navigator.clipboard.writeText(code);\r\n  };\r\n\r\n  const formatPrice = (amount: number) => {\r\n    return new Intl.NumberFormat('th-TH', {\r\n      style: 'currency',\r\n      currency: 'THB',\r\n      minimumFractionDigits: 0\r\n    }).format(amount);\r\n  };\r\n\r\n  const formatDate = (dateStr: string) => {\r\n    return new Date(dateStr).toLocaleDateString('th-TH', {\r\n      day: 'numeric',\r\n      month: 'short',\r\n      year: 'numeric'\r\n    });\r\n  };\r\n\r\n  const filteredCards = giftCards.filter(card =>\r\n    card.code.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    card.recipient_name?.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Gift weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Voucher Management Node\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight\"\r\n          >\r\n            Gift <span className=\"text-primary\">Cards</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating prepaid value nodes, clinical vouchers, and promotional credit cycles.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-3\">\r\n          <Button \r\n            variant=\"outline\" \r\n            onClick={fetchGiftCards}\r\n            disabled={loading}\r\n            className=\"gap-2\"\r\n          >\r\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\r\n            Sync Vault\r\n          </Button>\r\n          <Button \r\n            onClick={() => setShowCreateModal(true)}\r\n            className=\"gap-2 shadow-premium px-8\"\r\n          >\r\n            <Plus weight=\"bold\" className=\"w-4 h-4\" />\r\n            Issue Gift Card\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Summary */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n        <StatCard\r\n          title=\"Total Units Issued\"\r\n          value={giftCards.length}\r\n          icon={Gift}\r\n          trend=\"neutral\"\r\n          iconColor=\"text-primary\"\r\n        />\r\n        <StatCard\r\n          title=\"Active Liquidity\"\r\n          value={giftCards.filter(c => c.is_active && c.current_balance > 0).length}\r\n          icon={CheckCircle}\r\n          trend=\"up\"\r\n          change={12}\r\n          iconColor=\"text-emerald-500\"\r\n        />\r\n        <StatCard\r\n          title=\"Consolidated Balance\"\r\n          value={giftCards.reduce((sum, c) => sum + c.current_balance, 0)}\r\n          prefix=\"เธฟ\"\r\n          icon={CurrencyCircleDollar}\r\n          trend=\"neutral\"\r\n          iconColor=\"text-indigo-500\"\r\n        />\r\n        <StatCard\r\n          title=\"Absorbed Value\"\r\n          value={giftCards.reduce((sum, c) => sum + (c.initial_value - c.current_balance), 0)}\r\n          prefix=\"เธฟ\"\r\n          icon={DownloadSimple}\r\n          trend=\"up\"\r\n          change={8}\r\n          iconColor=\"text-blue-500\"\r\n        />\r\n      </div>\r\n\r\n      {/* Filters & Search */}\r\n      <div className=\"flex flex-col lg:flex-row gap-6\">\r\n        <div className=\"relative flex-1 group\">\r\n          <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-xl\" />\r\n          <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\r\n          <input \r\n            type=\"text\" \r\n            placeholder=\"Search identity node or transmission code...\" \r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n            className=\"w-full pl-11 pr-4 py-3 bg-secondary/50 border border-border rounded-2xl text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\r\n          />\r\n        </div>\r\n        <div className=\"flex bg-secondary/50 border border-border p-1 rounded-2xl w-fit shadow-inner\">\r\n          {(['all', 'active', 'expired', 'depleted'] as const).map((f) => (\r\n            <button\r\n              key={f}\r\n              onClick={() => setFilter(f)}\r\n              className={cn(\r\n                \"px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border\",\r\n                filter === f\r\n                  ? \"bg-card text-primary border-border/50 shadow-sm\"\r\n                  : \"text-muted-foreground border-transparent hover:text-foreground\"\r\n              )}\r\n            >\r\n              {f === 'all' ? 'All Units' : f === 'active' ? 'Operational' : f === 'expired' ? 'Expired' : 'Depleted'}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Gift Cards Grid */}\r\n      <div className=\"space-y-6\">\r\n        {loading ? (\r\n          <div className=\"py-32 flex flex-col items-center gap-4\">\r\n            <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Accessing Vault Nodes...</p>\r\n          </div>\r\n        ) : filteredCards.length === 0 ? (\r\n          <Card variant=\"ghost\" className=\"py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-4 opacity-40\">\r\n            <Gift weight=\"duotone\" className=\"w-16 h-16\" />\r\n            <p className=\"text-xs font-black uppercase tracking-widest\">Zero Gift Assets Detected</p>\r\n          </Card>\r\n        ) : (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n            {filteredCards.map((card, i) => (\r\n              <motion.div\r\n                key={card.id}\r\n                initial={{ opacity: 0, scale: 0.95 }}\r\n                animate={{ opacity: 1, scale: 1 }}\r\n                transition={{ delay: i * 0.05 }}\r\n              >\r\n                <Card className={cn(\r\n                  \"h-full border-border/50 hover:border-primary/30 transition-all group overflow-hidden flex flex-col\",\r\n                  (!card.is_active || card.current_balance === 0) && \"opacity-60 grayscale-[0.5]\"\r\n                )}>\r\n                  <CardHeader className=\"pb-4 bg-secondary/30 border-b border-border/50 px-6\">\r\n                    <div className=\"flex justify-between items-start gap-4\">\r\n                      <div className=\"space-y-1 min-w-0\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <span className=\"font-mono font-black text-lg text-foreground tracking-tighter\">{card.code}</span>\r\n                          <button\r\n                            onClick={() => copyCode(card.code)}\r\n                            className=\"p-1.5 hover:bg-primary/10 rounded-lg text-muted-foreground hover:text-primary transition-all\"\r\n                          >\r\n                            <Copy weight=\"bold\" className=\"w-3.5 h-3.5\" />\r\n                          </button>\r\n                        </div>\r\n                        <Badge variant={\r\n                          card.type === 'value' ? 'success' :\r\n                          card.type === 'service' ? 'default' :\r\n                          'warning'\r\n                        } size=\"sm\" className=\"font-black uppercase tracking-widest px-3 border-none\">\r\n                          {card.type === 'value' ? 'Fiscal Value' : card.type === 'service' ? 'Clinical Node' : 'Percentage Delta'}\r\n                        </Badge>\r\n                      </div>\r\n                      <Button \r\n                        variant=\"ghost\" \r\n                        size=\"sm\" \r\n                        className=\"p-2 rounded-xl text-muted-foreground hover:text-primary\"\r\n                      >\r\n                        <DotsThree weight=\"bold\" className=\"w-5 h-5\" />\r\n                      </Button>\r\n                    </div>\r\n                  </CardHeader>\r\n\r\n                  <CardContent className=\"p-6 flex-1 space-y-6 flex flex-col justify-between\">\r\n                    <div className=\"space-y-4\">\r\n                      <div className=\"space-y-1\">\r\n                        <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Operational Balance</p>\r\n                        <div className=\"flex items-baseline gap-2\">\r\n                          <span className=\"text-3xl font-black text-primary tracking-tighter tabular-nums\">เธฟ{card.current_balance.toLocaleString()}</span>\r\n                          <span className=\"text-sm font-bold text-muted-foreground uppercase tracking-widest opacity-60\">/ เธฟ{card.initial_value.toLocaleString()}</span>\r\n                        </div>\r\n                      </div>\r\n                      \r\n                      <div className=\"h-2 w-full bg-secondary rounded-full overflow-hidden p-0.5 border border-border shadow-inner\">\r\n                        <motion.div\r\n                          initial={{ width: 0 }}\r\n                          animate={{ width: `${(card.current_balance / card.initial_value) * 100}%` }}\r\n                          transition={{ duration: 1, delay: 0.2 }}\r\n                          className={cn(\r\n                            \"h-full rounded-full shadow-glow-sm\",\r\n                            card.current_balance / card.initial_value > 0.5 ? \"bg-emerald-500\" : card.current_balance > 0 ? \"bg-amber-500\" : \"bg-rose-500\"\r\n                          )}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-4\">\r\n                      {card.recipient_name && (\r\n                        <div className=\"flex items-center gap-3 p-3 bg-secondary/30 rounded-2xl border border-border/50 group-hover:border-primary/20 transition-all\">\r\n                          <div className=\"w-8 h-8 rounded-xl bg-card border border-border flex items-center justify-center text-primary shadow-sm\">\r\n                            <User weight=\"duotone\" className=\"w-4 h-4\" />\r\n                          </div>\r\n                          <div className=\"min-w-0\">\r\n                            <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest leading-none mb-1\">Target Identity</p>\r\n                            <p className=\"text-sm font-bold text-foreground truncate\">{card.recipient_name}</p>\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n\r\n                      <div className=\"flex items-center justify-between pt-4 border-t border-border/50\">\r\n                        <div className=\"flex items-center gap-2 text-[9px] font-black text-muted-foreground uppercase tracking-widest\">\r\n                          <Clock weight=\"bold\" className=\"w-3.5 h-3.5 text-primary/60\" />\r\n                          EXP: {formatDate(card.valid_until)}\r\n                        </div>\r\n                        <div className=\"flex gap-1\">\r\n                          <Button variant=\"ghost\" size=\"sm\" className=\"p-2 text-muted-foreground hover:text-primary\">\r\n                            <Eye weight=\"bold\" className=\"w-4 h-4\" />\r\n                          </Button>\r\n                          <Button variant=\"ghost\" size=\"sm\" className=\"p-2 text-muted-foreground hover:text-primary\">\r\n                            <EnvelopeSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n                          </Button>\r\n                          <Button variant=\"ghost\" size=\"sm\" className=\"p-2 text-muted-foreground hover:text-primary\">\r\n                            <DownloadSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n                          </Button>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </motion.div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Create Modal */}\r\n      <AnimatePresence>\r\n        {showCreateModal && (\r\n          <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-[200] flex items-center justify-center p-4\">\r\n            <motion.div\r\n              initial={{ opacity: 0, scale: 0.95, y: 20 }}\r\n              animate={{ opacity: 1, scale: 1 }}\r\n              exit={{ opacity: 0, scale: 0.95, y: 20 }}\r\n              className=\"bg-card p-8 rounded-[32px] border border-border shadow-premium w-full max-w-lg relative overflow-hidden\"\r\n            >\r\n              <div className=\"flex items-center justify-between mb-8\">\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20\">\r\n                    <Plus weight=\"bold\" className=\"w-6 h-6\" />\r\n                  </div>\r\n                  <div>\r\n                    <h2 className=\"text-2xl font-bold text-foreground tracking-tight\">Issue Gift Asset</h2>\r\n                    <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Configure prepaid node</p>\r\n                  </div>\r\n                </div>\r\n                <button \r\n                  onClick={() => setShowCreateModal(false)}\r\n                  className=\"p-2 text-muted-foreground hover:text-foreground hover:bg-secondary rounded-xl transition-all\"\r\n                >\r\n                  <X weight=\"bold\" className=\"w-6 h-6\" />\r\n                </button>\r\n              </div>\r\n\r\n              <form\r\n                onSubmit={async (e) => {\r\n                  e.preventDefault();\r\n                  const formData = new FormData(e.currentTarget);\r\n                  const res = await fetch('/api/gift-cards', {\r\n                    method: 'POST',\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    body: JSON.stringify({\r\n                      type: formData.get('type'),\r\n                      value: Number(formData.get('value')),\r\n                      recipientName: formData.get('recipientName'),\r\n                      recipientEmail: formData.get('recipientEmail'),\r\n                      validDays: Number(formData.get('validDays')) || 365\r\n                    })\r\n                  });\r\n                  if (res.ok) {\r\n                    setShowCreateModal(false);\r\n                    fetchGiftCards();\r\n                  }\r\n                }}\r\n                className=\"space-y-6\"\r\n              >\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Asset Identity Tier</label>\r\n                  <select name=\"type\" className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-5 text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-medium appearance-none\">\r\n                    <option value=\"value\" className=\"bg-card\">Fiscal Credit (THB)</option>\r\n                    <option value=\"percentage\" className=\"bg-card\">Percentage Delta (%)</option>\r\n                  </select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Initialization Value</label>\r\n                  <input\r\n                    type=\"number\"\r\n                    name=\"value\"\r\n                    required\r\n                    className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-5 text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-bold tabular-nums\"\r\n                    placeholder=\"0\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Target Name</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      name=\"recipientName\"\r\n                      className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-5 text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-medium placeholder:text-muted-foreground/40\"\r\n                      placeholder=\"e.g. John Doe\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Target Email</label>\r\n                    <input\r\n                      type=\"email\"\r\n                      name=\"recipientEmail\"\r\n                      className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-5 text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-medium placeholder:text-muted-foreground/40\"\r\n                      placeholder=\"identity@node.com\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Lifecycle Horizon (Days)</label>\r\n                  <input\r\n                    type=\"number\"\r\n                    name=\"validDays\"\r\n                    defaultValue={365}\r\n                    className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-5 text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-bold tabular-nums\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"flex flex-col sm:flex-row items-center gap-4 mt-10\">\r\n                  <Button type=\"submit\" className=\"w-full sm:w-auto px-10 py-4 shadow-premium\">\r\n                    Authorize Node\r\n                  </Button>\r\n                  <Button \r\n                    type=\"button\"\r\n                    variant=\"ghost\" \r\n                    onClick={() => setShowCreateModal(false)}\r\n                    className=\"w-full sm:w-auto text-xs font-black uppercase tracking-widest text-muted-foreground\"\r\n                  >\r\n                    Abort\r\n                  </Button>\r\n                </div>\r\n              </form>\r\n            </motion.div>\r\n          </div>\r\n        )}\r\n      </AnimatePresence>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\inventory\\alerts\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[59,73],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Bell' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Bell"},"fix":{"range":[154,162],"text":""},"desc":"Remove unused variable \"Bell\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Stack' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Stack"},"fix":{"range":[195,204],"text":""},"desc":"Remove unused variable \"Stack\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[204,218],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":23,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[342,354],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":23,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[354,365],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardContent' is defined but never used.","line":23,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":50,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardContent"},"fix":{"range":[365,378],"text":""},"desc":"Remove unused variable \"CardContent\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":31,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AnimatePresence"},"fix":{"range":[761,778],"text":""},"desc":"Remove unused variable \"AnimatePresence\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":47,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":47,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":48,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":10}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { \n  Warning, \n  Package, \n  Calendar, \n  ArrowLeft, \n  MagnifyingGlass, \n  ArrowsClockwise,\n  CheckCircle,\n  Clock,\n  WarningCircle,\n  Bell,\n  Archive,\n  Truck,\n  Buildings,\n  Stack,\n  CaretRight,\n  ShieldCheck,\n  Funnel\n} from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { cn } from '@/lib/utils';\nimport { useTranslations } from 'next-intl';\nimport { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Link } from '@/i18n/routing';\nimport ResponsiveTable from '@/components/ui/ResponsiveTable';\n\ninterface InventoryAlert {\n  id: string;\n  product_id: string;\n  product_name: string;\n  type: 'low_stock' | 'out_of_stock' | 'expiring' | 'expired';\n  current_value: number | string;\n  threshold_value: number | string;\n  status: 'pending' | 'resolved' | 'ignored';\n  created_at: string;\n}\n\nexport default function InventoryAlertsPage() {\n  const { goBack } = useBackNavigation();\n  const t = useTranslations('clinic.inventory.alerts');\n  const [loading, setLoading] = useState(true);\n  const [alerts, setAlerts] = useState<InventoryAlert[]>([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [typeFilter, setTypeFilter] = useState('all');\n\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      setAlerts([\n        {\n          id: '1',\n          product_id: 'p1',\n          product_name: 'Botox Type A 100u',\n          type: 'low_stock',\n          current_value: 5,\n          threshold_value: 10,\n          status: 'pending',\n          created_at: new Date().toISOString()\n        },\n        {\n          id: '2',\n          product_id: 'p2',\n          product_name: 'Filler Juvederm Voluma',\n          type: 'expiring',\n          current_value: '2024-03-15',\n          threshold_value: '30 days',\n          status: 'pending',\n          created_at: new Date().toISOString()\n        },\n        {\n          id: '3',\n          product_id: 'p3',\n          product_name: 'Alcohol Gel 500ml',\n          type: 'out_of_stock',\n          current_value: 0,\n          threshold_value: 1,\n          status: 'resolved',\n          created_at: new Date().toISOString()\n        }\n      ]);\n      setLoading(false);\n    }, 1000);\n    return () => clearTimeout(timer);\n  }, []);\n\n  const getTypeStyle = (type: string) => {\n    switch (type) {\n      case 'out_of_stock':\n      case 'expired':\n        return 'bg-rose-500/10 text-rose-500 border-rose-500/20';\n      case 'low_stock':\n      case 'expiring':\n        return 'bg-amber-500/10 text-amber-500 border-amber-500/20';\n      default:\n        return 'bg-secondary text-muted-foreground border-border';\n    }\n  };\n\n  const getTypeLabel = (type: string) => {\n    switch (type) {\n      case 'low_stock': return 'เธชเธ•เนเธญเธเธ•เนเธณ';\n      case 'out_of_stock': return 'เธชเธดเธเธเนเธฒเธซเธกเธ”';\n      case 'expiring': return 'เธเธณเธฅเธฑเธเธซเธกเธ”เธญเธฒเธขเธธ';\n      case 'expired': return 'เธซเธกเธ”เธญเธฒเธขเธธเนเธฅเนเธง';\n      default: return type;\n    }\n  };\n\n  const filteredAlerts = alerts.filter(alert => {\n    const matchesSearch = alert.product_name.toLowerCase().includes(searchTerm.toLowerCase());\n    const matchesType = typeFilter === 'all' || alert.type === typeFilter;\n    return matchesSearch && matchesType;\n  });\n\n  const columns = [\n    {\n      header: 'เธเธฃเธฐเน€เธ เธ—',\n      accessor: (alert: InventoryAlert) => (\n        <span className={cn(\n          \"px-2 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider border\",\n          getTypeStyle(alert.type)\n        )}>\n          {getTypeLabel(alert.type)}\n        </span>\n      )\n    },\n    {\n      header: 'เธชเธดเธเธเนเธฒ',\n      accessor: (alert: InventoryAlert) => (\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center text-primary\">\n            <Package className=\"w-4 h-4\" />\n          </div>\n          <span className=\"text-sm font-bold text-foreground\">{alert.product_name}</span>\n        </div>\n      )\n    },\n    {\n      header: 'เธชเธ–เธฒเธเธฐเธเธฑเธเธเธธเธเธฑเธ',\n      accessor: (alert: InventoryAlert) => (\n        <span className=\"text-sm font-medium text-foreground\">\n          {alert.current_value} / {alert.threshold_value}\n        </span>\n      )\n    },\n    {\n      header: 'เธงเธฑเธเธ—เธตเนเนเธเนเธ',\n      accessor: (alert: InventoryAlert) => (\n        <span className=\"text-sm text-muted-foreground\">\n          {new Date(alert.created_at).toLocaleDateString('th-TH')}\n        </span>\n      )\n    },\n    {\n      header: 'เธเธฑเธ”เธเธฒเธฃ',\n      className: 'text-right',\n      accessor: (alert: InventoryAlert) => (\n        alert.status === 'pending' ? (\n          <button className=\"p-2 text-emerald-500 hover:bg-emerald-500/10 rounded-lg transition-all border border-transparent hover:border-emerald-500/20\">\n            <CheckCircle className=\"w-5 h-5\" />\n          </button>\n        ) : (\n          <span className=\"text-xs text-muted-foreground font-medium uppercase tracking-widest\">Resolved</span>\n        )\n      )\n    }\n  ];\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header Section */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-rose-500 text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <WarningCircle weight=\"duotone\" className=\"w-4 h-4\" />\n            Stock Depletion Alert Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n          >\n            Inventory <span className=\"text-rose-500\">Alerts</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Monitoring critical stock thresholds, expiration timelines, and supply chain anomalies.\n          </motion.p>\n        </div>\n\n        <div className=\"flex flex-wrap items-center gap-3\">\n          <div className=\"flex bg-secondary/50 border border-border/50 p-1.5 rounded-[24px] shadow-inner mr-2\">\n            {[\n              { id: 'main', label: 'Vault', icon: Archive, href: '/clinic/inventory' },\n              { id: 'orders', label: 'Orders', icon: Truck, href: '/clinic/inventory/orders' },\n              { id: 'alerts', label: 'Alerts', icon: WarningCircle, href: '/clinic/inventory/alerts' },\n              { id: 'suppliers', label: 'Network', icon: Buildings, href: '/clinic/inventory/suppliers' }\n            ].map((node) => (\n              <Link key={node.id} href={node.href}>\n                <button\n                  className={cn(\n                    \"px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border whitespace-nowrap flex items-center gap-2\",\n                    node.id === 'alerts'\n                      ? \"bg-rose-500 text-white border-rose-500 shadow-premium\"\n                      : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\n                  )}\n                >\n                  <node.icon weight={node.id === 'alerts' ? \"fill\" : \"bold\"} className=\"w-3.5 h-3.5\" />\n                  {node.label}\n                </button>\n              </Link>\n            ))}\n          </div>\n          <Button \n            variant=\"outline\"\n            onClick={() => window.location.reload()}\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\n          >\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\n            Sync registry\n          </Button>\n        </div>\n      </div>\n\n      {/* Stats Summary */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\n        <StatCard\n          title=\"Total Alerts\"\n          value={alerts.length}\n          icon={Warning}\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Low Stock Nodes\"\n          value={alerts.filter(a => a.type === 'low_stock').length}\n          icon={Package}\n          iconColor=\"text-amber-500\"\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Expired Nodes\"\n          value={alerts.filter(a => a.type === 'expired').length}\n          icon={Calendar}\n          iconColor=\"text-rose-500\"\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Awaiting Action\"\n          value={alerts.filter(a => a.status === 'pending').length}\n          icon={Clock}\n          iconColor=\"text-blue-500\"\n          className=\"p-4\"\n        />\n      </div>\n\n      {/* Search & Intelligence Controls */}\n      <div className=\"px-2\">\n        <Card className=\"p-6 rounded-[32px] border-border/50 shadow-card\">\n          <div className=\"flex flex-col md:flex-row gap-6\">\n            <div className=\"relative flex-1 group\">\n              <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-xl\" />\n              <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\n              <input \n                type=\"text\" \n                placeholder=\"Query asset name or alert designation...\" \n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3.5 pl-12 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\n              />\n            </div>\n            \n            <div className=\"relative\">\n              <select\n                value={typeFilter}\n                onChange={(e) => setTypeFilter(e.target.value)}\n                className=\"w-full sm:w-64 bg-secondary/50 border border-border rounded-2xl py-3.5 px-6 text-xs font-black uppercase tracking-widest text-foreground focus:border-primary outline-none transition-all appearance-none font-bold\"\n              >\n                <option value=\"all\" className=\"bg-card\">PROTOCOL: ALL ALERTS</option>\n                <option value=\"low_stock\" className=\"bg-card\">NODE: LOW STOCK</option>\n                <option value=\"out_of_stock\" className=\"bg-card\">NODE: DEPLETED</option>\n                <option value=\"expiring\" className=\"bg-card\">NODE: EXPIRING</option>\n                <option value=\"expired\" className=\"bg-card\">NODE: EXPIRED</option>\n              </select>\n              <Funnel weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-muted-foreground/40 pointer-events-none\" />\n            </div>\n          </div>\n        </Card>\n      </div>\n\n      {/* Alerts Registry Table */}\n      <div className=\"px-2\">\n        <Card className=\"rounded-[40px] border-border/50 overflow-hidden shadow-premium\">\n          <ResponsiveTable\n            columns={columns}\n            data={filteredAlerts}\n            loading={loading}\n            rowKey={(alert) => alert.id}\n            emptyMessage=\"Zero inventory anomalies detected in current matrix.\"\n            mobileCard={(alert) => (\n              <div className=\"space-y-5\">\n                <div className=\"flex justify-between items-start\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className={cn(\n                      \"w-14 h-14 rounded-2xl border flex items-center justify-center transition-all duration-500 shadow-inner\",\n                      getTypeStyle(alert.type)\n                    )}>\n                      <Package weight=\"duotone\" className=\"w-7 h-7\" />\n                    </div>\n                    <div className=\"min-w-0\">\n                      <p className=\"font-bold text-foreground truncate uppercase tracking-tight\">{alert.product_name}</p>\n                      <div className=\"flex items-center gap-2\">\n                        <Badge variant=\"ghost\" className={cn(\"border-none font-black text-[8px] tracking-widest uppercase px-2 py-0.5\", getTypeStyle(alert.type))}>\n                          {getTypeLabel(alert.type)}\n                        </Badge>\n                        <span className=\"text-[10px] font-mono text-muted-foreground tracking-widest uppercase\">ID-{alert.product_id.slice(0,4)}</span>\n                      </div>\n                    </div>\n                  </div>\n                  <Badge variant={alert.status === 'pending' ? 'destructive' : 'secondary'} size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3\">\n                    {alert.status.toUpperCase()}\n                  </Badge>\n                </div>\n                \n                <div className=\"grid grid-cols-2 gap-6 py-4 border-y border-border/50\">\n                  <div>\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Telemetry Status</p>\n                    <div className=\"flex items-center gap-2\">\n                      <p className=\"text-lg font-black text-foreground tabular-nums\">{alert.current_value}</p>\n                      <span className=\"text-[10px] font-medium text-muted-foreground\">/ {alert.threshold_value} Target</span>\n                    </div>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Timestamp</p>\n                    <p className=\"text-sm font-bold text-foreground tabular-nums\">{new Date(alert.created_at).toLocaleDateString()}</p>\n                  </div>\n                </div>\n\n                <div className=\"flex justify-between items-center pt-1\">\n                  <div className=\"flex items-center gap-2 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\n                    <ShieldCheck weight=\"bold\" className=\"w-3.5 h-3.5 opacity-60\" />\n                    Protocol: {alert.status === 'pending' ? 'Active Attention' : 'Anomaly Resolved'}\n                  </div>\n                  {alert.status === 'pending' && (\n                    <Button \n                      variant=\"outline\"\n                      size=\"sm\"\n                      className=\"px-6 py-4 rounded-xl text-[10px] font-black uppercase tracking-widest border-emerald-500/20 text-emerald-500 hover:bg-emerald-500/10 shadow-sm\"\n                    >\n                      <CheckCircle weight=\"bold\" className=\"w-4 h-4 mr-2\" />\n                      Resolve Node\n                    </Button>\n                  )}\n                </div>\n              </div>\n            )}\n          />\n        </Card>\n      </div>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\inventory\\orders\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CurrencyDollar' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":17,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CurrencyDollar"},"fix":{"range":[80,100],"text":""},"desc":"Remove unused variable \"CurrencyDollar\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DotsThreeVertical' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":20,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"DotsThreeVertical"},"fix":{"range":[129,152],"text":""},"desc":"Remove unused variable \"DotsThreeVertical\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SquaresFour' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"SquaresFour"},"fix":{"range":[194,210],"text":""},"desc":"Remove unused variable \"SquaresFour\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretLeft' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretLeft"},"fix":{"range":[245,259],"text":""},"desc":"Remove unused variable \"CaretLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'XCircle' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"XCircle"},"fix":{"range":[268,280],"text":""},"desc":"Remove unused variable \"XCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":22,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[280,304],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowRight' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowRight"},"fix":{"range":[316,331],"text":""},"desc":"Remove unused variable \"ArrowRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":29,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[491,502],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Suspense' is defined but never used.","line":35,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":52,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Suspense"},"fix":{"range":[840,850],"text":""},"desc":"Remove unused variable \"Suspense\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRouter' is defined but never used.","line":36,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":19,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useRouter"},"fix":{"range":[886,896],"text":""},"desc":"Remove unused variable \"useRouter\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PurchaseOrderManagementContent' is defined but never used.","line":61,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":61,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":62,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":62,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { \r\n  FileText, \r\n  Plus, \r\n  MagnifyingGlass, \r\n  Truck, \r\n  CurrencyDollar, \r\n  PencilSimple, \r\n  Trash, \r\n  DotsThreeVertical, \r\n  SpinnerGap,\r\n  CheckCircle,\r\n  Clock,\r\n  SquaresFour,\r\n  CalendarDots,\r\n  WarningCircle,\r\n  CaretLeft,\r\n  User,\r\n  XCircle,\r\n  IdentificationBadge,\r\n  Archive,\r\n  ArrowRight,\r\n  ArrowsClockwise,\r\n  Buildings,\r\n  Receipt\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { cn } from '@/lib/utils';\r\nimport { useState, useEffect, useCallback, Suspense, useMemo } from 'react';\r\nimport { useRouter, useSearchParams } from 'next/navigation';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport PurchaseOrderModal from '@/components/PurchaseOrderModal';\r\nimport { Link } from '@/i18n/routing';\r\n\r\ninterface PurchaseOrder {\r\n  id: string;\r\n  po_number: string;\r\n  supplier_id: string;\r\n  status: string;\r\n  total_amount: number;\r\n  notes?: string;\r\n  ordered_at?: string;\r\n  received_at?: string;\r\n  created_at: string;\r\n  supplier?: {\r\n    id: string;\r\n    name: string;\r\n  };\r\n  creator?: {\r\n    id: string;\r\n    full_name: string;\r\n  };\r\n}\r\n\r\nfunction PurchaseOrderManagementContent() {\r\n  const { goBack } = useBackNavigation();\r\n  const searchParams = useSearchParams();\r\n  const supplierIdFilter = searchParams.get('supplierId');\r\n  \r\n  const [loading, setLoading] = useState(true);\r\n  const [orders, setOrders] = useState<PurchaseOrder[]>([]);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [selectedOrder, setSelectedOrder] = useState<PurchaseOrder | undefined>(undefined);\r\n\r\n  const fetchOrders = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const url = supplierIdFilter \r\n        ? `/api/purchase-orders?supplierId=${supplierIdFilter}`\r\n        : '/api/purchase-orders';\r\n      const res = await fetch(url);\r\n      const result = await res.json();\r\n      if (result.success) {\r\n        setOrders(result.data || []);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching purchase orders:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [supplierIdFilter]);\r\n\r\n  useEffect(() => {\r\n    fetchOrders();\r\n  }, [fetchOrders]);\r\n\r\n  const handleAddOrder = () => {\r\n    setSelectedOrder(undefined);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleEditOrder = (order: PurchaseOrder) => {\r\n    setSelectedOrder(order);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleDeleteOrder = async (id: string) => {\r\n    if (!confirm('Are you sure you want to terminate this purchase order? This action cannot be reversed.')) return;\r\n    \r\n    try {\r\n      const res = await fetch(`/api/purchase-orders/${id}`, { method: 'DELETE' });\r\n      const result = await res.json();\r\n      if (result.success) {\r\n        fetchOrders();\r\n      }\r\n    } catch (err) {\r\n      console.error('Error deleting purchase order:', err);\r\n    }\r\n  };\r\n\r\n  const filteredOrders = orders.filter(o => \r\n    o.po_number.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    o.supplier?.name.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  const stats = useMemo(() => ({\r\n    total: orders.length,\r\n    received: orders.filter(o => o.status === 'received').length,\r\n    pending: orders.filter(o => o.status === 'ordered' || o.status === 'draft').length,\r\n    totalSpent: orders.filter(o => o.status === 'received').reduce((acc, o) => acc + Number(o.total_amount), 0)\r\n  }), [orders]);\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      <PurchaseOrderModal \r\n        isOpen={isModalOpen}\r\n        onClose={() => setIsModalOpen(false)}\r\n        onSuccess={fetchOrders}\r\n        purchaseOrder={selectedOrder}\r\n      />\r\n\r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <FileText weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Procurement Intelligence Node\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Purchase <span className=\"text-primary\">Orders</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating clinical supply acquisition, inventory scaling, and fiscal procurement telemetry.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <div className=\"flex flex-wrap items-center gap-3\">\r\n          <div className=\"flex bg-secondary/50 border border-border/50 p-1.5 rounded-[24px] shadow-inner mr-2\">\r\n            {[\r\n              { id: 'main', label: 'Vault', icon: Archive, href: '/clinic/inventory' },\r\n              { id: 'orders', label: 'Orders', icon: Truck, href: '/clinic/inventory/orders' },\r\n              { id: 'alerts', label: 'Alerts', icon: WarningCircle, href: '/clinic/inventory/alerts' },\r\n              { id: 'suppliers', label: 'Network', icon: Buildings, href: '/clinic/inventory/suppliers' }\r\n            ].map((node) => (\r\n              <Link key={node.id} href={node.href}>\r\n                <button\r\n                  className={cn(\r\n                    \"px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border whitespace-nowrap flex items-center gap-2\",\r\n                    node.id === 'orders'\r\n                      ? \"bg-primary text-primary-foreground border-primary shadow-premium\"\r\n                      : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\r\n                  )}\r\n                >\r\n                  <node.icon weight={node.id === 'orders' ? \"fill\" : \"bold\"} className=\"w-3.5 h-3.5\" />\r\n                  {node.label}\r\n                </button>\r\n              </Link>\r\n            ))}\r\n          </div>\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={fetchOrders}\r\n            disabled={loading}\r\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\r\n          >\r\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\r\n            Sync Registry\r\n          </Button>\r\n          <Button \r\n            onClick={handleAddOrder}\r\n            className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\"\r\n          >\r\n            <Plus weight=\"bold\" className=\"w-4 h-4\" />\r\n            Initialize Order\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Summary */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\r\n        <StatCard\r\n          title=\"Total PO Nodes\"\r\n          value={stats.total}\r\n          icon={FileText}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Received Assets\"\r\n          value={stats.received}\r\n          icon={CheckCircle}\r\n          iconColor=\"text-emerald-500\"\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Active Flux\"\r\n          value={stats.pending}\r\n          icon={Clock}\r\n          iconColor=\"text-blue-500\"\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Total Commitment\"\r\n          value={stats.totalSpent}\r\n          prefix=\"เธฟ\"\r\n          icon={Receipt}\r\n          iconColor=\"text-primary\"\r\n          className=\"p-4\"\r\n        />\r\n      </div>\r\n\r\n      {/* Search & Intelligence Controls */}\r\n      <div className=\"px-2\">\r\n        <Card className=\"p-6 rounded-[32px] border-border/50 shadow-card\">\r\n          <div className=\"flex flex-col md:flex-row gap-6\">\r\n            <div className=\"relative flex-1 group\">\r\n              <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-xl\" />\r\n              <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\r\n              <input \r\n                type=\"text\" \r\n                placeholder=\"Query PO number, supplier node name, or procurement directives...\" \r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3.5 pl-12 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Orders Grid */}\r\n      <div className=\"px-2\">\r\n        {loading ? (\r\n          <div className=\"py-32 flex flex-col items-center justify-center gap-4\">\r\n            <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest text-center\">Synchronizing Procurement Matrix...</p>\r\n          </div>\r\n        ) : filteredOrders.length === 0 ? (\r\n          <Card variant=\"ghost\" className=\"py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-6 opacity-40 rounded-[40px]\">\r\n            <Truck weight=\"duotone\" className=\"w-16 h-16 text-muted-foreground\" />\r\n            <p className=\"text-sm font-black uppercase tracking-widest text-center\">Zero Procurement Cycles Detected In This Matrix</p>\r\n          </Card>\r\n        ) : (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\r\n            <AnimatePresence mode=\"popLayout\">\r\n              {filteredOrders.map((order, i) => (\r\n                <motion.div\r\n                  key={order.id}\r\n                  layout\r\n                  initial={{ opacity: 0, scale: 0.95 }}\r\n                  animate={{ opacity: 1, scale: 1 }}\r\n                  exit={{ opacity: 0, scale: 0.95 }}\r\n                  transition={{ delay: i * 0.05 }}\r\n                >\r\n                  <Card className=\"h-full border-border/50 hover:border-primary/30 transition-all group overflow-hidden flex flex-col rounded-[40px]\">\r\n                    <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                      <FileText className=\"w-32 h-32 text-primary\" />\r\n                    </div>\r\n\r\n                    <CardHeader className=\"pb-4 bg-secondary/30 border-b border-border/50 p-8\">\r\n                      <div className=\"flex justify-between items-start gap-4\">\r\n                        <div className=\"w-14 h-14 rounded-2xl bg-card border border-border flex items-center justify-center text-primary group-hover:bg-primary/10 transition-all duration-500 shadow-inner\">\r\n                          <Truck weight=\"duotone\" className=\"w-7 h-7\" />\r\n                        </div>\r\n                        <div className=\"flex gap-2\">\r\n                          <Button \r\n                            variant=\"ghost\" \r\n                            size=\"sm\" \r\n                            onClick={() => handleEditOrder(order)}\r\n                            className=\"h-10 w-10 p-0 rounded-xl text-muted-foreground hover:text-primary hover:bg-primary/5 border border-transparent hover:border-primary/20 transition-all\"\r\n                          >\r\n                            <PencilSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n                          </Button>\r\n                          <Button \r\n                            variant=\"ghost\" \r\n                            size=\"sm\" \r\n                            onClick={() => handleDeleteOrder(order.id)}\r\n                            className=\"h-10 w-10 p-0 rounded-xl text-muted-foreground hover:text-rose-500 hover:bg-rose-500/5 border border-transparent hover:border-rose-500/20 transition-all\"\r\n                          >\r\n                            <Trash weight=\"bold\" className=\"w-4 h-4\" />\r\n                          </Button>\r\n                        </div>\r\n                      </div>\r\n                    </CardHeader>\r\n\r\n                    <CardContent className=\"p-8 flex-1 flex flex-col justify-between space-y-8 relative z-10\">\r\n                      <div className=\"space-y-4\">\r\n                        <div>\r\n                          <div className=\"flex items-center gap-3 mb-2\">\r\n                            <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-mono text-[9px] tracking-widest uppercase px-3\">#{order.po_number}</Badge>\r\n                            <Badge variant={\r\n                              order.status === 'received' ? 'success' : \r\n                              order.status === 'ordered' ? 'default' : \r\n                              order.status === 'cancelled' ? 'destructive' : 'secondary'\r\n                            } size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3\">\r\n                              {order.status.toUpperCase()}\r\n                            </Badge>\r\n                          </div>\r\n                          <h3 className=\"text-xl font-bold text-foreground group-hover:text-primary transition-colors uppercase tracking-tight truncate\">{order.supplier?.name || 'Anonymous Supplier'}</h3>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 gap-6 pt-6 border-t border-border/30\">\r\n                          <div>\r\n                            <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest mb-1\">Fiscal Commitment</p>\r\n                            <p className=\"text-xl font-black text-foreground tabular-nums tracking-tighter\">เธฟ{Number(order.total_amount).toLocaleString()}</p>\r\n                          </div>\r\n                          {order.received_at && (\r\n                            <div className=\"text-right\">\r\n                              <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest mb-1\">Reception Node</p>\r\n                              <Badge variant=\"success\" size=\"sm\" className=\"font-black text-[8px] tracking-widest uppercase px-2\">SYNC_OK</Badge>\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n\r\n                        {order.notes && (\r\n                          <div className=\"p-4 bg-secondary/20 rounded-2xl border border-border/50\">\r\n                            <p className=\"text-[10px] text-muted-foreground font-medium italic leading-relaxed line-clamp-2\">\r\n                              &quot;{order.notes}&quot;\r\n                            </p>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n\r\n                      <div className=\"pt-6 border-t border-border/30 flex items-center justify-between\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <CalendarDots weight=\"bold\" className=\"w-3.5 h-3.5 text-primary/60\" />\r\n                          <span className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">TS: {new Date(order.created_at).toLocaleDateString()}</span>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <User weight=\"bold\" className=\"w-3.5 h-3.5 text-primary/60\" />\r\n                          <span className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">Op: {order.creator?.full_name?.split(' ')[0] || 'SYS'}</span>\r\n                        </div>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                </motion.div>\r\n              ))}\r\n            </AnimatePresence>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\inventory\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SpinnerGap' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"SpinnerGap"},"fix":{"range":[136,151],"text":""},"desc":"Remove unused variable \"SpinnerGap\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[151,165],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle"},"fix":{"range":[185,201],"text":""},"desc":"Remove unused variable \"CheckCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'XCircle' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"XCircle"},"fix":{"range":[201,213],"text":""},"desc":"Remove unused variable \"XCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[213,228],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Briefcase"},"fix":{"range":[228,242],"text":""},"desc":"Remove unused variable \"Briefcase\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Monitor' is defined but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Monitor"},"fix":{"range":[242,254],"text":""},"desc":"Remove unused variable \"Monitor\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":22,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[254,278],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Stack' is defined but never used.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Stack"},"fix":{"range":[278,288],"text":""},"desc":"Remove unused variable \"Stack\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ListBullets' is defined but never used.","line":27,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ListBullets"},"fix":{"range":[346,362],"text":""},"desc":"Remove unused variable \"ListBullets\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":32,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[494,506],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":32,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[506,517],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":59,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":59,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'idx' is defined but never used.","line":395,"column":61,"nodeType":"Identifier","messageId":"unusedVar","endLine":395,"endColumn":64}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { \r\n  Package, \r\n  Plus, \r\n  MagnifyingGlass, \r\n  Warning, \r\n  TrendUp, \r\n  PencilSimple, \r\n  Trash,\r\n  ChartBar,\r\n  SpinnerGap,\r\n  ArrowLeft,\r\n  ArrowsClockwise,\r\n  CheckCircle,\r\n  XCircle,\r\n  CaretRight,\r\n  Briefcase,\r\n  Monitor,\r\n  IdentificationBadge,\r\n  Stack,\r\n  Archive,\r\n  Tag,\r\n  WarningCircle,\r\n  Funnel,\r\n  Cube,\r\n  ListBullets,\r\n  ArrowsLeftRight,\r\n  Truck\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { cn } from '@/lib/utils';\r\nimport { useEffect, useState, useCallback, useMemo } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport ProductModal from '@/components/ProductModal';\r\nimport StockMovementModal from '@/components/StockMovementModal';\r\nimport { Link } from '@/i18n/routing';\r\nimport ResponsiveTable from '@/components/ui/ResponsiveTable';\r\n\r\ninterface Product {\r\n  id: string;\r\n  name: string;\r\n  sku: string;\r\n  category: string;\r\n  stock_quantity: number;\r\n  min_stock_level: number;\r\n  cost_price: number;\r\n  sale_price: number;\r\n  created_at: string;\r\n  image_url?: string;\r\n}\r\n\r\nexport default function InventoryManagement() {\r\n  const { goBack } = useBackNavigation();\r\n  const [products, setProducts] = useState<Product[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [selectedCategory, setSelectedCategory] = useState<string>('all');\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [selectedProduct, setSelectedProduct] = useState<Product | undefined>(undefined);\r\n  const [isMovementModalOpen, setIsMovementModalOpen] = useState(false);\r\n  const [selectedProductForMovement, setSelectedProductForMovement] = useState<Product | undefined>(undefined);\r\n\r\n  const categories = useMemo(() => {\r\n    const cats = ['all', ...new Set(products.map(p => p.category))];\r\n    return cats;\r\n  }, [products]);\r\n\r\n  const lowStockProducts = useMemo(() => {\r\n    return products.filter(p => p.stock_quantity <= p.min_stock_level);\r\n  }, [products]);\r\n\r\n  const totalValue = useMemo(() => {\r\n    return products.reduce((sum, p) => sum + (p.stock_quantity * p.cost_price), 0);\r\n  }, [products]);\r\n\r\n  const fetchProducts = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch('/api/products');\r\n      const result = await res.json();\r\n      if (result.success) {\r\n        setProducts(result.data || []);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching products:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchProducts();\r\n  }, [fetchProducts]);\r\n\r\n  const handleAddProduct = () => {\r\n    setSelectedProduct(undefined);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleEditProduct = (product: Product) => {\r\n    setSelectedProduct(product);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleAdjustStock = (product: Product) => {\r\n    setSelectedProductForMovement(product);\r\n    setIsMovementModalOpen(true);\r\n  };\r\n\r\n  const handleDeleteProduct = async (id: string) => {\r\n    if (!confirm('Are you sure you want to terminate this asset node?')) return;\r\n    \r\n    try {\r\n      const res = await fetch(`/api/products/${id}`, { method: 'DELETE' });\r\n      const result = await res.json();\r\n      if (result.success) {\r\n        fetchProducts();\r\n      }\r\n    } catch (err) {\r\n      console.error('Error deleting product:', err);\r\n    }\r\n  };\r\n\r\n  const filteredProducts = products.filter(product => {\r\n    const matchesSearch = product.name?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n                         product.sku?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n                         product.category?.toLowerCase().includes(searchTerm.toLowerCase());\r\n    const matchesCategory = selectedCategory === 'all' || product.category === selectedCategory;\r\n    return matchesSearch && matchesCategory;\r\n  });\r\n\r\n  const columns = [\r\n    {\r\n      header: 'Asset Intelligence',\r\n      accessor: (product: Product) => (\r\n        <div className=\"flex items-center gap-4\">\r\n          <div className=\"w-12 h-12 rounded-xl bg-secondary border border-border flex items-center justify-center text-muted-foreground group-hover:bg-primary/10 group-hover:text-primary transition-all duration-500 shadow-sm shrink-0\">\r\n            <Package className=\"w-6 h-6\" />\r\n          </div>\r\n          <div className=\"min-w-0\">\r\n            <span className=\"text-sm font-bold text-foreground group-hover:text-primary transition-colors truncate block\">{product.name}</span>\r\n            <span className=\"text-[10px] text-muted-foreground uppercase font-bold tracking-widest\">{product.category}</span>\r\n          </div>\r\n        </div>\r\n      )\r\n    },\r\n    {\r\n      header: 'Serial SKU',\r\n      accessor: (product: Product) => (\r\n        <span className=\"text-[11px] text-muted-foreground font-mono bg-secondary px-3 py-1.5 rounded-lg border border-border group-hover:border-primary/20 transition-colors uppercase\">\r\n          {product.sku || 'N/A'}\r\n        </span>\r\n      )\r\n    },\r\n    {\r\n      header: 'Stock Level',\r\n      accessor: (product: Product) => {\r\n        const isLowStock = product.stock_quantity <= product.min_stock_level;\r\n        return (\r\n          <div className=\"space-y-1.5 w-32\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className={cn(\"text-base font-bold tabular-nums\", isLowStock ? \"text-rose-500\" : \"text-foreground\")}>\r\n                {product.stock_quantity}\r\n              </span>\r\n              {isLowStock && <Warning className=\"w-4 h-4 text-rose-500 animate-pulse\" />}\r\n            </div>\r\n            <div className=\"h-1 w-full bg-secondary rounded-full overflow-hidden border border-border\">\r\n              <div \r\n                className={cn(\"h-full rounded-full\", isLowStock ? 'bg-rose-500' : 'bg-emerald-500')} \r\n                style={{ width: `${Math.min(100, (product.stock_quantity / (product.min_stock_level * 2)) * 100)}%` }} \r\n              />\r\n            </div>\r\n          </div>\r\n        );\r\n      }\r\n    },\r\n    {\r\n      header: 'Unit Cost',\r\n      accessor: (product: Product) => (\r\n        <span className=\"text-sm text-muted-foreground font-medium tabular-nums\">\r\n          เธฟ{product.cost_price?.toLocaleString() || '0'}\r\n        </span>\r\n      )\r\n    },\r\n    {\r\n      header: 'Market Val',\r\n      accessor: (product: Product) => (\r\n        <span className=\"text-sm text-emerald-500 font-bold tabular-nums\">\r\n          เธฟ{product.sale_price?.toLocaleString() || '0'}\r\n        </span>\r\n      )\r\n    },\r\n    {\r\n      header: 'Total Eq.',\r\n      accessor: (product: Product) => (\r\n        <span className=\"text-sm font-bold text-foreground tracking-tight tabular-nums\">\r\n          เธฟ{(product.stock_quantity * product.cost_price).toLocaleString()}\r\n        </span>\r\n      )\r\n    },\r\n    {\r\n      header: '',\r\n      className: 'text-right',\r\n      accessor: (product: Product) => (\r\n        <div className=\"flex items-center justify-end gap-2\">\r\n          <motion.button \r\n            whileHover={{ scale: 1.1 }}\r\n            whileTap={{ scale: 0.9 }}\r\n            onClick={() => handleAdjustStock(product)}\r\n            className=\"p-2 text-primary/60 hover:text-primary transition-all rounded-lg hover:bg-primary/10 border border-transparent hover:border-primary/10\"\r\n            title=\"Adjust Stock\"\r\n          >\r\n            <TrendUp className=\"w-4 h-4\" />\r\n          </motion.button>\r\n          <motion.button \r\n            whileHover={{ scale: 1.1 }}\r\n            whileTap={{ scale: 0.9 }}\r\n            onClick={() => handleEditProduct(product)}\r\n            className=\"p-2 text-muted-foreground hover:text-foreground transition-all rounded-lg hover:bg-accent border border-transparent hover:border-border\"\r\n            title=\"Edit Asset\"\r\n          >\r\n            <PencilSimple className=\"w-4 h-4\" />\r\n          </motion.button>\r\n          <motion.button \r\n            whileHover={{ scale: 1.1, rotate: 5 }}\r\n            whileTap={{ scale: 0.9 }}\r\n            onClick={() => handleDeleteProduct(product.id)}\r\n            className=\"p-2 text-rose-500/40 hover:text-rose-500 transition-all rounded-lg hover:bg-rose-500/10 border border-transparent hover:border-rose-500/10\"\r\n            title=\"Terminate Asset\"\r\n          >\r\n            <Trash className=\"w-4 h-4\" />\r\n          </motion.button>\r\n        </div>\r\n      )\r\n    }\r\n  ];\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      <ProductModal \r\n        isOpen={isModalOpen}\r\n        onClose={() => setIsModalOpen(false)}\r\n        onSuccess={fetchProducts}\r\n        product={selectedProduct}\r\n      />\r\n\r\n      <StockMovementModal \r\n        isOpen={isMovementModalOpen}\r\n        onClose={() => setIsMovementModalOpen(false)}\r\n        onSuccess={fetchProducts}\r\n        product={selectedProductForMovement}\r\n      />\r\n\r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Package weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Supply Chain Intelligence Node\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Inventory <span className=\"text-primary\">Matrix</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Real-time asset tracking, clinical supply orchestration, and stock optimization.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <div className=\"flex flex-wrap items-center gap-3\">\r\n          <div className=\"flex bg-secondary/50 border border-border/50 p-1.5 rounded-[24px] shadow-inner mr-2\">\r\n            {[\r\n              { id: 'main', label: 'Vault', icon: Archive, href: '/clinic/inventory' },\r\n              { id: 'orders', label: 'Orders', icon: Truck, href: '/clinic/inventory/orders' },\r\n              { id: 'alerts', label: 'Alerts', icon: WarningCircle, href: '/clinic/inventory/alerts' },\r\n              { id: 'suppliers', label: 'Network', icon: Buildings, href: '/clinic/inventory/suppliers' }\r\n            ].map((node) => (\r\n              <Link key={node.id} href={node.href}>\r\n                <button\r\n                  className={cn(\r\n                    \"px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border whitespace-nowrap flex items-center gap-2\",\r\n                    node.id === 'main'\r\n                      ? \"bg-primary text-primary-foreground border-primary shadow-premium\"\r\n                      : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\r\n                  )}\r\n                >\r\n                  <node.icon weight={node.id === 'main' ? \"fill\" : \"bold\"} className=\"w-3.5 h-3.5\" />\r\n                  {node.label}\r\n                </button>\r\n              </Link>\r\n            ))}\r\n          </div>\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={fetchProducts}\r\n            disabled={loading}\r\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\r\n          >\r\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\r\n            Sync Vault\r\n          </Button>\r\n          <Button \r\n            onClick={handleAddProduct}\r\n            className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\"\r\n          >\r\n            <Plus weight=\"bold\" className=\"w-4 h-4\" />\r\n            Initialize Asset\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Summary */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\r\n        <StatCard\r\n          title=\"Total Assets\"\r\n          value={products.length}\r\n          icon={Cube}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Critical Depletion\"\r\n          value={lowStockProducts.length}\r\n          icon={WarningCircle}\r\n          iconColor=\"text-rose-500\"\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Consolidated Value\"\r\n          value={totalValue}\r\n          prefix=\"เธฟ\"\r\n          icon={ChartBar}\r\n          iconColor=\"text-emerald-500\"\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Category Clusters\"\r\n          value={categories.length - 1}\r\n          icon={Tag}\r\n          iconColor=\"text-purple-500\"\r\n          className=\"p-4\"\r\n        />\r\n      </div>\r\n\r\n      {/* Low Stock Alert Hub */}\r\n      <AnimatePresence>\r\n        {lowStockProducts.length > 0 && (\r\n          <motion.div\r\n            initial={{ opacity: 0, y: -20, scale: 0.98 }}\r\n            animate={{ opacity: 1, y: 0, scale: 1 }}\r\n            exit={{ opacity: 0, scale: 0.98 }}\r\n            className=\"px-2\"\r\n          >\r\n            <Card className=\"border-none relative overflow-hidden bg-rose-500/10 shadow-glow-sm\">\r\n              <div className=\"absolute inset-0 bg-gradient-to-r from-rose-500/5 via-transparent to-transparent\" />\r\n              <CardContent className=\"p-6 relative z-10\">\r\n                <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-6\">\r\n                  <div className=\"flex items-center gap-5\">\r\n                    <div className=\"w-14 h-14 rounded-2xl bg-rose-500/20 flex items-center justify-center text-rose-500 border border-rose-500/30 shadow-inner\">\r\n                      <Warning weight=\"fill\" className=\"w-7 h-7 animate-pulse\" />\r\n                    </div>\r\n                    <div className=\"space-y-1\">\r\n                      <h3 className=\"text-lg font-black text-rose-500 uppercase tracking-tight\">Critical Depletion Detected</h3>\r\n                      <p className=\"text-rose-500/70 text-xs font-medium italic\">\r\n                        {lowStockProducts.length} asset nodes have reached critical operational thresholds.\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className=\"flex -space-x-3\">\r\n                      {lowStockProducts.slice(0, 3).map((p, idx) => (\r\n                        <div key={p.id} className=\"w-10 h-10 rounded-full border-2 border-rose-900 bg-secondary flex items-center justify-center text-[10px] font-black uppercase text-rose-500 shadow-lg relative z-[30-idx]\">\r\n                          {p.name.charAt(0)}\r\n                        </div>\r\n                      ))}\r\n                      {lowStockProducts.length > 3 && (\r\n                        <div className=\"w-10 h-10 rounded-full border-2 border-rose-900 bg-rose-500 text-white flex items-center justify-center text-[10px] font-black shadow-lg relative z-0\">\r\n                          +{lowStockProducts.length - 3}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    <Button className=\"bg-rose-500 hover:bg-rose-600 text-white border-none shadow-premium px-8 py-6 rounded-2xl text-[10px] font-black uppercase tracking-widest ml-4\">\r\n                      Initialize Replenishment\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Search & Intelligence Controls */}\r\n      <div className=\"px-2\">\r\n        <Card className=\"p-6 rounded-[32px] border-border/50 shadow-card\">\r\n          <div className=\"flex flex-col md:flex-row gap-6\">\r\n            <div className=\"relative flex-1 group\">\r\n              <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-xl\" />\r\n              <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\r\n              <input \r\n                type=\"text\" \r\n                placeholder=\"Query asset name, SKU identity, or cluster category...\" \r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3.5 pl-12 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\r\n              />\r\n            </div>\r\n            \r\n            <div className=\"relative\">\r\n              <select\r\n                value={selectedCategory}\r\n                onChange={(e) => setSelectedCategory(e.target.value)}\r\n                className=\"w-full sm:w-64 bg-secondary/50 border border-border rounded-2xl py-3.5 px-6 text-xs font-black uppercase tracking-widest text-foreground focus:border-primary outline-none transition-all appearance-none font-bold\"\r\n              >\r\n                {categories.map(category => (\r\n                  <option key={category} value={category} className=\"bg-card\">\r\n                    {category === 'all' ? 'Protocol: ALL CATEGORIES' : `CLUSTER: ${category.toUpperCase()}`}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n              <Funnel weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-muted-foreground/40 pointer-events-none\" />\r\n            </div>\r\n          </div>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Asset Registry Table */}\r\n      <div className=\"px-2\">\r\n        <Card className=\"rounded-[40px] border-border/50 overflow-hidden shadow-premium\">\r\n          <ResponsiveTable\r\n            columns={columns}\r\n            data={filteredProducts}\r\n            loading={loading}\r\n            rowKey={(p) => p.id}\r\n            emptyMessage=\"Zero asset nodes detected in current clinical registry.\"\r\n            mobileCard={(p) => {\r\n              const isLowStock = p.stock_quantity <= p.min_stock_level;\r\n              return (\r\n                <div className=\"space-y-5\">\r\n                  <div className=\"flex justify-between items-start\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                      <div className={cn(\r\n                        \"w-14 h-14 rounded-2xl border flex items-center justify-center transition-all duration-500 shadow-inner\",\r\n                        isLowStock ? \"bg-rose-500/10 border-rose-500/20 text-rose-500\" : \"bg-primary/10 border-primary/20 text-primary\"\r\n                      )}>\r\n                        <Package weight=\"duotone\" className=\"w-7 h-7\" />\r\n                      </div>\r\n                      <div className=\"min-w-0\">\r\n                        <p className=\"font-bold text-foreground truncate uppercase tracking-tight\">{p.name}</p>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[8px] tracking-widest uppercase px-2 py-0.5\">{p.category}</Badge>\r\n                          <span className=\"text-[10px] font-mono text-muted-foreground tracking-widest uppercase\">{p.sku || 'NO_SKU'}</span>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <Badge variant={isLowStock ? 'destructive' : 'success'} size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3\">\r\n                      {isLowStock ? 'DEPLETED' : 'OPERATIONAL'}\r\n                    </Badge>\r\n                  </div>\r\n                  \r\n                  <div className=\"grid grid-cols-2 gap-6 py-4 border-y border-border/50\">\r\n                    <div>\r\n                      <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Available Units</p>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <p className={cn(\"text-lg font-black tabular-nums\", isLowStock ? \"text-rose-500\" : \"text-foreground\")}>{p.stock_quantity}</p>\r\n                        {isLowStock && <Warning weight=\"fill\" className=\"w-3.5 h-3.5 text-rose-500\" />}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"text-right\">\r\n                      <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Market Valuation</p>\r\n                      <p className=\"text-lg font-black text-emerald-500 tabular-nums\">เธฟ{p.sale_price?.toLocaleString()}</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"flex justify-between items-center pt-1\">\r\n                    <div className=\"space-y-0.5\">\r\n                      <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest opacity-60\">Consolidated Equity</p>\r\n                      <p className=\"text-sm font-black text-foreground tabular-nums tracking-tighter\">เธฟ{(p.stock_quantity * p.cost_price).toLocaleString()}</p>\r\n                    </div>\r\n                    <div className=\"flex gap-2\">\r\n                      <Button \r\n                        onClick={() => handleAdjustStock(p)} \r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        className=\"h-10 w-10 p-0 border-border/50 rounded-xl text-primary hover:bg-primary/5\"\r\n                      >\r\n                        <ArrowsLeftRight weight=\"bold\" className=\"w-4 h-4\" />\r\n                      </Button>\r\n                      <Button \r\n                        onClick={() => handleEditProduct(p)} \r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        className=\"h-10 w-10 p-0 border-border/50 rounded-xl text-muted-foreground hover:bg-secondary\"\r\n                      >\r\n                        <PencilSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            }}\r\n          />\r\n        </Card>\r\n      </div>\r\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\inventory\\suppliers\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"User"},"fix":{"range":[70,80],"text":""},"desc":"Remove unused variable \"User\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MapPin' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":9,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"MapPin"},"fix":{"range":[111,123],"text":""},"desc":"Remove unused variable \"MapPin\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DotsThreeVertical' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":20,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"DotsThreeVertical"},"fix":{"range":[152,175],"text":""},"desc":"Remove unused variable \"DotsThreeVertical\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Clock"},"fix":{"range":[207,218],"text":""},"desc":"Remove unused variable \"Clock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SquaresFour' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"SquaresFour"},"fix":{"range":[218,235],"text":""},"desc":"Remove unused variable \"SquaresFour\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Package' is defined but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Package"},"fix":{"range":[246,259],"text":""},"desc":"Remove unused variable \"Package\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":22,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[295,319],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Globe' is defined but never used.","line":25,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Globe"},"fix":{"range":[349,359],"text":""},"desc":"Remove unused variable \"Globe\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":26,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Briefcase"},"fix":{"range":[359,373],"text":""},"desc":"Remove unused variable \"Briefcase\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":29,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[487,498],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useBackNavigation' is defined but never used.","line":33,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":27,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"useBackNavigation"},"fix":{"range":[696,758],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Suspense' is defined but never used.","line":35,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":52,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Suspense"},"fix":{"range":[836,846],"text":""},"desc":"Remove unused variable \"Suspense\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":35,"column":54,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":61,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useMemo"},"fix":{"range":[846,855],"text":""},"desc":"Remove unused variable \"useMemo\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SupplierManagementContent' is defined but never used.","line":52,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":52,"endColumn":35},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'HistoryIcon' is not defined.","line":326,"column":28,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":326,"endColumn":39}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { \r\n  Buildings, \r\n  Plus, \r\n  MagnifyingGlass, \r\n  User, \r\n  EnvelopeSimple, \r\n  Phone, \r\n  MapPin, \r\n  PencilSimple, \r\n  Trash, \r\n  DotsThreeVertical, \r\n  SpinnerGap,\r\n  CheckCircle, \r\n  Clock, \r\n  SquaresFour, \r\n  Truck, \r\n  Package, \r\n  ArrowRight,\r\n  ArrowsClockwise,\r\n  IdentificationBadge,\r\n  Archive,\r\n  WarningCircle,\r\n  Globe,\r\n  Briefcase\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { cn } from '@/lib/utils';\r\nimport { useState, useEffect, useCallback, Suspense, useMemo } from 'react';\r\nimport { useRouter } from '@/i18n/routing';\r\nimport SupplierModal from '@/components/SupplierModal';\r\nimport { Link } from '@/i18n/routing';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface Supplier {\r\n  id: string;\r\n  name: string;\r\n  contact_name?: string;\r\n  email?: string;\r\n  phone?: string;\r\n  address?: string;\r\n  is_active: boolean;\r\n  created_at: string;\r\n}\r\n\r\nfunction SupplierManagementContent() {\r\n  const router = useRouter();\r\n  const [loading, setLoading] = useState(true);\r\n  const [suppliers, setSuppliers] = useState<Supplier[]>([]);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [selectedSupplier, setSelectedSupplier] = useState<Supplier | undefined>(undefined);\r\n\r\n  const fetchSuppliers = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch('/api/suppliers');\r\n      const result = await res.json();\r\n      if (result.success) {\r\n        setSuppliers(result.data || []);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching suppliers:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchSuppliers();\r\n  }, [fetchSuppliers]);\r\n\r\n  const handleAddSupplier = () => {\r\n    setSelectedSupplier(undefined);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleEditSupplier = (supplier: Supplier) => {\r\n    setSelectedSupplier(supplier);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleDeleteSupplier = async (id: string) => {\r\n    if (!confirm('Are you sure you want to terminate this supplier node? This will affect material acquisition history.')) return;\r\n    \r\n    try {\r\n      const res = await fetch(`/api/suppliers/${id}`, { method: 'DELETE' });\r\n      const result = await res.json();\r\n      if (result.success) {\r\n        fetchSuppliers();\r\n      }\r\n    } catch (err) {\r\n      console.error('Error deleting supplier:', err);\r\n    }\r\n  };\r\n\r\n  const filteredSuppliers = suppliers.filter(s => \r\n    s.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    s.contact_name?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    s.email?.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      <SupplierModal \r\n        isOpen={isModalOpen}\r\n        onClose={() => setIsModalOpen(false)}\r\n        onSuccess={fetchSuppliers}\r\n        supplier={selectedSupplier}\r\n      />\r\n\r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Truck weight=\"duotone\" className=\"w-4 h-4\" />\r\n            External Resource Matrix\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Supplier <span className=\"text-primary\">Network</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating clinical acquisition nodes, material pipelines, and vendor telemetry.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <div className=\"flex flex-wrap items-center gap-3\">\r\n          <div className=\"flex bg-secondary/50 border border-border/50 p-1.5 rounded-[24px] shadow-inner mr-2\">\r\n            {[\r\n              { id: 'main', label: 'Vault', icon: Archive, href: '/clinic/inventory' },\r\n              { id: 'orders', label: 'Orders', icon: Truck, href: '/clinic/inventory/orders' },\r\n              { id: 'alerts', label: 'Alerts', icon: WarningCircle, href: '/clinic/inventory/alerts' },\r\n              { id: 'suppliers', label: 'Network', icon: Buildings, href: '/clinic/inventory/suppliers' }\r\n            ].map((node) => (\r\n              <Link key={node.id} href={node.href}>\r\n                <button\r\n                  className={cn(\r\n                    \"px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border whitespace-nowrap flex items-center gap-2\",\r\n                    node.id === 'suppliers'\r\n                      ? \"bg-primary text-primary-foreground border-primary shadow-premium\"\r\n                      : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\r\n                  )}\r\n                >\r\n                  <node.icon weight={node.id === 'suppliers' ? \"fill\" : \"bold\"} className=\"w-3.5 h-3.5\" />\r\n                  {node.label}\r\n                </button>\r\n              </Link>\r\n            ))}\r\n          </div>\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={fetchSuppliers}\r\n            disabled={loading}\r\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\r\n          >\r\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\r\n            Sync Network\r\n          </Button>\r\n          <Button \r\n            onClick={handleAddSupplier}\r\n            className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\"\r\n          >\r\n            <Plus weight=\"bold\" className=\"w-4 h-4\" />\r\n            Initialize Supplier\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Summary */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\r\n        <StatCard\r\n          title=\"Active Connections\"\r\n          value={suppliers.length}\r\n          icon={Truck as Icon}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Operational Nodes\"\r\n          value={suppliers.filter(s => s.is_active).length}\r\n          icon={CheckCircle as Icon}\r\n          iconColor=\"text-emerald-500\"\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Consolidated Flows\"\r\n          value={124}\r\n          icon={ArrowsClockwise as Icon}\r\n          iconColor=\"text-blue-500\"\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Network Reliability\"\r\n          value={99.4}\r\n          suffix=\"%\"\r\n          decimals={1}\r\n          icon={ShieldCheckIcon as Icon}\r\n          iconColor=\"text-primary\"\r\n          className=\"p-4\"\r\n        />\r\n      </div>\r\n\r\n      {/* Search & Filters */}\r\n      <div className=\"px-2\">\r\n        <Card className=\"p-6 rounded-[32px] border-border/50 shadow-card\">\r\n          <div className=\"flex flex-col md:flex-row gap-6\">\r\n            <div className=\"relative flex-1 group\">\r\n              <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-xl\" />\r\n              <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\r\n              <input \r\n                type=\"text\" \r\n                placeholder=\"Query supplier designation, contact identity, or neural mail node...\" \r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3.5 pl-12 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Supplier Grid */}\r\n      <div className=\"px-2\">\r\n        {loading ? (\r\n          <div className=\"py-32 flex flex-col items-center justify-center gap-4\">\r\n            <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest text-center\">Synchronizing Acquisition Matrix...</p>\r\n          </div>\r\n        ) : filteredSuppliers.length === 0 ? (\r\n          <Card variant=\"ghost\" className=\"py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-6 opacity-40 rounded-[40px]\">\r\n            <Buildings weight=\"duotone\" className=\"w-16 h-16 text-muted-foreground\" />\r\n            <p className=\"text-sm font-black uppercase tracking-widest text-center\">Zero Supplier Clusters Detected</p>\r\n          </Card>\r\n        ) : (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\r\n            <AnimatePresence mode=\"popLayout\">\r\n              {filteredSuppliers.map((s, i) => (\r\n                <motion.div\r\n                  key={s.id}\r\n                  layout\r\n                  initial={{ opacity: 0, scale: 0.95 }}\r\n                  animate={{ opacity: 1, scale: 1 }}\r\n                  exit={{ opacity: 0, scale: 0.95 }}\r\n                  transition={{ delay: i * 0.05 }}\r\n                >\r\n                  <Card className=\"h-full border-border/50 hover:border-primary/30 transition-all group overflow-hidden flex flex-col rounded-[40px]\">\r\n                    <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                      <Truck className=\"w-32 h-32 text-primary\" />\r\n                    </div>\r\n\r\n                    <CardHeader className=\"pb-4 bg-secondary/30 border-b border-border/50 p-8\">\r\n                      <div className=\"flex justify-between items-start gap-4\">\r\n                        <div className=\"w-14 h-14 rounded-2xl bg-card border border-border flex items-center justify-center text-primary group-hover:bg-primary/10 transition-all duration-500 shadow-inner\">\r\n                          <Buildings weight=\"duotone\" className=\"w-7 h-7\" />\r\n                        </div>\r\n                        <div className=\"flex gap-2\">\r\n                          <Button \r\n                            variant=\"ghost\" \r\n                            size=\"sm\" \r\n                            onClick={() => handleEditSupplier(s)}\r\n                            className=\"h-10 w-10 p-0 rounded-xl text-muted-foreground hover:text-primary hover:bg-primary/5 border border-transparent hover:border-primary/20 transition-all\"\r\n                          >\r\n                            <PencilSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n                          </Button>\r\n                          <Button \r\n                            variant=\"ghost\" \r\n                            size=\"sm\" \r\n                            onClick={() => handleDeleteSupplier(s.id)}\r\n                            className=\"h-10 w-10 p-0 rounded-xl text-muted-foreground hover:text-rose-500 hover:bg-rose-500/5 border border-transparent hover:border-rose-500/20 transition-all\"\r\n                          >\r\n                            <Trash weight=\"bold\" className=\"w-4 h-4\" />\r\n                          </Button>\r\n                        </div>\r\n                      </div>\r\n                    </CardHeader>\r\n\r\n                    <CardContent className=\"p-8 flex-1 flex flex-col justify-between space-y-8 relative z-10\">\r\n                      <div className=\"space-y-6\">\r\n                        <div>\r\n                          <Badge variant={s.is_active ? 'success' : 'secondary'} size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3 mb-2\">\r\n                            {s.is_active ? 'OPERATIONAL' : 'DEACTIVATED'}\r\n                          </Badge>\r\n                          <h3 className=\"text-xl font-bold text-foreground group-hover:text-primary transition-colors uppercase tracking-tight truncate\">{s.name}</h3>\r\n                          <p className=\"text-[10px] text-muted-foreground font-black uppercase tracking-widest mt-1 opacity-60\">POC: {s.contact_name || 'ANONYMOUS_NODE'}</p>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-3\">\r\n                          <div className=\"flex items-center gap-3 p-3 bg-secondary/20 rounded-2xl border border-border/50 group-hover:border-primary/20 transition-all\">\r\n                            <EnvelopeSimple weight=\"duotone\" className=\"w-4 h-4 text-primary/60 shrink-0\" />\r\n                            <p className=\"text-xs text-foreground/70 font-medium truncate italic\">{s.email || 'NO_MAIL_NODE'}</p>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-3 p-3 bg-secondary/20 rounded-2xl border border-border/50 group-hover:border-primary/20 transition-all\">\r\n                            <Phone weight=\"duotone\" className=\"w-4 h-4 text-primary/60 shrink-0\" />\r\n                            <p className=\"text-xs text-foreground/70 font-bold tabular-nums\">{s.phone || 'NO_COMM_LINK'}</p>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"pt-6 border-t border-border/30 flex items-center justify-between\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <HistoryIcon weight=\"bold\" className=\"w-3.5 h-3.5 text-primary/60\" />\r\n                          <span className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">Est: {new Date(s.created_at).toLocaleDateString()}</span>\r\n                        </div>\r\n                        <Button \r\n                          variant=\"ghost\" \r\n                          size=\"sm\" \r\n                          onClick={() => router.push(`/clinic/inventory/suppliers/orders?supplierId=${s.id}`)}\r\n                          className=\"text-primary font-black uppercase text-[9px] tracking-[0.2em] gap-2 hover:bg-primary/5 px-4 py-2 rounded-xl\"\r\n                        >\r\n                          PO Logs <ArrowRight weight=\"bold\" className=\"w-3 h-3\" />\r\n                        </Button>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                </motion.div>\r\n              ))}\r\n            </AnimatePresence>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\memberships\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[192,206],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Buildings' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Buildings"},"fix":{"range":[243,256],"text":""},"desc":"Remove unused variable \"Buildings\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowRight' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowRight"},"fix":{"range":[256,270],"text":""},"desc":"Remove unused variable \"ArrowRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Monitor' is defined but never used.","line":25,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Monitor"},"fix":{"range":[380,391],"text":""},"desc":"Remove unused variable \"Monitor\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":60,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":60,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":61,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":61,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":61,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1478,1481],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1478,1481],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'customerMemberships' is assigned a value but never used.","line":63,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":63,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setCustomerMemberships' is assigned a value but never used.","line":63,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":63,"endColumn":53},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatPrice' is assigned a value but never used.","line":88,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":88,"endColumn":20},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":220,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":220,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6836,6839],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6836,6839],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'SpinnerGap' is not defined.","line":246,"column":16,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":246,"endColumn":26},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Check' is not defined.","line":493,"column":26,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":493,"endColumn":31}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect, useMemo } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  Crown, \n  Plus, \n  Users, \n  TrendUp, \n  Star, \n  Gear, \n  ArrowLeft, \n  CaretRight, \n  CheckCircle, \n  X,\n  Buildings,\n  ArrowRight,\n  CurrencyCircleDollar,\n  UserCheck,\n  ArrowsClockwise,\n  Icon,\n  Lightning,\n  Sparkle,\n  IdentificationCard,\n  Monitor\n} from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { useTranslations } from 'next-intl';\nimport { cn } from '@/lib/utils';\n\ninterface Membership {\n  id: string;\n  name: { th: string; en: string };\n  description?: { th: string; en: string };\n  price: number;\n  billing_period: string;\n  discount_all_services: number;\n  priority_booking: boolean;\n  free_consultations: number;\n  points_multiplier: number;\n  welcome_points: number;\n  badge_color: string;\n  is_active: boolean;\n}\n\ninterface CustomerMembership {\n  id: string;\n  status: string;\n  start_date: string;\n  end_date?: string;\n  membership: Membership;\n}\n\nexport default function MembershipsPage() {\n  const { goBack } = useBackNavigation();\n  const t = useTranslations('clinic.memberships' as any);\n  const [memberships, setMemberships] = useState<Membership[]>([]);\n  const [customerMemberships, setCustomerMemberships] = useState<CustomerMembership[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [activeTab, setActiveTab] = useState<'plans' | 'members'>('plans');\n  const [showCreateModal, setShowCreateModal] = useState(false);\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  const fetchData = async () => {\n    try {\n      setLoading(true);\n      const [membershipsRes] = await Promise.all([\n        fetch('/api/memberships?clinic_id=current')\n      ]);\n      \n      const membershipsData = await membershipsRes.json();\n      setMemberships(membershipsData.memberships || []);\n    } catch (error) {\n      console.error('Failed to fetch data:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const formatPrice = (amount: number) => {\n    return new Intl.NumberFormat('th-TH', {\n      style: 'currency',\n      currency: 'THB',\n      minimumFractionDigits: 0\n    }).format(amount);\n  };\n\n  const getBillingLabel = (period: string) => {\n    switch (period) {\n      case 'monthly': return '/ Mo';\n      case 'quarterly': return '/ Qtr';\n      case 'yearly': return '/ Yr';\n      case 'one_time': return 'ONCE';\n      default: return '';\n    }\n  };\n\n  const stats = useMemo(() => ({\n    totalTiers: memberships.length,\n    activeMembers: 0, // Mocked for now\n    projectedYield: 0, // Mocked for now\n    retentionRate: 94 // Mocked for now\n  }), [memberships]);\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header Section */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <Crown weight=\"duotone\" className=\"w-4 h-4\" />\n            Loyalty Architecture Matrix\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n          >\n            Membership <span className=\"text-primary\">Protocols</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Orchestrating exclusive client tiers, privilege nodes, and retention cycles.\n          </motion.p>\n        </div>\n\n        <motion.div \n          initial={{ opacity: 0, scale: 0.9 }}\n          animate={{ opacity: 1, scale: 1 }}\n          transition={{ delay: 0.3 }}\n          className=\"flex items-center gap-3\"\n        >\n          <Button \n            variant=\"outline\" \n            onClick={fetchData}\n            disabled={loading}\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\n          >\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\n            Sync status\n          </Button>\n          <Button \n            onClick={() => setShowCreateModal(true)}\n            className=\"gap-3 shadow-premium px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest group\"\n          >\n            <Plus weight=\"bold\" className=\"w-4 h-4 group-hover:scale-110 transition-transform\" />\n            <span>Create Tier Node</span>\n          </Button>\n        </motion.div>\n      </div>\n\n      {/* Stats Summary Section */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\n        <StatCard\n          title=\"Active Tiers\"\n          value={stats.totalTiers}\n          icon={Crown as Icon}\n          iconColor=\"text-yellow-500\"\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Total Members\"\n          value={stats.activeMembers}\n          icon={Users as Icon}\n          iconColor=\"text-primary\"\n          trend=\"up\"\n          change={12.4}\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Recurring Yield\"\n          value={stats.projectedYield}\n          prefix=\"๏ฟฝ\"\n          icon={TrendUp as Icon}\n          iconColor=\"text-emerald-500\"\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Retention Delta\"\n          value={stats.retentionRate}\n          suffix=\"%\"\n          icon={Star as Icon}\n          iconColor=\"text-purple-500\"\n          className=\"p-4\"\n        />\n      </div>\n\n      {/* Navigation Matrix Tabs */}\n      <div className=\"px-2\">\n        <div className=\"flex bg-secondary/50 border border-border p-1.5 rounded-[24px] w-fit shadow-inner\">\n          {[\n            { id: 'plans', label: 'Tier Definitions', icon: Crown },\n            { id: 'members', label: 'Identity Registry', icon: UserCheck }\n          ].map((tab) => (\n            <button\n              key={tab.id}\n              onClick={() => setActiveTab(tab.id as any)}\n              className={cn(\n                \"flex items-center gap-3 px-8 py-3 rounded-2xl transition-all text-[10px] font-black uppercase tracking-widest border whitespace-nowrap\",\n                activeTab === tab.id\n                  ? \"bg-card text-primary border-border/50 shadow-sm\"\n                  : \"text-muted-foreground border-transparent hover:text-foreground\"\n              )}\n            >\n              <tab.icon weight={activeTab === tab.id ? \"fill\" : \"duotone\"} className=\"w-4 h-4\" />\n              {tab.label}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      {/* Main Content Node Hub */}\n      <div className=\"px-2\">\n        <AnimatePresence mode=\"wait\">\n          {loading ? (\n            <motion.div \n              key=\"loading\"\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n              className=\"py-48 flex flex-col items-center justify-center gap-6 bg-card border border-border/50 rounded-[40px] shadow-inner opacity-60\"\n            >\n              <SpinnerGap weight=\"bold\" className=\"w-12 h-12 text-primary animate-spin\" />\n              <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] text-center\">Synchronizing Loyalty Matrix...</p>\n            </motion.div>\n          ) : activeTab === 'plans' ? (\n            <motion.div \n              key=\"plans\"\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -20 }}\n              className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\"\n            >\n              {memberships.length === 0 ? (\n                <Card variant=\"ghost\" className=\"col-span-full py-48 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-8 opacity-40 rounded-[40px]\">\n                  <Crown weight=\"duotone\" className=\"w-20 h-20\" />\n                  <div className=\"text-center space-y-3\">\n                    <h3 className=\"text-2xl font-black text-foreground uppercase tracking-widest\">Protocol Registry Empty</h3>\n                    <p className=\"text-sm text-muted-foreground font-medium italic max-w-sm mx-auto\">No exclusive membership tiers established in this clinical node.</p>\n                    <Button variant=\"ghost\" size=\"sm\" onClick={() => setShowCreateModal(true)} className=\"text-primary font-black uppercase tracking-widest mt-4\">Initialize First Node</Button>\n                  </div>\n                </Card>\n              ) : (\n                memberships.map((membership, i) => (\n                  <motion.div\n                    key={membership.id}\n                    initial={{ opacity: 0, scale: 0.95 }}\n                    animate={{ opacity: 1, scale: 1 }}\n                    transition={{ delay: i * 0.05 }}\n                  >\n                    <Card className=\"h-full border-border/50 hover:border-primary/30 transition-all group overflow-hidden flex flex-col shadow-card hover:shadow-premium\">\n                      <div\n                        className=\"h-2 w-full\"\n                        style={{ backgroundColor: membership.badge_color }}\n                      />\n                      <CardHeader className=\"pb-4 relative z-10\">\n                        <div className=\"flex justify-between items-start gap-4\">\n                          <div className=\"space-y-1 min-w-0\">\n                            <CardTitle className=\"text-xl font-black uppercase tracking-tight truncate\">{membership.name.th}</CardTitle>\n                            <p className=\"text-[10px] text-muted-foreground font-black uppercase tracking-[0.2em]\">{membership.name.en}</p>\n                          </div>\n                          <Button \n                            variant=\"ghost\" \n                            size=\"sm\" \n                            className=\"p-2.5 h-10 w-10 rounded-xl text-muted-foreground hover:text-primary hover:bg-primary/5 transition-all\"\n                          >\n                            <Gear weight=\"bold\" className=\"w-5 h-5\" />\n                          </Button>\n                        </div>\n                      </CardHeader>\n\n                      <CardContent className=\"flex-1 space-y-8 relative z-10 flex flex-col justify-between\">\n                        <div className=\"space-y-6\">\n                          <div className=\"flex items-baseline gap-2 p-4 bg-secondary/30 rounded-2xl border border-border/50 shadow-inner group-hover:bg-secondary/50 transition-all\">\n                            <span className=\"text-4xl font-black text-foreground tracking-tighter tabular-nums\">\n                              ๏ฟฝ{membership.price.toLocaleString()}\n                            </span>\n                            <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest opacity-60\">\n                              {getBillingLabel(membership.billing_period)}\n                            </span>\n                          </div>\n\n                          <div className=\"space-y-4\">\n                            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Privilege Protocols</p>\n                            <div className=\"space-y-2.5\">\n                              {membership.discount_all_services > 0 && (\n                                <div className=\"flex items-center gap-3 p-3.5 bg-secondary/20 rounded-2xl border border-border/50 group-hover:border-primary/20 transition-all shadow-sm\">\n                                  <div className=\"w-7 h-7 rounded-lg bg-emerald-500/10 flex items-center justify-center text-emerald-500 shadow-inner\">\n                                    <CheckCircle weight=\"fill\" className=\"w-4 h-4\" />\n                                  </div>\n                                  <span className=\"text-xs font-bold text-foreground/80 uppercase tracking-tight\">{membership.discount_all_services}% Global Discount</span>\n                                </div>\n                              )}\n                              {membership.priority_booking && (\n                                <div className=\"flex items-center gap-3 p-3.5 bg-secondary/20 rounded-2xl border border-border/50 group-hover:border-primary/20 transition-all shadow-sm\">\n                                  <div className=\"w-7 h-7 rounded-lg bg-primary/10 flex items-center justify-center text-primary shadow-inner\">\n                                    <Lightning weight=\"fill\" className=\"w-4 h-4\" />\n                                  </div>\n                                  <span className=\"text-xs font-bold text-foreground/80 uppercase tracking-tight\">Priority Scheduling Link</span>\n                                </div>\n                              )}\n                              {membership.points_multiplier > 1 && (\n                                <div className=\"flex items-center gap-3 p-3.5 bg-secondary/20 rounded-2xl border border-border/50 group-hover:border-primary/20 transition-all shadow-sm\">\n                                  <div className=\"w-7 h-7 rounded-lg bg-purple-500/10 flex items-center justify-center text-purple-500 shadow-inner\">\n                                    <Sparkle weight=\"fill\" className=\"w-4 h-4\" />\n                                  </div>\n                                  <span className=\"text-xs font-bold text-foreground/80 uppercase tracking-tight\">{membership.points_multiplier}x Reward Velocity</span>\n                                </div>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n\n                        <div className=\"pt-6 border-t border-border/30 flex items-center justify-between\">\n                          <div className=\"flex items-center gap-2.5 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\n                            <Users weight=\"duotone\" className=\"w-4 h-4 text-primary/60\" />\n                            <span className=\"tabular-nums\">0 IDENTITIES_SYNCED</span>\n                          </div>\n                          <Badge variant={membership.is_active ? 'success' : 'secondary'} size=\"sm\" className=\"font-black uppercase tracking-[0.2em] px-3 py-1 shadow-sm\">\n                            {membership.is_active ? 'NOMINAL' : 'OFFLINE'}\n                          </Badge>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  </motion.div>\n                ))\n              )}\n            </motion.div>\n          ) : (\n            <motion.div \n              key=\"members\"\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -20 }}\n            >\n              <Card variant=\"ghost\" className=\"py-48 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-8 opacity-40 rounded-[48px]\">\n                <div className=\"w-24 h-24 rounded-[48px] bg-secondary border border-border/50 flex items-center justify-center text-muted-foreground shadow-inner\">\n                  <IdentificationCard weight=\"duotone\" className=\"w-12 h-12\" />\n                </div>\n                <div className=\"text-center space-y-3\">\n                  <h3 className=\"text-2xl font-black text-foreground uppercase tracking-widest\">Identity Registry Empty</h3>\n                  <p className=\"text-sm text-muted-foreground font-medium italic max-w-sm mx-auto leading-relaxed\">\n                    No active membership synchronizations detected in this clinical sector.\n                  </p>\n                </div>\n              </Card>\n            </motion.div>\n          )}\n        </AnimatePresence>\n      </div>\n\n      {/* Create Tier Modal Protocol */}\n      <AnimatePresence>\n        {showCreateModal && (\n          <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-[200] flex items-center justify-center p-4 overflow-y-auto\">\n            <motion.div\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n              onClick={() => setShowCreateModal(false)}\n              className=\"absolute inset-0\"\n            />\n            <motion.div\n              initial={{ opacity: 0, scale: 0.95, y: 20 }}\n              animate={{ opacity: 1, scale: 1 }}\n              exit={{ opacity: 0, scale: 0.95, y: 20 }}\n              className=\"bg-card p-10 rounded-[40px] border border-border shadow-premium w-full max-w-2xl relative overflow-hidden group\"\n              onClick={e => e.stopPropagation()}\n            >\n              <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n                <Crown weight=\"fill\" className=\"w-64 h-64 text-primary\" />\n              </div>\n\n              <div className=\"flex items-center justify-between mb-10 relative z-10\">\n                <div className=\"flex items-center gap-5\">\n                  <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm shadow-inner\">\n                    <Plus weight=\"duotone\" className=\"w-8 h-8\" />\n                  </div>\n                  <div>\n                    <h2 className=\"text-2xl font-black text-foreground uppercase tracking-tight leading-tight\">Tier Definition</h2>\n                    <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Configure clinical privilege protocol node</p>\n                  </div>\n                </div>\n                <Button \n                  variant=\"ghost\"\n                  onClick={() => setShowCreateModal(false)}\n                  className=\"h-11 w-11 p-0 rounded-xl hover:bg-secondary transition-all\"\n                >\n                  <X weight=\"bold\" className=\"w-6 h-6\" />\n                </Button>\n              </div>\n\n              <form\n                onSubmit={async (e) => {\n                  e.preventDefault();\n                  const formData = new FormData(e.currentTarget);\n                  const res = await fetch('/api/memberships', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                      name: { th: formData.get('nameTh'), en: formData.get('nameEn') },\n                      description: { th: formData.get('descTh'), en: formData.get('descEn') },\n                      price: Number(formData.get('price')),\n                      billingPeriod: formData.get('billingPeriod'),\n                      discountAllServices: Number(formData.get('discount')) || 0,\n                      priorityBooking: formData.get('priorityBooking') === 'on',\n                      freeConsultations: Number(formData.get('freeConsultations')) || 0,\n                      pointsMultiplier: Number(formData.get('pointsMultiplier')) || 1,\n                      welcomePoints: Number(formData.get('welcomePoints')) || 0,\n                      badgeColor: formData.get('badgeColor') || '#6366f1'\n                    })\n                  });\n                  if (res.ok) {\n                    setShowCreateModal(false);\n                    fetchData();\n                  }\n                }}\n                className=\"space-y-10 relative z-10\"\n              >\n                <div className=\"space-y-8\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10\">\n                    <div className=\"space-y-3\">\n                      <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Identity Node (THA) *</label>\n                      <input name=\"nameTh\" required className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner\" placeholder=\"e.g. ๏ฟฝลทิน๏ฟฝ๏ฟฝ\" />\n                    </div>\n                    <div className=\"space-y-3\">\n                      <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Identity Node (ENG) *</label>\n                      <input name=\"nameEn\" required className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold shadow-inner\" placeholder=\"e.g. PLATINUM_ALPHA\" />\n                    </div>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10\">\n                    <div className=\"space-y-3\">\n                      <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Investment Value (๏ฟฝ) *</label>\n                      <div className=\"relative group/input\">\n                        <CurrencyCircleDollar weight=\"bold\" className=\"absolute left-5 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\n                        <input type=\"number\" name=\"price\" required className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:border-primary outline-none transition-all font-black tabular-nums shadow-inner\" placeholder=\"0\" />\n                      </div>\n                    </div>\n                    <div className=\"space-y-3\">\n                      <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Settlement Frequency *</label>\n                      <div className=\"relative\">\n                        <select name=\"billingPeriod\" className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-6 text-xs font-black uppercase tracking-widest text-foreground focus:border-primary outline-none transition-all appearance-none shadow-inner\">\n                          <option value=\"monthly\" className=\"bg-card\">MONTHLY_CYCLE</option>\n                          <option value=\"quarterly\" className=\"bg-card\">QUARTERLY_CYCLE</option>\n                          <option value=\"yearly\" className=\"bg-card\">ANNUAL_CYCLE</option>\n                          <option value=\"one_time\" className=\"bg-card\">INSTANT_INITIALIZATION</option>\n                        </select>\n                        <CaretRight weight=\"bold\" className=\"absolute right-6 top-1/2 -translate-y-1/2 w-4 h-4 rotate-90 text-muted-foreground/40 pointer-events-none\" />\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10\">\n                    <div className=\"space-y-3\">\n                      <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Protocol Discount (%)</label>\n                      <input type=\"number\" name=\"discount\" defaultValue={0} className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-black tabular-nums shadow-inner\" />\n                    </div>\n                    <div className=\"space-y-3\">\n                      <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-1\">Reward Velocity (x)</label>\n                      <input type=\"number\" name=\"pointsMultiplier\" defaultValue={1} step=\"0.1\" className=\"w-full bg-secondary/30 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-black tabular-nums shadow-inner\" />\n                    </div>\n                  </div>\n\n                  <div className=\"flex flex-col sm:flex-row items-center gap-10 p-8 bg-secondary/50 rounded-[32px] border border-border shadow-inner\">\n                    <label className=\"flex items-center gap-4 cursor-pointer group flex-1\">\n                      <div className=\"relative flex items-center justify-center\">\n                        <input type=\"checkbox\" name=\"priorityBooking\" className=\"peer sr-only\" />\n                        <div className=\"w-7 h-7 bg-card border-2 border-border/50 rounded-xl transition-all peer-checked:bg-primary peer-checked:border-primary shadow-sm\" />\n                        <Check weight=\"bold\" className=\"absolute w-4 h-4 text-primary-foreground opacity-0 peer-checked:opacity-100 transition-opacity\" />\n                      </div>\n                      <div className=\"space-y-0.5\">\n                        <p className=\"text-[10px] font-black text-foreground uppercase tracking-widest group-hover:text-primary transition-colors\">Priority Access</p>\n                        <p className=\"text-[8px] font-bold text-muted-foreground uppercase tracking-widest opacity-60\">Linear scheduling priority</p>\n                      </div>\n                    </label>\n                    <div className=\"h-10 w-px bg-border hidden sm:block\" />\n                    <div className=\"flex items-center gap-5\">\n                      <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Protocol visual node:</label>\n                      <div className=\"relative group/color\">\n                        <input type=\"color\" name=\"badgeColor\" defaultValue=\"#3C50E0\" className=\"w-12 h-12 rounded-2xl cursor-pointer border-2 border-card bg-card overflow-hidden shadow-sm\" />\n                        <div className=\"absolute -inset-1 border border-primary/20 rounded-[20px] opacity-0 group-hover/color:opacity-100 transition-opacity\" />\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"flex flex-col sm:flex-row items-center gap-4 pt-6 border-t border-border/30\">\n                  <Button type=\"submit\" className=\"w-full sm:flex-[2] py-7 rounded-[24px] font-black uppercase tracking-widest text-[11px] shadow-premium gap-3 relative overflow-hidden group/btn\">\n                    <div className=\"absolute inset-0 bg-white/20 -translate-x-full group-hover/btn:translate-x-full transition-transform duration-1000\" />\n                    <Crown weight=\"bold\" className=\"w-5 h-5 group-hover:scale-110 transition-transform\" />\n                    Deploy Tier Node\n                  </Button>\n                  <Button \n                    type=\"button\"\n                    variant=\"outline\" \n                    onClick={() => setShowCreateModal(false)}\n                    className=\"w-full sm:flex-1 py-7 rounded-[24px] font-black uppercase tracking-widest text-[11px] border-border/50 hover:bg-secondary\"\n                  >\n                    Abort Synthesis\n                  </Button>\n                </div>\n              </form>\n            </motion.div>\n          </div>\n        )}\n      </AnimatePresence>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Declaration or statement expected.","line":350,"column":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { \r\n  TrendUp, \r\n  Users, \r\n  Sparkle, \r\n  CalendarDots, \r\n  ArrowUpRight, \r\n  ArrowDownRight,\r\n  Pulse,\r\n  SpinnerGap,\r\n  ShoppingCart,\r\n  ChartBar,\r\n  ArrowRight,\r\n  Package,\r\n  CheckCircle,\r\n  CaretRight,\r\n  Strategy,\r\n  Eye,\r\n  ArrowLeft,\r\n  Monitor,\r\n  IdentificationBadge,\r\n  Graph,\r\n  Receipt,\r\n  Icon,\r\n  ShieldCheck,\r\n  Clock,\r\n  Briefcase\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { cn } from '@/lib/utils';\r\nimport { useRouter } from 'next/navigation';\r\nimport { createClient } from '@/lib/supabase/client';\r\nimport RevenueChart from '@/components/analytics/RevenueChart';\r\nimport StaffIntelligence from '@/components/analytics/StaffIntelligence';\r\nimport StrategicForecast from '@/components/analytics/StrategicForecast';\r\nimport { useEffect, useState, useMemo } from 'react';\r\nimport AnimatedNumber from '@/components/ui/premium/AnimatedNumber';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nexport default function ClinicDashboard() {\r\n  const router = useRouter();\r\n  const { goBack } = useBackNavigation();\r\n  const [loading, setLoading] = useState(true);\r\n  const [clinicId, setClinicId] = useState<string | null>(null);\r\n  const [stats, setStats] = useState<{\r\n    label: string;\r\n    value: number;\r\n    change: number;\r\n    trend: 'up' | 'down';\r\n    icon: any;\r\n    prefix?: string;\r\n  }[]>([]);\r\n  const [stockAlerts, setStockAlerts] = useState<any[]>([]);\r\n\r\n  const supabase = useMemo(() => createClient(), []);\r\n\r\n  useEffect(() => {\r\n    async function fetchClinicData() {\r\n      setLoading(true);\r\n      try {\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (user) {\r\n          const { data: staff } = await supabase\r\n            .from('clinic_staff')\r\n            .select('clinic_id')\r\n            .eq('user_id', user.id)\r\n            .single();\r\n          \r\n          if (staff) {\r\n            setClinicId(staff.clinic_id);\r\n            \r\n            // Fetch real overview stats and stock alerts\r\n            const [reportRes, alertsRes] = await Promise.all([\r\n              fetch('/api/reports?type=clinic_overview'),\r\n              fetch('/api/reports?type=stock_alerts')\r\n            ]);\r\n            \r\n            const result = await reportRes.json();\r\n            const alertsResult = await alertsRes.json();\r\n            \r\n            if (result.success) {\r\n              const d = result.data;\r\n              setStats([\r\n                { label: 'Monthly Revenue', value: Number(d.monthlyRevenue), change: 12.5, trend: 'up', icon: TrendUp, prefix: 'เธฟ' },\r\n                { label: 'Total AI Scans', value: Number(d.totalScans), change: 18.2, trend: 'up', icon: Sparkle },\r\n                { label: 'Active Customers', value: Number(d.activeCustomers), change: 5.4, trend: 'up', icon: Users },\r\n                { label: 'Today Appointments', value: Number(d.todayAppointments), change: 2.1, trend: 'down', icon: CalendarDots },\r\n              ]);\r\n            }\r\n\r\n            if (alertsResult.success) {\r\n              setStockAlerts(alertsResult.data);\r\n            }\r\n          }\r\n        }\r\n      } catch (err) {\r\n        console.error('Clinic Dashboard Error:', err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n    fetchClinicData();\r\n  }, [supabase]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-[400px] flex flex-col items-center justify-center space-y-4\">\r\n        <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n        <p className=\"text-muted-foreground animate-pulse text-xs uppercase tracking-widest text-center\">\r\n          Synchronizing Executive Node...\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Pulse weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Executive Oversight Node\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Clinic <span className=\"text-primary\">Intelligence</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating multi-tenant operational reporting, clinical performance, and strategic growth matrices.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <motion.div \r\n          initial={{ opacity: 0, scale: 0.9 }}\r\n          animate={{ opacity: 1, scale: 1 }}\r\n          transition={{ delay: 0.3 }}\r\n          className=\"flex flex-wrap gap-3\"\r\n        >\r\n          <Button \r\n            onClick={() => router.push('/clinic/pos')}\r\n            className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium group\"\r\n          >\r\n            <ShoppingCart weight=\"bold\" className=\"w-4 h-4 group-hover:scale-110 transition-transform\" />\r\n            Launch Terminal\r\n          </Button>\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={() => router.push('/clinic/reports')}\r\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary\"\r\n          >\r\n            <ChartBar weight=\"duotone\" className=\"w-4 h-4 text-primary\" />\r\n            Analytics Matrix\r\n          </Button>\r\n        </motion.div>\r\n      </div>\r\n\r\n      {/* Stats Summary */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\r\n        {stats.map((stat, i) => (\r\n          <StatCard\r\n            key={stat.label}\r\n            title={stat.label}\r\n            value={stat.value}\r\n            change={stat.change}\r\n            trend={stat.trend}\r\n            icon={stat.icon as Icon}\r\n            prefix={stat.prefix}\r\n            className=\"p-4\"\r\n          />\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-10 px-2\">\r\n        {/* Revenue Projection & Forecasting */}\r\n        <div className=\"lg:col-span-2 space-y-10\">\r\n          <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n            <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 flex flex-row items-center justify-between\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n                  <TrendUp weight=\"duotone\" className=\"w-6 h-6\" />\r\n                </div>\r\n                <div>\r\n                  <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Revenue Trajectory</CardTitle>\r\n                  <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Global yield synchronization</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex bg-secondary border border-border/50 p-1 rounded-xl shadow-inner\">\r\n                {['30d', '90d', 'All'].map((p) => (\r\n                  <button\r\n                    key={p}\r\n                    className=\"px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all hover:text-primary text-muted-foreground\"\r\n                  >\r\n                    {p}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent className=\"p-8 min-h-[400px]\">\r\n              {clinicId && <RevenueChart clinicId={clinicId} />}\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {clinicId && (\r\n            <motion.div\r\n              initial={{ opacity: 0, y: 20 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              transition={{ delay: 0.4 }}\r\n            >\r\n              <StrategicForecast clinicId={clinicId} />\r\n            </motion.div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Sidebar Intelligence Nodes */}\r\n        <div className=\"space-y-10\">\r\n          <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n            <div className=\"absolute top-0 right-0 p-8 opacity-[0.02] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n              <Package className=\"w-64 h-64 text-primary\" />\r\n            </div>\r\n\r\n            <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 flex flex-row items-center justify-between\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n                  <Package weight=\"duotone\" className=\"w-5 h-5\" />\r\n                </div>\r\n                <CardTitle className=\"text-sm font-black uppercase tracking-tight text-foreground/80\">Asset Alerts</CardTitle>\r\n              </div>\r\n              {stockAlerts.length > 0 && (\r\n                <Badge variant=\"destructive\" pulse className=\"font-black text-[8px] tracking-widest px-3 py-1\">CRITICAL_NODE</Badge>\r\n              )}\r\n            </CardHeader>\r\n\r\n            <CardContent className=\"p-8 space-y-4\">\r\n              {stockAlerts.length === 0 ? (\r\n                <div className=\"py-16 text-center opacity-20 flex flex-col items-center gap-4\">\r\n                  <CheckCircle weight=\"duotone\" className=\"w-12 h-12 text-emerald-500\" />\r\n                  <p className=\"text-[10px] font-black uppercase tracking-widest\">Inventory Nominal</p>\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-4\">\r\n                  {stockAlerts.map((item, i) => (\r\n                    <motion.div \r\n                      key={i} \r\n                      initial={{ opacity: 0, x: 20 }}\r\n                      animate={{ opacity: 1, x: 0 }}\r\n                      transition={{ delay: 0.1 * i }}\r\n                      className=\"p-5 bg-secondary/30 rounded-3xl border border-border/50 flex justify-between items-center group/alert hover:bg-secondary/50 transition-all cursor-pointer\"\r\n                      onClick={() => router.push('/clinic/inventory')}\r\n                    >\r\n                      <div className=\"space-y-1\">\r\n                        <p className=\"text-sm font-bold text-foreground group-hover/alert:text-primary transition-colors uppercase tracking-tight\">{item.name}</p>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Badge variant=\"ghost\" size=\"sm\" className=\"bg-rose-500/10 text-rose-500 border-none font-black text-[8px] px-2\">DEPLETION</Badge>\r\n                          <span className=\"text-[9px] text-muted-foreground font-bold tabular-nums\">STOCK: {item.stock_quantity}</span>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"p-2 bg-rose-500/5 text-rose-500 rounded-xl border border-rose-500/10 group-hover/alert:bg-rose-500/10 transition-all\">\r\n                        <CaretRight weight=\"bold\" className=\"w-3.5 h-3.5\" />\r\n                      </div>\r\n                    </motion.div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n              \r\n              <Button \r\n                variant=\"ghost\"\r\n                onClick={() => router.push('/clinic/inventory')}\r\n                className=\"w-full mt-4 text-[10px] font-black uppercase tracking-[0.3em] text-muted-foreground hover:text-primary border border-dashed border-border/50 py-4 rounded-2xl\"\r\n              >\r\n                Access Inventory Vault\r\n              </Button>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card className=\"rounded-[40px] border-primary/10 bg-primary/[0.02] overflow-hidden group\">\r\n            <div className=\"absolute -top-12 -left-12 w-48 h-48 bg-primary/5 blur-[60px] rounded-full group-hover:bg-primary/10 transition-all duration-700\" />\r\n            \r\n            <CardHeader className=\"p-8 border-b border-primary/10\">\r\n              <CardTitle className=\"text-xs font-black uppercase tracking-[0.3em] flex items-center gap-3 text-primary\">\r\n                <Sparkle weight=\"duotone\" className=\"w-5 h-5\" />\r\n                Strategic Intelligence\r\n              </CardTitle>\r\n            </CardHeader>\r\n            \r\n            <CardContent className=\"p-8 space-y-4 relative z-10\">\r\n              {[\r\n                { title: \"Optimal Node Window\", desc: \"14:00 - 17:00 Workdays\", icon: Clock, color: \"text-primary\", bg: \"bg-primary/5\" },\r\n                { title: \"Peak Conversion Path\", desc: \"AI Scan โ’ Premium Protocol\", icon: Strategy, color: \"text-emerald-500\", bg: \"bg-emerald-500/5\" },\r\n                { title: \"Tenant Retention Rate\", desc: \"85% Month-over-Month\", icon: Activity, color: \"text-blue-500\", bg: \"bg-blue-500/5\" }\r\n              ].map((item, i) => (\r\n                <motion.div \r\n                  key={i} \r\n                  initial={{ opacity: 0, x: 20 }}\r\n                  animate={{ opacity: 1, x: 0 }}\r\n                  transition={{ delay: 0.5 + i * 0.1 }}\r\n                  className=\"p-5 bg-card border border-border/50 rounded-3xl hover:border-primary/20 transition-all group/intel\"\r\n                >\r\n                  <div className=\"flex items-center gap-5\">\r\n                    <div className={cn(\"w-12 h-12 rounded-2xl flex items-center justify-center border border-border/50 group-hover/intel:scale-110 transition-transform shadow-inner\", item.bg, item.color)}>\r\n                      <item.icon weight=\"duotone\" className=\"w-6 h-6\" />\r\n                    </div>\r\n                    <div className=\"space-y-0.5\">\r\n                      <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">{item.title}</p>\r\n                      <p className=\"text-sm font-bold text-foreground tracking-tight uppercase\">{item.desc}</p>\r\n                    </div>\r\n                  </div>\r\n                </motion.div>\r\n              ))}\r\n              \r\n              <Button \r\n                variant=\"ghost\"\r\n                onClick={() => router.push('/clinic/reports')}\r\n                className=\"w-full mt-4 text-[10px] font-black uppercase tracking-[0.3em] text-muted-foreground hover:text-primary\"\r\n              >\r\n                Extract Full Intelligence Node\r\n              </Button>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n  );\r\n}\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\pos\\history\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Declaration or statement expected.","line":398,"column":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { \r\n  ClockCounterClockwise, \r\n  MagnifyingGlass, \r\n  CalendarDots, \r\n  Funnel, \r\n  CaretRight, \r\n  SpinnerGap, \r\n  ArrowLeft,\r\n  CreditCard,\r\n  ShoppingCart,\r\n  User,\r\n  CheckCircle,\r\n  XCircle,\r\n  Clock,\r\n  Printer,\r\n  DownloadSimple,\r\n  Receipt,\r\n  Monitor,\r\n  IdentificationBadge,\r\n  Sparkle,\r\n  ArrowsClockwise,\r\n  Icon,\r\n  DotsThreeVertical,\r\n  IdentificationCard\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { useTranslations } from 'next-intl';\r\nimport { cn } from '@/lib/utils';\r\nimport { useRouter } from '@/i18n/routing';\r\nimport { useState, useEffect, useCallback, Suspense, useMemo } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface TransactionItem {\r\n  id: string;\r\n  item_name: string;\r\n  item_type: string;\r\n  quantity: number;\r\n  unit_price: number;\r\n  total: number;\r\n}\r\n\r\ninterface Transaction {\r\n  id: string;\r\n  transaction_number: string;\r\n  total_amount: number;\r\n  payment_status: string;\r\n  created_at: string;\r\n  customer: {\r\n    full_name: string;\r\n    phone?: string;\r\n  };\r\n  items: TransactionItem[];\r\n}\r\n\r\nfunction POSHistoryContent() {\r\n  const { goBack } = useBackNavigation();\r\n  const [loading, setLoading] = useState(true);\r\n  const [transactions, setTransactions] = useState<Transaction[]>([]);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [selectedTransaction, setSelectedTransaction] = useState<Transaction | null>(null);\r\n\r\n  const fetchTransactions = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch('/api/pos/transactions');\r\n      const result = await res.json();\r\n      if (result.success) {\r\n        setTransactions(result.data || []);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching transactions:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchTransactions();\r\n  }, [fetchTransactions]);\r\n\r\n  const filteredTransactions = transactions.filter(txn => \r\n    txn.transaction_number.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    txn.customer?.full_name.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  const stats = useMemo(() => ({\r\n    total: transactions.length,\r\n    volume: transactions.reduce((acc, t) => acc + Number(t.total_amount), 0),\r\n    paid: transactions.filter(t => t.payment_status === 'paid').length,\r\n    pending: transactions.filter(t => t.payment_status === 'pending').length\r\n  }), [transactions]);\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <ClockCounterClockwise weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Audit Log Registry\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Sales <span className=\"text-primary\">History</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Reviewing historical fiscal nodes, transaction telemetry, and settled protocol records.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <div className=\"flex flex-wrap items-center gap-3\">\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={fetchTransactions}\r\n            disabled={loading}\r\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\r\n          >\r\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\r\n            Sync Ledger\r\n          </Button>\r\n          <Button className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\">\r\n            <DownloadSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n            Export Archive\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Summary */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\r\n        <StatCard\r\n          title=\"Consolidated Yield\"\r\n          value={stats.volume}\r\n          prefix=\"เธฟ\"\r\n          icon={Receipt as Icon}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Settled Nodes\"\r\n          value={stats.paid}\r\n          icon={CheckCircle as Icon}\r\n          iconColor=\"text-emerald-500\"\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Pending Flux\"\r\n          value={stats.pending}\r\n          icon={Clock as Icon}\r\n          iconColor=\"text-amber-500\"\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Total Transactions\"\r\n          value={stats.total}\r\n          icon={ShoppingCart as Icon}\r\n          iconColor=\"text-primary\"\r\n          className=\"p-4\"\r\n        />\r\n      </div>\r\n\r\n      {/* Search & Intelligence Controls */}\r\n      <div className=\"px-2\">\r\n        <Card className=\"p-6 rounded-[32px] border-border/50 shadow-card\">\r\n          <div className=\"flex flex-col md:flex-row gap-6\">\r\n            <div className=\"relative flex-1 group\">\r\n              <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-xl\" />\r\n              <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\r\n              <input \r\n                type=\"text\" \r\n                placeholder=\"Query transaction ID, patient identity, or ledger metadata...\" \r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3.5 pl-12 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10 font-bold\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </Card>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-10 px-2\">\r\n        {/* Transaction List Node */}\r\n        <div className=\"lg:col-span-2 space-y-6\">\r\n          {loading ? (\r\n            <div className=\"py-32 flex flex-col items-center justify-center gap-4 bg-card border border-border/50 rounded-[40px] shadow-inner\">\r\n              <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n              <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest text-center\">Synchronizing Audit Matrix...</p>\r\n            </div>\r\n          ) : filteredTransactions.length === 0 ? (\r\n            <Card variant=\"ghost\" className=\"py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-6 opacity-40 rounded-[40px]\">\r\n              <ShoppingCart weight=\"duotone\" className=\"w-16 h-16 text-muted-foreground\" />\r\n              <p className=\"text-sm font-black uppercase tracking-widest text-center\">Zero Transaction Nodes Detected</p>\r\n            </Card>\r\n          ) : (\r\n            <div className=\"grid grid-cols-1 gap-4\">\r\n              <AnimatePresence mode=\"popLayout\">\r\n                {filteredTransactions.map((txn, i) => (\r\n                  <motion.button\r\n                    key={txn.id}\r\n                    layout\r\n                    initial={{ opacity: 0, x: -20 }}\r\n                    animate={{ opacity: 1, x: 0 }}\r\n                    exit={{ opacity: 0, scale: 0.95 }}\r\n                    transition={{ delay: i * 0.03 }}\r\n                    onClick={() => setSelectedTransaction(txn)}\r\n                    className={cn(\r\n                      \"w-full flex items-center justify-between p-6 rounded-[28px] border transition-all text-left group relative overflow-hidden\",\r\n                      selectedTransaction?.id === txn.id \r\n                        ? \"bg-primary text-primary-foreground border-primary shadow-premium\" \r\n                        : \"bg-card border-border/50 hover:border-primary/30 shadow-card hover:shadow-card-hover\"\r\n                    )}\r\n                  >\r\n                    <div className=\"absolute top-0 right-0 p-6 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                      <Receipt weight=\"fill\" className=\"w-24 h-24\" />\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-6 relative z-10\">\r\n                      <div className={cn(\r\n                        \"w-14 h-14 rounded-2xl flex items-center justify-center transition-all duration-500 shadow-inner\",\r\n                        selectedTransaction?.id === txn.id ? \"bg-white/20\" : \"bg-secondary border border-border group-hover:bg-primary/10 transition-all\"\r\n                      )}>\r\n                        <CreditCard weight=\"duotone\" className=\"w-7 h-7\" />\r\n                      </div>\r\n                      <div className=\"min-w-0\">\r\n                        <div className=\"flex items-center gap-3 mb-1\">\r\n                          <span className={cn(\r\n                            \"text-[10px] font-mono font-bold tracking-widest px-2 py-0.5 rounded-md border uppercase\",\r\n                            selectedTransaction?.id === txn.id ? \"bg-white/10 border-white/20 text-white\" : \"bg-primary/5 border-primary/20 text-primary\"\r\n                          )}>{txn.transaction_number}</span>\r\n                          <Badge variant={txn.payment_status === 'paid' ? 'success' : 'warning'} size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-2\">\r\n                            {txn.payment_status.toUpperCase()}\r\n                          </Badge>\r\n                        </div>\r\n                        <h4 className=\"text-lg font-black uppercase tracking-tight truncate\">{txn.customer?.full_name || 'ANONYMOUS_NODE'}</h4>\r\n                        <p className={cn(\r\n                          \"text-[10px] font-black uppercase tracking-widest mt-1 opacity-60\",\r\n                          selectedTransaction?.id === txn.id ? \"text-white\" : \"text-muted-foreground\"\r\n                        )}>\r\n                          {new Date(txn.created_at).toLocaleString()} โ€ข SYNC_OK\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"text-right relative z-10 shrink-0\">\r\n                      <p className=\"text-2xl font-black tabular-nums tracking-tighter\">เธฟ{Number(txn.total_amount).toLocaleString()}</p>\r\n                      <p className={cn(\r\n                        \"text-[9px] font-black uppercase tracking-widest\",\r\n                        selectedTransaction?.id === txn.id ? \"text-white/60\" : \"text-muted-foreground\"\r\n                      )}>{txn.items.length} Protocol Nodes</p>\r\n                    </div>\r\n                  </motion.button>\r\n                ))}\r\n              </AnimatePresence>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Transaction Detail Panel Node */}\r\n        <div className=\"lg:col-span-1\">\r\n          <AnimatePresence mode=\"wait\">\r\n            {selectedTransaction ? (\r\n              <motion.div\r\n                key={selectedTransaction.id}\r\n                initial={{ opacity: 0, x: 20 }}\r\n                animate={{ opacity: 1, x: 0 }}\r\n                exit={{ opacity: 0, scale: 0.95 }}\r\n                className=\"sticky top-24\"\r\n              >\r\n                <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden bg-card/50 backdrop-blur-xl group\">\r\n                  <div className=\"absolute top-0 right-0 p-8 opacity-[0.02] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                    <IdentificationCard weight=\"fill\" className=\"w-48 h-48 text-primary\" />\r\n                  </div>\r\n\r\n                  <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center gap-4\">\r\n                        <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\r\n                          <Receipt weight=\"duotone\" className=\"w-6 h-6\" />\r\n                        </div>\r\n                        <div>\r\n                          <CardTitle className=\"text-base font-black uppercase tracking-tight\">Receipt Data</CardTitle>\r\n                          <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">Protocol Transcript</p>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"flex gap-2\">\r\n                        <Button variant=\"ghost\" size=\"sm\" className=\"h-10 w-10 p-0 rounded-xl hover:bg-primary/5 text-muted-foreground hover:text-primary transition-all\">\r\n                          <Printer weight=\"bold\" className=\"w-4 h-4\" />\r\n                        </Button>\r\n                        <Button variant=\"ghost\" size=\"sm\" className=\"h-10 w-10 p-0 rounded-xl hover:bg-primary/5 text-muted-foreground hover:text-primary transition-all\">\r\n                          <DownloadSimple weight=\"bold\" className=\"w-4 h-4\" />\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  </CardHeader>\r\n\r\n                  <CardContent className=\"p-8 space-y-10 relative z-10\">\r\n                    <div className=\"flex items-center gap-5 p-5 bg-secondary/30 rounded-[28px] border border-border/50 shadow-inner group/patient\">\r\n                      <div className=\"w-14 h-14 rounded-3xl bg-card border border-border/50 flex items-center justify-center text-primary font-black text-2xl group-hover/patient:scale-110 transition-transform\">\r\n                        {selectedTransaction.customer?.full_name.charAt(0).toUpperCase()}\r\n                      </div>\r\n                      <div className=\"min-w-0\">\r\n                        <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest mb-0.5\">Identity Node</p>\r\n                        <p className=\"text-lg font-bold text-foreground truncate uppercase tracking-tight leading-tight\">{selectedTransaction.customer?.full_name}</p>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-6\">\r\n                      <div className=\"flex items-center justify-between px-1\">\r\n                        <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em]\">Protocol Payload</p>\r\n                        <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[8px] uppercase tracking-widest px-2\">{selectedTransaction.items.length} Units</Badge>\r\n                      </div>\r\n                      <div className=\"space-y-4\">\r\n                        {selectedTransaction.items.map((item, idx) => (\r\n                          <div key={idx} className=\"flex justify-between items-center group/item\">\r\n                            <div className=\"space-y-1 min-w-0\">\r\n                              <p className=\"text-sm font-bold text-foreground group-hover/item:text-primary transition-colors uppercase tracking-tight truncate leading-tight\">{item.item_name}</p>\r\n                              <p className=\"text-[9px] text-muted-foreground uppercase font-black tracking-widest opacity-60\">\r\n                                {item.quantity} x เธฟ{Number(item.unit_price).toLocaleString()}\r\n                              </p>\r\n                            </div>\r\n                            <p className=\"text-sm font-black text-foreground tabular-nums ml-4\">เธฟ{Number(item.total).toLocaleString()}</p>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"pt-8 border-t border-border/30 space-y-4\">\r\n                      <div className=\"flex justify-between items-center px-1\">\r\n                        <div className=\"space-y-0.5\">\r\n                          <span className=\"text-sm font-black text-foreground uppercase tracking-widest\">Consolidated Total</span>\r\n                          <p className=\"text-[9px] text-muted-foreground uppercase font-black tracking-widest opacity-60\">Fiscal yield delta</p>\r\n                        </div>\r\n                        <span className=\"text-3xl font-black text-primary tabular-nums tracking-tighter text-glow\">เธฟ{Number(selectedTransaction.total_amount).toLocaleString()}</span>\r\n                      </div>\r\n                      <div className=\"flex justify-between items-center px-1\">\r\n                        <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em]\">Settlement Status</span>\r\n                        <Badge variant={selectedTransaction.payment_status === 'paid' ? 'success' : 'warning'} className=\"font-black uppercase tracking-[0.2em] px-4 py-1.5 text-[9px] rounded-full shadow-sm\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <div className={cn(\"w-1.5 h-1.5 rounded-full\", selectedTransaction.payment_status === 'paid' ? \"bg-emerald-500 animate-pulse\" : \"bg-amber-500\")} />\r\n                            {selectedTransaction.payment_status.toUpperCase()}\r\n                          </div>\r\n                        </Badge>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"pt-6\">\r\n                      <Button className=\"w-full py-7 rounded-[24px] text-[11px] font-black uppercase tracking-[0.3em] shadow-premium group\">\r\n                        Re-Verify Node\r\n                        <Sparkle weight=\"bold\" className=\"w-4 h-4 ml-3 group-hover:scale-125 transition-transform\" />\r\n                      </Button>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </motion.div>\r\n            ) : (\r\n              <Card variant=\"ghost\" className=\"h-[500px] flex flex-col items-center justify-center bg-secondary/10 border-2 border-dashed border-border/50 rounded-[40px] opacity-40 text-center p-12\">\r\n                <div className=\"w-20 h-20 rounded-[40px] bg-card border border-border/50 flex items-center justify-center mb-8 shadow-inner\">\r\n                  <ClockCounterClockwise weight=\"duotone\" className=\"w-10 h-10 text-muted-foreground\" />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <h4 className=\"text-xl font-black text-foreground uppercase tracking-widest\">Awaiting Node Selection</h4>\r\n                  <p className=\"text-sm text-muted-foreground font-medium italic max-w-[240px] mx-auto\">\r\n                    Initialize inspection by selecting a specific transaction node from the audit log stream.\r\n                  </p>\r\n                </div>\r\n              </Card>\r\n            )}\r\n          </AnimatePresence>\r\n        </div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n  );\r\n}\r\n\r\nexport default function POSHistoryPage() {\r\n  return (\r\n    <Suspense fallback={\r\n      <div className=\"h-[80vh] flex flex-col items-center justify-center space-y-6\">\r\n        <SpinnerGap className=\"w-12 h-12 text-primary animate-spin\" />\r\n        <p className=\"text-sm font-black uppercase tracking-[0.3em] text-muted-foreground animate-pulse\">Accessing Audit Cluster...</p>\r\n      </div>\r\n    }>\r\n      <POSHistoryContent />\r\n    </Suspense>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\pos\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ShoppingCart' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":15,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ShoppingCart"},"fix":{"range":[142,155],"text":""},"desc":"Remove unused variable \"ShoppingCart\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Clock"},"fix":{"range":[265,274],"text":""},"desc":"Remove unused variable \"Clock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretLeft' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretLeft"},"fix":{"range":[274,287],"text":""},"desc":"Remove unused variable \"CaretLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[287,300],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CurrencyCircleDollar' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":23,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CurrencyCircleDollar"},"fix":{"range":[300,324],"text":""},"desc":"Remove unused variable \"CurrencyCircleDollar\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Receipt' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Receipt"},"fix":{"range":[324,335],"text":""},"desc":"Remove unused variable \"Receipt\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Plus"},"fix":{"range":[357,365],"text":""},"desc":"Remove unused variable \"Plus\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Icon' is defined but never used.","line":22,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":19,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Icon"},"fix":{"range":[398,448],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'StatCard' is defined but never used.","line":23,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":18,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"StatCard"},"fix":{"range":[449,501],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Card' is defined but never used.","line":24,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Card"},"fix":{"range":[511,516],"text":""},"desc":"Remove unused variable \"Card\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":24,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[515,527],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":24,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[527,538],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardContent' is defined but never used.","line":24,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":50,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"CardContent"},"fix":{"range":[502,582],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":25,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":15,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Badge"},"fix":{"range":[583,629],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'createClient' is defined but never used.","line":36,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":22,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"createClient"},"fix":{"range":[1163,1216],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":39,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":40,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":40,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1340,1343],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1340,1343],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":43,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1467,1470],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1467,1470],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":44,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1526,1529],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1526,1529],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":45,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1583,1586],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1583,1586],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":47,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1716,1719],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1716,1719],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":51,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2035,2038],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2035,2038],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":55,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2292,2295],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2292,2295],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":100,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3884,3887],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3884,3887],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":193,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6777,6780],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6777,6780],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":26,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  ShoppingCart, \n  MagnifyingGlass, \n  User, \n  SpinnerGap, \n  SquaresFour,\n  ClockCounterClockwise,\n  CheckCircle,\n  XCircle,\n  Clock,\n  CaretLeft,\n  ArrowLeft,\n  CurrencyCircleDollar,\n  Receipt,\n  IdentificationCard,\n  Plus\n} from '@phosphor-icons/react';\nimport type { Icon } from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { useTranslations } from 'next-intl';\nimport { cn } from '@/lib/utils';\nimport { useRouter } from 'next/navigation';\nimport POSProductGrid from '@/components/pos/POSProductGrid';\nimport POSCart, { CartItem } from '@/components/pos/POSCart';\nimport PaymentModal from '@/components/pos/PaymentModal';\nimport DigitalReceipt from '@/components/pos/DigitalReceipt';\nimport { createClient } from '@/lib/supabase/client';\n\nexport default function POSPage() {\n  const { goBack } = useBackNavigation();\n  const t = useTranslations('clinic.pos' as any);\n  const router = useRouter();\n  const [loading, setLoading] = useState(true);\n  const [products, setProducts] = useState<any[]>([]);\n  const [treatments, setTreatments] = useState<any[]>([]);\n  const [customers, setCustomers] = useState<any[]>([]);\n  const [cartItems, setCartItems] = useState<CartItem[]>([]);\n  const [selectedCustomer, setSelectedCustomer] = useState<any | null>(null);\n  const [isCheckoutLoading, setIsCheckoutLoading] = useState(false);\n  const [isPaymentModalOpen, setIsPaymentModalOpen] = useState(false);\n  const [pendingTransactionId, setPendingTransactionId] = useState<string | null>(null);\n  const [transactionSuccessData, setTransactionSuccessData] = useState<any | null>(null);\n  const [isCustomerSelectOpen, setIsCustomerSelectOpen] = useState(false);\n  const [customerSearch, setCustomerSearch] = useState('');\n  const [clinicId, setClinicId] = useState<string>('');\n  const [clinicInfo, setClinicInfo] = useState<any>(null);\n  const [currency, setCurrency] = useState<'THB' | 'USD'>('THB');\n  const exchangeRate = 35.5; // Mock rate: 1 USD = 35.5 THB\n\n  const fetchData = useCallback(async () => {\n    setLoading(true);\n    try {\n      const [productsRes, treatmentsRes, customersRes, userRes, clinicRes] = await Promise.all([\n        fetch('/api/products'),\n        fetch('/api/treatments'),\n        fetch('/api/customers?limit=100'),\n        fetch('/api/staff/invite?type=profile'),\n        fetch('/api/clinic/settings')\n      ]);\n\n      const [productsData, treatmentsData, customersData, userData, clinicData] = await Promise.all([\n        productsRes.json(),\n        treatmentsRes.json(),\n        customersRes.json(),\n        userRes.json(),\n        clinicRes.json()\n      ]);\n\n      if (productsData.success) setProducts(productsData.data);\n      if (treatmentsData.success) setTreatments(treatmentsData.data);\n      if (customersData.success) setCustomers(customersData.data);\n      if (userData.success) setClinicId(userData.data.clinic_id);\n      if (clinicData.success) {\n        setClinicInfo({\n          name: clinicData.data.display_name?.th || clinicData.data.display_name?.en || 'Clinic Node',\n          address: clinicData.data.metadata?.address || 'Operational Cluster Address',\n          phone: clinicData.data.metadata?.phone || '00-000-0000'\n        });\n      }\n    } catch (err) {\n      console.error('Error fetching POS data:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchData();\n  }, [fetchData]);\n\n  const handleSelectItem = (item: any, type: 'PRODUCT' | 'TREATMENT') => {\n    const existingItem = cartItems.find(i => i.item_id === item.id && i.item_type === type);\n    \n    if (existingItem) {\n      handleUpdateQuantity(existingItem.id, 1);\n    } else {\n      const name = type === 'TREATMENT' \n        ? (typeof item.names === 'object' ? (item.names.th || item.names.en) : item.names)\n        : item.name;\n      \n      // Always store base price in THB in the cart, conversion happens at display time\n      const priceTHB = type === 'TREATMENT' ? item.price_min : item.sale_price;\n      \n      const newItem: CartItem = {\n        id: crypto.randomUUID(),\n        item_id: item.id,\n        item_type: type,\n        item_name: name,\n        quantity: 1,\n        unit_price: Number(priceTHB),\n        total: Number(priceTHB),\n        discount: 0\n      };\n      setCartItems([...cartItems, newItem]);\n    }\n  };\n\n  const convertPrice = (amount: number) => {\n    if (currency === 'USD') return amount / exchangeRate;\n    return amount;\n  };\n\n  const formatPrice = (amount: number) => {\n    const converted = convertPrice(amount);\n    return new Intl.NumberFormat(undefined, {\n      style: 'currency',\n      currency: currency,\n      minimumFractionDigits: currency === 'USD' ? 2 : 0,\n      maximumFractionDigits: 2\n    }).format(converted);\n  };\n\n  const handleUpdateQuantity = (id: string, delta: number) => {\n    setCartItems(prev => prev.map(item => {\n      if (item.id === id) {\n        const newQuantity = Math.max(1, item.quantity + delta);\n        return {\n          ...item,\n          quantity: newQuantity,\n          total: newQuantity * item.unit_price\n        };\n      }\n      return item;\n    }));\n  };\n\n  const handleRemoveItem = (id: string) => {\n    setCartItems(prev => prev.filter(item => item.id !== id));\n  };\n\n  const handleCheckoutInitiate = async () => {\n    if (!selectedCustomer || cartItems.length === 0) return;\n    \n    setIsCheckoutLoading(true);\n    try {\n      const subtotal = cartItems.reduce((acc, item) => acc + item.total, 0);\n      const res = await fetch('/api/pos/transactions', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          customer_id: selectedCustomer.id,\n          items: cartItems,\n          subtotal,\n          total_amount: subtotal,\n          payment_status: 'pending' // Initialize as pending\n        })\n      });\n\n      const result = await res.json();\n      if (result.success) {\n        setPendingTransactionId(result.data.id);\n        setIsPaymentModalOpen(true);\n      } else {\n        throw new Error(result.error?.message || 'Transaction initiation failed');\n      }\n    } catch (err) {\n      console.error('Checkout error:', err);\n      alert('Checkout failed. Please check console.');\n    } finally {\n      setIsCheckoutLoading(false);\n    }\n  };\n\n  const handlePaymentSuccess = (paymentData: any) => {\n    setTransactionSuccessData({\n      id: pendingTransactionId,\n      number: paymentData.metadata?.transaction_number || 'TXN-GENERATING',\n      date: new Date().toISOString(),\n      customerName: selectedCustomer.full_name,\n      items: cartItems,\n      subtotal: cartItems.reduce((acc, i) => acc + i.total, 0),\n      total: cartItems.reduce((acc, i) => acc + i.total, 0)\n    });\n    setCartItems([]);\n    setSelectedCustomer(null);\n    setIsPaymentModalOpen(false);\n    setPendingTransactionId(null);\n    fetchData(); // Refresh stock\n  };\n\n  const filteredCustomers = customers.filter(c => \n    c.full_name.toLowerCase().includes(customerSearch.toLowerCase()) ||\n    c.phone?.includes(customerSearch) ||\n    c.nickname?.toLowerCase().includes(customerSearch.toLowerCase())\n  );\n\n  if (loading) {\n    return (\n      <div className=\"h-[80vh] flex flex-col items-center justify-center space-y-6\">\n        <SpinnerGap className=\"w-12 h-12 text-primary animate-spin\" />\n        <p className=\"text-sm font-black uppercase tracking-[0.3em] text-muted-foreground animate-pulse\">Initializing Sales Interface...</p>\n      </div>\n    );\n  }\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"h-[calc(100vh-140px)] -m-8 flex font-sans overflow-hidden bg-background\"\n    >\n      <PaymentModal \n        isOpen={isPaymentModalOpen}\n        onClose={() => setIsPaymentModalOpen(false)}\n        onSuccess={handlePaymentSuccess}\n        amount={cartItems.reduce((acc, item) => acc + item.total, 0)}\n        transactionId={pendingTransactionId || ''}\n        clinicId={clinicId}\n      />\n\n      {/* Main Content Area */}\n      <div className=\"flex-1 flex flex-col p-8 overflow-hidden print:hidden relative border-r border-border/50\">\n        <div className=\"flex-shrink-0 mb-8\">\n          <Breadcrumb />\n          \n          <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 mt-6\">\n            <div className=\"space-y-1\">\n              <motion.div \n                initial={{ opacity: 0, x: -20 }}\n                animate={{ opacity: 1, x: 0 }}\n                className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n              >\n                <SquaresFour weight=\"duotone\" className=\"w-4 h-4\" />\n                Sales Orchestration Node\n              </motion.div>\n              <motion.h1 \n                initial={{ opacity: 0, x: -20 }}\n                animate={{ opacity: 1, x: 0 }}\n                transition={{ delay: 0.1 }}\n                className=\"text-4xl font-heading font-bold text-foreground tracking-tight\"\n              >\n                Point of <span className=\"text-primary\">Sale</span>\n              </motion.h1>\n            </div>\n            \n            <div className=\"flex items-center gap-3\">\n              <div className=\"flex bg-secondary/50 border border-border p-1 rounded-2xl shadow-inner\">\n                {(['THB', 'USD'] as const).map((curr) => (\n                  <button\n                    key={curr}\n                    onClick={() => setCurrency(curr)}\n                    className={cn(\n                      \"px-5 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border\",\n                      currency === curr \n                        ? \"bg-card text-primary border-border/50 shadow-sm\" \n                        : \"text-muted-foreground border-transparent hover:text-foreground\"\n                    )}\n                  >\n                    {curr}\n                  </button>\n                ))}\n              </div>\n              <Button \n                variant=\"outline\"\n                onClick={() => router.push('/clinic/pos/history')}\n                className=\"gap-2\"\n              >\n                <ClockCounterClockwise weight=\"bold\" className=\"w-4 h-4\" />\n                Recent Logs\n              </Button>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"flex-1 min-h-0 relative\">\n          <POSProductGrid \n            products={products}\n            treatments={treatments}\n            onSelectItem={handleSelectItem}\n            currency={currency}\n            formatPrice={formatPrice}\n          />\n        </div>\n      </div>\n\n      {/* Sidebar - Cart */}\n      <div className=\"w-[400px] flex-shrink-0 print:hidden bg-card/30 backdrop-blur-xl\">\n        <POSCart \n          items={cartItems}\n          customer={selectedCustomer}\n          onUpdateQuantity={handleUpdateQuantity}\n          onRemoveItem={handleRemoveItem}\n          onSelectCustomer={() => setIsCustomerSelectOpen(true)}\n          onCheckout={handleCheckoutInitiate}\n          loading={isCheckoutLoading}\n          currency={currency}\n          formatPrice={formatPrice}\n        />\n      </div>\n\n      {/* Customer Selection Modal */}\n      <AnimatePresence>\n        {isCustomerSelectOpen && (\n          <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-[200] flex items-center justify-center p-4 print:hidden\">\n            <motion.div\n              initial={{ opacity: 0, scale: 0.95, y: 20 }}\n              animate={{ opacity: 1, scale: 1, y: 0 }}\n              exit={{ opacity: 0, scale: 0.95, y: 20 }}\n              onClick={(e) => e.stopPropagation()}\n              className=\"w-full max-w-lg bg-card border border-border rounded-[32px] p-8 shadow-premium overflow-hidden flex flex-col max-h-[85vh] relative\"\n            >\n              <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] pointer-events-none\">\n                <IdentificationCard className=\"w-48 h-48 text-primary\" />\n              </div>\n\n              <div className=\"flex items-center justify-between mb-8 relative z-10\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\n                    <User weight=\"duotone\" className=\"w-6 h-6\" />\n                  </div>\n                  <div>\n                    <h2 className=\"text-2xl font-bold text-foreground tracking-tight\">Identity Registry</h2>\n                    <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Select target client node</p>\n                  </div>\n                </div>\n                <button \n                  onClick={() => setIsCustomerSelectOpen(false)}\n                  className=\"p-2 text-muted-foreground hover:text-foreground hover:bg-secondary rounded-xl transition-all\"\n                >\n                  <XCircle weight=\"bold\" className=\"w-6 h-6\" />\n                </button>\n              </div>\n\n              <div className=\"relative mb-8 relative z-10 group\">\n                <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-2xl\" />\n                <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\n                <input \n                  type=\"text\" \n                  placeholder=\"Search by identity name, phone, or alias...\"\n                  value={customerSearch}\n                  onChange={(e) => setCustomerSearch(e.target.value)}\n                  autoFocus\n                  className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-12 pr-5 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\n                />\n              </div>\n\n              <div className=\"flex-1 overflow-y-auto space-y-2 pr-2 custom-scrollbar relative z-10\">\n                {filteredCustomers.map(customer => (\n                  <button\n                    key={customer.id}\n                    onClick={() => {\n                      setSelectedCustomer(customer);\n                      setIsCustomerSelectOpen(false);\n                    }}\n                    className={cn(\n                      \"w-full flex items-center justify-between p-5 rounded-[24px] border transition-all group/item\",\n                      selectedCustomer?.id === customer.id \n                        ? \"bg-primary text-white border-primary shadow-premium\" \n                        : \"bg-secondary/30 border-border/50 hover:border-primary/30 hover:bg-secondary/50 text-foreground\"\n                    )}\n                  >\n                    <div className=\"flex items-center gap-5\">\n                      <div className={cn(\n                        \"w-12 h-12 rounded-2xl flex items-center justify-center text-lg font-bold shadow-sm transition-colors\",\n                        selectedCustomer?.id === customer.id ? \"bg-white/20\" : \"bg-card border border-border group-hover/item:text-primary\"\n                      )}>\n                        {customer.full_name.charAt(0)}\n                      </div>\n                      <div className=\"text-left space-y-0.5\">\n                        <p className={cn(\"font-bold text-base tracking-tight\", selectedCustomer?.id === customer.id ? \"text-white\" : \"text-foreground\")}>{customer.full_name}</p>\n                        <p className={cn(\"text-[10px] font-black uppercase tracking-widest\", selectedCustomer?.id === customer.id ? \"text-white/60\" : \"text-muted-foreground\")}>{customer.phone || 'No Phone Node'}</p>\n                      </div>\n                    </div>\n                    {selectedCustomer?.id === customer.id && (\n                      <div className=\"bg-white/20 p-1.5 rounded-full\">\n                        <CheckCircle weight=\"fill\" className=\"w-5 h-5 text-white\" />\n                      </div>\n                    )}\n                  </button>\n                ))}\n                {filteredCustomers.length === 0 && (\n                  <div className=\"py-20 text-center opacity-30 flex flex-col items-center gap-4\">\n                    <User weight=\"duotone\" className=\"w-16 h-16\" />\n                    <p className=\"text-[10px] font-black uppercase tracking-widest\">Zero Identities Detected</p>\n                  </div>\n                )}\n              </div>\n            </motion.div>\n          </div>\n        )}\n      </AnimatePresence>\n\n      {/* Transaction Success Modal */}\n      <AnimatePresence>\n        {transactionSuccessData && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"fixed inset-0 bg-black/90 backdrop-blur-2xl z-[300] flex items-center justify-center p-4 overflow-y-auto custom-scrollbar\"\n          >\n            <div className=\"max-w-2xl w-full py-10 relative\">\n              <div className=\"flex justify-center mb-10 print:hidden\">\n                <motion.div\n                  initial={{ scale: 0.8, opacity: 0, y: 20 }}\n                  animate={{ scale: 1, opacity: 1, y: 0 }}\n                  className=\"bg-emerald-500/10 border border-emerald-500/20 px-8 py-3 rounded-full flex items-center gap-4 shadow-lg backdrop-blur-md\"\n                >\n                  <div className=\"w-2 h-2 rounded-full bg-emerald-500 animate-pulse shadow-[0_0_10px_rgba(16,185,129,0.6)]\" />\n                  <span className=\"text-[10px] font-black text-emerald-500 uppercase tracking-[0.3em]\">Transaction Node Validated</span>\n                </motion.div>\n              </div>\n\n              <DigitalReceipt \n                transactionNumber={transactionSuccessData.number}\n                date={transactionSuccessData.date}\n                customerName={transactionSuccessData.customerName}\n                items={transactionSuccessData.items}\n                subtotal={transactionSuccessData.subtotal}\n                discount={0}\n                tax={0}\n                total={transactionSuccessData.total}\n                clinicInfo={clinicInfo || { name: 'BN-Aura Clinical Node', address: 'Operational Data Loading...', phone: '...' }}\n              />\n\n              <div className=\"mt-12 flex flex-col items-center gap-6 print:hidden\">\n                <Button\n                  onClick={() => setTransactionSuccessData(null)}\n                  className=\"px-12 py-6 rounded-[24px] shadow-premium text-base font-bold uppercase tracking-widest\"\n                >\n                  Confirm & New Sale\n                </Button>\n                <button className=\"text-[10px] font-black uppercase tracking-[0.3em] text-white/40 hover:text-white transition-colors\">\n                  Archive Digital Transcript\n                </button>\n              </div>\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\queue\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":4,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AnimatePresence"},"fix":{"range":[75,92],"text":""},"desc":"Remove unused variable \"AnimatePresence\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Phone' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Phone"},"fix":{"range":[169,179],"text":""},"desc":"Remove unused variable \"Phone\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[199,212],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"User"},"fix":{"range":[212,220],"text":""},"desc":"Remove unused variable \"User\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[220,234],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MagnifyingGlass' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":18,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"MagnifyingGlass"},"fix":{"range":[234,253],"text":""},"desc":"Remove unused variable \"MagnifyingGlass\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningCircle' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WarningCircle"},"fix":{"range":[270,287],"text":""},"desc":"Remove unused variable \"WarningCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":41,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":42,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":42,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1120,1123],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1120,1123],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchQueue'. Either include it or remove the dependency array.","line":59,"column":6,"nodeType":"ArrayExpression","endLine":59,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [clinicId, fetchQueue]","fix":{"range":[1585,1595],"text":"[clinicId, fetchQueue]"}}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'SpinnerGap' is not defined.","line":201,"column":18,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":201,"endColumn":28}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  Users, \n  Bell, \n  CheckCircle, \n  Clock, \n  Phone, \n  ArrowsClockwise,\n  ArrowLeft,\n  User,\n  CaretRight,\n  MagnifyingGlass,\n  Plus,\n  Queue,\n  WarningCircle\n} from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { useTranslations } from 'next-intl';\nimport { cn } from '@/lib/utils';\n\ninterface CheckIn {\n  id: string;\n  queue_number: number;\n  status: string;\n  check_in_method: string;\n  phone_lookup?: string;\n  checked_in_at: string;\n  customer?: { full_name: string };\n  appointment?: { time: string; service_name: string };\n}\n\nexport default function QueuePage() {\n  const { goBack } = useBackNavigation();\n  const t = useTranslations('clinic.queue' as any);\n  const [queue, setQueue] = useState<CheckIn[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [clinicId, setClinicId] = useState<string>('');\n\n  useEffect(() => {\n    // Get clinic ID from staff session\n    fetchClinicId();\n  }, []);\n\n  useEffect(() => {\n    if (clinicId) {\n      fetchQueue();\n      // Auto-refresh every 10 seconds\n      const interval = setInterval(fetchQueue, 10000);\n      return () => clearInterval(interval);\n    }\n  }, [clinicId]);\n\n  const fetchClinicId = async () => {\n    try {\n      const res = await fetch('/api/auth/session');\n      const data = await res.json();\n      if (data.clinicId) setClinicId(data.clinicId);\n    } catch (e) { console.error(e); }\n  };\n\n  const fetchQueue = async () => {\n    if (!clinicId) return;\n    setLoading(true);\n    try {\n      const res = await fetch(`/api/kiosk?clinic_id=${clinicId}&action=queue`);\n      const data = await res.json();\n      setQueue(data.queue || []);\n    } catch (e) { console.error(e); }\n    setLoading(false);\n  };\n\n  const updateStatus = async (checkinId: string, status: string) => {\n    await fetch('/api/kiosk', {\n      method: 'PATCH',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ checkinId, status })\n    });\n    fetchQueue();\n  };\n\n  const formatTime = (d: string) => new Date(d).toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit' });\n\n  const getMethodLabel = (m: string) => {\n    const labels: Record<string, string> = {\n      phone: 'เน€เธเธญเธฃเนเนเธ—เธฃ', walk_in: 'Walk-in', appointment: 'เธเธฑเธ”เธซเธกเธฒเธข', qr_code: 'QR', membership: 'เธชเธกเธฒเธเธดเธ'\n    };\n    return labels[m] || m;\n  };\n\n  const waiting = queue.filter(q => q.status === 'waiting');\n  const called = queue.filter(q => q.status === 'called');\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <Queue weight=\"duotone\" className=\"w-4 h-4\" />\n            Live Operations Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight\"\n          >\n            Queue <span className=\"text-primary\">Management</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Real-time synchronization of client arrival and practitioner assignment.\n          </motion.p>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <Button \n            variant=\"outline\" \n            onClick={fetchQueue}\n            disabled={loading}\n            className=\"gap-2\"\n          >\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\n            Sync Queue\n          </Button>\n          <Button className=\"gap-2 shadow-premium px-8\">\n            <Plus weight=\"bold\" className=\"w-4 h-4\" />\n            Check-in Client\n          </Button>\n        </div>\n      </div>\n\n      {/* Stats Summary */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <StatCard\n          title=\"Clients Waiting\"\n          value={waiting.length}\n          icon={Clock}\n          trend=\"neutral\"\n          iconColor=\"text-amber-500\"\n        />\n        <StatCard\n          title=\"Currently Serving\"\n          value={called.length}\n          icon={Bell}\n          trend=\"neutral\"\n          iconColor=\"text-primary\"\n        />\n        <StatCard\n          title=\"Next Queue ID\"\n          value={waiting[0]?.queue_number || 0}\n          prefix={waiting[0] ? \"#\" : \"None\"}\n          icon={CheckCircle}\n          trend=\"neutral\"\n          iconColor=\"text-emerald-500\"\n        />\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n        {/* Waiting List */}\n        <Card className=\"relative overflow-hidden group border-border/50\">\n          <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700\">\n            <Clock className=\"w-48 h-48 text-amber-500\" />\n          </div>\n\n          <CardHeader className=\"border-b border-border/50 pb-6\">\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"text-sm font-black uppercase tracking-[0.2em] flex items-center gap-3\">\n                <Clock weight=\"duotone\" className=\"w-5 h-5 text-amber-500\" />\n                Waiting Nodes ({waiting.length})\n              </CardTitle>\n              <Badge variant=\"warning\" size=\"sm\" className=\"font-bold\">AWAITING ACTION</Badge>\n            </div>\n          </CardHeader>\n\n          <CardContent className=\"pt-6\">\n            {loading && !queue.length ? (\n              <div className=\"py-20 flex flex-col items-center gap-4\">\n                <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\n                <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Accessing Queue Node...</p>\n              </div>\n            ) : waiting.length === 0 ? (\n              <div className=\"py-20 text-center opacity-30 flex flex-col items-center gap-4\">\n                <Users weight=\"duotone\" className=\"w-12 h-12\" />\n                <p className=\"text-[10px] font-black uppercase tracking-widest\">Registry Empty</p>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {waiting.map(item => (\n                  <motion.div \n                    key={item.id} \n                    initial={{ opacity: 0, x: -20 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    className=\"bg-secondary/30 rounded-[24px] border border-border/50 p-5 flex flex-col sm:flex-row sm:items-center justify-between gap-6 hover:border-amber-500/30 transition-all group/item\"\n                  >\n                    <div className=\"flex items-center gap-5\">\n                      <div className=\"w-16 h-16 bg-amber-500/10 border border-amber-500/20 rounded-2xl flex flex-col items-center justify-center shadow-sm group-hover/item:bg-amber-500/20 transition-all\">\n                        <span className=\"text-2xl font-black text-amber-600 tabular-nums leading-none\">{item.queue_number}</span>\n                        <span className=\"text-[8px] font-black text-amber-600/60 uppercase tracking-widest mt-1\">Node</span>\n                      </div>\n                      <div className=\"space-y-1\">\n                        <p className=\"text-base font-bold text-foreground tracking-tight\">{item.customer?.full_name || item.phone_lookup || 'Registered Client'}</p>\n                        <div className=\"flex items-center gap-3\">\n                          <Badge variant=\"ghost\" size=\"sm\" className=\"font-bold uppercase tracking-wider text-[9px]\">{getMethodLabel(item.check_in_method)}</Badge>\n                          <div className=\"flex items-center gap-1.5 text-[10px] font-bold text-muted-foreground uppercase tracking-widest\">\n                            <Clock weight=\"bold\" className=\"w-3 h-3\" />\n                            {formatTime(item.checked_in_at)}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <Button\n                      onClick={() => updateStatus(item.id, 'called')}\n                      className=\"bg-primary text-white shadow-premium gap-2 px-6\"\n                    >\n                      <Bell weight=\"bold\" className=\"w-4 h-4\" />\n                      Initiate Call\n                    </Button>\n                  </motion.div>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Called List */}\n        <Card className=\"relative overflow-hidden group border-border/50\">\n          <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700\">\n            <Bell className=\"w-48 h-48 text-primary\" />\n          </div>\n\n          <CardHeader className=\"border-b border-border/50 pb-6\">\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"text-sm font-black uppercase tracking-[0.2em] flex items-center gap-3\">\n                <Bell weight=\"duotone\" className=\"w-5 h-5 text-primary\" />\n                Active Call Nodes ({called.length})\n              </CardTitle>\n              <Badge variant=\"default\" size=\"sm\" className=\"font-bold\">IN TRANSIT</Badge>\n            </div>\n          </CardHeader>\n\n          <CardContent className=\"pt-6\">\n            {called.length === 0 ? (\n              <div className=\"py-20 text-center opacity-30 flex flex-col items-center gap-4\">\n                <Bell weight=\"duotone\" className=\"w-12 h-12\" />\n                <p className=\"text-[10px] font-black uppercase tracking-widest\">Zero Active Calls</p>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {called.map(item => (\n                  <motion.div \n                    key={item.id} \n                    initial={{ opacity: 0, x: 20 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    className=\"bg-primary/5 rounded-[24px] border border-primary/20 p-5 flex flex-col sm:flex-row sm:items-center justify-between gap-6 hover:bg-primary/10 transition-all group/item\"\n                  >\n                    <div className=\"flex items-center gap-5\">\n                      <div className=\"w-16 h-16 bg-primary rounded-2xl flex flex-col items-center justify-center shadow-premium animate-pulse\">\n                        <span className=\"text-2xl font-black text-white tabular-nums leading-none\">{item.queue_number}</span>\n                        <span className=\"text-[8px] font-black text-white/60 uppercase tracking-widest mt-1\">Calling</span>\n                      </div>\n                      <div className=\"space-y-1\">\n                        <p className=\"text-base font-bold text-foreground tracking-tight\">{item.customer?.full_name || item.phone_lookup || 'Registered Client'}</p>\n                        <Badge variant=\"secondary\" size=\"sm\" className=\"font-bold uppercase tracking-wider text-[9px] bg-primary/10 text-primary border-none\">{getMethodLabel(item.check_in_method)}</Badge>\n                      </div>\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <Button\n                        onClick={() => updateStatus(item.id, 'serving')}\n                        className=\"bg-emerald-600 hover:bg-emerald-700 text-white border-none gap-2 shadow-sm\"\n                      >\n                        <CheckCircle weight=\"bold\" className=\"w-4 h-4\" />\n                        Acknowledge\n                      </Button>\n                      <Button\n                        variant=\"ghost\"\n                        onClick={() => updateStatus(item.id, 'no_show')}\n                        className=\"text-muted-foreground hover:text-rose-500 hover:bg-rose-500/10\"\n                      >\n                        No Show\n                      </Button>\n                    </div>\n                  </motion.div>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\quota\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Invalid character.","line":74,"column":35}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  ChartBar, \n  TrendUp, \n  Lightning, \n  CreditCard, \n  ArrowUpRight,\n  Package,\n  Sparkle,\n  Target,\n  Clock,\n  CheckCircle,\n  SpinnerGap,\n  Pulse,\n  X,\n  Brain,\n  ArrowLeft,\n  Activity,\n  Cpu,\n  ArrowsClockwise,\n  Icon\n} from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { useAuth } from '@/hooks/useAuth';\nimport { cn } from '@/lib/utils';\nimport { QUOTA_PLANS, type QuotaConfig } from '@/lib/quota/quotaManager';\n\ninterface UsageStats {\n  totalScans: number;\n  successfulScans: number;\n  failedScans: number;\n  totalCost: number;\n  averageCostPerScan: number;\n  mostUsedScanType: string;\n  peakUsageDay: string;\n  utilizationRate: number;\n}\n\ninterface Recommendations {\n  currentPlan: string;\n  recommendedPlan?: string;\n  reasoning: string;\n  potentialSavings?: number;\n}\n\nexport default function QuotaManagement() {\n  const { goBack } = useBackNavigation();\n  const [quotaData, setQuotaData] = useState<QuotaConfig | null>(null);\n  const [usageStats, setUsageStats] = useState<UsageStats | null>(null);\n  const [recommendations, setRecommendations] = useState<Recommendations | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [daysUntilReset, setDaysUntilReset] = useState(0);\n  const [selectedPeriod, setSelectedPeriod] = useState<'current' | 'last30' | 'last90'>('current');\n\n  const { getClinicId } = useAuth();\n\n  const fetchQuotaData = useCallback(async () => {\n    setLoading(true);\n    try {\n      const clinicId = getClinicId();\n      if (!clinicId) {\n        setLoading(false);\n        return;\n      }\n      \n      const response = await fetch(\\/api/quota/usage?clinicId=\\&period=\\\\);\n      \n      if (response.ok) {\n        const data = await response.json();\n        setQuotaData(data.quota);\n        setUsageStats(data.stats);\n        setRecommendations(data.recommendations);\n        setDaysUntilReset(data.daysUntilReset);\n      }\n    } catch (error) {\n      console.error('Error fetching quota data:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [getClinicId, selectedPeriod]);\n\n  useEffect(() => {\n    fetchQuotaData();\n  }, [fetchQuotaData]);\n\n  const currentPlan = useMemo(() => {\n    return QUOTA_PLANS.find(plan => plan.id === quotaData?.plan);\n  }, [quotaData?.plan]);\n\n  const utilizationPercentage = quotaData \n    ? Math.round((quotaData.currentUsage / quotaData.monthlyQuota) * 100) \n    : 0;\n\n  const getUtilizationColor = (percentage: number) => {\n    if (percentage >= 90) return 'text-rose-500 bg-rose-500/10 border-rose-500/20';\n    if (percentage >= 70) return 'text-amber-500 bg-amber-500/10 border-amber-500/20';\n    return 'text-emerald-500 bg-emerald-500/10 border-emerald-500/20';\n  };\n\n  const getUtilizationBarColor = (percentage: number) => {\n    if (percentage >= 90) return 'bg-rose-500';\n    if (percentage >= 70) return 'bg-amber-500';\n    return 'bg-emerald-500';\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-[80vh] flex flex-col items-center justify-center space-y-6\">\n        <SpinnerGap className=\"w-12 h-12 text-primary animate-spin\" />\n        <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] animate-pulse\">Synchronizing Quota Matrix...</p>\n      </div>\n    );\n  }\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header Section */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <Lightning weight=\"duotone\" className=\"w-4 h-4\" />\n            Computational Resource Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n          >\n            Quota <span className=\"text-primary\">Intelligence</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Monitoring autonomous orchestration, unit consumption, and predictive scaling nodes.\n          </motion.p>\n        </div>\n        \n        <motion.div \n          initial={{ opacity: 0, scale: 0.9 }}\n          animate={{ opacity: 1, scale: 1 }}\n          transition={{ delay: 0.3 }}\n          className=\"flex flex-wrap items-center gap-3\"\n        >\n          <div className=\"bg-secondary/50 border border-border/50 p-1.5 rounded-2xl shadow-inner relative group/select\">\n            <select\n              value={selectedPeriod}\n              onChange={(e) => setSelectedPeriod(e.target.value as 'current' | 'last30' | 'last90')}\n              className=\"bg-transparent border-none text-[10px] font-black uppercase tracking-widest text-foreground focus:ring-0 px-6 py-2.5 cursor-pointer appearance-none pr-10\"\n            >\n              <option value=\"current\" className=\"bg-card\">ACTIVE_CYCLE</option>\n              <option value=\"last30\" className=\"bg-card\">STANDARD_30D</option>\n              <option value=\"last90\" className=\"bg-card\">QUARTERLY_90D</option>\n            </select>\n            <CaretRight weight=\"bold\" className=\"absolute right-4 top-1/2 -translate-y-1/2 w-3 h-3 rotate-90 text-muted-foreground/40 pointer-events-none\" />\n          </div>\n          <Button className=\"gap-3 shadow-premium px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest group\">\n            <Package weight=\"bold\" className=\"w-4 h-4 group-hover:scale-110 transition-transform\" />\n            Scale Capacity\n          </Button>\n        </motion.div>\n      </div>\n\n      {/* Main Quota Architecture Grid */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-10 px-2\">\n        <div className=\"lg:col-span-2 space-y-10\">\n          <Card className=\"rounded-[48px] border-border/50 shadow-premium overflow-hidden group\">\n            <CardHeader className=\"p-8 md:p-10 border-b border-border/50 bg-secondary/30 relative\">\n              <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n                <ChartBar weight=\"fill\" className=\"w-64 h-64 text-primary\" />\n              </div>\n\n              <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-8 relative z-10\">\n                <div className=\"flex items-center gap-5\">\n                  <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm shadow-inner transition-all group-hover:bg-primary/20\">\n                    <Pulse weight=\"duotone\" className=\"w-7 h-7\" />\n                  </div>\n                  <div>\n                    <CardTitle className=\"text-2xl font-black uppercase tracking-tight\">System Utilization</CardTitle>\n                    <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] mt-1\">Consumption telemetry matrix</p>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-3 px-6 py-3 bg-card border border-border/50 rounded-2xl shadow-sm\">\n                  <Clock weight=\"bold\" className=\"w-4 h-4 text-primary/60\" />\n                  <span className=\"text-[10px] font-black text-foreground uppercase tracking-widest\">{daysUntilReset} Cycles to Reset</span>\n                </div>\n              </div>\n            </CardHeader>\n\n            <CardContent className=\"p-10 md:p-12 space-y-12 relative z-10\">\n              {/* Neural Bandwidth Node */}\n              <div className=\"space-y-8\">\n                <div className=\"flex justify-between items-end\">\n                  <div className=\"space-y-2\">\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-1.5 h-1.5 rounded-full bg-primary animate-pulse\" />\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.4em]\">Neural Bandwidth</p>\n                    </div>\n                    <div className=\"flex items-baseline gap-3\">\n                      <span className=\"text-6xl font-black text-foreground tracking-tighter tabular-nums text-glow-sm\">{quotaData?.currentUsage || 0}</span>\n                      <span className=\"text-xl font-bold text-muted-foreground uppercase tracking-widest opacity-40\">/ {quotaData?.monthlyQuota || 0} Nodes</span>\n                    </div>\n                  </div>\n                  <Badge variant=\"ghost\" className={cn(\"font-black uppercase tracking-[0.2em] px-5 py-2.5 text-[10px] rounded-full shadow-sm border-none\", getUtilizationColor(utilizationPercentage))}>\n                    <Target weight=\"fill\" className=\"w-4 h-4 mr-2\" />\n                    {utilizationPercentage}% Global Load\n                  </Badge>\n                </div>\n                \n                <div className=\"h-2.5 w-full bg-secondary/50 rounded-full overflow-hidden p-0.5 border border-border shadow-inner\">\n                  <motion.div \n                    initial={{ width: 0 }}\n                    animate={{ width: \\\\%\\ }}\n                    transition={{ duration: 2, ease: \"circOut\" }}\n                    className={cn(\n                      \"h-full rounded-full shadow-sm transition-all duration-1000\",\n                      getUtilizationBarColor(utilizationPercentage)\n                    )}\n                  />\n                </div>\n              </div>\n\n              {/* Usage Analytics Grid */}\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-6\">\n                {[\n                  { label: 'Validated', value: usageStats?.successfulScans || 0, icon: CheckCircle, color: 'text-emerald-500', bg: 'bg-emerald-500/10' },\n                  { label: 'Exceptions', value: usageStats?.failedScans || 0, icon: X, color: 'text-rose-500', bg: 'bg-rose-500/10' },\n                  { label: 'Fiscal Yield', value: (usageStats?.totalCost || 0).toLocaleString(), icon: CreditCard, color: 'text-primary', bg: 'bg-primary/10', prefix: '๏ฟฝ' },\n                  { label: 'Peak Flux', value: usageStats?.peakUsageDay || 'N/A', icon: Activity, color: 'text-purple-500', bg: 'bg-purple-500/10' }\n                ].map((stat, i) => (\n                  <motion.div \n                    key={stat.label}\n                    initial={{ opacity: 0, y: 10 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    transition={{ delay: 0.1 * i }}\n                    className=\"p-6 bg-secondary/30 border border-border/50 rounded-[32px] hover:border-primary/20 transition-all text-center group/stat shadow-inner\"\n                  >\n                    <div className={cn(\"w-12 h-12 rounded-2xl flex items-center justify-center mx-auto mb-4 border border-border/50 group-hover/stat:scale-110 group-hover/stat:rotate-3 transition-all duration-500 shadow-sm\", stat.bg, stat.color)}>\n                      <stat.icon weight=\"duotone\" className=\"w-6 h-6\" />\n                    </div>\n                    <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest mb-1 opacity-60\">{stat.label}</p>\n                    <p className={cn(\"text-lg font-black tracking-tight tabular-nums\", stat.color)}>\n                      {stat.prefix}{stat.value}\n                    </p>\n                  </motion.div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Scale Optimization Grid */}\n          <div className=\"space-y-8\">\n            <div className=\"flex items-center justify-between px-4\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-1.5 h-1.5 rounded-full bg-primary animate-pulse shadow-[0_0_10px_rgba(var(--primary),0.6)]\" />\n                <h2 className=\"text-xl font-black text-foreground uppercase tracking-tight\">Scale <span className=\"text-primary text-glow\">Optimization</span></h2>\n              </div>\n              <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[10px] tracking-widest uppercase px-4 py-1.5\">Elite Matrix Available</Badge>\n            </div>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n              {QUOTA_PLANS.map((plan, i) => {\n                const isCurrentPlan = plan.id === quotaData?.plan;\n                \n                return (\n                  <motion.div\n                    key={plan.id}\n                    initial={{ opacity: 0, scale: 0.95 }}\n                    animate={{ opacity: 1, scale: 1 }}\n                    transition={{ delay: 0.2 + i * 0.1 }}\n                  >\n                    <Card className={cn(\n                      \"h-full p-8 rounded-[48px] border transition-all duration-500 relative overflow-hidden group/plan flex flex-col justify-between shadow-card hover:shadow-premium\",\n                      isCurrentPlan \n                        ? \"border-primary/50 bg-primary/5 shadow-premium\" \n                        : \"border-border/50 hover:border-primary/30\"\n                    )}>\n                      <div className=\"absolute top-0 right-0 p-8 opacity-[0.02] group-hover/plan:scale-110 transition-transform duration-700\">\n                        <Cpu weight=\"fill\" className=\"w-32 h-32 text-primary\" />\n                      </div>\n\n                      <div className=\"space-y-8 relative z-10\">\n                        <div className=\"flex justify-between items-start\">\n                          <div className=\"space-y-1\">\n                            <h3 className=\"text-2xl font-black text-foreground uppercase tracking-tight group-hover/plan:text-primary transition-colors\">{plan.name}</h3>\n                            <p className=\"text-[11px] text-muted-foreground font-medium italic leading-relaxed\">{plan.description}</p>\n                          </div>\n                          {isCurrentPlan ? (\n                            <Badge variant=\"success\" size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3 py-1 shadow-glow-sm\">ACTIVE_NODE</Badge>\n                          ) : plan.recommended && (\n                            <Badge variant=\"primary\" size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3 py-1 shadow-glow-sm\">ELITE_NODE</Badge>\n                          )}\n                        </div>\n\n                        <div className=\"flex items-baseline gap-2 pt-2\">\n                          <span className=\"text-4xl font-black text-foreground tracking-tighter tabular-nums\">๏ฟฝ{plan.monthlyPrice.toLocaleString()}</span>\n                          <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] opacity-60\">/ Monthly Cycle</span>\n                        </div>\n\n                        <div className=\"space-y-4 pt-8 border-t border-border/30\">\n                          <div className=\"flex justify-between items-center text-[10px] font-black uppercase tracking-widest\">\n                            <span className=\"text-muted-foreground opacity-60\">Neural Bandwidth</span>\n                            <span className=\"text-foreground\">{plan.monthlyQuota} UNIT_LOGS</span>\n                          </div>\n                          <div className=\"flex justify-between items-center text-[10px] font-black uppercase tracking-widest\">\n                            <span className=\"text-muted-foreground opacity-60\">Overage Gradient</span>\n                            <span className=\"text-primary font-bold\">๏ฟฝ{plan.scanPrice} / UNIT</span>\n                          </div>\n                        </div>\n\n                        <div className=\"space-y-3.5 pt-4\">\n                          {Object.entries(plan.features).map(([key, enabled]) => (\n                            <div key={key} className=\"flex items-center gap-3\">\n                              <div className={cn(\n                                \"w-5 h-5 rounded-lg flex items-center justify-center transition-all shadow-inner\",\n                                enabled ? \"bg-emerald-500/10 text-emerald-500 border border-emerald-500/20\" : \"bg-secondary text-muted-foreground/20 border border-border/50\"\n                              )}>\n                                {enabled ? <CheckCircle weight=\"fill\" className=\"w-3.5 h-3.5\" /> : <X weight=\"bold\" className=\"w-2.5 h-2.5\" />}\n                              </div>\n                              <span className={cn(\n                                \"text-[10px] font-black uppercase tracking-widest transition-colors\",\n                                enabled ? \"text-foreground/80\" : \"text-muted-foreground/30\"\n                              )}>\n                                {key.replace(/([A-Z])/g, ' ').trim()}\n                              </span>\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n\n                      <div className=\"pt-10 relative z-10\">\n                        <Button\n                          disabled={isCurrentPlan}\n                          className={cn(\n                            \"w-full py-7 rounded-[24px] text-[11px] font-black uppercase tracking-[0.3em] shadow-premium gap-3 group/btn\",\n                            isCurrentPlan ? \"bg-secondary/50 text-muted-foreground/40 cursor-default shadow-none border-none\" : \"relative overflow-hidden\"\n                          )}\n                        >\n                          {!isCurrentPlan && <div className=\"absolute inset-0 bg-white/20 -translate-x-full group-hover/btn:translate-x-full transition-transform duration-1000\" />}\n                          <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", !isCurrentPlan && \"group-hover/btn:rotate-180 transition-transform duration-500\")} />\n                          {isCurrentPlan ? 'IDENTITY_TIER_ACTIVE' : 'SYNCHRONIZE NODE'}\n                        </Button>\n                      </div>\n                    </Card>\n                  </motion.div>\n                );\n              })}\n            </div>\n          </div>\n        </div>\n\n        {/* Right Oversight Column */}\n        <div className=\"space-y-10\">\n          {/* Growth Recommendations Node */}\n          <AnimatePresence>\n            {recommendations && (\n              <motion.div \n                initial={{ opacity: 0, scale: 0.95 }}\n                animate={{ opacity: 1, scale: 1 }}\n                exit={{ opacity: 0, scale: 0.95 }}\n              >\n                <Card className=\"rounded-[40px] border-emerald-500/20 bg-emerald-500/[0.02] overflow-hidden group shadow-premium\">\n                  <div className=\"absolute -bottom-12 -right-12 w-48 h-48 bg-emerald-500/5 blur-[60px] rounded-full group-hover:scale-110 transition-transform duration-700\" />\n                  \n                  <CardHeader className=\"p-8 border-b border-emerald-500/10\">\n                    <CardTitle className=\"text-xs font-black uppercase tracking-[0.3em] flex items-center gap-3 text-emerald-600\">\n                      <TrendUp weight=\"duotone\" className=\"w-5 h-5\" />\n                      Growth Optimization\n                    </CardTitle>\n                  </CardHeader>\n                  \n                  <CardContent className=\"p-8 space-y-8 relative z-10\">\n                    <div className=\"p-6 bg-card border border-border/50 rounded-[32px] shadow-inner backdrop-blur-md\">\n                      <p className=\"text-sm text-foreground/80 font-medium leading-relaxed italic opacity-90\">\n                        &quot;{recommendations.reasoning}&quot;\n                      </p>\n                    </div>\n                    \n                    {recommendations.recommendedPlan && (\n                      <div className=\"space-y-5\">\n                        <div className=\"flex items-center justify-between px-2\">\n                          <span className=\"text-[10px] font-black text-primary uppercase tracking-[0.2em]\">Suggested Protocol</span>\n                          {recommendations.potentialSavings && (\n                            <Badge variant=\"success\" size=\"sm\" className=\"font-black uppercase text-[8px] px-3 shadow-glow-sm\">\n                              Yield +๏ฟฝ{recommendations.potentialSavings.toLocaleString()}\n                            </Badge>\n                          )}\n                        </div>\n                        <Button className=\"w-full py-10 rounded-[32px] bg-emerald-600 hover:bg-emerald-700 text-white border-none shadow-premium group/upgrade relative overflow-hidden\">\n                          <div className=\"absolute inset-0 bg-white/10 -translate-x-full group-hover/upgrade:translate-x-full transition-transform duration-1000\" />\n                          <div className=\"flex items-center justify-between w-full relative z-10 px-4\">\n                            <div className=\"text-left space-y-1\">\n                              <p className=\"text-[10px] font-black uppercase tracking-widest opacity-60\">Upgrade Trajectory</p>\n                              <p className=\"text-2xl font-black uppercase tracking-tight leading-none\">\n                                {QUOTA_PLANS.find(p => p.id === recommendations.recommendedPlan)?.name}\n                              </p>\n                            </div>\n                            <div className=\"w-12 h-12 rounded-2xl bg-white/10 flex items-center justify-center group-hover/upgrade:scale-110 group-hover/upgrade:rotate-12 transition-all\">\n                              <ArrowUpRight weight=\"bold\" className=\"w-6 h-6\" />\n                            </div>\n                          </div>\n                        </Button>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </motion.div>\n            )}\n          </AnimatePresence>\n\n          {/* Protocol Intelligence Card */}\n          <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n            <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n              <Brain weight=\"fill\" className=\"w-48 h-48 text-primary\" />\n            </div>\n            \n            <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 relative\">\n              <CardTitle className=\"text-xs font-black uppercase tracking-[0.3em] flex items-center gap-3\">\n                <Brain weight=\"duotone\" className=\"w-5 h-5 text-primary\" />\n                Active Intelligence\n              </CardTitle>\n            </CardHeader>\n\n            <CardContent className=\"p-8 space-y-10 relative z-10\">\n              <div className=\"p-6 bg-primary/5 rounded-[32px] border border-primary/10 space-y-4 hover:border-primary/30 transition-all duration-500 shadow-inner group/active-node\">\n                <div className=\"flex items-center justify-between\">\n                  <Badge variant=\"ghost\" className=\"bg-primary/10 text-primary border-none font-black text-[9px] uppercase tracking-widest px-3 py-1\">{currentPlan?.name} NODE</Badge>\n                  <div className=\"w-2 h-2 rounded-full bg-emerald-500 animate-pulse shadow-[0_0_10px_rgba(16,185,129,0.6)]\" />\n                </div>\n                <p className=\"text-xs text-foreground/70 font-medium leading-relaxed italic opacity-80\">{currentPlan?.description}</p>\n              </div>\n\n              <div className=\"space-y-5\">\n                <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.4em] ml-2\">Identity Privileges</p>\n                <div className=\"space-y-2.5\">\n                  {quotaData && Object.entries(quotaData.features).map(([key, enabled]) => (\n                    <div key={key} className=\"flex items-center justify-between p-4 bg-secondary/30 rounded-2xl border border-border/50 hover:bg-secondary/50 hover:border-primary/20 transition-all group/feat shadow-sm\">\n                      <span className=\"text-[10px] font-black text-foreground/80 uppercase tracking-widest group-hover/feat:text-primary transition-colors\">{key.replace(/([A-Z])/g, ' ').trim()}</span>\n                      <div className={cn(\n                        \"w-6 h-6 rounded-lg flex items-center justify-center shadow-inner\",\n                        enabled ? \"bg-emerald-500/10 text-emerald-500 border border-emerald-500/20\" : \"bg-card border border-border/50 text-muted-foreground/20\"\n                      )}>\n                        {enabled ? <CheckCircle weight=\"fill\" className=\"w-4 h-4 shadow-glow-sm\" /> : <X weight=\"bold\" className=\"w-3 h-3\" />}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Fiscal Ledger Link Card */}\n          <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n            <CardContent className=\"p-10 space-y-8\">\n              <div className=\"flex items-center gap-5\">\n                <div className=\"w-14 h-14 rounded-2xl bg-secondary border border-border/50 flex items-center justify-center text-muted-foreground group-hover:bg-primary/10 group-hover:text-primary transition-all duration-500 shadow-inner\">\n                  <CreditCard weight=\"duotone\" className=\"w-7 h-7\" />\n                </div>\n                <div>\n                  <h3 className=\"text-sm font-black text-foreground uppercase tracking-[0.3em]\">Fiscal Hub</h3>\n                  <p className=\"text-[10px] font-bold text-muted-foreground uppercase tracking-widest mt-1\">Billing Oversight Registry</p>\n                </div>\n              </div>\n              <div className=\"space-y-5\">\n                <div className=\"flex justify-between items-center p-5 bg-secondary/30 rounded-3xl border border-border/50 hover:bg-secondary/50 transition-all shadow-inner\">\n                  <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Temporal Reset</span>\n                  <span className=\"text-xs font-black text-foreground tabular-nums uppercase tracking-tighter\">\n                    {new Date(quotaData?.resetDate || '').toLocaleDateString(undefined, { month: 'short', day: 'numeric', year: 'numeric' })}\n                  </span>\n                </div>\n                <Button variant=\"outline\" className=\"w-full py-5 rounded-[24px] text-[10px] font-black uppercase tracking-[0.3em] border-border/50 hover:bg-secondary group/btn shadow-sm\">\n                  Access Billing Vault\n                  <CaretRight weight=\"bold\" className=\"w-3.5 h-3.5 ml-2 group-hover/btn:translate-x-1 transition-transform\" />\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\reports\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":4,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AnimatePresence"},"fix":{"range":[88,105],"text":""},"desc":"Remove unused variable \"AnimatePresence\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CalendarDots' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":15,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CalendarDots"},"fix":{"range":[176,193],"text":""},"desc":"Remove unused variable \"CalendarDots\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Funnel' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":9,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Funnel"},"fix":{"range":[211,221],"text":""},"desc":"Remove unused variable \"Funnel\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[235,249],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[272,285],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle"},"fix":{"range":[304,319],"text":""},"desc":"Remove unused variable \"CheckCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":26,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":15,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Badge"},"fix":{"range":[547,593],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRouter' is defined but never used.","line":32,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":19,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"useRouter"},"fix":{"range":[838,882],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PieChart' is defined but never used.","line":43,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":11,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"PieChart"},"fix":{"range":[1049,1061],"text":""},"desc":"Remove unused variable \"PieChart\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pie' is defined but never used.","line":44,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":6,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pie"},"fix":{"range":[1061,1068],"text":""},"desc":"Remove unused variable \"Pie\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":48,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":49,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":49,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1219,1222],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1219,1222],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":52,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":52,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1399,1402],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1399,1402],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":87,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2325,2328],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2325,2328],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":95,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2545,2548],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2545,2548],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":210,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":210,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7805,7808],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7805,7808],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":17,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  ChartBar, \n  Users, \n  FirstAidKit, \n  CalendarDots,\n  DownloadSimple,\n  Funnel,\n  SpinnerGap,\n  CaretRight,\n  TrendUp,\n  FileText,\n  ArrowLeft,\n  ArrowsClockwise,\n  CheckCircle,\n  Activity,\n  ChartLineUp,\n  PresentationChart,\n  UserCheck\n} from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { useTranslations } from 'next-intl';\nimport { cn } from '@/lib/utils';\nimport { useRouter } from 'next/navigation';\nimport ResponsiveTable from '@/components/ui/ResponsiveTable';\nimport {\n  BarChart,\n  Bar,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer,\n  Cell,\n  PieChart,\n  Pie\n} from 'recharts';\n\nexport default function ReportsPage() {\n  const { goBack } = useBackNavigation();\n  const t = useTranslations('clinic.reports' as any);\n  const [loading, setLoading] = useState(true);\n  const [reportType, setReportType] = useState<'sales' | 'staff' | 'treatments'>('sales');\n  const [data, setData] = useState<any[]>([]);\n  const [period, setPeriod] = useState<'30d' | '90d' | '365d'>('30d');\n\n  const fetchData = useCallback(async () => {\n    setLoading(true);\n    try {\n      const typeMap = {\n        sales: 'revenue_summary',\n        staff: 'staff_performance',\n        treatments: 'top_treatments'\n      };\n      \n      const res = await fetch(`/api/reports?type=${typeMap[reportType]}`);\n      const result = await res.json();\n      \n      if (result.success) {\n        if (reportType === 'sales') setData(result.data.chartData);\n        else setData(result.data);\n      }\n    } catch (err) {\n      console.error('Error fetching report data:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [reportType]);\n\n  useEffect(() => {\n    fetchData();\n  }, [fetchData]);\n\n  const COLORS = ['#FFD700', '#4A90E2', '#50E3C2', '#FF6B6B', '#B8E986'];\n\n  const columns = [\n    {\n      header: 'Identity Node',\n      accessor: (item: any) => (\n        <span className=\"text-sm font-bold text-foreground uppercase tracking-tight\">\n          {item.name || item.date}\n        </span>\n      )\n    },\n    {\n      header: 'Node Metric',\n      accessor: (item: any) => (\n        <span className=\"text-sm font-bold text-primary tabular-nums\">\n          เธฟ{(item.amount || item.sales || item.revenue || 0).toLocaleString()}\n        </span>\n      )\n    },\n    {\n      header: 'Efficiency',\n      accessor: () => (\n        <div className=\"flex items-center gap-3\">\n          <div className=\"h-1.5 w-24 bg-secondary rounded-full overflow-hidden border border-border\">\n            <motion.div \n              initial={{ width: 0 }}\n              animate={{ width: `${Math.random() * 60 + 40}%` }}\n              className=\"h-full bg-primary/40 rounded-full\"\n            />\n          </div>\n          <span className=\"text-[10px] font-bold text-muted-foreground uppercase\">OPTIMAL</span>\n        </div>\n      )\n    }\n  ];\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <PresentationChart weight=\"duotone\" className=\"w-4 h-4\" />\n            Executive Data Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight\"\n          >\n            Clinical <span className=\"text-primary\">Reports</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            High-fidelity operational reporting and multidimensional performance telemetry.\n          </motion.p>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <Button \n            variant=\"outline\" \n            onClick={fetchData}\n            disabled={loading}\n            className=\"gap-2\"\n          >\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\n            Sync Intel\n          </Button>\n          <Button className=\"gap-2 shadow-premium px-8\">\n            <DownloadSimple weight=\"bold\" className=\"w-4 h-4\" />\n            Export Archive\n          </Button>\n        </div>\n      </div>\n\n      {/* Stats Summary - Contextual based on report type */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        {reportType === 'sales' ? (\n          <>\n            <StatCard title=\"Gross Volume\" value={data.reduce((acc, i) => acc + (i.amount || 0), 0)} prefix=\"เธฟ\" icon={ChartLineUp} trend=\"up\" change={12.5} />\n            <StatCard title=\"Transaction Density\" value={data.length} icon={Activity} trend=\"neutral\" />\n            <StatCard title=\"Average Node Value\" value={data.length ? Math.round(data.reduce((acc, i) => acc + (i.amount || 0), 0) / data.length) : 0} prefix=\"เธฟ\" icon={ChartBar} trend=\"up\" change={2.1} />\n          </>\n        ) : reportType === 'staff' ? (\n          <>\n            <StatCard title=\"Active Practitioners\" value={data.length} icon={UserCheck} trend=\"neutral\" />\n            <StatCard title=\"Top Performance\" value={data.length ? Math.max(...data.map(i => i.sales || 0)) : 0} prefix=\"เธฟ\" icon={TrendUp} trend=\"up\" change={15.2} />\n            <StatCard title=\"Efficiency Mean\" value={data.length ? Math.round(data.reduce((acc, i) => acc + (i.sales || 0), 0) / data.length) : 0} prefix=\"เธฟ\" icon={Activity} trend=\"neutral\" />\n          </>\n        ) : (\n          <>\n            <StatCard title=\"Protocol Portfolio\" value={data.length} icon={FirstAidKit} trend=\"neutral\" />\n            <StatCard title=\"Peak Utilization\" value={data.length ? Math.max(...data.map(i => i.revenue || 0)) : 0} prefix=\"เธฟ\" icon={Lightning} trend=\"up\" change={8.4} />\n            <StatCard title=\"Service Yield\" value={data.length ? Math.round(data.reduce((acc, i) => acc + (i.revenue || 0), 0) / data.length) : 0} prefix=\"เธฟ\" icon={ChartBar} trend=\"up\" change={5.7} />\n          </>\n        )}\n      </div>\n\n      {/* Main Analysis Interface */}\n      <div className=\"flex flex-col lg:flex-row gap-8\">\n        <div className=\"lg:w-72 flex-shrink-0\">\n          <Card className=\"sticky top-28 border-border/50\">\n            <CardHeader className=\"pb-4\">\n              <CardTitle className=\"text-xs font-black uppercase tracking-widest text-muted-foreground opacity-60\">Analytics Vectors</CardTitle>\n            </CardHeader>\n            <CardContent className=\"p-2 space-y-1\">\n              {[\n                { id: 'sales', label: 'Sales Velocity', icon: TrendUp },\n                { id: 'staff', label: 'Practitioner Intel', icon: Users },\n                { id: 'treatments', label: 'Protocol Density', icon: FirstAidKit },\n              ].map((tab) => (\n                <button\n                  key={tab.id}\n                  onClick={() => setReportType(tab.id as any)}\n                  className={cn(\n                    \"w-full flex items-center gap-4 px-5 py-4 rounded-2xl transition-all text-[11px] font-black uppercase tracking-widest border\",\n                    reportType === tab.id \n                      ? \"bg-primary/10 text-primary border-primary/30 shadow-sm\" \n                      : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\n                  )}\n                >\n                  <tab.icon weight={reportType === tab.id ? \"fill\" : \"duotone\"} className=\"w-5 h-5\" />\n                  <span>{tab.label}</span>\n                </button>\n              ))}\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"flex-1 space-y-8\">\n          {/* Main Visualization Node */}\n          <Card className=\"relative overflow-hidden group border-border/50\">\n            <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n              <PresentationChart className=\"w-64 h-64 text-primary\" />\n            </div>\n\n            <CardHeader className=\"border-b border-border/50 pb-6 relative z-10\">\n              <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-6\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\n                    <FileText weight=\"duotone\" className=\"w-6 h-6\" />\n                  </div>\n                  <div>\n                    <CardTitle className=\"text-xl\">\n                      {reportType === 'sales' ? 'Revenue Trajectory' : \n                       reportType === 'staff' ? 'Personnel Efficiency' : 'Protocol Density Matrix'}\n                    </CardTitle>\n                    <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] mt-1\">Telemetry visualization</p>\n                  </div>\n                </div>\n\n                <div className=\"flex bg-secondary/50 border border-border p-1 rounded-2xl shadow-inner\">\n                  {(['30d', '90d', '365d'] as const).map((p) => (\n                    <button\n                      key={p}\n                      onClick={() => setPeriod(p)}\n                      className={cn(\n                        \"px-5 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border\",\n                        period === p ? \"bg-card text-primary border-border/50 shadow-sm\" : \"text-muted-foreground border-transparent hover:text-foreground hover:bg-card/50\"\n                      )}\n                    >\n                      {p}\n                    </button>\n                  ))}\n                </div>\n              </div>\n            </CardHeader>\n\n            <CardContent className=\"pt-10 relative z-10\">\n              {loading ? (\n                <div className=\"h-[400px] flex flex-col items-center justify-center gap-4\">\n                  <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\n                  <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Reconstructing Node Data...</p>\n                </div>\n              ) : data.length > 0 ? (\n                <div className=\"h-[400px] w-full\">\n                  <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    {reportType === 'sales' ? (\n                      <BarChart data={data}>\n                        <defs>\n                          <linearGradient id=\"barGradient\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                            <stop offset=\"0%\" stopColor=\"var(--primary)\" stopOpacity={1}/>\n                            <stop offset=\"100%\" stopColor=\"var(--primary)\" stopOpacity={0.6}/>\n                          </linearGradient>\n                        </defs>\n                        <CartesianGrid strokeDasharray=\"3 3\" stroke=\"currentColor\" opacity={0.05} vertical={false} />\n                        <XAxis \n                          dataKey=\"date\" \n                          stroke=\"currentColor\" \n                          opacity={0.4}\n                          fontSize={10} \n                          fontWeight=\"bold\"\n                          axisLine={false}\n                          tickLine={false}\n                          tickFormatter={(val) => new Date(val).toLocaleDateString(undefined, { day: 'numeric', month: 'short' })}\n                        />\n                        <YAxis stroke=\"currentColor\" opacity={0.4} fontSize={10} fontWeight=\"bold\" axisLine={false} tickLine={false} />\n                        <Tooltip \n                          cursor={{ fill: 'rgba(var(--primary-rgb), 0.05)', radius: 8 }}\n                          contentStyle={{ backgroundColor: 'var(--card)', border: '1px solid var(--border)', borderRadius: '16px', boxShadow: '0 10px 25px -5px rgba(0,0,0,0.1)' }}\n                          itemStyle={{ color: 'var(--primary)', fontWeight: 'bold', fontSize: '12px' }}\n                        />\n                        <Bar dataKey=\"amount\" fill=\"url(#barGradient)\" radius={[8, 8, 0, 0]} barSize={24} />\n                      </BarChart>\n                    ) : (\n                      <BarChart data={data} layout=\"vertical\">\n                        <CartesianGrid strokeDasharray=\"3 3\" stroke=\"currentColor\" opacity={0.05} horizontal={false} />\n                        <XAxis type=\"number\" stroke=\"currentColor\" opacity={0.4} fontSize={10} fontWeight=\"bold\" axisLine={false} tickLine={false} />\n                        <YAxis dataKey=\"name\" type=\"category\" stroke=\"currentColor\" opacity={0.4} fontSize={10} fontWeight=\"bold\" width={120} axisLine={false} tickLine={false} />\n                        <Tooltip \n                          cursor={{ fill: 'rgba(var(--primary-rgb), 0.05)', radius: 8 }}\n                          contentStyle={{ backgroundColor: 'var(--card)', border: '1px solid var(--border)', borderRadius: '16px' }}\n                          itemStyle={{ color: 'var(--primary)', fontWeight: 'bold', fontSize: '12px' }}\n                        />\n                        <Bar dataKey={reportType === 'staff' ? 'sales' : 'revenue'} radius={[0, 8, 8, 0]} barSize={24}>\n                          {data.map((entry, index) => (\n                            <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                          ))}\n                        </Bar>\n                      </BarChart>\n                    )}\n                  </ResponsiveContainer>\n                </div>\n              ) : (\n                <div className=\"h-[400px] flex flex-col items-center justify-center opacity-20 gap-4\">\n                  <ChartBar weight=\"duotone\" className=\"w-16 h-16\" />\n                  <p className=\"text-sm font-black uppercase tracking-[0.3em]\">Zero Telemetry Signal</p>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* Detailed Data Registry */}\n          <div className=\"space-y-4\">\n            <h4 className=\"text-sm font-black text-foreground uppercase tracking-[0.2em] ml-1 flex items-center gap-3\">\n              <div className=\"w-1.5 h-1.5 rounded-full bg-primary animate-pulse\" />\n              Detailed Metric Registry\n            </h4>\n            <Card className=\"border-border/50\">\n              <ResponsiveTable\n                columns={columns}\n                data={data}\n                loading={loading}\n                rowKey={(item) => item.id || item.date || Math.random().toString()}\n                emptyMessage=\"No telemetry data recorded for this period.\"\n                mobileCard={(item) => (\n                  <div className=\"space-y-4\">\n                    <div className=\"flex justify-between items-start\">\n                      <div className=\"space-y-1\">\n                        <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Node Identity</p>\n                        <p className=\"text-base font-bold text-foreground uppercase\">{item.name || item.date}</p>\n                      </div>\n                      <div className=\"text-right space-y-1\">\n                        <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Node Value</p>\n                        <p className=\"text-lg font-black text-primary tabular-nums\">\n                          เธฟ{(item.amount || item.sales || item.revenue || 0).toLocaleString()}\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"pt-4 border-t border-border/50 flex items-center justify-between\">\n                      <div className=\"flex items-center gap-3 flex-1\">\n                        <div className=\"h-1.5 flex-1 bg-secondary rounded-full overflow-hidden border border-border\">\n                          <div className=\"h-full bg-primary/40 rounded-full w-[75%]\" />\n                        </div>\n                        <span className=\"text-[10px] font-black text-muted-foreground uppercase\">OPTIMAL</span>\n                      </div>\n                    </div>\n                  </div>\n                )}\n              />\n            </Card>\n          </div>\n        </div>\n      </div>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\revenue\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Invalid character.","line":70,"column":14}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { \n  TrendUp, \n  CurrencyDollar, \n  CreditCard, \n  CalendarDots,\n  ArrowUpRight,\n  ArrowDownRight,\n  SpinnerGap,\n  SquaresFour,\n  ChartBar,\n  Users,\n  ArrowsClockwise,\n  ArrowRight,\n  Monitor,\n  IdentificationBadge,\n  Pulse,\n  Briefcase,\n  Coin,\n  Graph,\n  Receipt,\n  ShieldCheck,\n  Clock\n} from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { cn } from '@/lib/utils';\nimport { useState, useEffect, useCallback } from 'react';\nimport {\n  AreaChart,\n  Area,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer,\n  BarChart,\n  Bar,\n  Cell\n} from 'recharts';\nimport { motion, AnimatePresence } from 'framer-motion';\n\ninterface RevenueStats {\n  chartData: Array<{ date: string; amount: number }>;\n  totalRevenue: number;\n  transactionCount: number;\n}\n\nexport default function RevenueDashboard() {\n  const { goBack } = useBackNavigation();\n  const [loading, setLoading] = useState(true);\n  const [stats, setStats] = useState<RevenueStats | null>(null);\n  const [topTreatments, setTopTreatments] = useState<any[]>([]);\n  const [period, setPeriod] = useState<'7d' | '30d' | '90d'>('30d');\n\n  const fetchData = useCallback(async () => {\n    setLoading(true);\n    try {\n      const startDate = new Date();\n      if (period === '7d') startDate.setDate(startDate.getDate() - 7);\n      else if (period === '30d') startDate.setDate(startDate.getDate() - 30);\n      else if (period === '90d') startDate.setDate(startDate.getDate() - 90);\n\n      const [revenueRes, treatmentsRes] = await Promise.all([\n        fetch(\\/api/reports?type=revenue_summary&startDate=\\\\),\n        fetch(\\/api/reports?type=top_treatments&startDate=\\\\)\n      ]);\n\n      const [revenueData, treatmentsData] = await Promise.all([\n        revenueRes.json(),\n        treatmentsRes.json()\n      ]);\n\n      if (revenueData.success) setStats(revenueData.data);\n      if (treatmentsData.success) setTopTreatments(treatmentsData.data);\n    } catch (err) {\n      console.error('Error fetching revenue data:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [period]);\n\n  useEffect(() => {\n    fetchData();\n  }, [fetchData]);\n\n  if (loading && !stats) {\n    return (\n      <div className=\\\"h-[80vh] flex flex-col items-center justify-center space-y-6\\\">\n        <SpinnerGap className=\\\"w-12 h-12 text-primary animate-spin\\\" />\n        <p className=\\\"text-sm font-black uppercase tracking-[0.3em] text-muted-foreground animate-pulse\\\">Accessing Financial Nodes...</p>\n      </div>\n    );\n  }\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\\\"space-y-8 pb-20 font-sans\\\"\n    >\n      <Breadcrumb />\n\n      {/* Header Section */}\n      <div className=\\\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\\\">\n        <div className=\\\"space-y-1\\\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\\\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\\\"\n          >\n            <TrendUp weight=\\\"duotone\\\" className=\\\"w-4 h-4\\\" />\n            Financial Intelligence Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\\\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\\\"\n          >\n            Revenue <span className=\\\"text-primary\\\">Intelligence</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\\\"text-muted-foreground font-light text-sm italic\\\"\n          >\n            Real-time terminal performance, fiscal growth matrices, and predictive yield deltas.\n          </motion.p>\n        </div>\n\n        <div className=\\\"flex items-center gap-3\\\">\n          <div className=\\\"flex bg-secondary/50 border border-border/50 p-1.5 rounded-[24px] shadow-inner\\\">\n            {['7d', '30d', '90d'].map((p) => (\n              <button\n                key={p}\n                onClick={() => setPeriod(p as any)}\n                className={cn(\n                  \\\"px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border whitespace-nowrap\\\",\n                  period === p\n                    ? \\\"bg-primary text-primary-foreground border-primary shadow-premium\\\"\n                    : \\\"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\\\"\n                )}\n              >\n                {p} Cycle\n              </button>\n            ))}\n          </div>\n          <Button \n            variant=\\\"outline\\\"\n            onClick={fetchData}\n            disabled={loading}\n            className=\\\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\\\"\n          >\n            <ArrowsClockwise weight=\\\"bold\\\" className={cn(\\\"w-4 h-4\\\", loading && \\\"animate-spin\\\")} />\n            Sync Ledger\n          </Button>\n        </div>\n      </div>\n\n      {/* Quick Stats Summary */}\n      <div className=\\\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\\\">\n        <StatCard\n          title=\\\"Consolidated Yield\\\"\n          value={stats?.totalRevenue || 0}\n          prefix=\\\"๏ฟฝ\\\"\n          icon={Coin}\n          trend=\\\"up\\\"\n          change={12.4}\n          className=\\\"p-4\\\"\n        />\n        <StatCard\n          title=\\\"Transaction Density\\\"\n          value={stats?.transactionCount || 0}\n          icon={Receipt}\n          className=\\\"p-4\\\"\n        />\n        <StatCard\n          title=\\\"Mean Node Value\\\"\n          value={stats?.totalRevenue && stats?.transactionCount ? Math.round(stats.totalRevenue / stats.transactionCount) : 0}\n          prefix=\\\"๏ฟฝ\\\"\n          icon={Monitor}\n          className=\\\"p-4\\\"\n        />\n        <StatCard\n          title=\\\"Growth Vector\\\"\n          value={8.2}\n          suffix=\\\"%\\\"\n          icon={Graph}\n          iconColor=\\\"text-emerald-500\\\"\n          className=\\\"p-4\\\"\n        />\n      </div>\n\n      <div className=\\\"grid grid-cols-1 lg:grid-cols-3 gap-10 px-2\\\">\n        {/* Revenue Projection Chart */}\n        <div className=\\\"lg:col-span-2 space-y-10\\\">\n          <Card className=\\\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\\\">\n            <CardHeader className=\\\"p-8 border-b border-border/50 bg-secondary/30\\\">\n              <div className=\\\"flex items-center gap-4\\\">\n                <div className=\\\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\\\">\n                  <ChartBar weight=\\\"duotone\\\" className=\\\"w-6 h-6\\\" />\n                </div>\n                <div>\n                  <CardTitle className=\\\"text-xl font-black uppercase tracking-tight\\\">Temporal Revenue Matrix</CardTitle>\n                  <p className=\\\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\\\">Historical fiscal synchronization</p>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent className=\\\"p-10 h-[450px]\\\">\n              <ResponsiveContainer width=\\\"100%\\\" height=\\\"100%\\\">\n                <AreaChart data={stats?.chartData || []}>\n                  <defs>\n                    <linearGradient id=\\\"colorRevenue\\\" x1=\\\"0\\\" y1=\\\"0\\\" x2=\\\"0\\\" y2=\\\"1\\\">\n                      <stop offset=\\\"5%\\\" stopColor=\\\"hsl(var(--primary))\\\" stopOpacity={0.3}/>\n                      <stop offset=\\\"95%\\\" stopColor=\\\"hsl(var(--primary))\\\" stopOpacity={0}/>\n                    </linearGradient>\n                  </defs>\n                  <CartesianGrid strokeDasharray=\\\"3 3\\\" stroke=\\\"hsl(var(--border)/0.3)\\\" vertical={false} />\n                  <XAxis \n                    dataKey=\\\"date\\\" \n                    tickFormatter={(val) => new Date(val).toLocaleDateString(undefined, { month: 'short', day: 'numeric' })}\n                    axisLine={false}\n                    tickLine={false}\n                    tick={{ fill: 'hsl(var(--muted-foreground))', fontSize: 10, fontWeight: 'bold' }}\n                  />\n                  <YAxis \n                    axisLine={false} \n                    tickLine={false}\n                    tick={{ fill: 'hsl(var(--muted-foreground))', fontSize: 10, fontWeight: 'bold' }}\n                    tickFormatter={(val) => \\๏ฟฝ\\\\}\n                  />\n                  <Tooltip \n                    contentStyle={{ \n                      backgroundColor: 'hsl(var(--card))', \n                      borderColor: 'hsl(var(--border))', \n                      borderRadius: '16px',\n                      boxShadow: 'var(--shadow-premium)',\n                      fontSize: '12px',\n                      fontWeight: 'bold',\n                      textTransform: 'uppercase'\n                    }}\n                  />\n                  <Area \n                    type=\\\"monotone\\\" \n                    dataKey=\\\"amount\\\" \n                    stroke=\\\"hsl(var(--primary))\\\" \n                    strokeWidth={4}\n                    fillOpacity={1} \n                    fill=\\\"url(#colorRevenue)\\\" \n                    animationDuration={2000}\n                  />\n                </AreaChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n\n          {/* Top Protocols */}\n          <div className=\\\"space-y-6\\\">\n            <div className=\\\"flex items-center justify-between px-4\\\">\n              <h3 className=\\\"text-xl font-black text-foreground uppercase tracking-[0.2em]\\\">Top Protocol <span className=\\\"text-primary\\\">Yields</span></h3>\n              <Badge variant=\\\"ghost\\\" className=\\\"bg-primary/5 text-primary border-none font-black text-[10px] tracking-widest uppercase px-4 py-1.5\\\">Efficiency Nodes</Badge>\n            </div>\n            \n            <div className=\\\"grid grid-cols-1 md:grid-cols-2 gap-6\\\">\n              {topTreatments.map((t, i) => (\n                <Card key={i} className=\\\"p-6 bg-secondary/20 rounded-[32px] border border-border/50 hover:border-primary/20 transition-all group/item overflow-hidden relative\\\">\n                  <div className=\\\"absolute top-0 right-0 p-4 opacity-[0.03] group-hover/item:scale-110 transition-transform\\\">\n                    <SquaresFour weight=\\\"fill\\\" className=\\\"w-16 h-16 text-primary\\\" />\n                  </div>\n                  <div className=\\\"flex items-center gap-5 relative z-10\\\">\n                    <div className=\\\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\\\">\n                      <SquaresFour weight=\\\"duotone\\\" className=\\\"w-6 h-6\\\" />\n                    </div>\n                    <div className=\\\"flex-1 min-w-0\\\">\n                      <h4 className=\\\"text-sm font-black text-foreground uppercase tracking-tight truncate\\\">{t.name}</h4>\n                      <p className=\\\"text-[10px] text-muted-foreground font-black uppercase tracking-widest\\\">{t.count} Units Executed</p>\n                    </div>\n                    <div className=\\\"text-right\\\">\n                      <p className=\\\"text-lg font-black text-foreground tabular-nums tracking-tighter\\\">๏ฟฝ{t.revenue.toLocaleString()}</p>\n                      <div className=\\\"flex items-center justify-end gap-1 text-[9px] text-emerald-500 font-bold\\\">\n                        <ArrowUpRight weight=\\\"bold\\\" className=\\\"w-2.5 h-2.5\\\" />\n                        <span>{t.growth || '8.4'}%</span>\n                      </div>\n                    </div>\n                  </div>\n                </Card>\n              ))}\n            </div>\n          </div>\n        </div>\n\n        {/* Right Sidebar: Operations & Sync */}\n        <div className=\\\"space-y-10\\\">\n          <Card className=\\\"rounded-[40px] border-border/50 overflow-hidden shadow-premium\\\">\n            <CardHeader className=\\\"p-8 border-b border-border/50 bg-secondary/30\\\">\n              <div className=\\\"flex items-center gap-4\\\">\n                <div className=\\\"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\\\">\n                  <ChartBar weight=\\\"duotone\\\" className=\\\"w-5 h-5\\\" />\n                </div>\n                <CardTitle className=\\\"text-sm font-black uppercase tracking-tight\\\">Financial Ledger</CardTitle>\n              </div>\n            </CardHeader>\n            \n            <CardContent className=\\\"p-8 space-y-8\\\">\n              <div className=\\\"space-y-4\\\">\n                {[\n                  { label: 'Settlement Node', val: 'Operational', icon: CheckCircle, color: 'text-emerald-500' },\n                  { label: 'Cycle Frequency', val: 'Real-time', icon: Pulse, color: 'text-primary' },\n                  { label: 'Protocol Integrity', val: 'Secured', icon: ShieldCheck, color: 'text-blue-500' }\n                ].map((item, i) => (\n                  <div key={i} className=\\\"flex items-center justify-between p-4 bg-secondary/30 rounded-2xl border border-border/50 hover:bg-secondary/50 transition-all group/node\\\">\n                    <div className=\\\"flex items-center gap-3\\\">\n                      <item.icon weight=\\\"duotone\\\" className={cn(\\\"w-4 h-4\\\", item.color)} />\n                      <span className=\\\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\\\">{item.label}</span>\n                    </div>\n                    <span className=\\\"text-[10px] font-black text-foreground uppercase tracking-widest\\\">{item.val}</span>\n                  </div>\n                ))}\n              </div>\n\n              <div className=\\\"pt-8 border-t border-border/30 space-y-6\\\">\n                <div className=\\\"text-center space-y-1\\\">\n                  <p className=\\\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\\\">Global Cumulative Yield</p>\n                  <p className=\\\"text-3xl font-black text-foreground tabular-nums tracking-tighter\\\">๏ฟฝ{(stats?.totalRevenue || 0).toLocaleString()}</p>\n                </div>\n                <Button className=\\\"w-full py-6 rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] shadow-premium gap-3 hover:scale-105 transition-all\\\">\n                  Access Vault Terminal\n                  <ArrowRight weight=\\\"bold\\\" className=\\\"w-4 h-4\\\" />\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Predictive Yield Node */}\n          <Card className=\\\"p-8 rounded-[40px] border-primary/10 bg-primary/[0.02] space-y-6 group overflow-hidden relative\\\">\n            <div className=\\\"absolute -bottom-12 -right-12 w-32 h-32 bg-primary/5 blur-[50px] rounded-full group-hover:bg-primary/10 transition-all duration-700\\\" />\n            <div className=\\\"flex items-center gap-3 relative z-10\\\">\n              <Sparkle weight=\\\"duotone\\\" className=\\\"w-5 h-5 text-primary group-hover:scale-110 transition-transform\\\" />\n              <h4 className=\\\"text-[10px] font-black text-primary uppercase tracking-[0.3em]\\\">Predictive Delta</h4>\n            </div>\n            <div className=\\\"space-y-2 relative z-10\\\">\n              <div className=\\\"flex items-baseline gap-2\\\">\n                <span className=\\\"text-3xl font-black text-foreground tabular-nums tracking-tighter\\\">+14.2%</span>\n                <Badge variant=\\\"ghost\\\" className=\\\"bg-emerald-500/10 text-emerald-500 border-none font-black text-[8px] uppercase px-2 py-0.5\\\">Projected</Badge>\n              </div>\n              <p className=\\\"text-xs text-muted-foreground italic font-medium leading-relaxed\\\">\n                Cognitive algorithms suggest a secondary yield surge in sector omega based on historical protocol velocity.\n              </p>\n            </div>\n          </Card>\n        </div>\n      </div>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\reviews\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":4,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AnimatePresence"},"fix":{"range":[75,92],"text":""},"desc":"Remove unused variable \"AnimatePresence\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ThumbsUp' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":11,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ThumbsUp"},"fix":{"range":[148,161],"text":""},"desc":"Remove unused variable \"ThumbsUp\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Funnel' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":9,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Funnel"},"fix":{"range":[161,172],"text":""},"desc":"Remove unused variable \"Funnel\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[172,186],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle"},"fix":{"range":[225,241],"text":""},"desc":"Remove unused variable \"CheckCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":4,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"X"},"fix":{"range":[241,247],"text":""},"desc":"Remove unused variable \"X\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":21,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[404,415],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":40,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":41,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":41,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1063,1066],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1063,1066],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchData'. Either include it or remove the dependency array.","line":49,"column":37,"nodeType":"ArrayExpression","endLine":49,"endColumn":45,"suggestions":[{"desc":"Update the dependencies array to be: [fetchData, filter]","fix":{"range":[1500,1508],"text":"[fetchData, filter]"}}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'SpinnerGap' is not defined.","line":216,"column":14,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":216,"endColumn":24},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":260,"column":25,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[10963,10989],"text":"\n                        &quot;"},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[10963,10989],"text":"\n                        &ldquo;"},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[10963,10989],"text":"\n                        &#34;"},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[10963,10989],"text":"\n                        &rdquo;"},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":260,"column":46,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[11009,11033],"text":"&quot;\n                      "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[11009,11033],"text":"&ldquo;\n                      "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[11009,11033],"text":"&#34;\n                      "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[11009,11033],"text":"&rdquo;\n                      "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  Star, \n  ChatCircle, \n  ThumbsUp, \n  Funnel, \n  ArrowLeft, \n  ArrowsClockwise, \n  ChatCircleText, \n  CheckCircle, \n  X,\n  User,\n  Smiley,\n  SmileySad,\n  ChartLineUp\n} from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { useTranslations } from 'next-intl';\nimport { cn } from '@/lib/utils';\n\ninterface Review {\n  id: string;\n  customer?: { full_name: string };\n  rating: number;\n  review_text: string;\n  response_text?: string;\n  platform: string;\n  created_at: string;\n}\n\nexport default function ReviewsPage() {\n  const { goBack } = useBackNavigation();\n  const t = useTranslations('clinic.reviews' as any);\n  const [reviews, setReviews] = useState<Review[]>([]);\n  const [stats, setStats] = useState({ totalReviews: 0, avgRating: 0, ratingCounts: { 5: 0, 4: 0, 3: 0, 2: 0, 1: 0 } });\n  const [loading, setLoading] = useState(true);\n  const [filter, setFilter] = useState<string>('');\n  const [responding, setResponding] = useState<string | null>(null);\n  const [response, setResponse] = useState('');\n\n  useEffect(() => { fetchData(); }, [filter]);\n\n  const fetchData = async () => {\n    setLoading(true);\n    try {\n      const params = new URLSearchParams();\n      if (filter) params.set('rating', filter);\n      const res = await fetch(`/api/reviews?${params}`);\n      const data = await res.json();\n      setReviews(data.reviews || []);\n      setStats({ totalReviews: data.totalReviews, avgRating: data.avgRating, ratingCounts: data.ratingCounts });\n    } catch (e) { console.error(e); }\n    setLoading(false);\n  };\n\n  const submitResponse = async (reviewId: string) => {\n    if (!response.trim()) return;\n    await fetch('/api/reviews', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ reviewId, responseText: response })\n    });\n    setResponding(null);\n    setResponse('');\n    fetchData();\n  };\n\n  const formatDate = (d: string) => new Date(d).toLocaleDateString('th-TH', { day: 'numeric', month: 'short', year: 'numeric' });\n\n  const renderStars = (rating: number) => (\n    <div className=\"flex gap-0.5\">\n      {[1, 2, 3, 4, 5].map(i => (\n        <Star key={i} className={`w-4 h-4 ${i <= rating ? 'fill-yellow-400 text-yellow-400' : 'text-gray-300'}`} />\n      ))}\n    </div>\n  );\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <ChatCircleText weight=\"duotone\" className=\"w-4 h-4\" />\n            Brand Reputation Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight\"\n          >\n            Reviews & <span className=\"text-primary\">Reputation</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Monitoring client sentiment and clinical service validation.\n          </motion.p>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <Button \n            variant=\"outline\" \n            onClick={fetchData}\n            disabled={loading}\n            className=\"gap-2\"\n          >\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\n            Sync Sentiment\n          </Button>\n        </div>\n      </div>\n\n      {/* Sentiment Overview */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\n        <StatCard\n          title=\"Consolidated Rating\"\n          value={stats.avgRating}\n          decimals={1}\n          suffix=\"/5.0\"\n          icon={Star}\n          trend={stats.avgRating >= 4.5 ? \"up\" : \"neutral\"}\n          iconColor=\"text-yellow-500\"\n        />\n        \n        <Card className=\"lg:col-span-3 border-border/50 relative overflow-hidden group\">\n          <div className=\"absolute top-0 right-0 p-8 opacity-[0.02] group-hover:scale-110 transition-transform duration-700\">\n            <ChartLineUp className=\"w-48 h-48 text-primary\" />\n          </div>\n          <CardContent className=\"p-6\">\n            <div className=\"space-y-3\">\n              {[5, 4, 3, 2, 1].map(rating => (\n                <div key={rating} className=\"flex items-center gap-4\">\n                  <div className=\"flex items-center gap-1.5 w-12 shrink-0\">\n                    <span className=\"text-xs font-black text-foreground w-3\">{rating}</span>\n                    <Star weight=\"fill\" className=\"w-3.5 h-3.5 text-yellow-500\" />\n                  </div>\n                  <div className=\"flex-1 h-2 bg-secondary rounded-full overflow-hidden border border-border/50 shadow-inner\">\n                    <motion.div \n                      initial={{ width: 0 }}\n                      animate={{ width: `${stats.totalReviews ? (stats.ratingCounts[rating as keyof typeof stats.ratingCounts] / stats.totalReviews) * 100 : 0}%` }}\n                      transition={{ duration: 1, delay: (5-rating) * 0.1 }}\n                      className={cn(\n                        \"h-full rounded-full\",\n                        rating >= 4 ? \"bg-emerald-500\" : rating === 3 ? \"bg-amber-500\" : \"bg-rose-500\"\n                      )}\n                    />\n                  </div>\n                  <span className=\"w-10 text-[10px] font-black text-muted-foreground text-right tabular-nums\">\n                    {stats.ratingCounts[rating as keyof typeof stats.ratingCounts]}\n                  </span>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Filters */}\n      <div className=\"flex flex-col sm:flex-row items-center gap-3 bg-secondary/30 p-2 rounded-[24px] border border-border/50 w-fit\">\n        <button \n          onClick={() => setFilter('')} \n          className={cn(\n            \"px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border\",\n            !filter \n              ? \"bg-card text-primary border-border/50 shadow-sm\" \n              : \"text-muted-foreground border-transparent hover:text-foreground\"\n          )}\n        >\n          All Feedback\n        </button>\n        <div className=\"flex gap-1\">\n          {[5, 4, 3, 2, 1].map(r => (\n            <button \n              key={r} \n              onClick={() => setFilter(r.toString())} \n              className={cn(\n                \"px-4 py-2.5 rounded-xl text-[10px] font-black transition-all border flex items-center gap-1.5\",\n                filter === r.toString()\n                  ? \"bg-card text-primary border-border/50 shadow-sm\"\n                  : \"text-muted-foreground border-transparent hover:text-foreground hover:bg-card/50\"\n              )}\n            >\n              {r} <Star weight=\"fill\" className=\"w-3 h-3 text-yellow-500\" />\n            </button>\n          ))}\n        </div>\n      </div>\n\n      {/* Reviews List */}\n      <div className=\"space-y-6\">\n        {loading ? (\n          <div className=\"py-32 flex flex-col items-center gap-4\">\n            <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em]\">Decoding Sentiment Matrix...</p>\n          </div>\n        ) : reviews.length === 0 ? (\n          <Card variant=\"ghost\" className=\"py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-4 opacity-40\">\n            <ChatCircleText weight=\"duotone\" className=\"w-16 h-16\" />\n            <p className=\"text-xs font-black uppercase tracking-widest\">No Client Nodes Detected</p>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            {reviews.map((review, i) => (\n              <motion.div\n                key={review.id}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: i * 0.05 }}\n              >\n                <Card className=\"h-full border-border/50 hover:border-primary/30 transition-all group overflow-hidden\">\n                  <div className=\"absolute top-0 right-0 p-6 opacity-0 group-hover:opacity-10 transition-opacity\">\n                    {review.rating >= 4 ? <Smiley className=\"w-12 h-12 text-emerald-500\" /> : <SmileySad className=\"w-12 h-12 text-rose-500\" />}\n                  </div>\n                  \n                  <CardHeader className=\"pb-4\">\n                    <div className=\"flex justify-between items-start\">\n                      <div className=\"flex items-center gap-4\">\n                        <div className=\"w-12 h-12 rounded-2xl bg-secondary/50 border border-border flex items-center justify-center text-primary group-hover:bg-primary/10 transition-all duration-500\">\n                          <User weight=\"duotone\" className=\"w-6 h-6\" />\n                        </div>\n                        <div>\n                          <p className=\"font-bold text-foreground tracking-tight\">{review.customer?.full_name || 'Incognito Node'}</p>\n                          <div className=\"flex items-center gap-3 mt-1\">\n                            {renderStars(review.rating)}\n                            <div className=\"w-1 h-1 rounded-full bg-border\" />\n                            <Badge variant=\"ghost\" size=\"sm\" className=\"text-[8px] font-black uppercase tracking-widest\">{review.platform}</Badge>\n                          </div>\n                        </div>\n                      </div>\n                      <span className=\"text-[10px] font-medium text-muted-foreground italic\">{formatDate(review.created_at)}</span>\n                    </div>\n                  </CardHeader>\n\n                  <CardContent className=\"space-y-6\">\n                    {review.review_text && (\n                      <p className=\"text-sm text-foreground/80 leading-relaxed font-medium bg-secondary/30 p-4 rounded-2xl border border-border/50\">\n                        \"{review.review_text}\"\n                      </p>\n                    )}\n                    \n                    {review.response_text ? (\n                      <div className=\"p-4 bg-primary/5 rounded-2xl border border-primary/10 relative\">\n                        <div className=\"absolute left-0 top-4 bottom-4 w-1 bg-primary/20 rounded-full\" />\n                        <div className=\"flex items-center gap-2 mb-2\">\n                          <Badge variant=\"default\" size=\"sm\" className=\"text-[8px] font-black uppercase\">Official Response</Badge>\n                        </div>\n                        <p className=\"text-sm text-foreground/70 font-medium italic pl-2\">\n                          {review.response_text}\n                        </p>\n                      </div>\n                    ) : responding === review.id ? (\n                      <motion.div \n                        initial={{ opacity: 0, scale: 0.95 }}\n                        animate={{ opacity: 1, scale: 1 }}\n                        className=\"space-y-4 pt-4 border-t border-border/50\"\n                      >\n                        <textarea\n                          value={response}\n                          onChange={e => setResponse(e.target.value)}\n                          className=\"w-full bg-secondary/50 border border-border rounded-2xl p-4 text-sm font-medium focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all min-h-[100px]\"\n                          placeholder=\"Input clinical response node...\"\n                        />\n                        <div className=\"flex gap-3\">\n                          <Button \n                            size=\"sm\"\n                            onClick={() => submitResponse(review.id)} \n                            className=\"bg-primary text-white shadow-premium flex-1\"\n                          >\n                            Transmit Response\n                          </Button>\n                          <Button \n                            size=\"sm\"\n                            variant=\"outline\"\n                            onClick={() => setResponding(null)}\n                          >\n                            Cancel\n                          </Button>\n                        </div>\n                      </motion.div>\n                    ) : (\n                      <Button \n                        variant=\"ghost\" \n                        size=\"sm\"\n                        onClick={() => setResponding(review.id)}\n                        className=\"text-[10px] font-black uppercase tracking-widest text-primary hover:bg-primary/5 gap-2\"\n                      >\n                        <ChatCircle weight=\"bold\" className=\"w-3.5 h-3.5\" />\n                        Initiate Response\n                      </Button>\n                    )}\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        )}\n      </div>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\settings\\integrations\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Declaration or statement expected.","line":455,"column":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { \n  Gear, \n  Phone, \n  EnvelopeSimple, \n  ChatCircle, \n  Check, \n  X, \n  Eye, \n  EyeSlash, \n  FloppyDisk, \n  ArrowsClockwise, \n  Pulse, \n  ShieldCheck, \n  Lightning, \n  Plus, \n  Info, \n  Translate, \n  Globe, \n  CaretRight,\n  Monitor,\n  IdentificationBadge,\n  Browser,\n  WebhookLogo,\n  Robot\n} from '@phosphor-icons/react';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { cn } from '@/lib/utils';\nimport { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\ninterface Integration {\n  id?: string;\n  platform: string;\n  is_active: boolean;\n  account_name?: string;\n  connected_at?: string;\n  settings?: Record<string, string>;\n}\n\nexport default function IntegrationsPage() {\n  const { goBack } = useBackNavigation();\n  const [integrations, setIntegrations] = useState<Integration[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState<string | null>(null);\n  const [showSecrets, setShowSecrets] = useState<Record<string, boolean>>({});\n\n  const [twilioConfig, setTwilioConfig] = useState({ accountSid: '', authToken: '', phoneNumber: '' });\n  const [sendgridConfig, setSendgridConfig] = useState({ apiKey: '', fromEmail: '', fromName: '' });\n  const [lineConfig, setLineConfig] = useState({ channelAccessToken: '', channelSecret: '' });\n\n  useEffect(() => { fetchIntegrations(); }, []);\n\n  const fetchIntegrations = async () => {\n    try {\n      const res = await fetch('/api/social/integrations');\n      const data = await res.json();\n      setIntegrations(data.integrations || []);\n\n      // Load existing configs\n      for (const int of data.integrations || []) {\n        if (int.platform === 'twilio' && int.settings) {\n          setTwilioConfig(int.settings as typeof twilioConfig);\n        }\n        if (int.platform === 'sendgrid' && int.settings) {\n          setSendgridConfig(int.settings as typeof sendgridConfig);\n        }\n        if (int.platform === 'line' && int.settings) {\n          setLineConfig(prev => ({ ...prev, channelSecret: (int.settings as { channelSecret?: string })?.channelSecret || '' }));\n        }\n      }\n    } catch (e) { console.error(e); }\n    setLoading(false);\n  };\n\n  const saveIntegration = async (platform: string, settings: Record<string, string>) => {\n    setSaving(platform);\n    try {\n      await fetch('/api/social/integrations', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          platform,\n          settings,\n          accountName: platform === 'twilio' ? settings.phoneNumber : platform === 'sendgrid' ? settings.fromEmail : 'LINE Bot'\n        })\n      });\n      fetchIntegrations();\n    } catch (e) { console.error(e); }\n    setSaving(null);\n  };\n\n  const disconnectIntegration = async (platform: string) => {\n    if (!confirm('เธขเธทเธเธขเธฑเธเธเธฒเธฃเธขเธเน€เธฅเธดเธเธเธฒเธฃเน€เธเธทเนเธญเธกเธ•เนเธญ?')) return;\n    await fetch(`/api/social/integrations?platform=${platform}`, { method: 'DELETE' });\n    fetchIntegrations();\n  };\n\n  const isConnected = (platform: string) => integrations.some(i => i.platform === platform && i.is_active);\n\n  const toggleSecret = (key: string) => setShowSecrets(prev => ({ ...prev, [key]: !prev[key] }));\n\n  const maskValue = (value: string) => value ? 'โ€ข'.repeat(Math.min(value.length, 20)) : '';\n\n  if (loading) {\n    return (\n      <div className=\"p-6 flex justify-center\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-indigo-600 border-t-transparent rounded-full\" />\n      </div>\n    );\n  }\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header Section */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <Pulse weight=\"duotone\" className=\"w-4 h-4\" />\n            Neural Link Gateway\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n          >\n            External <span className=\"text-primary\">Integrations</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Synchronizing clinical data streams with specialized third-party infrastructure.\n          </motion.p>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <Button \n            variant=\"outline\"\n            onClick={fetchIntegrations}\n            disabled={loading}\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\n          >\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\n            Sync Grid\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 xl:grid-cols-2 gap-8 px-2\">\n        {/* Twilio SMS Node */}\n        <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n          <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 relative overflow-hidden\">\n            <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n              <Phone className=\"w-48 h-48 text-primary\" />\n            </div>\n            <div className=\"flex justify-between items-start relative z-10\">\n              <div className=\"flex items-center gap-5\">\n                <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\n                  <Phone weight=\"duotone\" className=\"w-7 h-7\" />\n                </div>\n                <div>\n                  <h3 className=\"text-xl font-black uppercase tracking-tight\">Twilio SMS</h3>\n                  <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Short message transmission protocol</p>\n                </div>\n              </div>\n              <Badge variant={isConnected('twilio') ? 'success' : 'secondary'} size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3\">\n                {isConnected('twilio') ? 'LINKED' : 'UNLINKED'}\n              </Badge>\n            </div>\n          </CardHeader>\n          <CardContent className=\"p-8 space-y-8 relative z-10\">\n            <div className=\"space-y-6\">\n              <div className=\"space-y-2\">\n                <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Account SID</label>\n                <div className=\"relative group/input\">\n                  <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\n                  <input\n                    type=\"text\"\n                    value={twilioConfig.accountSid}\n                    onChange={e => setTwilioConfig({ ...twilioConfig, accountSid: e.target.value })}\n                    className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-mono shadow-inner relative z-10\"\n                    placeholder=\"ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\"\n                  />\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Auth Token Node</label>\n                <div className=\"relative group/input\">\n                  <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\n                  <input\n                    type={showSecrets.twilioAuth ? 'text' : 'password'}\n                    value={twilioConfig.authToken}\n                    onChange={e => setTwilioConfig({ ...twilioConfig, authToken: e.target.value })}\n                    className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 pr-14 text-sm text-foreground focus:border-primary outline-none transition-all font-mono shadow-inner relative z-10\"\n                    placeholder=\"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\"\n                  />\n                  <button onClick={() => toggleSecret('twilioAuth')} className=\"absolute right-6 top-1/2 -translate-y-1/2 text-muted-foreground/40 hover:text-primary transition-colors z-20\">\n                    {showSecrets.twilioAuth ? <EyeSlash weight=\"bold\" className=\"w-5 h-5\" /> : <Eye weight=\"bold\" className=\"w-5 h-5\" />}\n                  </button>\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Transmission Identity (Phone)</label>\n                <div className=\"relative group/input\">\n                  <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\n                  <input\n                    type=\"text\"\n                    value={twilioConfig.phoneNumber}\n                    onChange={e => setTwilioConfig({ ...twilioConfig, phoneNumber: e.target.value })}\n                    className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold tabular-nums relative z-10\"\n                    placeholder=\"+1234567890\"\n                  />\n                </div>\n              </div>\n            </div>\n            <div className=\"flex gap-4 pt-4 border-t border-border/30\">\n              <Button\n                onClick={() => saveIntegration('twilio', twilioConfig)}\n                disabled={saving === 'twilio' || !twilioConfig.accountSid}\n                className=\"flex-1 py-7 rounded-[24px] font-black uppercase tracking-widest text-[10px] shadow-premium gap-3\"\n              >\n                {saving === 'twilio' ? <SpinnerGap className=\"w-4 h-4 animate-spin\" /> : <FloppyDisk weight=\"bold\" className=\"w-4 h-4\" />}\n                {saving === 'twilio' ? 'SYNCING...' : 'COMMIT LINK'}\n              </Button>\n              {isConnected('twilio') && (\n                <Button \n                  variant=\"outline\"\n                  onClick={() => disconnectIntegration('twilio')} \n                  className=\"px-8 py-7 rounded-[24px] font-black uppercase tracking-widest text-[10px] border-rose-500/20 text-rose-500 hover:bg-rose-500/5 hover:border-rose-500/30\"\n                >\n                  ABORT\n                </Button>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* SendGrid Email Node */}\n        <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n          <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 relative overflow-hidden\">\n            <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n              <EnvelopeSimple className=\"w-48 h-48 text-primary\" />\n            </div>\n            <div className=\"flex justify-between items-start relative z-10\">\n              <div className=\"flex items-center gap-5\">\n                <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\n                  <EnvelopeSimple weight=\"duotone\" className=\"w-7 h-7\" />\n                </div>\n                <div>\n                  <h3 className=\"text-xl font-black uppercase tracking-tight\">SendGrid Email</h3>\n                  <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">SMTP & marketing dispatch protocol</p>\n                </div>\n              </div>\n              <Badge variant={isConnected('sendgrid') ? 'success' : 'secondary'} size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3\">\n                {isConnected('sendgrid') ? 'LINKED' : 'UNLINKED'}\n              </Badge>\n            </div>\n          </CardHeader>\n          <CardContent className=\"p-8 space-y-8 relative z-10\">\n            <div className=\"space-y-6\">\n              <div className=\"space-y-2\">\n                <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">API Key Node</label>\n                <div className=\"relative group/input\">\n                  <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\n                  <input\n                    type={showSecrets.sendgridKey ? 'text' : 'password'}\n                    value={sendgridConfig.apiKey}\n                    onChange={e => setSendgridConfig({ ...sendgridConfig, apiKey: e.target.value })}\n                    className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 pr-14 text-sm text-foreground focus:border-primary outline-none transition-all font-mono shadow-inner relative z-10\"\n                    placeholder=\"SG.xxxxxxxxxxxxxxxxxxxxxxxx\"\n                  />\n                  <button onClick={() => toggleSecret('sendgridKey')} className=\"absolute right-6 top-1/2 -translate-y-1/2 text-muted-foreground/40 hover:text-primary transition-colors z-20\">\n                    {showSecrets.sendgridKey ? <EyeSlash weight=\"bold\" className=\"w-5 h-5\" /> : <Eye weight=\"bold\" className=\"w-5 h-5\" />}\n                  </button>\n                </div>\n              </div>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div className=\"space-y-2\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Transmission Origin (Email)</label>\n                  <input\n                    type=\"email\"\n                    value={sendgridConfig.fromEmail}\n                    onChange={e => setSendgridConfig({ ...sendgridConfig, fromEmail: e.target.value })}\n                    className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-medium italic shadow-inner\"\n                    placeholder=\"noreply@clinic.network\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Sender Designation</label>\n                  <input\n                    type=\"text\"\n                    value={sendgridConfig.fromName}\n                    onChange={e => setSendgridConfig({ ...sendgridConfig, fromName: e.target.value })}\n                    className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold uppercase text-xs tracking-widest shadow-inner\"\n                    placeholder=\"BN-AURA CLINIC\"\n                  />\n                </div>\n              </div>\n            </div>\n            <div className=\"flex gap-4 pt-4 border-t border-border/30\">\n              <Button\n                onClick={() => saveIntegration('sendgrid', sendgridConfig)}\n                disabled={saving === 'sendgrid' || !sendgridConfig.apiKey}\n                className=\"flex-1 py-7 rounded-[24px] font-black uppercase tracking-widest text-[10px] shadow-premium gap-3\"\n              >\n                {saving === 'sendgrid' ? <SpinnerGap className=\"w-4 h-4 animate-spin\" /> : <FloppyDisk weight=\"bold\" className=\"w-4 h-4\" />}\n                {saving === 'sendgrid' ? 'SYNCING...' : 'COMMIT LINK'}\n              </Button>\n              {isConnected('sendgrid') && (\n                <Button \n                  variant=\"outline\"\n                  onClick={() => disconnectIntegration('sendgrid')} \n                  className=\"px-8 py-7 rounded-[24px] font-black uppercase tracking-widest text-[10px] border-rose-500/20 text-rose-500 hover:bg-rose-500/5 hover:border-rose-500/30\"\n                >\n                  ABORT\n                </Button>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* LINE OA Node */}\n        <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n          <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 relative overflow-hidden\">\n            <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n              <ChatCircle className=\"w-48 h-48 text-primary\" />\n            </div>\n            <div className=\"flex justify-between items-start relative z-10\">\n              <div className=\"flex items-center gap-5\">\n                <div className=\"w-14 h-14 rounded-2xl bg-emerald-500/10 flex items-center justify-center text-emerald-500 border border-emerald-500/20 shadow-sm\">\n                  <ChatCircle weight=\"duotone\" className=\"w-7 h-7\" />\n                </div>\n                <div>\n                  <h3 className=\"text-xl font-black uppercase tracking-tight\">LINE Official Account</h3>\n                  <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Social chat & reservation uplink</p>\n                </div>\n              </div>\n              <Badge variant={isConnected('line') ? 'success' : 'secondary'} size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3\">\n                {isConnected('line') ? 'LINKED' : 'UNLINKED'}\n              </Badge>\n            </div>\n          </CardHeader>\n          <CardContent className=\"p-8 space-y-8 relative z-10\">\n            <div className=\"space-y-6\">\n              <div className=\"space-y-2\">\n                <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Channel Access Token</label>\n                <div className=\"relative group/input\">\n                  <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\n                  <input\n                    type={showSecrets.lineToken ? 'text' : 'password'}\n                    value={lineConfig.channelAccessToken}\n                    onChange={e => setLineConfig({ ...lineConfig, channelAccessToken: e.target.value })}\n                    className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 pr-14 text-sm text-foreground focus:border-primary outline-none transition-all font-mono shadow-inner relative z-10\"\n                    placeholder=\"Long-lived channel access token\"\n                  />\n                  <button onClick={() => toggleSecret('lineToken')} className=\"absolute right-6 top-1/2 -translate-y-1/2 text-muted-foreground/40 hover:text-primary transition-colors z-20\">\n                    {showSecrets.lineToken ? <EyeSlash weight=\"bold\" className=\"w-5 h-5\" /> : <Eye weight=\"bold\" className=\"w-5 h-5\" />}\n                  </button>\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Channel Secret Node</label>\n                <div className=\"relative group/input\">\n                  <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\n                  <input\n                    type={showSecrets.lineSecret ? 'text' : 'password'}\n                    value={lineConfig.channelSecret}\n                    onChange={e => setLineConfig({ ...lineConfig, channelSecret: e.target.value })}\n                    className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 pr-14 text-sm text-foreground focus:border-primary outline-none transition-all font-mono shadow-inner relative z-10\"\n                    placeholder=\"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\"\n                  />\n                  <button onClick={() => toggleSecret('lineSecret')} className=\"absolute right-6 top-1/2 -translate-y-1/2 text-muted-foreground/40 hover:text-primary transition-colors z-20\">\n                    {showSecrets.lineSecret ? <EyeSlash weight=\"bold\" className=\"w-5 h-5\" /> : <Eye weight=\"bold\" className=\"w-5 h-5\" />}\n                  </button>\n                </div>\n              </div>\n              <div className=\"p-5 bg-primary/5 rounded-[28px] border border-primary/10 space-y-3 shadow-inner\">\n                <div className=\"flex items-center gap-2\">\n                  <WebhookLogo weight=\"bold\" className=\"w-4 h-4 text-primary\" />\n                  <span className=\"text-[10px] font-black text-primary uppercase tracking-widest\">Webhook Payload Gateway</span>\n                </div>\n                <div className=\"flex items-center justify-between gap-4\">\n                  <code className=\"text-[10px] text-muted-foreground font-mono truncate\">https://bn-aura.vercel.app/api/webhooks/line</code>\n                  <Button variant=\"ghost\" size=\"sm\" className=\"h-8 w-8 p-0 rounded-lg hover:bg-primary/10 text-primary\">\n                    <Plus weight=\"bold\" className=\"w-3 h-3\" />\n                  </Button>\n                </div>\n              </div>\n            </div>\n            <div className=\"flex gap-4 pt-4 border-t border-border/30\">\n              <Button\n                onClick={() => saveIntegration('line', { ...lineConfig, accessToken: lineConfig.channelAccessToken })}\n                disabled={saving === 'line' || !lineConfig.channelAccessToken}\n                className=\"flex-1 py-7 rounded-[24px] font-black uppercase tracking-widest text-[10px] shadow-premium gap-3\"\n              >\n                {saving === 'line' ? <SpinnerGap className=\"w-4 h-4 animate-spin\" /> : <FloppyDisk weight=\"bold\" className=\"w-4 h-4\" />}\n                {saving === 'line' ? 'SYNCING...' : 'COMMIT LINK'}\n              </Button>\n              {isConnected('line') && (\n                <Button \n                  variant=\"outline\"\n                  onClick={() => disconnectIntegration('line')} \n                  className=\"px-8 py-7 rounded-[24px] font-black uppercase tracking-widest text-[10px] border-rose-500/20 text-rose-500 hover:bg-rose-500/5 hover:border-rose-500/30\"\n                >\n                  ABORT\n                </Button>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Global Synchronization Info */}\n        <div className=\"xl:col-span-2\">\n          <Card className=\"p-8 rounded-[40px] border-primary/10 bg-primary/[0.02] flex flex-col md:flex-row items-center gap-8 relative overflow-hidden group\">\n            <div className=\"absolute -bottom-12 -right-12 w-48 h-48 bg-primary/5 blur-[60px] rounded-full group-hover:bg-primary/10 transition-all duration-700\" />\n            <div className=\"w-20 h-20 rounded-[32px] bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner group-hover:scale-110 transition-transform\">\n              <Lightning weight=\"duotone\" className=\"w-10 h-10\" />\n            </div>\n            <div className=\"flex-1 space-y-2 relative z-10 text-center md:text-left\">\n              <h4 className=\"text-xl font-black text-foreground uppercase tracking-tight\">System Link Protocol v1.0</h4>\n              <p className=\"text-sm text-muted-foreground font-medium italic leading-relaxed max-w-2xl\">\n                External integrations enable autonomous clinical notifications, automated patient engagement, and high-fidelity synchronization with regional social networks. Protocol modifications propagate globally across clinical terminal nodes.\n              </p>\n            </div>\n            <div className=\"relative z-10 shrink-0\">\n              <Badge variant=\"success\" size=\"sm\" className=\"font-black text-[10px] tracking-[0.2em] px-6 py-2 rounded-full shadow-premium\">\n                NETWORK_READY\n              </Badge>\n            </div>\n          </Card>\n        </div>\n      </div>\n    </motion.div>\n  );\n}\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\settings\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[326,342],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CalendarDots' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":15,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CalendarDots"},"fix":{"range":[374,391],"text":""},"desc":"Remove unused variable \"CalendarDots\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ListChecks' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ListChecks"},"fix":{"range":[446,461],"text":""},"desc":"Remove unused variable \"ListChecks\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Monitor' is defined but never used.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Monitor"},"fix":{"range":[461,473],"text":""},"desc":"Remove unused variable \"Monitor\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ShieldCheck' is defined but never used.","line":25,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ShieldCheck"},"fix":{"range":[473,489],"text":""},"desc":"Remove unused variable \"ShieldCheck\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pulse' is defined but never used.","line":26,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pulse"},"fix":{"range":[489,499],"text":""},"desc":"Remove unused variable \"Pulse\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Icon' is defined but never used.","line":28,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Icon"},"fix":{"range":[519,528],"text":""},"desc":"Remove unused variable \"Icon\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":37,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[834,837],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[834,837],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3243,3246],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3243,3246],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":120,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3549,3552],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3549,3552],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":121,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3585,3588],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3585,3588],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":127,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3706,3709],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3706,3709],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":128,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":128,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3742,3745],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3742,3745],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":147,"column":6,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":147,"endColumn":12},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Breadcrumb' is not defined.","line":152,"column":8,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":152,"endColumn":18},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":157,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":157,"endColumn":18},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":165,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":165,"endColumn":18},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":173,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":173,"endColumn":18},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":183,"column":10,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":183,"endColumn":16},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":207,"column":10,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":207,"endColumn":16},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":229,"column":22,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":229,"endColumn":28},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'AnimatePresence' is not defined.","line":253,"column":12,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":253,"endColumn":27},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":254,"column":14,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":254,"endColumn":20},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":281,"column":26,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":281,"endColumn":32},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'EnvelopeSimple' is not defined.","line":328,"column":28,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":328,"endColumn":42},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":357,"column":28,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":357,"endColumn":34},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":437,"column":28,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":437,"endColumn":34},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'motion' is not defined.","line":508,"column":28,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":508,"endColumn":34}],"suppressedMessages":[],"errorCount":15,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { cn } from '@/lib/utils';\r\nimport { \r\n  Gear, \r\n  Buildings, \r\n  Bell, \r\n  Shield, \r\n  CreditCard, \r\n  Palette, \r\n  Globe, \r\n  CaretRight,\r\n  UploadSimple,\r\n  FloppyDisk,\r\n  CalendarDots,\r\n  SpinnerGap,\r\n  CheckCircle,\r\n  Sparkle,\r\n  TrendUp,\r\n  ListChecks,\r\n  Monitor,\r\n  ShieldCheck,\r\n  Pulse,\r\n  ArrowsClockwise,\r\n  Icon,\r\n  Crown,\r\n  IdentificationCard\r\n} from '@phosphor-icons/react';\r\n\r\nexport default function SettingsPage() {\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [success, setSuccess] = useState(false);\r\n  const [clinicData, setClinicData] = useState<any>(null);\r\n  const [activeSection, setActiveSection] = useState('general');\r\n  const [upgrading, setUpgrading] = useState<string | null>(null);\r\n\r\n  const sections = [\r\n    { id: 'general', label: 'Clinic Information', icon: Buildings },\r\n    { id: 'appearance', label: 'Brand & Appearance', icon: Palette },\r\n    { id: 'notifications', label: 'Notifications', icon: Bell },\r\n    { id: 'security', label: 'Security & RLS', icon: Shield },\r\n    { id: 'billing', label: 'Subscription & Billing', icon: CreditCard },\r\n    { id: 'loyalty', label: 'Loyalty Program', icon: Sparkle },\r\n    { id: 'i18n', label: 'Translate', icon: Globe },\r\n  ];\r\n\r\n  const currentPlan = useMemo(() => {\r\n    return QUOTA_PLANS.find(p => p.id === clinicData?.subscription_tier) || QUOTA_PLANS[0];\r\n  }, [clinicData?.subscription_tier]);\r\n\r\n  const fetchSettings = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch('/api/clinic/settings');\r\n      const result = await res.json();\r\n      if (result.success) {\r\n        setClinicData(result.data);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching settings:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchSettings();\r\n  }, [fetchSettings]);\r\n\r\n  const handleSave = async () => {\r\n    setSaving(true);\r\n    setSuccess(false);\r\n    try {\r\n      const res = await fetch('/api/clinic/settings', {\r\n        method: 'PATCH',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          display_name: clinicData.display_name,\r\n          metadata: clinicData.metadata\r\n        })\r\n      });\r\n      const result = await res.json();\r\n      if (result.success) {\r\n        setSuccess(true);\r\n        setTimeout(() => setSuccess(false), 3000);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error saving settings:', err);\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleUpgrade = async (planId: string) => {\r\n    if (planId === clinicData?.subscription_tier) return;\r\n    \r\n    setUpgrading(planId);\r\n    try {\r\n      const res = await fetch('/api/clinic/subscription/upgrade', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ planId })\r\n      });\r\n      const result = await res.json();\r\n      if (result.success) {\r\n        setClinicData((prev: any) => ({ ...prev, subscription_tier: planId }));\r\n        alert(`Successfully upgraded to ${result.data.plan.name}`);\r\n      }\r\n    } catch (err) {\r\n      console.error('Upgrade error:', err);\r\n    } finally {\r\n      setUpgrading(null);\r\n    }\r\n  };\r\n\r\n  const updateClinicField = (field: string, value: any) => {\r\n    setClinicData((prev: any) => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n  };\r\n\r\n  const updateMetadataField = (field: string, value: any) => {\r\n    setClinicData((prev: any) => ({\r\n      ...prev,\r\n      metadata: {\r\n        ...(prev.metadata || {}),\r\n        [field]: value\r\n      }\r\n    }));\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"h-[80vh] flex flex-col items-center justify-center space-y-6\">\r\n        <SpinnerGap className=\"w-12 h-12 text-primary animate-spin\" />\r\n        <p className=\"text-sm font-black uppercase tracking-[0.3em] text-muted-foreground animate-pulse\">Syncing Configuration Cluster...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"max-w-6xl mx-auto space-y-10 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Gear weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Workspace Configuration Hub\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Clinic <span className=\"text-primary\">Settings</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating clinical orchestration, brand identity, and security protocol matrices.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <motion.div \r\n          initial={{ opacity: 0, scale: 0.9 }}\r\n          animate={{ opacity: 1, scale: 1 }}\r\n          transition={{ delay: 0.3 }}\r\n        >\r\n          <Button \r\n            onClick={handleSave}\r\n            disabled={saving}\r\n            className=\"gap-3 shadow-premium px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest group\"\r\n          >\r\n            {saving ? (\r\n              <SpinnerGap weight=\"bold\" className=\"w-4 h-4 animate-spin\" />\r\n            ) : success ? (\r\n              <CheckCircle weight=\"bold\" className=\"w-4 h-4 text-emerald-400\" />\r\n            ) : (\r\n              <FloppyDisk weight=\"bold\" className=\"w-4 h-4 group-hover:scale-110 transition-transform\" />\r\n            )}\r\n            <span>{saving ? 'SYNCHRONIZING...' : success ? 'SETTLED' : 'COMMIT CHANGES'}</span>\r\n          </Button>\r\n        </motion.div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-10 px-2\">\r\n        {/* Navigation Sidebar Hub */}\r\n        <motion.div \r\n          initial={{ opacity: 0, x: -20 }}\r\n          animate={{ opacity: 1, x: 0 }}\r\n          transition={{ delay: 0.3 }}\r\n          className=\"lg:col-span-1 space-y-3\"\r\n        >\r\n          <Card className=\"border-border/50 shadow-sm p-2 rounded-[32px] bg-secondary/10 backdrop-blur-md\">\r\n            <div className=\"space-y-1\">\r\n              {sections.map((section) => (\r\n                <button\r\n                  key={section.id}\r\n                  onClick={() => setActiveSection(section.id)}\r\n                  className={cn(\r\n                    \"w-full flex items-center gap-4 px-6 py-4 rounded-2xl transition-all text-[10px] font-black uppercase tracking-widest relative group\",\r\n                    activeSection === section.id \r\n                      ? \"bg-primary text-primary-foreground shadow-premium\" \r\n                      : \"text-muted-foreground hover:bg-primary/5 hover:text-foreground\"\r\n                  )}\r\n                >\r\n                  <section.icon weight={activeSection === section.id ? \"fill\" : \"duotone\"} className={cn(\"w-4 h-4 transition-transform group-hover:scale-110\", activeSection === section.id ? \"text-primary-foreground\" : \"text-primary/60\")} />\r\n                  <span>{section.label}</span>\r\n                  {activeSection === section.id && (\r\n                    <motion.div \r\n                      layoutId=\"active-nav-glow\"\r\n                      className=\"absolute inset-0 bg-primary/20 blur-xl rounded-2xl z-[-1]\"\r\n                    />\r\n                  )}\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </Card>\r\n\r\n          <Card className=\"p-6 rounded-[32px] border-primary/10 bg-primary/[0.02] mt-6 group overflow-hidden relative shadow-inner\">\r\n            <div className=\"absolute -bottom-12 -right-12 w-32 h-32 bg-primary/5 blur-[50px] rounded-full group-hover:bg-primary/10 transition-all duration-700\" />\r\n            <div className=\"flex items-center gap-3 relative z-10\">\r\n              <Sparkle weight=\"duotone\" className=\"w-5 h-5 text-primary group-hover:scale-110 transition-transform\" />\r\n              <h4 className=\"text-[10px] font-black text-primary uppercase tracking-[0.3em]\">Protocol Intel</h4>\r\n            </div>\r\n            <p className=\"text-[11px] text-muted-foreground italic font-medium leading-relaxed relative z-10 opacity-80 mt-2\">\r\n              Clinical configuration parameters are synchronized across the global cluster matrix in real-time.\r\n            </p>\r\n          </Card>\r\n        </motion.div>\r\n\r\n        {/* Content Matrix Area */}\r\n        <div className=\"lg:col-span-3\">\r\n          <AnimatePresence mode=\"wait\">\r\n            <motion.div\r\n              key={activeSection}\r\n              initial={{ opacity: 0, y: 20 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              exit={{ opacity: 0, scale: 0.98 }}\r\n              transition={{ duration: 0.3 }}\r\n            >\r\n              {activeSection === 'general' && (\r\n                <Card className=\"rounded-[48px] border-border/50 shadow-premium overflow-hidden group\">\r\n                  <CardHeader className=\"p-8 md:p-10 border-b border-border/50 bg-secondary/30 relative\">\r\n                    <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                      <Buildings weight=\"fill\" className=\"w-64 h-64 text-primary\" />\r\n                    </div>\r\n                    <div className=\"flex items-center gap-5 relative z-10\">\r\n                      <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm shadow-inner group-hover:bg-primary/20 transition-all\">\r\n                        <Buildings weight=\"duotone\" className=\"w-7 h-7\" />\r\n                      </div>\r\n                      <div>\r\n                        <CardTitle className=\"text-2xl font-black uppercase tracking-tight\">Clinic Information</CardTitle>\r\n                        <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] mt-1\">Foundational identity nodes</p>\r\n                      </div>\r\n                    </div>\r\n                  </CardHeader>\r\n\r\n                  <CardContent className=\"p-8 md:p-12 space-y-10 relative z-10\">\r\n                    <div className=\"flex flex-col md:flex-row md:items-center gap-10\">\r\n                      <div className=\"relative group/logo flex-shrink-0\">\r\n                        <motion.div \r\n                          whileHover={{ scale: 1.05 }}\r\n                          className=\"w-32 h-28 rounded-[40px] bg-secondary/30 border-2 border-dashed border-border flex flex-col items-center justify-center text-muted-foreground hover:border-primary/50 hover:text-primary transition-all cursor-pointer relative overflow-hidden shadow-inner backdrop-blur-md\"\r\n                        >\r\n                          <UploadSimple weight=\"bold\" className=\"w-7 h-7 mb-2\" />\r\n                          <span className=\"text-[9px] font-black uppercase tracking-[0.2em]\">Upload Node</span>\r\n                        </motion.div>\r\n                      </div>\r\n                      <div className=\"space-y-2\">\r\n                        <h3 className=\"text-xl font-black text-foreground uppercase tracking-tight\">Identity Visual node</h3>\r\n                        <p className=\"text-sm text-muted-foreground font-medium italic leading-relaxed opacity-80 max-w-sm\">\r\n                          Clinical trademark synchronization. Optimized for 512x512px with alpha transparency.\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10 pt-4\">\r\n                      <div className=\"space-y-3\">\r\n                        <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Clinical Designation *</label>\r\n                        <div className=\"relative group/input\">\r\n                          <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-2xl\" />\r\n                          <Buildings weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\r\n                          <input \r\n                            type=\"text\" \r\n                            value={clinicData?.display_name?.th || ''}\r\n                            onChange={(e) => updateClinicField('display_name', { ...clinicData.display_name, th: e.target.value })}\r\n                            className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary outline-none transition-all font-bold shadow-inner relative z-10\"\r\n                            placeholder=\"Clinic Name (THA)\"\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"space-y-3\">\r\n                        <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Registry Code</label>\r\n                        <div className=\"relative group/input\">\r\n                          <IdentificationCard weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\r\n                          <input \r\n                            type=\"text\" \r\n                            value={clinicData?.clinic_code || ''}\r\n                            readOnly\r\n                            className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground/40 focus:outline-none outline-none transition-all font-mono shadow-inner relative z-10 cursor-not-allowed italic\"\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"space-y-3 md:col-span-2\">\r\n                        <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Secure Contact Link *</label>\r\n                        <div className=\"relative group/input\">\r\n                          <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-2xl\" />\r\n                          <EnvelopeSimple weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\r\n                          <input \r\n                            type=\"email\" \r\n                            value={clinicData?.metadata?.email || ''}\r\n                            onChange={(e) => updateMetadataField('email', e.target.value)}\r\n                            className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary outline-none transition-all font-bold shadow-inner relative z-10\"\r\n                            placeholder=\"contact@clinical.network\"\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"pt-10 border-t border-border/30\">\r\n                      <div className=\"flex items-center justify-between p-8 bg-secondary/20 rounded-[32px] border border-border/50 group/toggle hover:border-primary/20 transition-all shadow-inner relative overflow-hidden\">\r\n                        <div className=\"absolute top-0 right-0 p-6 opacity-[0.02] group-hover/toggle:scale-110 transition-transform\">\r\n                          <Globe weight=\"fill\" className=\"w-32 h-32 text-primary\" />\r\n                        </div>\r\n                        <div className=\"space-y-1 relative z-10\">\r\n                          <h4 className=\"text-sm font-black text-foreground uppercase tracking-widest\">Global Visibility node</h4>\r\n                          <p className=\"text-[10px] text-muted-foreground font-medium italic opacity-60\">Authorize external protocol discovery and neural booking integration.</p>\r\n                        </div>\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => updateClinicField('is_active', !clinicData.is_active)}\r\n                          className={cn(\r\n                            \"relative w-14 h-8 rounded-full transition-all duration-500 shadow-inner overflow-hidden z-10\",\r\n                            clinicData?.is_active ? \"bg-primary shadow-glow-sm\" : \"bg-card border border-border/50\"\r\n                          )}\r\n                        >\r\n                          <motion.div\r\n                            className=\"absolute top-1 w-6 h-6 rounded-xl bg-white shadow-lg\"\r\n                            animate={{ left: clinicData?.is_active ? 28 : 4 }}\r\n                            transition={{ type: \"spring\", stiffness: 500, damping: 30 }}\r\n                          />\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              )}\r\n\r\n              {activeSection === 'loyalty' && (\r\n                <Card className=\"rounded-[48px] border-border/50 shadow-premium overflow-hidden group\">\r\n                  <CardHeader className=\"p-8 md:p-10 border-b border-border/50 bg-secondary/30 relative\">\r\n                    <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                      <Sparkle weight=\"fill\" className=\"w-64 h-64 text-primary\" />\r\n                    </div>\r\n                    <div className=\"flex items-center gap-5 relative z-10\">\r\n                      <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm shadow-inner group-hover:bg-primary/20 transition-all\">\r\n                        <Sparkle weight=\"duotone\" className=\"w-7 h-7\" />\r\n                      </div>\r\n                      <div>\r\n                        <CardTitle className=\"text-2xl font-black uppercase tracking-tight\">Loyalty Engine</CardTitle>\r\n                        <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] mt-1\">Configuring rewards & customer retention nodes</p>\r\n                      </div>\r\n                    </div>\r\n                  </CardHeader>\r\n\r\n                  <CardContent className=\"p-8 md:p-12 space-y-10 relative z-10\">\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10\">\r\n                      <div className=\"space-y-3\">\r\n                        <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1 flex items-center gap-2\">\r\n                          <TrendUp weight=\"bold\" className=\"w-3.5 h-3.5 text-primary/60\" /> Earning Velocity Protocol\r\n                        </label>\r\n                        <div className=\"relative group/input\">\r\n                          <div className=\"absolute left-5 top-1/2 -translate-y-1/2 text-[10px] font-black text-muted-foreground/40 uppercase tracking-widest z-10\">1 POINT /</div>\r\n                          <input \r\n                            type=\"number\" \r\n                            value={clinicData?.metadata?.loyalty?.earn_rate || 100}\r\n                            onChange={(e) => updateMetadataField('loyalty', { ...clinicData.metadata?.loyalty, earn_rate: parseInt(e.target.value) })}\r\n                            className=\"w-full pl-24 pr-16 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary outline-none transition-all font-black tabular-nums shadow-inner relative z-10\"\r\n                          />\r\n                          <div className=\"absolute right-5 top-1/2 -translate-y-1/2 text-[10px] font-black text-primary uppercase tracking-widest z-10\">THB</div>\r\n                        </div>\r\n                        <p className=\"text-[9px] text-muted-foreground italic opacity-60 ml-1 leading-relaxed\">System Standard: 1 point for every 100 THB established yield.</p>\r\n                      </div>\r\n\r\n                      <div className=\"space-y-3\">\r\n                        <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1 flex items-center gap-2\">\r\n                          <CreditCard weight=\"bold\" className=\"w-3.5 h-3.5 text-primary/60\" /> Redemption Ratio matrix\r\n                        </label>\r\n                        <div className=\"relative group/input\">\r\n                          <div className=\"absolute left-5 top-1/2 -translate-y-1/2 text-[10px] font-black text-muted-foreground/40 uppercase tracking-widest z-10\">1 POINT =</div>\r\n                          <input \r\n                            type=\"number\" \r\n                            value={clinicData?.metadata?.loyalty?.burn_rate || 1}\r\n                            onChange={(e) => updateMetadataField('loyalty', { ...clinicData.metadata?.loyalty, burn_rate: parseInt(e.target.value) })}\r\n                            className=\"w-full pl-24 pr-16 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary outline-none transition-all font-black tabular-nums shadow-inner relative z-10\"\r\n                          />\r\n                          <div className=\"absolute right-5 top-1/2 -translate-y-1/2 text-[10px] font-black text-primary uppercase tracking-widest z-10\">THB</div>\r\n                        </div>\r\n                        <p className=\"text-[9px] text-muted-foreground italic opacity-60 ml-1 leading-relaxed\">System Standard: 1 point equals 1 THB commercial discount.</p>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"pt-6 border-t border-border/30\">\r\n                      <div className=\"flex items-center justify-between p-8 bg-emerald-500/5 rounded-[32px] border border-emerald-500/10 group/toggle hover:border-emerald-500/20 transition-all shadow-inner\">\r\n                        <div className=\"space-y-1 relative z-10\">\r\n                          <h4 className=\"text-sm font-black text-foreground uppercase tracking-widest\">Automatic Point Injection</h4>\r\n                          <p className=\"text-[10px] text-muted-foreground font-medium italic opacity-60\">Authorize POS terminal to automatically award points upon node validation.</p>\r\n                        </div>\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => updateMetadataField('loyalty', { ...clinicData.metadata?.loyalty, auto_award: !clinicData.metadata?.loyalty?.auto_award })}\r\n                          className={cn(\r\n                            \"relative w-14 h-8 rounded-full transition-all duration-500 shadow-inner overflow-hidden\",\r\n                            clinicData?.metadata?.loyalty?.auto_award ? \"bg-emerald-500 shadow-glow-sm\" : \"bg-card border border-border/50\"\r\n                          )}\r\n                        >\r\n                          <motion.div\r\n                            className=\"absolute top-1 w-6 h-6 rounded-xl bg-white shadow-lg\"\r\n                            animate={{ left: clinicData?.metadata?.loyalty?.auto_award ? 28 : 4 }}\r\n                            transition={{ type: \"spring\", stiffness: 500, damping: 30 }}\r\n                          />\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              )}\r\n\r\n              {activeSection === 'billing' && (\r\n                <div className=\"space-y-10\">\r\n                  {/* Current Plan Overview Node */}\r\n                  <Card className=\"rounded-[48px] border-border/50 shadow-premium overflow-hidden group\">\r\n                    <CardContent className=\"p-10 md:p-12 relative overflow-hidden\">\r\n                      <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                        <Crown weight=\"fill\" className=\"w-64 h-64 text-primary\" />\r\n                      </div>\r\n                      \r\n                      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-10 relative z-10\">\r\n                        <div className=\"space-y-8\">\r\n                          <div className=\"flex items-center gap-4\">\r\n                            <Badge variant=\"ghost\" className=\"bg-primary/10 text-primary border-none font-black text-[10px] tracking-[0.2em] px-5 py-2 rounded-full uppercase shadow-sm\">\r\n                              ACTIVE_TIER: {currentPlan?.name.toUpperCase()}\r\n                            </Badge>\r\n                            <div className=\"flex items-center gap-2.5 px-4 py-1.5 bg-emerald-500/5 border border-emerald-500/10 rounded-full\">\r\n                              <div className={cn(\r\n                                \"w-1.5 h-1.5 rounded-full animate-pulse shadow-[0_0_8px_rgba(52,211,153,0.6)]\",\r\n                                clinicData?.is_active ? \"bg-emerald-500\" : \"bg-rose-500\"\r\n                              )} />\r\n                              <span className=\"text-[9px] text-emerald-500 font-black uppercase tracking-widest\">{clinicData?.is_active ? 'NOMINAL' : 'OFFLINE'}</span>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"space-y-3\">\r\n                            <h3 className=\"text-3xl font-black text-foreground uppercase tracking-tight\">Computational Subscription</h3>\r\n                            <p className=\"text-sm text-muted-foreground font-medium italic leading-relaxed max-w-lg opacity-80\">\r\n                              Your clinical node is operating on the <span className=\"text-primary font-black\">{currentPlan?.name.toUpperCase()}</span> infrastructure. \r\n                              Next cycle adjustment established for the temporal reset.\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"text-right p-8 bg-secondary/30 rounded-[40px] border border-border/50 shadow-inner min-w-[240px]\">\r\n                          <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mb-2 opacity-60\">Cycle Investment</p>\r\n                          <div className=\"flex items-center justify-end gap-2\">\r\n                            <span className=\"text-4xl font-black text-foreground tabular-nums tracking-tighter\">เธฟ{currentPlan?.monthlyPrice.toLocaleString()}</span>\r\n                            <span className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest mt-3\">/ Mo</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n\r\n                  {/* Plan Deployment Grid */}\r\n                  <div className=\"space-y-8\">\r\n                    <div className=\"flex items-center justify-between px-4\">\r\n                      <div className=\"flex items-center gap-3\">\r\n                        <div className=\"w-1.5 h-1.5 rounded-full bg-primary animate-pulse shadow-[0_0_10px_rgba(var(--primary),0.6)]\" />\r\n                        <h3 className=\"text-xl font-black text-foreground uppercase tracking-tight\">Deployment <span className=\"text-primary text-glow\">Tiers</span></h3>\r\n                      </div>\r\n                      <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[10px] tracking-widest uppercase px-4 py-1.5 shadow-sm\">Scale Optimization Available</Badge>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                      {QUOTA_PLANS.map((plan, i) => {\r\n                        const isCurrent = plan.id === clinicData?.subscription_tier;\r\n                        const isUpgrading = upgrading === plan.id;\r\n\r\n                        return (\r\n                          <motion.div\r\n                            key={plan.id}\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            transition={{ delay: i * 0.1 }}\r\n                          >\r\n                            <Card className={cn(\r\n                              \"h-full p-8 rounded-[48px] border transition-all duration-500 relative overflow-hidden group/plan flex flex-col justify-between shadow-card hover:shadow-premium\",\r\n                              isCurrent \r\n                                ? \"border-primary/50 bg-primary/5 shadow-premium\" \r\n                                : \"border-border/50 bg-secondary/10 hover:border-primary/30 hover:bg-secondary/20\"\r\n                            )}>\r\n                              {plan.recommended && !isCurrent && (\r\n                                <div className=\"absolute top-8 right-8 z-20\">\r\n                                  <Badge variant=\"default\" size=\"sm\" className=\"font-black text-[8px] tracking-[0.2em] px-4 py-1.5 uppercase shadow-glow-sm\">ELITE_CHOICE</Badge>\r\n                                </div>\r\n                              )}\r\n\r\n                              <div className=\"space-y-8 relative z-10\">\r\n                                <div className=\"space-y-1\">\r\n                                  <h4 className=\"text-2xl font-black text-foreground uppercase tracking-tight group-hover/plan:text-primary transition-colors\">{plan.name}</h4>\r\n                                  <p className=\"text-[11px] text-muted-foreground italic font-medium leading-relaxed opacity-80\">{plan.description}</p>\r\n                                </div>\r\n\r\n                                <div className=\"flex items-baseline gap-2 pt-2\">\r\n                                  <span className=\"text-4xl font-black text-foreground tabular-nums tracking-tighter\">เธฟ{plan.monthlyPrice.toLocaleString()}</span>\r\n                                  <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest opacity-60\">/ cycle</span>\r\n                                </div>\r\n\r\n                                <div className=\"space-y-4 pt-8 border-t border-border/30\">\r\n                                  <div className=\"flex justify-between items-center text-[10px] font-black uppercase tracking-widest\">\r\n                                    <span className=\"text-muted-foreground opacity-60\">Neural Bandwidth</span>\r\n                                    <span className=\"text-foreground\">{plan.monthlyQuota} SCAN_NODES</span>\r\n                                  </div>\r\n                                  <div className=\"flex justify-between items-center text-[10px] font-black uppercase tracking-widest\">\r\n                                    <span className=\"text-muted-foreground opacity-60\">Overage Gradient</span>\r\n                                    <span className=\"text-primary font-bold\">เธฟ{plan.scanPrice} / unit</span>\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n\r\n                              <div className=\"pt-10 relative z-10\">\r\n                                <Button\r\n                                  disabled={isCurrent || upgrading !== null}\r\n                                  onClick={() => handleUpgrade(plan.id)}\r\n                                  className={cn(\r\n                                    \"w-full py-7 rounded-[24px] text-[11px] font-black uppercase tracking-[0.3em] shadow-premium gap-3 relative overflow-hidden group/btn\",\r\n                                    isCurrent ? \"bg-emerald-500/10 text-emerald-500 border border-emerald-500/20 cursor-default shadow-none\" : \"hover:brightness-110\"\r\n                                  )}\r\n                                >\r\n                                  {!isCurrent && <div className=\"absolute inset-0 bg-white/20 -translate-x-full group-hover/btn:translate-x-full transition-transform duration-1000\" />}\r\n                                  {isUpgrading ? (\r\n                                    <SpinnerGap weight=\"bold\" className=\"w-4 h-4 animate-spin\" />\r\n                                  ) : isCurrent ? (\r\n                                    <CheckCircle weight=\"bold\" className=\"w-4 h-4\" />\r\n                                  ) : (\r\n                                    <ArrowsClockwise weight=\"bold\" className=\"w-4 h-4 group-hover/btn:rotate-180 transition-transform duration-500\" />\r\n                                  )}\r\n                                  {isCurrent ? 'ACTIVE_INFRASTRUCTURE' : 'DEPLOY TIER'}\r\n                                </Button>\r\n                              </div>\r\n                            </Card>\r\n                          </motion.div>\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </motion.div>\r\n          </AnimatePresence>\r\n        </div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\sms\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChatCircle' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ChatCircle"},"fix":{"range":[129,140],"text":""},"desc":"Remove unused variable \"ChatCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Clock"},"fix":{"range":[167,177],"text":""},"desc":"Remove unused variable \"Clock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[206,220],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Paperclip' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Paperclip"},"fix":{"range":[283,296],"text":""},"desc":"Remove unused variable \"Paperclip\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Card' is defined but never used.","line":19,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Card"},"fix":{"range":[338,343],"text":""},"desc":"Remove unused variable \"Card\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":19,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[342,354],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":19,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[354,365],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardContent' is defined but never used.","line":19,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":50,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"CardContent"},"fix":{"range":[329,409],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":20,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":15,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Badge"},"fix":{"range":[410,456],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":38,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":39,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":39,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1083,1086],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1083,1086],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'SpinnerGap' is not defined.","line":124,"column":18,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":124,"endColumn":28}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  ChatCircle, \n  PaperPlaneTilt, \n  User, \n  Clock, \n  MagnifyingGlass, \n  Plus, \n  ArrowLeft,\n  ChatCircleText,\n  Phone,\n  CheckCircle,\n  DotsThreeVertical,\n  Paperclip\n} from '@phosphor-icons/react';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { useTranslations } from 'next-intl';\nimport { cn } from '@/lib/utils';\n\ninterface Conversation {\n  id: string;\n  customer_phone: string;\n  customer?: { full_name: string };\n  status: string;\n  unread_count: number;\n  last_message_at: string;\n  messages: { id: string; content: string; direction: string; created_at: string }[];\n}\n\nexport default function SMSPage() {\n  const { goBack } = useBackNavigation();\n  const t = useTranslations('clinic.sms' as any);\n  const [conversations, setConversations] = useState<Conversation[]>([]);\n  const [selected, setSelected] = useState<Conversation | null>(null);\n  const [message, setMessage] = useState('');\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => { fetchData(); }, []);\n\n  const fetchData = async () => {\n    setLoading(true);\n    try {\n      const res = await fetch('/api/sms');\n      const data = await res.json();\n      setConversations(data.conversations || []);\n    } catch (e) { console.error(e); }\n    setLoading(false);\n  };\n\n  const sendMessage = async () => {\n    if (!message.trim() || !selected) return;\n    await fetch('/api/sms', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ conversationId: selected.id, content: message })\n    });\n    setMessage('');\n    fetchData();\n  };\n\n  const formatTime = (d: string) => new Date(d).toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit' });\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"h-[calc(100vh-140px)] -m-8 flex flex-col font-sans overflow-hidden\"\n    >\n      <div className=\"p-8 pb-4 flex-shrink-0\">\n        <Breadcrumb />\n        \n        <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 mt-6\">\n          <div className=\"space-y-1\">\n            <motion.div \n              initial={{ opacity: 0, x: -20 }}\n              animate={{ opacity: 1, x: 0 }}\n              className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n            >\n              <ChatCircleText weight=\"duotone\" className=\"w-4 h-4\" />\n              Communication Node\n            </motion.div>\n            <motion.h1 \n              initial={{ opacity: 0, x: -20 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ delay: 0.1 }}\n              className=\"text-4xl font-heading font-bold text-foreground tracking-tight\"\n            >\n              Short Message <span className=\"text-primary\">Service</span>\n            </motion.h1>\n          </div>\n          \n          <Button className=\"gap-2 shadow-premium px-8\">\n            <Plus weight=\"bold\" className=\"w-4 h-4\" />\n            New Transmission\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"flex-1 flex overflow-hidden border-t border-border/50\">\n        {/* Conversations List */}\n        <div className=\"w-96 border-r border-border/50 bg-card/30 flex flex-col flex-shrink-0\">\n          <div className=\"p-6 space-y-4\">\n            <div className=\"relative group\">\n              <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-xl\" />\n              <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\n              <input \n                type=\"text\" \n                placeholder=\"Search identity node...\" \n                className=\"w-full pl-11 pr-4 py-3 bg-secondary/50 border border-border rounded-2xl text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\n              />\n            </div>\n          </div>\n\n          <div className=\"flex-1 overflow-y-auto custom-scrollbar px-3 space-y-1\">\n            {loading ? (\n              <div className=\"py-20 flex flex-col items-center gap-4\">\n                <SpinnerGap className=\"w-8 h-8 text-primary animate-spin\" />\n                <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Syncing Nodes...</p>\n              </div>\n            ) : conversations.length === 0 ? (\n              <div className=\"py-20 text-center opacity-30 flex flex-col items-center gap-4\">\n                <ChatCircleText weight=\"duotone\" className=\"w-12 h-12\" />\n                <p className=\"text-[10px] font-black uppercase tracking-widest\">No Active Links</p>\n              </div>\n            ) : (\n              conversations.map(conv => (\n                <button\n                  key={conv.id}\n                  onClick={() => setSelected(conv)}\n                  className={cn(\n                    \"w-full p-4 rounded-[24px] transition-all flex items-start gap-4 text-left group\",\n                    selected?.id === conv.id \n                      ? \"bg-primary text-white shadow-premium\" \n                      : \"hover:bg-secondary/50 text-foreground\"\n                  )}\n                >\n                  <div className=\"relative flex-shrink-0\">\n                    <div className={cn(\n                      \"w-12 h-12 rounded-2xl flex items-center justify-center text-lg font-bold shadow-sm transition-colors\",\n                      selected?.id === conv.id ? \"bg-white/20\" : \"bg-primary/10 text-primary group-hover:bg-primary/20\"\n                    )}>\n                      {conv.customer?.full_name?.charAt(0) || <User weight=\"duotone\" />}\n                    </div>\n                    {conv.unread_count > 0 && (\n                      <span className=\"absolute -top-1 -right-1 w-5 h-5 bg-rose-500 text-white text-[10px] font-black rounded-full flex items-center justify-center border-2 border-card ring-2 ring-rose-500/20\">\n                        {conv.unread_count}\n                      </span>\n                    )}\n                  </div>\n                  <div className=\"flex-1 min-w-0 py-0.5\">\n                    <div className=\"flex justify-between items-center mb-1\">\n                      <p className={cn(\"font-bold text-sm truncate tracking-tight\", selected?.id === conv.id ? \"text-white\" : \"text-foreground\")}>\n                        {conv.customer?.full_name || conv.customer_phone}\n                      </p>\n                      <span className={cn(\"text-[10px] font-medium opacity-60 tabular-nums\", selected?.id === conv.id ? \"text-white\" : \"text-muted-foreground\")}>\n                        {conv.last_message_at ? formatTime(conv.last_message_at) : ''}\n                      </span>\n                    </div>\n                    <p className={cn(\"text-xs truncate\", selected?.id === conv.id ? \"text-white/80\" : \"text-muted-foreground\")}>\n                      {conv.messages?.[0]?.content || 'No signal transmitted...'}\n                    </p>\n                  </div>\n                </button>\n              ))\n            )}\n          </div>\n        </div>\n\n        {/* Chat Area */}\n        <div className=\"flex-1 flex flex-col bg-background relative overflow-hidden\">\n          <AnimatePresence mode=\"wait\">\n            {selected ? (\n              <motion.div \n                key={selected.id}\n                initial={{ opacity: 0 }}\n                animate={{ opacity: 1 }}\n                exit={{ opacity: 0 }}\n                className=\"flex flex-col h-full\"\n              >\n                {/* Chat Header */}\n                <div className=\"p-6 bg-card border-b border-border/50 flex items-center justify-between\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\n                      <User weight=\"duotone\" className=\"w-6 h-6\" />\n                    </div>\n                    <div>\n                      <p className=\"font-bold text-foreground tracking-tight leading-none mb-1\">{selected.customer?.full_name || 'Anonymous Node'}</p>\n                      <div className=\"flex items-center gap-2\">\n                        <div className=\"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse\" />\n                        <p className=\"text-[10px] text-muted-foreground font-black uppercase tracking-widest\">{selected.customer_phone}</p>\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Button variant=\"ghost\" size=\"sm\" className=\"p-2.5 rounded-xl text-muted-foreground hover:text-foreground\">\n                      <Phone weight=\"bold\" className=\"w-5 h-5\" />\n                    </Button>\n                    <Button variant=\"ghost\" size=\"sm\" className=\"p-2.5 rounded-xl text-muted-foreground hover:text-foreground\">\n                      <DotsThreeVertical weight=\"bold\" className=\"w-5 h-5\" />\n                    </Button>\n                  </div>\n                </div>\n\n                {/* Messages Area */}\n                <div className=\"flex-1 overflow-y-auto p-8 space-y-6 custom-scrollbar bg-[radial-gradient(circle_at_center,var(--primary)_0%,transparent_100%)] bg-[length:100%_100%] bg-no-repeat bg-fixed opacity-[0.03] pointer-events-none absolute inset-0\" />\n                <div className=\"flex-1 overflow-y-auto p-8 space-y-6 custom-scrollbar relative z-10\">\n                  {selected.messages?.map((msg, idx) => (\n                    <motion.div \n                      key={msg.id} \n                      initial={{ opacity: 0, x: msg.direction === 'outbound' ? 20 : -20 }}\n                      animate={{ opacity: 1, x: 0 }}\n                      transition={{ delay: idx * 0.05 }}\n                      className={cn(\"flex\", msg.direction === 'outbound' ? 'justify-end' : 'justify-start')}\n                    >\n                      <div className={cn(\n                        \"max-w-[70%] group relative\",\n                        msg.direction === 'outbound' ? 'items-end' : 'items-start'\n                      )}>\n                        <div className={cn(\n                          \"px-5 py-3.5 rounded-[24px] text-sm font-medium shadow-sm transition-all duration-300\",\n                          msg.direction === 'outbound' \n                            ? 'bg-primary text-white rounded-tr-none hover:shadow-premium' \n                            : 'bg-card border border-border/50 text-foreground rounded-tl-none hover:border-primary/30'\n                        )}>\n                          <p className=\"leading-relaxed\">{msg.content}</p>\n                        </div>\n                        <div className={cn(\n                          \"mt-1.5 flex items-center gap-2 text-[9px] font-black uppercase tracking-widest px-1\",\n                          msg.direction === 'outbound' ? 'justify-end text-primary/60' : 'text-muted-foreground/60'\n                        )}>\n                          {formatTime(msg.created_at)}\n                          {msg.direction === 'outbound' && <CheckCircle weight=\"fill\" className=\"w-3 h-3\" />}\n                        </div>\n                      </div>\n                    </motion.div>\n                  ))}\n                </div>\n\n                {/* Input Area */}\n                <div className=\"p-6 bg-card border-t border-border/50 relative z-10\">\n                  <div className=\"flex items-end gap-3 bg-secondary/50 border border-border/50 p-2 rounded-[28px] focus-within:border-primary focus-within:ring-4 focus-within:ring-primary/5 transition-all\">\n                    <Button variant=\"ghost\" size=\"sm\" className=\"p-3 rounded-full text-muted-foreground hover:text-primary mb-0.5\">\n                      <Plus weight=\"bold\" className=\"w-5 h-5\" />\n                    </Button>\n                    <textarea\n                      value={message}\n                      onChange={e => setMessage(e.target.value)}\n                      onKeyDown={e => {\n                        if (e.key === 'Enter' && !e.shiftKey) {\n                          e.preventDefault();\n                          sendMessage();\n                        }\n                      }}\n                      rows={1}\n                      placeholder=\"Input clinical transmission...\"\n                      className=\"flex-1 bg-transparent border-none focus:ring-0 py-3.5 px-2 text-sm font-medium text-foreground placeholder:text-muted-foreground/40 resize-none max-h-32 custom-scrollbar\"\n                    />\n                    <Button \n                      onClick={sendMessage} \n                      disabled={!message.trim()}\n                      className=\"p-3.5 bg-primary text-white rounded-full shadow-premium mb-0.5 disabled:opacity-50 disabled:grayscale transition-all hover:scale-105 active:scale-95\"\n                    >\n                      <PaperPlaneTilt weight=\"fill\" className=\"w-5 h-5\" />\n                    </Button>\n                  </div>\n                </div>\n              </motion.div>\n            ) : (\n              <div className=\"flex-1 flex flex-col items-center justify-center space-y-6 text-center opacity-30\">\n                <div className=\"w-24 h-24 rounded-[40px] bg-secondary border border-border flex items-center justify-center text-muted-foreground\">\n                  <ChatCircleText weight=\"duotone\" className=\"w-12 h-12\" />\n                </div>\n                <div className=\"space-y-2\">\n                  <h4 className=\"text-xl font-black text-foreground uppercase tracking-[0.2em]\">Zero Signal Detected</h4>\n                  <p className=\"text-sm font-medium text-muted-foreground italic\">Select a node from the registry to initialize communication.</p>\n                </div>\n              </div>\n            )}\n          </AnimatePresence>\n        </div>\n      </div>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\staff\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\staff\\test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\treatments\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Invalid character.","line":88,"column":30}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { \n  FirstAidKit, \n  Plus, \n  MagnifyingGlass, \n  Tag, \n  CurrencyDollar, \n  Lightning, \n  Stack,\n  PencilSimple, \n  Trash,\n  DotsThree,\n  Sparkle,\n  SpinnerGap,\n  ArrowLeft,\n  ArrowsClockwise,\n  CheckCircle,\n  XCircle,\n  CaretRight,\n  Briefcase,\n  Monitor,\n  Icon,\n  DotsThreeVertical\n} from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { cn } from '@/lib/utils';\nimport { useEffect, useState, useCallback, useMemo } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport TreatmentModal from '@/components/TreatmentModal';\n\ninterface Treatment {\n  id: string;\n  names: { [key: string]: string } | string;\n  category: string;\n  price_min: number;\n  price_max?: number;\n  is_active: boolean;\n  created_at: string;\n}\n\nexport default function TreatmentCatalog() {\n  const { goBack } = useBackNavigation();\n  const [treatments, setTreatments] = useState<Treatment[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [selectedTreatment, setSelectedTreatment] = useState<Treatment | undefined>(undefined);\n\n  const fetchTreatments = useCallback(async () => {\n    setLoading(true);\n    try {\n      const res = await fetch('/api/treatments');\n      const result = await res.json();\n      if (result.success) {\n        setTreatments(result.data || []);\n      }\n    } catch (err) {\n      console.error('Error fetching treatments:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchTreatments();\n  }, [fetchTreatments]);\n\n  const handleAddTreatment = () => {\n    setSelectedTreatment(undefined);\n    setIsModalOpen(true);\n  };\n\n  const handleEditTreatment = (treatment: Treatment) => {\n    setSelectedTreatment(treatment);\n    setIsModalOpen(true);\n  };\n\n  const handleDeleteTreatment = async (id: string) => {\n    if (!confirm('Are you sure you want to terminate this protocol node?')) return;\n    \n    try {\n      const res = await fetch(\\/api/treatments/\\\\, { method: 'DELETE' });\n      const result = await res.json();\n      if (result.success) {\n        fetchTreatments();\n      }\n    } catch (err) {\n      console.error('Error deleting treatment:', err);\n    }\n  };\n\n  const filteredTreatments = treatments.filter(item => {\n    const nameStr = typeof item.names === 'object' ? JSON.stringify(item.names) : item.names;\n    return (\n      nameStr?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      item.category?.toLowerCase().includes(searchTerm.toLowerCase())\n    );\n  });\n\n  const stats = useMemo(() => ({\n    total: treatments.length,\n    active: treatments.filter(t => t.is_active).length,\n    avgPrice: treatments.length ? Math.round(treatments.reduce((acc, t) => acc + t.price_min, 0) / treatments.length) : 0,\n    categories: new Set(treatments.map(t => t.category)).size\n  }), [treatments]);\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <TreatmentModal \n        isOpen={isModalOpen}\n        onClose={() => setIsModalOpen(false)}\n        onSuccess={fetchTreatments}\n        treatment={selectedTreatment}\n      />\n\n      <Breadcrumb />\n\n      {/* Header Section */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <FirstAidKit weight=\"duotone\" className=\"w-4 h-4\" />\n            Medical Excellence Catalog\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n          >\n            Treatment <span className=\"text-primary\">Protocols</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Managing clinical services, unit economics, and AI diagnostic mapping nodes.\n          </motion.p>\n        </div>\n\n        <motion.div \n          initial={{ opacity: 0, scale: 0.9 }}\n          animate={{ opacity: 1, scale: 1 }}\n          transition={{ delay: 0.3 }}\n        >\n          <Button \n            onClick={handleAddTreatment}\n            className=\"gap-3 shadow-premium px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest group\"\n          >\n            <Plus weight=\"bold\" className=\"w-4 h-4 group-hover:scale-110 transition-transform\" />\n            <span>Authorize New Node</span>\n          </Button>\n        </motion.div>\n      </div>\n\n      {/* Stats Summary Section */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\n        <StatCard\n          title=\"Total Registry\"\n          value={stats.total}\n          icon={Stack as any}\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Active Nodes\"\n          value={stats.active}\n          icon={CheckCircle as any}\n          iconColor=\"text-emerald-500\"\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Avg. Valuation\"\n          value={stats.avgPrice}\n          prefix=\"๏ฟฝ\"\n          icon={CurrencyDollar as any}\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Protocol Clusters\"\n          value={stats.categories}\n          icon={Tag as any}\n          iconColor=\"text-purple-500\"\n          className=\"p-4\"\n        />\n      </div>\n\n      {/* Search & Intelligence Controls */}\n      <div className=\"px-2\">\n        <Card className=\"p-6 rounded-[32px] border-border/50 shadow-card\">\n          <div className=\"flex flex-col md:flex-row gap-6\">\n            <div className=\"relative flex-1 group\">\n              <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-xl\" />\n              <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\n              <input \n                type=\"text\" \n                placeholder=\"Query protocol name, category, or identity node...\" \n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3.5 pl-12 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10 font-bold\"\n              />\n            </div>\n            \n            <div className=\"flex items-center gap-3\">\n              <Button variant=\"outline\" className=\"gap-2 px-8 py-3.5 rounded-2xl text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\">\n                <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} onClick={() => fetchTreatments()} />\n                Sync Ledger\n              </Button>\n            </div>\n          </div>\n        </Card>\n      </div>\n\n      {/* Protocol Matrix Area */}\n      <div className=\"px-2\">\n        {loading && treatments.length === 0 ? (\n          <div className=\"py-48 flex flex-col items-center justify-center gap-6 bg-card border border-border/50 rounded-[40px] shadow-inner opacity-60\">\n            <SpinnerGap weight=\"bold\" className=\"w-12 h-12 text-primary animate-spin\" />\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] text-center\">Accessing Clinical Registry Matrix...</p>\n          </div>\n        ) : filteredTreatments.length === 0 ? (\n          <Card variant=\"ghost\" className=\"py-48 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-8 opacity-40 rounded-[40px]\">\n            <Stack weight=\"duotone\" className=\"w-20 h-20 text-muted-foreground\" />\n            <div className=\"text-center space-y-3\">\n              <h3 className=\"text-2xl font-black text-foreground uppercase tracking-widest\">Protocol Vault Empty</h3>\n              <p className=\"text-sm text-muted-foreground font-medium italic max-w-sm mx-auto\">No clinical treatments detected in this matrix node.</p>\n            </div>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n            <AnimatePresence mode=\"popLayout\">\n              {filteredTreatments.map((item, i) => {\n                const name = typeof item.names === 'object' ? (item.names as any).th || (item.names as any).en : item.names;\n                \n                return (\n                  <motion.div\n                    key={item.id}\n                    layout\n                    initial={{ opacity: 0, scale: 0.95, y: 20 }}\n                    animate={{ opacity: 1, scale: 1, y: 0 }}\n                    exit={{ opacity: 0, scale: 0.95 }}\n                    transition={{ delay: i * 0.05 }}\n                  >\n                    <Card className=\"h-full border-border/50 hover:border-primary/30 transition-all group overflow-hidden flex flex-col shadow-card hover:shadow-premium\">\n                      <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n                        <Sparkle weight=\"fill\" className=\"w-32 h-32 text-primary\" />\n                      </div>\n\n                      <CardHeader className=\"pb-4 relative z-10\">\n                        <div className=\"flex justify-between items-start gap-4\">\n                          <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner group-hover:bg-primary/20 transition-all\">\n                            <Tag weight=\"duotone\" className=\"w-7 h-7\" />\n                          </div>\n                          <div className=\"flex gap-2\">\n                            <Badge variant={item.is_active ? 'success' : 'secondary'} size=\"sm\" className=\"font-black text-[8px] tracking-widest px-2.5 py-1\">\n                              {item.is_active ? 'OPERATIONAL' : 'ARCHIVED'}\n                            </Badge>\n                          </div>\n                        </div>\n                      </CardHeader>\n\n                      <CardContent className=\"flex-1 space-y-6 relative z-10 flex flex-col justify-between\">\n                        <div className=\"space-y-4\">\n                          <div>\n                            <p className=\"text-[10px] font-black text-primary uppercase tracking-[0.3em] mb-1\">{item.category}</p>\n                            <h3 className=\"text-xl font-black text-foreground group-hover:text-primary transition-colors tracking-tight uppercase line-clamp-2 leading-tight\">\n                              {name}\n                            </h3>\n                          </div>\n\n                          <div className=\"p-4 bg-secondary/30 rounded-2xl border border-border/50 shadow-inner group-hover:border-primary/20 transition-all\">\n                            <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest mb-1\">Fiscal Unit Node</p>\n                            <div className=\"flex items-baseline gap-1\">\n                              <span className=\"text-2xl font-black text-foreground tabular-nums tracking-tighter\">๏ฟฝ{item.price_min.toLocaleString()}</span>\n                              {item.price_max && (\n                                <span className=\"text-xs font-bold text-muted-foreground\"> - ๏ฟฝ{item.price_max.toLocaleString()}</span>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n\n                        <div className=\"pt-6 border-t border-border/30 flex items-center justify-between\">\n                          <div className=\"flex items-center gap-2 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\n                            <Monitor weight=\"bold\" className=\"w-3.5 h-3.5 opacity-40\" />\n                            ID: {item.id.slice(0, 8).toUpperCase()}\n                          </div>\n                          <div className=\"flex gap-2\">\n                            <Button \n                              variant=\"outline\" \n                              size=\"sm\" \n                              onClick={() => handleEditTreatment(item)}\n                              className=\"h-10 w-10 p-0 rounded-xl border-border/50 hover:bg-secondary text-primary\"\n                            >\n                              <PencilSimple weight=\"bold\" className=\"w-4 h-4\" />\n                            </Button>\n                            <Button \n                              variant=\"outline\" \n                              size=\"sm\" \n                              onClick={() => handleDeleteTreatment(item.id)}\n                              className=\"h-10 w-10 p-0 border-border/50 rounded-xl hover:bg-rose-500/10 text-muted-foreground hover:text-rose-500 hover:border-rose-500/30 transition-all\"\n                            >\n                              <Trash weight=\"bold\" className=\"w-4 h-4\" />\n                            </Button>\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  </motion.div>\n                );\n              })}\n            </AnimatePresence>\n          </div>\n        )}\n      </div>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\clinic\\waitlist\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":3,"column":69,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":78,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[81,92],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningCircle' is defined but never used.","line":3,"column":110,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":123,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WarningCircle"},"fix":{"range":[122,137],"text":""},"desc":"Remove unused variable \"WarningCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'UserList' is defined but never used.","line":3,"column":125,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":133,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"UserList"},"fix":{"range":[137,147],"text":""},"desc":"Remove unused variable \"UserList\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":3,"column":135,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":145,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[147,159],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CalendarDots' is defined but never used.","line":3,"column":156,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":168,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CalendarDots"},"fix":{"range":[168,182],"text":""},"desc":"Remove unused variable \"CalendarDots\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":5,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[281,293],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":5,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[293,304],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardContent' is defined but never used.","line":5,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":50,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardContent"},"fix":{"range":[304,317],"text":""},"desc":"Remove unused variable \"CardContent\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Link' is defined but never used.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Link"},"fix":{"range":[604,609],"text":""},"desc":"Remove unused variable \"Link\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRouter' is defined but never used.","line":11,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":25,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"useRouter"},"fix":{"range":[595,644],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":31,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":17},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchData'. Either include it or remove the dependency array.","line":50,"column":6,"nodeType":"ArrayExpression","endLine":50,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [fetchData, filter]","fix":{"range":[1832,1840],"text":"[fetchData, filter]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { Clock, User, Phone, Bell, Check, X, Plus, MagnifyingGlass, ArrowLeft, ArrowsClockwise, CheckCircle, WarningCircle, UserList, CaretRight, History, CalendarDots } from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { cn } from '@/lib/utils';\nimport { Link, useRouter } from '@/i18n/routing';\nimport ResponsiveTable from '@/components/ui/ResponsiveTable';\nimport { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\ninterface WaitlistEntry {\n  id: string;\n  customer_name?: string;\n  customer_phone?: string;\n  customer?: { full_name: string; phone: string };\n  service?: { name: { th: string } };\n  preferred_dates: string[];\n  preferred_time_range: { start: string; end: string };\n  priority: number;\n  status: string;\n  notified_count: number;\n  created_at: string;\n}\n\nexport default function WaitlistPage() {\n  const { goBack } = useBackNavigation();\n  const [entries, setEntries] = useState<WaitlistEntry[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [filter, setFilter] = useState('waiting');\n  const [search, setSearch] = useState('');\n  const [selected, setSelected] = useState<string[]>([]);\n\n  const fetchData = async () => {\n    setLoading(true);\n    try {\n      const res = await fetch(`/api/waitlist?status=${filter}`);\n      const data = await res.json();\n      setEntries(data.entries || []);\n    } catch (e) { console.error(e); }\n    setLoading(false);\n  };\n\n  useEffect(() => { \n    fetchData(); \n  }, [filter]);\n\n  const updateStatus = async (id: string, status: string) => {\n    await fetch('/api/waitlist', {\n      method: 'PATCH',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ entryId: id, status })\n    });\n    fetchData();\n  };\n\n  const notify = async () => {\n    if (!selected.length) return;\n    await fetch('/api/waitlist/notify', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        entryIds: selected,\n        availableSlot: { date: new Date().toISOString().split('T')[0], time: '14:00' }\n      })\n    });\n    setSelected([]);\n    fetchData();\n  };\n\n  const filtered = entries.filter(e => {\n    const name = e.customer?.full_name || e.customer_name || '';\n    return name.toLowerCase().includes(search.toLowerCase());\n  });\n\n  const getStatusStyle = (s: string) => {\n    if (s === 'waiting') return 'bg-blue-500/10 text-blue-500';\n    if (s === 'notified') return 'bg-amber-500/10 text-amber-500';\n    if (s === 'converted') return 'bg-emerald-500/10 text-emerald-500';\n    return 'bg-secondary text-muted-foreground';\n  };\n\n  const columns = [\n    {\n      header: '',\n      className: 'w-12',\n      accessor: (entry: WaitlistEntry) => (\n        entry.status === 'waiting' ? (\n          <input\n            type=\"checkbox\"\n            checked={selected.includes(entry.id)}\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n              if (e.target.checked) {\n                setSelected([...selected, entry.id]);\n              } else {\n                setSelected(selected.filter(id => id !== entry.id));\n              }\n            }}\n            className=\"rounded border-border bg-secondary text-primary focus:ring-primary\"\n          />\n        ) : null\n      )\n    },\n    {\n      header: 'เธฅเธนเธเธเนเธฒ',\n      accessor: (entry: WaitlistEntry) => (\n        <div>\n          <p className=\"font-bold text-foreground\">{entry.customer?.full_name || entry.customer_name}</p>\n          <p className=\"text-[10px] text-muted-foreground flex items-center gap-1 mt-0.5 font-medium\">\n            <Phone className=\"w-3 h-3 text-primary/60\" /> {entry.customer?.phone || entry.customer_phone}\n          </p>\n        </div>\n      )\n    },\n    {\n      header: 'เธเธฃเธดเธเธฒเธฃ',\n      accessor: (entry: WaitlistEntry) => (\n        <span className=\"text-sm font-medium text-foreground\">{entry.service?.name?.th || '-'}</span>\n      )\n    },\n    {\n      header: 'เธฅเธณเธ”เธฑเธ',\n      accessor: (entry: WaitlistEntry) => (\n        <span className={cn(\n          \"px-2 py-1 rounded text-xs font-bold tabular-nums\",\n          entry.priority <= 3 ? \"bg-rose-500/10 text-rose-500\" : \"bg-secondary text-muted-foreground\"\n        )}>\n          #{entry.priority}\n        </span>\n      )\n    },\n    {\n      header: 'เธชเธ–เธฒเธเธฐ',\n      accessor: (entry: WaitlistEntry) => (\n        <span className={cn(\"px-2 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider\", getStatusStyle(entry.status))}>\n          {entry.status === 'waiting' ? 'เธฃเธญเธเธดเธง' : entry.status === 'notified' ? 'เนเธเนเธเนเธฅเนเธง' : 'เธเธญเธเนเธฅเนเธง'}\n        </span>\n      )\n    },\n    {\n      header: '',\n      className: 'text-right',\n      accessor: (entry: WaitlistEntry) => (\n        entry.status === 'waiting' && (\n          <div className=\"flex justify-end gap-2\">\n            <button \n              onClick={() => updateStatus(entry.id, 'converted')} \n              className=\"p-2 text-emerald-500 hover:bg-emerald-500/10 rounded-lg transition-all border border-transparent hover:border-emerald-500/20\"\n              title=\"เธเธญเธเธชเธณเน€เธฃเนเธ\"\n            >\n              <Check className=\"w-4 h-4 stroke-[3px]\" />\n            </button>\n            <button \n              onClick={() => updateStatus(entry.id, 'cancelled')} \n              className=\"p-2 text-rose-500 hover:bg-rose-500/10 rounded-lg transition-all border border-transparent hover:border-rose-500/20\"\n              title=\"เธขเธเน€เธฅเธดเธ\"\n            >\n              <X className=\"w-4 h-4 stroke-[3px]\" />\n            </button>\n          </div>\n        )\n      )\n    }\n  ];\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header Section */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <Clock weight=\"duotone\" className=\"w-4 h-4\" />\n            Temporal Queue registry\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n          >\n            Clinic <span className=\"text-primary\">Waitlist</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Orchestrating unassigned temporal slots and prioritized client identity nodes.\n          </motion.p>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <AnimatePresence>\n            {selected.length > 0 && (\n              <motion.div\n                initial={{ opacity: 0, scale: 0.9, x: 20 }}\n                animate={{ opacity: 1, scale: 1, x: 0 }}\n                exit={{ opacity: 0, scale: 0.9, x: 20 }}\n              >\n                <Button \n                  onClick={notify}\n                  className=\"bg-amber-500 hover:bg-amber-600 text-white gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\"\n                >\n                  <Bell weight=\"bold\" className=\"w-4 h-4\" />\n                  Dispatch Notice ({selected.length})\n                </Button>\n              </motion.div>\n            )}\n          </AnimatePresence>\n          <Button \n            variant=\"outline\"\n            onClick={fetchData}\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\n          >\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\n            Sync Queue\n          </Button>\n          <Button className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\">\n            <Plus weight=\"bold\" className=\"w-4 h-4\" />\n            Initialize Entry\n          </Button>\n        </div>\n      </div>\n\n      {/* Stats Summary */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\n        <StatCard\n          title=\"Waiting Nodes\"\n          value={entries.filter(e => e.status === 'waiting').length}\n          icon={Clock}\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Notified Identities\"\n          value={entries.filter(e => e.status === 'notified').length}\n          icon={Bell}\n          iconColor=\"text-amber-500\"\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Converted Cycles\"\n          value={entries.filter(e => e.status === 'converted').length}\n          icon={CheckCircle}\n          iconColor=\"text-emerald-500\"\n          className=\"p-4\"\n        />\n        <StatCard\n          title=\"Conversion Velocity\"\n          value={entries.length ? Math.round((entries.filter(e => e.status === 'converted').length / entries.length) * 100) : 0}\n          suffix=\"%\"\n          icon={TrendUp}\n          iconColor=\"text-primary\"\n          className=\"p-4\"\n        />\n      </div>\n\n      {/* Search & Filters */}\n      <div className=\"px-2\">\n        <Card className=\"p-6 rounded-[32px] border-border/50 shadow-card\">\n          <div className=\"flex flex-col md:flex-row gap-6\">\n            <div className=\"relative flex-1 group\">\n              <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-xl\" />\n              <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\n              <input \n                type=\"text\" \n                placeholder=\"Query identity node name or registry phone...\" \n                value={search}\n                onChange={(e) => setSearch(e.target.value)}\n                className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3.5 pl-12 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\n              />\n            </div>\n            <div className=\"flex bg-secondary/50 border border-border/50 p-1.5 rounded-[20px] w-fit shadow-inner\">\n              {[\n                { id: 'waiting', label: 'Queued', icon: Clock },\n                { id: 'notified', label: 'Notified', icon: Bell },\n                { id: 'converted', label: 'Sealed', icon: CheckCircle }\n              ].map((f) => (\n                <button\n                  key={f.id}\n                  onClick={() => setFilter(f.id)}\n                  className={cn(\n                    \"px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all border whitespace-nowrap flex items-center gap-2\",\n                    filter === f.id\n                      ? \"bg-primary text-primary-foreground border-primary shadow-premium\"\n                      : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\n                  )}\n                >\n                  <f.icon weight={filter === f.id ? \"fill\" : \"bold\"} className=\"w-3.5 h-3.5\" />\n                  {f.label}\n                </button>\n              ))}\n            </div>\n          </div>\n        </Card>\n      </div>\n\n      {/* Waitlist Registry Table */}\n      <div className=\"px-2\">\n        <Card className=\"rounded-[40px] border-border/50 overflow-hidden shadow-premium\">\n          <ResponsiveTable\n            columns={columns}\n            data={filtered}\n            loading={loading}\n            rowKey={(e) => e.id}\n            emptyMessage=\"Zero temporal waiting nodes detected in current matrix.\"\n            mobileCard={(entry) => (\n              <div className=\"space-y-5\">\n                <div className=\"flex justify-between items-start\">\n                  <div className=\"flex items-center gap-4\">\n                    {entry.status === 'waiting' && (\n                      <div className=\"relative flex items-center justify-center\">\n                        <input\n                          type=\"checkbox\"\n                          checked={selected.includes(entry.id)}\n                          onChange={(e) => {\n                            if (e.target.checked) setSelected([...selected, entry.id]);\n                            else setSelected(selected.filter(id => id !== entry.id));\n                          }}\n                          className=\"peer sr-only\"\n                        />\n                        <div className=\"w-6 h-6 bg-secondary border-2 border-border/50 rounded-lg transition-all peer-checked:bg-primary peer-checked:border-primary shadow-inner\" />\n                        <Check weight=\"bold\" className=\"absolute w-3.5 h-3.5 text-primary-foreground opacity-0 peer-checked:opacity-100 transition-opacity\" />\n                      </div>\n                    )}\n                    <div className=\"w-14 h-14 rounded-2xl bg-secondary border border-border flex items-center justify-center text-primary shadow-inner\">\n                      <User weight=\"duotone\" className=\"w-7 h-7\" />\n                    </div>\n                    <div className=\"min-w-0\">\n                      <p className=\"font-bold text-foreground truncate uppercase tracking-tight\">{entry.customer?.full_name || entry.customer_name}</p>\n                      <p className=\"text-[10px] font-black text-muted-foreground truncate uppercase tracking-widest flex items-center gap-2\">\n                        <Phone weight=\"bold\" className=\"w-3 h-3\" />\n                        {entry.customer?.phone || entry.customer_phone}\n                      </p>\n                    </div>\n                  </div>\n                  <Badge variant={entry.status === 'waiting' ? 'default' : entry.status === 'notified' ? 'warning' : 'success'} size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-3\">\n                    {entry.status === 'waiting' ? 'QUEUED' : entry.status === 'notified' ? 'NOTIFIED' : 'SEALED'}\n                  </Badge>\n                </div>\n                \n                <div className=\"grid grid-cols-2 gap-6 py-4 border-y border-border/50\">\n                  <div>\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Target Protocol</p>\n                    <p className=\"text-xs font-bold text-foreground truncate uppercase\">{entry.service?.name?.th || 'General Service'}</p>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">Priority Index</p>\n                    <Badge variant={entry.priority <= 3 ? 'destructive' : 'secondary'} size=\"sm\" className=\"font-black text-[10px] tabular-nums\">\n                      #{entry.priority}\n                    </Badge>\n                  </div>\n                </div>\n\n                <div className=\"flex justify-between items-center pt-1\">\n                  <div className=\"flex items-center gap-2 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\n                    <History weight=\"bold\" className=\"w-3.5 h-3.5 opacity-60\" />\n                    Registry: {new Date(entry.created_at).toLocaleDateString()}\n                  </div>\n                  {entry.status === 'waiting' && (\n                    <div className=\"flex gap-2\">\n                      <Button \n                        onClick={() => updateStatus(entry.id, 'converted')} \n                        variant=\"outline\"\n                        size=\"sm\"\n                        className=\"h-10 w-10 p-0 border-border/50 rounded-xl text-emerald-500 hover:bg-emerald-500/10 hover:border-emerald-500/20\"\n                      >\n                        <Check weight=\"bold\" className=\"w-4 h-4\" />\n                      </Button>\n                      <Button \n                        onClick={() => updateStatus(entry.id, 'cancelled')} \n                        variant=\"outline\"\n                        size=\"sm\"\n                        className=\"h-10 w-10 p-0 border-border/50 rounded-xl text-rose-500 hover:bg-rose-500/10 hover:border-rose-500/20\"\n                      >\n                        <X weight=\"bold\" className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n          />\n        </Card>\n      </div>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\customer\\booking\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used.","line":6,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"User"},"fix":{"range":[53,63],"text":""},"desc":"Remove unused variable \"User\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningCircle' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WarningCircle"},"fix":{"range":[142,160],"text":""},"desc":"Remove unused variable \"WarningCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":22,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[199,223],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pulse' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pulse"},"fix":{"range":[223,233],"text":""},"desc":"Remove unused variable \"Pulse\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationCard' is defined but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":21,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationCard"},"fix":{"range":[247,270],"text":""},"desc":"Remove unused variable \"IdentificationCard\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'StatCard' is defined but never used.","line":22,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":18,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"StatCard"},"fix":{"range":[320,372],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useTranslations' is defined but never used.","line":28,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":25,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"useTranslations"},"fix":{"range":[672,716],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Suspense' is defined but never used.","line":30,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":52,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Suspense"},"fix":{"range":[794,804],"text":""},"desc":"Remove unused variable \"Suspense\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CustomerBookingContent' is defined but never used.","line":46,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":32},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":47,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":47,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setSelectedStaff' is assigned a value but never used.","line":59,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":59,"endColumn":41}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { \r\n  CalendarDots, \r\n  Clock, \r\n  User, \r\n  FirstAidKit, \r\n  CaretRight, \r\n  CaretLeft,\r\n  CheckCircle,\r\n  SpinnerGap,\r\n  WarningCircle,\r\n  Sparkle,\r\n  ArrowRight,\r\n  Monitor,\r\n  IdentificationBadge,\r\n  Pulse,\r\n  Briefcase,\r\n  IdentificationCard,\r\n  CreditCard\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { useTranslations } from 'next-intl';\r\nimport { cn } from '@/lib/utils';\r\nimport { useState, useEffect, useCallback, Suspense } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface Treatment {\r\n  id: string;\r\n  names: { th: string; en: string };\r\n  category: string;\r\n  price_min: number;\r\n}\r\n\r\ninterface Staff {\r\n  id: string;\r\n  full_name: string;\r\n}\r\n\r\nfunction CustomerBookingContent() {\r\n  const { goBack } = useBackNavigation();\r\n  const router = useRouter();\r\n  const [step, setStep] = useState(1);\r\n  const [loading, setLoading] = useState(true);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  \r\n  const [treatments, setTreatments] = useState<Treatment[]>([]);\r\n  const [staffList, setStaffList] = useState<Staff[]>([]);\r\n  \r\n  const [selectedTreatment, setSelectedTreatment] = useState<Treatment | null>(null);\r\n  const [selectedDate, setSelectedDate] = useState<string>('');\r\n  const [selectedTime, setSelectedTime] = useState<string>('');\r\n  const [selectedStaff, setSelectedStaff] = useState<Staff | null>(null);\r\n  const [customerNotes, setCustomerNotes] = useState('');\r\n  const [bookingSuccess, setBookingSuccess] = useState<string | null>(null);\r\n\r\n  const fetchData = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const [treatmentsRes, staffRes] = await Promise.all([\r\n        fetch('/api/treatments?activeOnly=true'),\r\n        fetch('/api/staff/invite?type=list') // Assuming this returns clinic staff\r\n      ]);\r\n\r\n      const [treatmentsData, staffData] = await Promise.all([\r\n        treatmentsRes.json(),\r\n        staffRes.json()\r\n      ]);\r\n\r\n      if (treatmentsData.success) setTreatments(treatmentsData.data);\r\n      if (staffData.success) setStaffList(staffData.data);\r\n    } catch (err) {\r\n      console.error('Error fetching booking data:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, [fetchData]);\r\n\r\n  const handleBooking = async () => {\r\n    if (!selectedTreatment || !selectedDate || !selectedTime) return;\r\n    \r\n    setSubmitting(true);\r\n    try {\r\n      // Get current customer info first (real customer id linked to user)\r\n      const customerRes = await fetch('/api/customers/me'); // Need to create this or handle in API\r\n      const customerData = await customerRes.json();\r\n      \r\n      const res = await fetch('/api/appointments', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          customer_id: customerData.data.id,\r\n          treatment_ids: [selectedTreatment.id],\r\n          appointment_date: selectedDate,\r\n          start_time: selectedTime,\r\n          appointment_type: 'treatment',\r\n          staff_id: selectedStaff?.id || staffList[0]?.id, // Default to first staff if none selected\r\n          customer_notes: customerNotes,\r\n          status: 'pending'\r\n        })\r\n      });\r\n\r\n      const result = await res.json();\r\n      if (result.success) {\r\n        setBookingSuccess(result.data.appointment_code);\r\n      } else {\r\n        throw new Error(result.error?.message || 'Booking failed');\r\n      }\r\n    } catch (err) {\r\n      console.error('Booking error:', err);\r\n      alert('Booking failed. Please try again.');\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"h-[80vh] flex flex-col items-center justify-center space-y-6\">\r\n        <SpinnerGap className=\"w-12 h-12 text-primary animate-spin\" />\r\n        <p className=\"text-sm font-black uppercase tracking-[0.3em] text-muted-foreground animate-pulse\">Synchronizing with Booking Node...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <CalendarDots weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Temporal Reservation Node\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Book <span className=\"text-primary\">Transformation</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating your clinical temporal slot for aesthetic protocol execution.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-4 bg-secondary/50 p-1.5 rounded-[24px] border border-border/50 shadow-inner\">\r\n          {[1, 2, 3].map((s) => (\r\n            <div key={s} className=\"flex items-center gap-2\">\r\n              <div className={cn(\r\n                \"w-10 h-10 rounded-xl flex items-center justify-center text-xs font-black transition-all duration-500 relative\",\r\n                step === s ? \"bg-primary text-primary-foreground shadow-premium\" : \r\n                step > s ? \"bg-emerald-500/10 text-emerald-500 border border-emerald-500/20\" :\r\n                \"bg-transparent text-muted-foreground/40 border border-transparent\"\r\n              )}>\r\n                {step > s ? <CheckCircle weight=\"bold\" className=\"w-5 h-5\" /> : s}\r\n                {step === s && (\r\n                  <motion.div layoutId=\"step-glow\" className=\"absolute -inset-1.5 bg-primary/5 blur-md rounded-xl z-[-1]\" />\r\n                )}\r\n              </div>\r\n              {s < 3 && <div className=\"w-4 h-px bg-border/30\" />}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"max-w-5xl mx-auto\">\r\n        <AnimatePresence mode=\"wait\">\r\n          {/* Step 1: Protocol Selection */}\r\n          {step === 1 && (\r\n            <motion.div\r\n              key=\"step1\"\r\n              initial={{ opacity: 0, y: 20 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              exit={{ opacity: 0, scale: 0.95 }}\r\n              className=\"space-y-8\"\r\n            >\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                {treatments.map((t, i) => (\r\n                  <motion.button\r\n                    key={t.id}\r\n                    initial={{ opacity: 0, scale: 0.95 }}\r\n                    animate={{ opacity: 1, scale: 1 }}\r\n                    transition={{ delay: i * 0.05 }}\r\n                    onClick={() => setSelectedTreatment(t)}\r\n                    className={cn(\r\n                      \"p-8 rounded-[40px] border transition-all duration-500 text-left group relative overflow-hidden\",\r\n                      selectedTreatment?.id === t.id \r\n                        ? \"bg-primary/5 border-primary/40 shadow-premium scale-[1.02]\" \r\n                        : \"bg-secondary/20 border-border/50 hover:border-primary/20\"\r\n                    )}\r\n                  >\r\n                    <div className=\"absolute top-0 right-0 p-8 opacity-[0.02] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                      <FirstAidKit className=\"w-32 h-32 text-primary\" />\r\n                    </div>\r\n\r\n                    <div className=\"flex justify-between items-start mb-8 relative z-10\">\r\n                      <div className={cn(\r\n                        \"w-14 h-14 rounded-2xl bg-secondary border border-border flex items-center justify-center text-primary group-hover:bg-primary/10 transition-all duration-500 shadow-inner\",\r\n                        selectedTreatment?.id === t.id ? \"bg-primary text-primary-foreground border-primary\" : \"bg-card text-primary border-border/50 group-hover:border-primary/20\"\r\n                      )}>\r\n                        <FirstAidKit weight=\"duotone\" className=\"w-7 h-7\" />\r\n                      </div>\r\n                      <div className=\"text-right\">\r\n                        <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.2em]\">Protocol Entry</p>\r\n                        <p className=\"text-2xl font-black text-foreground tabular-nums tracking-tighter\">เธฟ{t.price_min.toLocaleString()}</p>\r\n                      </div>\r\n                    </div>\r\n                    \r\n                    <div className=\"space-y-1 relative z-10\">\r\n                      <h3 className=\"text-xl font-black text-foreground group-hover:text-primary transition-colors tracking-tight uppercase\">{t.names.th}</h3>\r\n                      <p className=\"text-[10px] text-muted-foreground uppercase tracking-widest font-black opacity-60\">{t.names.en}</p>\r\n                    </div>\r\n\r\n                    <div className=\"mt-8 flex items-center gap-3 relative z-10 pt-6 border-t border-border/30\">\r\n                      <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[8px] tracking-widest uppercase px-3\">{t.category}</Badge>\r\n                      <Badge variant=\"ghost\" className=\"bg-secondary text-muted-foreground border-none font-black text-[8px] tracking-widest uppercase px-3\">Active</Badge>\r\n                    </div>\r\n                  </motion.button>\r\n                ))}\r\n              </div>\r\n\r\n              <div className=\"flex justify-end pt-10\">\r\n                <Button\r\n                  disabled={!selectedTreatment}\r\n                  onClick={() => setStep(2)}\r\n                  className=\"group px-12 py-7 rounded-[32px] text-xs font-black uppercase tracking-[0.3em] shadow-premium gap-4\"\r\n                >\r\n                  Configure Temporal Node\r\n                  <CaretRight weight=\"bold\" className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />\r\n                </Button>\r\n              </div>\r\n            </motion.div>\r\n          )}\r\n\r\n          {/* Step 2: Temporal Sync */}\r\n          {step === 2 && (\r\n            <motion.div\r\n              key=\"step2\"\r\n              initial={{ opacity: 0, y: 20 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              exit={{ opacity: 0, scale: 0.95 }}\r\n              className=\"grid grid-cols-1 lg:grid-cols-3 gap-10\"\r\n            >\r\n              <div className=\"lg:col-span-2 space-y-8\">\r\n                <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n                  <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                      <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n                        <CalendarDots weight=\"duotone\" className=\"w-6 h-6\" />\r\n                      </div>\r\n                      <div>\r\n                        <CardTitle className=\"text-lg font-black uppercase tracking-tight\">Select Cycle Date</CardTitle>\r\n                        <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Primary chronological node</p>\r\n                      </div>\r\n                    </div>\r\n                  </CardHeader>\r\n                  <CardContent className=\"p-10\">\r\n                    <div className=\"relative group/input\">\r\n                      <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-3xl\" />\r\n                      <input \r\n                        type=\"date\"\r\n                        value={selectedDate}\r\n                        onChange={(e) => setSelectedDate(e.target.value)}\r\n                        min={new Date().toISOString().split('T')[0]}\r\n                        className=\"w-full bg-secondary/50 border border-border rounded-3xl py-6 px-10 text-2xl font-black text-foreground focus:outline-none focus:border-primary transition-all [color-scheme:dark] shadow-inner relative z-10\"\r\n                      />\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n                  <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                      <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n                        <Clock weight=\"duotone\" className=\"w-6 h-6\" />\r\n                      </div>\r\n                      <div>\r\n                        <CardTitle className=\"text-lg font-black uppercase tracking-tight\">Temporal Shift</CardTitle>\r\n                        <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Daily operational slots</p>\r\n                      </div>\r\n                    </div>\r\n                  </CardHeader>\r\n                  <CardContent className=\"p-10\">\r\n                    <div className=\"grid grid-cols-3 md:grid-cols-4 gap-4\">\r\n                      {['09:00', '10:00', '11:00', '13:00', '14:00', '15:00', '16:00', '17:00'].map((time) => (\r\n                        <button\r\n                          key={time}\r\n                          onClick={() => setSelectedTime(time)}\r\n                          className={cn(\r\n                            \"py-5 rounded-[24px] border text-sm font-black transition-all duration-300 tabular-nums\",\r\n                            selectedTime === time \r\n                              ? \"bg-primary text-primary-foreground border-primary shadow-premium\" \r\n                              : \"bg-secondary/20 border-border/50 text-muted-foreground hover:border-primary/30 hover:bg-secondary/40\"\r\n                          )}\r\n                        >\r\n                          {time}\r\n                        </button>\r\n                      ))}\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n\r\n              <div className=\"space-y-8\">\r\n                <Card className=\"p-8 rounded-[40px] border-border shadow-card relative overflow-hidden group\">\r\n                  <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                    <Sparkle className=\"w-64 h-64 text-primary\" />\r\n                  </div>\r\n\r\n                  <h4 className=\"text-[10px] font-black text-primary uppercase tracking-[0.3em] mb-8 relative z-10\">Configuration Summary</h4>\r\n                  <div className=\"space-y-8 relative z-10\">\r\n                    <div className=\"flex items-center gap-5\">\r\n                      <div className=\"w-12 h-12 rounded-2xl bg-secondary border border-border flex items-center justify-center text-primary shadow-inner\">\r\n                        <FirstAidKit weight=\"duotone\" className=\"w-6 h-6\" />\r\n                      </div>\r\n                      <div className=\"min-w-0\">\r\n                        <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">Protocol</p>\r\n                        <p className=\"text-sm font-bold text-foreground truncate\">{selectedTreatment?.names.th || 'Not Initialized'}</p>\r\n                      </div>\r\n                    </div>\r\n                    {selectedDate && (\r\n                      <div className=\"flex items-center gap-5\">\r\n                        <div className=\"w-12 h-12 rounded-2xl bg-secondary border border-border flex items-center justify-center text-blue-500 shadow-inner\">\r\n                          <CalendarDots weight=\"duotone\" className=\"w-6 h-6\" />\r\n                        </div>\r\n                        <div>\r\n                          <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">Target Date</p>\r\n                          <p className=\"text-sm font-bold text-foreground\">\r\n                            {new Date(selectedDate).toLocaleDateString(undefined, { weekday: 'short', day: 'numeric', month: 'short' })}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </Card>\r\n\r\n                <div className=\"flex gap-4\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={() => setStep(1)}\r\n                    className=\"p-6 h-16 w-16 border-border rounded-[24px] text-muted-foreground hover:text-foreground\"\r\n                  >\r\n                    <CaretLeft weight=\"bold\" className=\"w-6 h-6\" />\r\n                  </Button>\r\n                  <Button\r\n                    disabled={!selectedDate || !selectedTime}\r\n                    onClick={() => setStep(3)}\r\n                    className=\"flex-1 py-6 rounded-[24px] text-xs font-black uppercase tracking-widest shadow-premium gap-3\"\r\n                  >\r\n                    Seal Node\r\n                    <CaretRight weight=\"bold\" className=\"w-4 h-4\" />\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </motion.div>\r\n          )}\r\n\r\n          {/* Step 3: Deployment Authorization */}\r\n          {step === 3 && (\r\n            <motion.div\r\n              key=\"step3\"\r\n              initial={{ opacity: 0, scale: 0.95 }}\r\n              animate={{ opacity: 1, scale: 1 }}\r\n              exit={{ opacity: 0, scale: 0.95 }}\r\n              className=\"max-w-2xl mx-auto px-2\"\r\n            >\r\n              <Card className=\"rounded-[56px] border-primary/20 shadow-premium overflow-hidden group\">\r\n                <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                  <Sparkle className=\"w-64 h-64 text-primary\" />\r\n                </div>\r\n\r\n                <div className=\"p-12 md:p-16 space-y-12 relative z-10\">\r\n                  <div className=\"text-center space-y-3\">\r\n                    <div className=\"w-20 h-20 rounded-[32px] bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-glow-sm mx-auto mb-6\">\r\n                      <Monitor weight=\"duotone\" className=\"w-10 h-10\" />\r\n                    </div>\r\n                    <h3 className=\"text-3xl font-black text-foreground uppercase tracking-tight\">Authorization Review</h3>\r\n                    <p className=\"text-sm text-muted-foreground font-medium italic\">Validating clinical protocol deployment nodes</p>\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-2 gap-6\">\r\n                    {[\r\n                      { label: 'Protocol Node', value: selectedTreatment?.names.th, icon: FirstAidKit },\r\n                      { label: 'Fiscal Node', value: `เธฟ${selectedTreatment?.price_min.toLocaleString()}`, icon: CreditCard, color: 'text-emerald-500' },\r\n                      { label: 'Temporal Node', value: new Date(selectedDate).toLocaleDateString(), icon: CalendarDots },\r\n                      { label: 'Temporal Cycle', value: selectedTime, icon: Clock }\r\n                    ].map((item, i) => (\r\n                      <div key={i} className=\"p-6 bg-secondary/30 border border-border/50 rounded-[32px] space-y-2 group/item transition-all hover:bg-secondary/40\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                          <item.icon weight=\"duotone\" className={cn(\"w-4 h-4\", item.color || \"text-primary\")} />\r\n                          <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-widest\">{item.label}</p>\r\n                        </div>\r\n                        <p className={cn(\"text-base font-bold uppercase tracking-tight truncate\", item.color || \"text-foreground\")}>{item.value}</p>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n\r\n                  <div className=\"space-y-4\">\r\n                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-4 flex items-center gap-3\">\r\n                      <Briefcase weight=\"duotone\" className=\"w-4 h-4\" />\r\n                      Clinical Directives\r\n                    </label>\r\n                    <textarea \r\n                      value={customerNotes}\r\n                      onChange={(e) => setCustomerNotes(e.target.value)}\r\n                      placeholder=\"Input additional telemetry or specific protocol requirements...\"\r\n                      className=\"w-full bg-secondary/50 border border-border rounded-[32px] p-8 text-sm text-foreground focus:border-primary outline-none transition-all resize-none italic font-medium shadow-inner\"\r\n                      rows={4}\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"flex gap-4 pt-6\">\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      onClick={() => setStep(2)}\r\n                      disabled={submitting}\r\n                      className=\"px-10 py-6 rounded-[28px] text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\"\r\n                    >\r\n                      Refine\r\n                    </Button>\r\n                    <Button\r\n                      onClick={handleBooking}\r\n                      disabled={submitting}\r\n                      className=\"flex-1 py-6 rounded-[28px] text-[10px] font-black uppercase tracking-[0.2em] shadow-premium gap-4\"\r\n                    >\r\n                      {submitting ? (\r\n                        <>\r\n                          <SpinnerGap className=\"w-5 h-5 animate-spin\" />\r\n                          Synchronizing...\r\n                        </>\r\n                      ) : (\r\n                        <>\r\n                          <Sparkle weight=\"bold\" className=\"w-5 h-5\" />\r\n                          Commit Protocol\r\n                        </>\r\n                      )}\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </Card>\r\n            </motion.div>\r\n          )}\r\n        </AnimatePresence>\r\n      </div>\r\n\r\n      {/* Synchronized Success Node */}\r\n      <AnimatePresence>\r\n        {bookingSuccess && (\r\n          <div className=\"fixed inset-0 z-[300] flex items-center justify-center p-4 overflow-y-auto\">\r\n            <motion.div\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              exit={{ opacity: 0 }}\r\n              className=\"absolute inset-0 bg-black/80 backdrop-blur-xl\"\r\n            />\r\n            <motion.div\r\n              initial={{ scale: 0.8, opacity: 0, y: 20 }}\r\n              animate={{ scale: 1, opacity: 1, y: 0 }}\r\n              className=\"relative w-full max-w-md bg-card border border-primary/30 rounded-[56px] p-12 text-center shadow-premium group overflow-hidden\"\r\n            >\r\n              <div className=\"absolute inset-0 bg-scanner-grid opacity-[0.05] pointer-events-none\" />\r\n              \r\n              <div className=\"relative z-10 space-y-10\">\r\n                <div className=\"w-24 h-24 rounded-[40px] bg-emerald-500/10 border border-emerald-500/20 flex items-center justify-center mx-auto shadow-glow-sm group-hover:scale-110 transition-transform duration-700\">\r\n                  <CheckCircle weight=\"fill\" className=\"w-12 h-12 text-emerald-500\" />\r\n                </div>\r\n                \r\n                <div className=\"space-y-3\">\r\n                  <h3 className=\"text-3xl font-black text-foreground uppercase tracking-tight\">Cycle Active</h3>\r\n                  <p className=\"text-sm text-muted-foreground font-medium italic\">Clinical temporal node initialized successfully.</p>\r\n                </div>\r\n                \r\n                <div className=\"p-8 bg-secondary/30 rounded-[32px] border border-border/50 shadow-inner relative group/token overflow-hidden\">\r\n                  <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mb-4\">Protocol Identity Token</p>\r\n                  <p className=\"text-2xl font-mono text-primary font-black tracking-[0.2em]\">{bookingSuccess}</p>\r\n                </div>\r\n\r\n                <Button\r\n                  onClick={() => router.push('/customer')}\r\n                  className=\"w-full py-6 rounded-[28px] text-[10px] font-black uppercase tracking-widest shadow-premium gap-3 hover:scale-105 transition-all\"\r\n                >\r\n                  Return to Dashboard\r\n                  <ArrowRight weight=\"bold\" className=\"w-4 h-4\" />\r\n                </Button>\r\n              </div>\r\n            </motion.div>\r\n          </div>\r\n        )}\r\n      </AnimatePresence>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\customer\\loyalty\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\customer\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Invalid character.","line":116,"column":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect, useMemo } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  Sparkle, \n  ChatCircle, \n  CalendarDots, \n  SpinnerGap,\n  CaretRight,\n  TrendUp,\n  Lightning,\n  ShieldCheck,\n  Heartbeat,\n  User,\n  Clock,\n  ArrowRight,\n  Gift,\n  Crown,\n  Pulse,\n  Monitor,\n  Icon\n} from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { useTranslations } from 'next-intl';\nimport { createClient } from '@/lib/supabase/client';\nimport MySalesRep from '@/components/customer/MySalesRep';\nimport TreatmentJourney from '@/components/customer/TreatmentJourney';\nimport DirectChat from '@/components/customer/DirectChat';\nimport { Link } from '@/i18n/routing';\nimport { cn } from '@/lib/utils';\n\nexport default function CustomerDashboard() {\n  const { goBack } = useBackNavigation();\n  const t = useTranslations('customer' as any);\n  const [loading, setLoading] = useState(true);\n  const [customerName, setCustomerName] = useState('');\n  const [realCustomerId, setRealCustomerId] = useState<string | null>(null);\n  const [salesRep, setSalesRep] = useState<{ id: string; name: string } | null>(null);\n  const [isChatOpen, setIsChatOpen] = useState(false);\n  const [loyaltyPoints, setLoyaltyPoints] = useState(0);\n  const [overview, setOverview] = useState({\n    skinScore: 0,\n    activeTreatments: 0,\n    nextSessionDate: null as string | null\n  });\n\n  const supabase = useMemo(() => createClient(), []);\n\n  useEffect(() => {\n    async function fetchCustomerData() {\n      setLoading(true);\n      try {\n        const { data: { user } } = await supabase.auth.getUser();\n        if (user) {\n          const { data: customer } = await supabase\n            .from('customers')\n            .select('id, full_name, assigned_sales_id')\n            .eq('user_id', user.id)\n            .single();\n          \n          if (customer) {\n            setCustomerName(customer.full_name);\n            setRealCustomerId(customer.id);\n            \n            if (customer.assigned_sales_id) {\n              const { data: salesUser } = await supabase\n                .from('users')\n                .select('id, full_name')\n                .eq('id', customer.assigned_sales_id)\n                .single();\n              if (salesUser) {\n                setSalesRep({\n                  id: salesUser.id,\n                  name: salesUser.full_name\n                });\n              }\n            }\n\n            const [pointsRes, overviewRes] = await Promise.all([\n              fetch('/api/loyalty/points'),\n              fetch('/api/reports?type=customer_overview')\n            ]);\n\n            const [pointsData, overviewData] = await Promise.all([\n              pointsRes.json(),\n              overviewRes.json()\n            ]);\n\n            if (pointsData.success) {\n              setLoyaltyPoints(pointsData.data.points || 0);\n            }\n\n            if (overviewData.success) {\n              setOverview(overviewData.data);\n            }\n          }\n        }\n      } catch (err) {\n        console.error('Customer Dashboard Error:', err);\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    fetchCustomerData();\n  }, [supabase]);\n\n  if (loading) {\n    return (\n      <div className=\\\"min-h-[400px] flex flex-col items-center justify-center space-y-4\\\">\n        <SpinnerGap className=\\\"w-10 h-10 text-primary animate-spin\\\" />\n        <p className=\\\"text-muted-foreground animate-pulse text-xs uppercase tracking-widest text-center\\\">\n          Loading Your Aesthetic Profile...\n        </p>\n      </div>\n    );\n  }\n\n  const getStageColor = (stage: string) => {\n    switch (stage) {\n      case 'scanned': return 'bg-blue-500/10 text-blue-400 border-blue-500/20';\n      case 'proposal_sent': return 'bg-purple-500/10 text-purple-400 border-purple-500/20';\n      case 'payment_confirmed': return 'bg-emerald-500/10 text-emerald-400 border-emerald-500/20';\n      default: return 'bg-secondary text-muted-foreground border-border/50';\n    }\n  };\n\n  const activeWorkflow = null; // Placeholder for active workflow detection\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\\\"space-y-8 pb-20 font-sans\\\"\n    >\n      <Breadcrumb />\n\n      {/* Welcome Header */}\n      <div className=\\\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\\\">\n        <div className=\\\"space-y-1\\\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\\\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\\\"\n          >\n            <Sparkle weight=\\\"duotone\\\" className=\\\"w-4 h-4\\\" />\n            Elite Aura Member Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\\\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\\\"\n          >\n            Welcome, <span className=\\\"text-primary\\\">{customerName || 'Valued Guest'}</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\\\"text-muted-foreground font-light text-sm italic\\\"\n          >\n            Orchestrating your personalized clinical path to aesthetic excellence.\n          </motion.p>\n        </div>\n\n        <motion.div \n          initial={{ opacity: 0, scale: 0.9 }}\n          animate={{ opacity: 1, scale: 1 }}\n          transition={{ delay: 0.3 }}\n          className=\\\"flex flex-wrap gap-3\\\"\n        >\n          <Link href=\\\"/customer/booking\\\">\n            <Button className=\\\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\\\">\n              <CalendarDots weight=\\\"bold\\\" className=\\\"w-4 h-4\\\" />\n              Initialize Booking\n            </Button>\n          </Link>\n          <Button \n            variant=\\\"outline\\\"\n            onClick={() => setIsChatOpen(true)}\n            className=\\\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\\\"\n          >\n            <ChatCircle weight=\\\"duotone\\\" className=\\\"w-4 h-4 text-primary group-hover:scale-110 transition-transform\\\" />\n            Advisor Link\n          </Button>\n        </motion.div>\n      </div>\n\n      {/* Main Content Grid */}\n      <div className=\\\"grid grid-cols-1 lg:grid-cols-3 gap-10 px-2\\\">\n        {/* Left: Journey and Progress */}\n        <div className=\\\"lg:col-span-2 space-y-10\\\">\n          {/* Quick Stats Summary */}\n          <div className=\\\"grid grid-cols-1 md:grid-cols-3 gap-8\\\">\n            <StatCard\n              title=\\\"Skin Health Score\\\"\n              value={overview.skinScore}\n              suffix=\\\"/100\\\"\n              icon={Heartbeat as Icon}\n              trend=\\\"up\\\"\n              change={5}\n              className=\\\"p-4\\\"\n            />\n            <StatCard\n              title=\\\"Active Protocols\\\"\n              value={overview.activeTreatments}\n              icon={Lightning as Icon}\n              trend=\\\"neutral\\\"\n              className=\\\"p-4\\\"\n            />\n            <StatCard\n              title=\\\"Temporal Sync\\\"\n              value={overview.nextSessionDate ? 1 : 0}\n              prefix={overview.nextSessionDate ? \\\"\\\" : \\\"N/A\\\"}\n              suffix={overview.nextSessionDate ? \\\" Active\\\" : \\\"\\\"}\n              icon={CalendarDots as Icon}\n              className={cn(\\\"p-4\\\", !overview.nextSessionDate && \\\"opacity-50\\\")}\n            />\n          </div>\n\n          {/* Treatment Journey Node */}\n          {realCustomerId && (\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.4 }}\n            >\n              <Card className=\\\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\\\">\n                <CardHeader className=\\\"p-8 border-b border-border/50 bg-secondary/30\\\">\n                  <div className=\\\"flex items-center gap-4\\\">\n                    <div className=\\\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\\\">\n                      <Pulse weight=\\\"duotone\\\" className=\\\"w-6 h-6\\\" />\n                    </div>\n                    <div>\n                      <CardTitle className=\\\"text-xl font-black uppercase tracking-tight\\\">Active Treatment Cycle</CardTitle>\n                      <p className=\\\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\\\">Chronological progress registry</p>\n                    </div>\n                  </div>\n                </CardHeader>\n                <CardContent className=\\\"p-8\\\">\n                  <TreatmentJourney customerId={realCustomerId} />\n                </CardContent>\n              </Card>\n            </motion.div>\n          )}\n\n          {/* Skin Analysis Intelligence */}\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.5 }}\n          >\n            <Card className=\\\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group relative\\\">\n              <div className=\\\"absolute top-0 right-0 p-12 opacity-[0.02] group-hover:scale-110 transition-transform duration-700 pointer-events-none\\\">\n                <Sparkle className=\\\"w-64 h-64 text-primary\\\" />\n              </div>\n              \n              <CardHeader className=\\\"p-8 border-b border-border/50 bg-secondary/30 flex flex-row items-center justify-between\\\">\n                <div className=\\\"flex items-center gap-4\\\">\n                  <div className=\\\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\\\">\n                    <Monitor weight=\\\"duotone\\\" className=\\\"w-6 h-6\\\" />\n                  </div>\n                  <div>\n                    <CardTitle className=\\\"text-xl font-black uppercase tracking-tight\\\">Cutaneous Intelligence</CardTitle>\n                    <p className=\\\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\\\">AI-driven biometric analysis</p>\n                  </div>\n                </div>\n                <Link href=\\\"/customer/skin-profile\\\">\n                  <Button variant=\\\"ghost\\\" size=\\\"sm\\\" className=\\\"text-primary font-black uppercase tracking-widest gap-3 hover:bg-primary/5 rounded-xl px-4 py-2\\\">\n                    Access Profile <CaretRight weight=\\\"bold\\\" className=\\\"w-3.5 h-3.5\\\" />\n                  </Button>\n                </Link>\n              </CardHeader>\n\n              <CardContent className=\\\"p-10 relative z-10\\\">\n                <div className=\\\"grid grid-cols-2 md:grid-cols-4 gap-8\\\">\n                  {[\n                    { label: 'Hydration', value: 'Optimized', percentage: 75, color: 'bg-blue-400' },\n                    { label: 'Elasticity', value: 'Premium', percentage: 92, color: 'bg-emerald-400' },\n                    { label: 'Surface', value: 'Refining', percentage: 60, color: 'bg-amber-400' },\n                    { label: 'Pore Matrix', value: 'Excellent', percentage: 85, color: 'bg-primary' }\n                  ].map((item, i) => (\n                    <motion.div \n                      key={item.label} \n                      initial={{ opacity: 0, scale: 0.9 }}\n                      animate={{ opacity: 1, scale: 1 }}\n                      transition={{ delay: 0.6 + i * 0.1 }}\n                      className=\\\"space-y-4\\\"\n                    >\n                      <div className=\\\"space-y-1\\\">\n                        <p className=\\\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\\\">{item.label}</p>\n                        <p className=\\\"text-lg font-bold text-foreground uppercase tracking-tight\\\">{item.value}</p>\n                      </div>\n                      <div className=\\\"h-2 w-full bg-secondary rounded-full overflow-hidden p-0.5 border border-border/50 shadow-inner\\\">\n                        <motion.div \n                          initial={{ width: 0 }}\n                          animate={{ width: ${item.percentage}% }}\n                          transition={{ duration: 1.5, ease: \\\"easeOut\\\", delay: 0.8 + i * 0.1 }}\n                          className={cn(\\\"h-full rounded-full shadow-glow-sm\\\", item.color)} \n                        />\n                      </div>\n                    </motion.div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        </div>\n\n        {/* Right Sidebar: Advisor and Rewards */}\n        <div className=\\\"space-y-10\\\">\n          {/* Advisor Identification */}\n          {realCustomerId && (\n            <motion.div\n              initial={{ opacity: 0, x: 20 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ delay: 0.6 }}\n            >\n              <Card className=\\\"rounded-[40px] border-border/50 overflow-hidden group\\\">\n                <CardContent className=\\\"p-0\\\">\n                  <MySalesRep customerId={realCustomerId} />\n                </CardContent>\n              </Card>\n            </motion.div>\n          )}\n\n          {/* AI Personalized Recommendation Hub */}\n          <Card className=\\\"rounded-[40px] border-primary/10 overflow-hidden shadow-premium group\\\">\n            <div className=\\\"absolute -bottom-12 -right-12 w-32 h-32 bg-primary/5 blur-[50px] rounded-full group-hover:bg-primary/10 transition-all duration-700\\\" />\n            \n            <CardHeader className=\\\"p-8 border-b border-border/50 bg-primary/5\\\">\n              <CardTitle className=\\\"text-xs font-black uppercase tracking-[0.3em] flex items-center gap-3 text-primary\\\">\n                <Sparkle weight=\\\"duotone\\\" className=\\\"w-5 h-5\\\" />\n                Cognitive Suggestions\n              </CardTitle>\n            </CardHeader>\n\n            <CardContent className=\\\"p-8 space-y-4 relative z-10\\\">\n              {[\n                { title: 'Vitamin C Brightening', type: 'Product Protocol', price: '๏ฟฝ2,450', color: 'text-emerald-500', bg: 'bg-emerald-500/5', icon: Gift },\n                { title: 'HydraFacial Node', type: 'Clinical Cycle', price: '๏ฟฝ4,500', color: 'text-primary', bg: 'bg-primary/5', icon: Lightning }\n              ].map((offer, i) => (\n                <motion.div \n                  key={offer.title}\n                  whileHover={{ x: 4 }}\n                  className=\\\"p-5 bg-secondary/30 rounded-3xl border border-border/50 hover:border-primary/30 transition-all cursor-pointer group/offer hover:bg-secondary/50 flex flex-col gap-3\\\"\n                >\n                  <div className=\\\"flex justify-between items-start\\\">\n                    <div className=\\\"space-y-1\\\">\n                      <p className=\\\"text-[8px] font-black text-muted-foreground uppercase tracking-widest\\\">{offer.type}</p>\n                      <h4 className=\\\"text-sm font-bold text-foreground group-hover/offer:text-primary transition-colors uppercase tracking-tight\\\">{offer.title}</h4>\n                    </div>\n                    <Badge variant=\\\"ghost\\\" size=\\\"sm\\\" className={cn(\\\"font-black border-none px-3\\\", offer.bg, offer.color)}>\n                      {offer.price}\n                    </Badge>\n                  </div>\n                  <Button variant=\\\"ghost\\\" size=\\\"sm\\\" className=\\\"w-full justify-between px-0 pt-3 border-t border-border/20 text-[9px] font-black uppercase tracking-widest text-muted-foreground group-hover/offer:text-primary\\\">\n                    View Protocol Details <ArrowRight weight=\\\"bold\\\" className=\\\"w-3 h-3\\\" />\n                  </Button>\n                </motion.div>\n              ))}\n              \n              <Button variant=\\\"ghost\\\" className=\\\"w-full mt-4 text-[10px] font-black uppercase tracking-[0.3em] text-muted-foreground hover:text-primary border border-dashed border-border/50 py-4 rounded-2xl\\\">\n                Explore Intelligence Hub\n              </Button>\n            </CardContent>\n          </Card>\n\n          {/* Aura Elite Loyalty Node */}\n          <Card className=\\\"rounded-[40px] border-primary/20 overflow-hidden shadow-premium bg-gradient-to-br from-primary/10 via-background to-background group\\\">\n            <div className=\\\"absolute -top-12 -left-12 w-48 h-48 bg-primary/10 blur-[60px] rounded-full group-hover:bg-primary/20 transition-all duration-700\\\" />\n            \n            <CardHeader className=\\\"p-8 border-b border-primary/10\\\">\n              <div className=\\\"flex items-center justify-between relative z-10\\\">\n                <CardTitle className=\\\"text-xs font-black text-primary uppercase tracking-[0.3em] flex items-center gap-3\\\">\n                  <Crown weight=\\\"duotone\\\" className=\\\"w-5 h-5\\\" />\n                  Elite Status Node\n                </CardTitle>\n                <Badge variant=\\\"ghost\\\" className=\\\"bg-primary/10 text-primary border-none font-black text-[8px] tracking-widest uppercase px-3 py-1\\\">Gold Tier</Badge>\n              </div>\n            </CardHeader>\n\n            <CardContent className=\\\"p-8 space-y-8 relative z-10\\\">\n              <div className=\\\"space-y-4\\\">\n                <div className=\\\"flex items-baseline gap-3\\\">\n                  <span className=\\\"text-5xl font-black text-foreground tracking-tighter tabular-nums\\\">{loyaltyPoints.toLocaleString()}</span>\n                  <span className=\\\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\\\">Points</span>\n                </div>\n                <div className=\\\"space-y-3\\\">\n                  <div className=\\\"h-2 w-full bg-secondary rounded-full overflow-hidden p-0.5 border border-border/50 shadow-inner\\\">\n                    <motion.div \n                      initial={{ width: 0 }}\n                      animate={{ width: ${Math.min(100, (loyaltyPoints / 3000) * 100)}% }}\n                      transition={{ duration: 2, ease: \\\"easeOut\\\", delay: 1 }}\n                      className=\\\"h-full bg-primary shadow-glow-sm rounded-full\\\" \n                    />\n                  </div>\n                  <div className=\\\"flex justify-between items-center text-[9px] font-black uppercase tracking-widest\\\">\n                    <span className=\\\"text-muted-foreground\\\">Gold Registry</span>\n                    <span className=\\\"text-primary\\\">{loyaltyPoints < 3000 ? Sync  for Platinum : 'Platinum Synchronized'}</span>\n                  </div>\n                </div>\n              </div>\n              \n              <Link href=\\\"/customer/loyalty\\\">\n                <Button className=\\\"w-full py-6 rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] shadow-premium group/redeem\\\">\n                  Exchange Privilege Assets\n                  <CaretRight weight=\\\"bold\\\" className=\\\"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform\\\" />\n                </Button>\n              </Link>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n\n      {/* Synchronized Advisor Interface */}\n      <AnimatePresence>\n        {realCustomerId && salesRep && isChatOpen && (\n          <DirectChat\n            customerId={realCustomerId}\n            salesId={salesRep.id}\n            salesName={salesRep.name}\n            isOpen={isChatOpen}\n            onClose={() => setIsChatOpen(false)}\n          />\n        )}\n      </AnimatePresence>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\customer\\rewards\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: ')' expected.","line":564,"column":4}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { \r\n  Gift, \r\n  Plus, \r\n  MagnifyingGlass, \r\n  Copy, \r\n  EnvelopeSimple, \r\n  DownloadSimple, \r\n  Eye, \r\n  DotsThree,\r\n  ArrowLeft,\r\n  ArrowsClockwise,\r\n  CheckCircle,\r\n  Clock,\r\n  CurrencyCircleDollar,\r\n  Ticket,\r\n  Trophy,\r\n  Star,\r\n  Lightning,\r\n  Sparkle,\r\n  IdentificationCard,\r\n  Coins,\r\n  Receipt,\r\n  CaretRight,\r\n  User,\r\n  Tag,\r\n  Check\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { cn } from '@/lib/utils';\r\nimport { useEffect, useState } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { toast } from 'sonner';\r\n\r\ntype Reward = {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  points_cost: number;\r\n  type: string;\r\n  tier_requirement?: string | null;\r\n  monetary_value?: number;\r\n};\r\n\r\ntype Redemption = {\r\n  id: string;\r\n  code: string;\r\n  status: string;\r\n  pointsCost: number;\r\n  issuedAt: string;\r\n  appliedAt?: string | null;\r\n  appliedPosTransactionId?: string | null;\r\n  reward?: {\r\n    id: string;\r\n    name: string;\r\n    type: string;\r\n    monetary_value?: number;\r\n  } | null;\r\n};\r\n\r\ntype PointTxn = {\r\n  id: string;\r\n  type: string;\r\n  amount: number;\r\n  description: string;\r\n  createdAt: string;\r\n};\r\n\r\nexport default function CustomerRewardsPage() {\r\n  const { goBack } = useBackNavigation();\r\n  const [loading, setLoading] = useState(true);\r\n  const [availablePoints, setAvailablePoints] = useState(0);\r\n  const [currentTier, setCurrentTier] = useState('bronze');\r\n  const [rewards, setRewards] = useState<Reward[]>([]);\r\n  const [redeemingId, setRedeemingId] = useState<string | null>(null);\r\n  const [lastRedemptionCode, setLastRedemptionCode] = useState<string | null>(null);\r\n  const [historyLoading, setHistoryLoading] = useState(false);\r\n  const [redemptions, setRedemptions] = useState<Redemption[]>([]);\r\n  const [transactions, setTransactions] = useState<PointTxn[]>([]);\r\n  const [activeTab, setActiveTab] = useState<'rewards' | 'coupons' | 'history'>('rewards');\r\n\r\n  const load = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch('/api/loyalty/rewards');\r\n      const json = await res.json();\r\n      if (json.success) {\r\n        setAvailablePoints(json.data.availablePoints || 0);\r\n        setCurrentTier(json.data.currentTier || 'bronze');\r\n        setRewards(json.data.rewards || []);\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n      setRewards([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadHistory = async () => {\r\n    try {\r\n      setHistoryLoading(true);\r\n      const res = await fetch('/api/loyalty/history?limit=20');\r\n      const json = await res.json();\r\n      if (!res.ok || !json?.success) {\r\n        throw new Error(json?.error || 'Failed to load history');\r\n      }\r\n\r\n      setRedemptions(json.data.redemptions || []);\r\n      setTransactions(json.data.transactions || []);\r\n    } catch (e) {\r\n      console.error(e);\r\n      setRedemptions([]);\r\n      setTransactions([]);\r\n    } finally {\r\n      setHistoryLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    load();\r\n    loadHistory();\r\n  }, []);\r\n\r\n  const redeem = async (rewardId: string) => {\r\n    try {\r\n      setRedeemingId(rewardId);\r\n      const idempotencyKey = crypto.randomUUID();\r\n      const res = await fetch('/api/loyalty/redeem', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Idempotency-Key': idempotencyKey\r\n        },\r\n        body: JSON.stringify({ rewardId })\r\n      });\r\n\r\n      const json = await res.json();\r\n      if (!res.ok || !json?.success) {\r\n        throw new Error(json?.error || 'Redeem failed');\r\n      }\r\n\r\n      setLastRedemptionCode(json.data?.redemptionCode || null);\r\n      await load();\r\n      await loadHistory();\r\n    } catch (e) {\r\n      console.error(e);\r\n      alert('Redeem failed');\r\n    } finally {\r\n      setRedeemingId(null);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-[400px] flex items-center justify-center\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-10 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Trophy weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Reward Node registry\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Exclusive <span className=\"text-primary\">Rewards</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating aesthetic privilege nodes and promotional asset redemptions.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-3\">\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={load}\r\n            disabled={loading}\r\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\r\n          >\r\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\r\n            Sync Vault\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Quick Stats Summary */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\r\n        <StatCard\r\n          title=\"Available Points\"\r\n          value={availablePoints}\r\n          icon={Coins}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Identity Status\"\r\n          value={1}\r\n          prefix={currentTier.toUpperCase()}\r\n          icon={Crown}\r\n          iconColor=\"text-yellow-500\"\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Active Coupons\"\r\n          value={redemptions.filter(r => r.status === 'unused').length}\r\n          icon={Ticket}\r\n          iconColor=\"text-primary\"\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Lifetime Benefits\"\r\n          value={transactions.filter(t => t.type === 'earn').reduce((acc, t) => acc + t.amount, 0)}\r\n          icon={Sparkle}\r\n          iconColor=\"text-purple-500\"\r\n          className=\"p-4\"\r\n        />\r\n      </div>\r\n\r\n      {/* Navigation Tabs */}\r\n      <div className=\"flex bg-secondary/50 border border-border p-1 rounded-2xl w-fit shadow-inner mx-2\">\r\n        {[\r\n          { id: 'rewards', label: 'Reward Nodes', icon: Gift },\r\n          { id: 'coupons', label: 'Active Assets', icon: Ticket },\r\n          { id: 'history', label: 'Protocol Logs', icon: History }\r\n        ].map((tab) => (\r\n          <button\r\n            key={tab.id}\r\n            onClick={() => setActiveTab(tab.id as any)}\r\n            className={cn(\r\n              \"flex items-center gap-3 px-8 py-3 rounded-xl text-[11px] font-black uppercase tracking-widest transition-all border\",\r\n              activeTab === tab.id\r\n                ? \"bg-card text-primary border-border/50 shadow-sm\"\r\n                : \"text-muted-foreground border-transparent hover:text-foreground\"\r\n            )}\r\n          >\r\n            <tab.icon weight={activeTab === tab.id ? \"fill\" : \"bold\"} className=\"w-4 h-4\" />\r\n            {tab.label}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Content Hub */}\r\n      <AnimatePresence mode=\"wait\">\r\n        {loading ? (\r\n          <motion.div \r\n            key=\"loading\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"py-32 flex flex-col items-center gap-4\"\r\n          >\r\n            <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest text-center\">Synchronizing Privilege Matrix...</p>\r\n          </motion.div>\r\n        ) : activeTab === 'rewards' ? (\r\n          <motion.div \r\n            key=\"rewards\"\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, y: -20 }}\r\n            className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 px-2\"\r\n          >\r\n            {rewards.length === 0 ? (\r\n              <Card variant=\"ghost\" className=\"col-span-full py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-6 opacity-40\">\r\n                <Gift weight=\"duotone\" className=\"w-16 h-16 text-muted-foreground\" />\r\n                <p className=\"text-sm font-black uppercase tracking-widest text-center\">Zero Reward Nodes Detected In This Sector</p>\r\n              </Card>\r\n            ) : (\r\n              rewards.map((reward, i) => (\r\n                <motion.div\r\n                  key={reward.id}\r\n                  initial={{ opacity: 0, scale: 0.95 }}\r\n                  animate={{ opacity: 1, scale: 1 }}\r\n                  transition={{ delay: i * 0.05 }}\r\n                >\r\n                  <Card className=\"h-full border-border/50 hover:border-primary/30 transition-all group overflow-hidden flex flex-col\">\r\n                    <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                      <Sparkle className=\"w-32 h-32 text-primary\" />\r\n                    </div>\r\n\r\n                    <CardHeader className=\"pb-4 bg-secondary/30 border-b border-border/50\">\r\n                      <div className=\"flex justify-between items-start gap-4\">\r\n                        <div className=\"space-y-1\">\r\n                          <h3 className=\"text-lg font-bold text-foreground tracking-tight group-hover:text-primary transition-colors uppercase\">{reward.name}</h3>\r\n                          <Badge variant=\"ghost\" size=\"sm\" className=\"bg-primary/5 text-primary border-none font-black text-[8px] tracking-widest uppercase px-3\">\r\n                            {reward.type.replace('_', ' ')}\r\n                          </Badge>\r\n                        </div>\r\n                        <div className=\"flex flex-col items-end\">\r\n                          <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest mb-1\">Exchange Cost</p>\r\n                          <span className=\"text-xl font-black text-primary tabular-nums\">{reward.points_cost} PTS</span>\r\n                        </div>\r\n                      </div>\r\n                    </CardHeader>\r\n\r\n                    <CardContent className=\"p-6 flex-1 flex flex-col justify-between space-y-8 relative z-10\">\r\n                      <p className=\"text-sm text-muted-foreground font-medium italic leading-relaxed\">\r\n                        {reward.description}\r\n                      </p>\r\n\r\n                      <div className=\"space-y-4\">\r\n                        {reward.tier_requirement && (\r\n                          <div className=\"flex items-center gap-2 p-3 bg-amber-500/5 rounded-2xl border border-amber-500/10\">\r\n                            <ShieldCheck weight=\"fill\" className=\"w-4 h-4 text-amber-500\" />\r\n                            <span className=\"text-[10px] font-black text-amber-600 uppercase tracking-widest\">Protocol Required: {reward.tier_requirement}</span>\r\n                          </div>\r\n                        )}\r\n\r\n                        <Button \r\n                          onClick={() => redeem(reward.id)}\r\n                          disabled={availablePoints < reward.points_cost || (reward.tier_requirement && currentTier !== reward.tier_requirement)}\r\n                          className={cn(\r\n                            \"w-full py-6 rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] shadow-premium group/btn\",\r\n                            availablePoints < reward.points_cost && \"opacity-50 grayscale cursor-not-allowed\"\r\n                          )}\r\n                        >\r\n                          {redeemingId === reward.id ? (\r\n                            <SpinnerGap className=\"w-4 h-4 animate-spin\" />\r\n                          ) : (\r\n                            <></>\r\n                          )}\r\n                        </Button>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                </motion.div>\r\n              ))\r\n            )}\r\n          </motion.div>\r\n        ) : activeTab === 'coupons' ? (\r\n          <motion.div \r\n            key=\"coupons\"\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, y: -20 }}\r\n            className=\"grid grid-cols-1 md:grid-cols-2 gap-8 px-2\"\r\n          >\r\n            {redemptions.length === 0 ? (\r\n              <Card variant=\"ghost\" className=\"col-span-full py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-6 opacity-40\">\r\n                <Ticket weight=\"duotone\" className=\"w-16 h-16 text-muted-foreground\" />\r\n                <p className=\"text-sm font-black uppercase tracking-widest text-center\">Identity Registry Empty</p>\r\n              </Card>\r\n            ) : (\r\n              redemptions.map((redemption, i) => (\r\n                <Card key={redemption.id} className=\"p-0 rounded-[32px] border-border/50 shadow-premium overflow-hidden group hover:border-primary/20 transition-all\">\r\n                  <div className=\"flex h-full\">\r\n                    <div className=\"w-32 bg-primary flex flex-col items-center justify-center text-white relative overflow-hidden shrink-0\">\r\n                      <div className=\"absolute inset-0 bg-scanner-grid opacity-20\" />\r\n                      <div className=\"relative z-10 flex flex-col items-center gap-2\">\r\n                        <Ticket weight=\"fill\" className=\"w-10 h-10\" />\r\n                        <span className=\"text-[10px] font-black uppercase tracking-[0.3em] rotate-90 origin-center whitespace-nowrap mt-8\">PROTOCOL</span>\r\n                      </div>\r\n                      {/* Scalloped edge */}\r\n                      <div className=\"absolute top-0 right-[-8px] bottom-0 w-4 flex flex-col justify-around py-2\">\r\n                        {[...Array(8)].map((_, i) => (\r\n                          <div key={i} className=\"w-4 h-4 bg-card rounded-full\" />\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                    \r\n                    <div className=\"flex-1 p-8 space-y-6\">\r\n                      <div className=\"flex justify-between items-start\">\r\n                        <div className=\"space-y-1\">\r\n                          <h4 className=\"text-lg font-black text-foreground uppercase tracking-tight\">{redemption.reward?.name || 'Voucher Asset'}</h4>\r\n                          <Badge variant={redemption.status === 'used' ? 'secondary' : 'success'} size=\"sm\" className=\"font-black text-[8px] tracking-widest px-3\">\r\n                            {redemption.status.toUpperCase()}\r\n                          </Badge>\r\n                        </div>\r\n                        <div className=\"text-right\">\r\n                          <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest mb-1\">Asset ID</p>\r\n                          <span className=\"font-mono text-xs font-black text-primary uppercase\">{redemption.code}</span>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"pt-6 border-t border-border/30 flex justify-between items-end\">\r\n                        <div className=\"space-y-1\">\r\n                          <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest\">Issued Date</p>\r\n                          <p className=\"text-sm font-bold text-foreground tabular-nums\">{new Date(redemption.issuedAt).toLocaleDateString()}</p>\r\n                        </div>\r\n                        <Button \r\n                          variant=\"outline\" \r\n                          size=\"sm\" \r\n                          onClick={() => {\r\n                            navigator.clipboard.writeText(redemption.code);\r\n                            toast.success('Asset code synchronized to clipboard');\r\n                          }}\r\n                          className=\"rounded-xl border-border/50 hover:bg-secondary gap-2 text-[9px] font-black uppercase tracking-widest px-4\"\r\n                        >\r\n                          <Copy weight=\"bold\" className=\"w-3 h-3\" />\r\n                          Link Node\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </Card>\r\n              ))\r\n            )}\r\n          </motion.div>\r\n        ) : (\r\n          <motion.div \r\n            key=\"history\"\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, y: -20 }}\r\n            className=\"px-2\"\r\n          >\r\n            <Card className=\"rounded-[40px] border-border/50 overflow-hidden shadow-premium\">\r\n              <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30 flex flex-row items-center justify-between\">\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n                    <History weight=\"duotone\" className=\"w-6 h-6\" />\r\n                  </div>\r\n                  <div>\r\n                    <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Protocol Lifecycle Ledger</CardTitle>\r\n                    <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Historical point synchronization</p>\r\n                  </div>\r\n                </div>\r\n                <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[10px] tracking-widest uppercase px-4 py-1.5\">Alpha Sync</Badge>\r\n              </CardHeader>\r\n              \r\n              <CardContent className=\"p-8\">\r\n                {transactions.length === 0 ? (\r\n                  <div className=\"py-20 text-center opacity-20 flex flex-col items-center gap-6\">\r\n                    <div className=\"w-20 h-20 rounded-[40px] bg-secondary flex items-center justify-center text-muted-foreground\">\r\n                      <Lightning weight=\"duotone\" className=\"w-10 h-10\" />\r\n                    </div>\r\n                    <p className=\"text-sm font-black uppercase tracking-[0.3em]\">No Temporal Registry Data</p>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"space-y-8\">\r\n                    {transactions.map((txn, i) => (\r\n                      <div key={txn.id} className=\"flex gap-8 group/log\">\r\n                        <div className=\"flex flex-col items-center gap-3\">\r\n                          <div className={cn(\r\n                            \"w-12 h-12 rounded-2xl border flex items-center justify-center transition-all duration-500 shadow-inner shrink-0\",\r\n                            txn.type === 'earn' ? \"bg-emerald-500/10 border-emerald-500/20 text-emerald-500\" : \"bg-rose-500/10 border-rose-500/20 text-rose-500\"\r\n                          )}>\r\n                            <Clock weight=\"duotone\" className=\"w-6 h-6\" />\r\n                          </div>\r\n                          {i !== (transactions.length - 1) && <div className=\"w-0.5 h-full bg-border/50 group-hover/log:bg-primary/30 transition-colors\" />}\r\n                        </div>\r\n                        <div className=\"flex-1 pb-8 group-last/log:pb-0\">\r\n                          <div className=\"flex justify-between items-start mb-2\">\r\n                            <h4 className=\"text-base font-bold text-foreground uppercase tracking-tight group-hover/log:text-primary transition-colors\">{txn.description}</h4>\r\n                            <span className={cn(\r\n                              \"text-lg font-black tabular-nums tracking-tight\",\r\n                              txn.type === 'earn' ? \"text-emerald-500\" : \"text-rose-500\"\r\n                            )}>\r\n                              {txn.type === 'earn' ? '+' : '-'}{txn.amount}\r\n                            </span>\r\n                          </div>\r\n                          <p className=\"text-xs text-muted-foreground font-medium mb-4 italic opacity-80\">Synchronization confirmed at terminal node: {new Date(txn.createdAt).toLocaleString()}</p>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <Badge variant=\"ghost\" className=\"text-[8px] font-black uppercase tracking-widest bg-secondary text-muted-foreground border-none\">TXID: {txn.id.slice(0,8)}</Badge>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Redeemed Code Dialog */}\r\n      <AnimatePresence>\r\n        {lastRedemptionCode && (\r\n          <div className=\"fixed inset-0 z-[300] flex items-center justify-center p-4 overflow-y-auto\">\r\n            <motion.div\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              exit={{ opacity: 0 }}\r\n              className=\"absolute inset-0 bg-black/60 backdrop-blur-sm\"\r\n              onClick={() => setLastRedemptionCode(null)}\r\n            />\r\n            \r\n            <motion.div\r\n              initial={{ scale: 0.95, opacity: 0, y: 20 }}\r\n              animate={{ scale: 1, opacity: 1, y: 0 }}\r\n              exit={{ scale: 0.95, opacity: 0, y: 20 }}\r\n              className=\"relative w-full max-w-md bg-card border border-border rounded-[40px] overflow-hidden shadow-premium group p-10\"\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                <Ticket className=\"w-64 h-64 text-primary\" />\r\n              </div>\r\n\r\n              <div className=\"relative z-10 space-y-10 text-center\">\r\n                <div className=\"w-20 h-20 rounded-full bg-emerald-500/10 flex items-center justify-center text-emerald-500 border border-emerald-500/20 shadow-glow-sm mx-auto\">\r\n                  <Check weight=\"bold\" className=\"w-10 h-10\" />\r\n                </div>\r\n                \r\n                <div className=\"space-y-3\">\r\n                  <h3 className=\"text-2xl font-black text-foreground uppercase tracking-tight\">Redemption Protocol Confirmed</h3>\r\n                  <p className=\"text-sm text-muted-foreground font-medium leading-relaxed italic max-w-sm mx-auto\">\r\n                    Your privilege asset has been initialized and synchronized with the clinical vault. Present this node code at checkout.\r\n                  </p>\r\n                </div>\r\n\r\n                <div className=\"p-8 bg-secondary/30 rounded-[32px] border border-primary/20 relative group/code overflow-hidden\">\r\n                  <div className=\"absolute inset-0 bg-scanner-grid opacity-10 group-hover/code:opacity-20 transition-opacity\" />\r\n                  <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mb-4\">Asset Identification Node</p>\r\n                  <div className=\"flex items-center justify-center gap-4\">\r\n                    <span className=\"text-4xl font-mono font-black text-primary tracking-tighter\">{lastRedemptionCode}</span>\r\n                    <Button \r\n                      variant=\"ghost\" \r\n                      size=\"sm\" \r\n                      onClick={() => {\r\n                        navigator.clipboard.writeText(lastRedemptionCode);\r\n                        toast.success('Asset node linked to clipboard');\r\n                      }}\r\n                      className=\"text-primary hover:bg-primary/10\"\r\n                    >\r\n                      <Copy weight=\"bold\" className=\"w-5 h-5\" />\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n\r\n                <Button \r\n                  onClick={() => setLastRedemptionCode(null)}\r\n                  className=\"w-full py-6 rounded-2xl text-[10px] font-black uppercase tracking-widest shadow-premium\"\r\n                >\r\n                  Terminate Terminal\r\n                </Button>\r\n              </div>\r\n            </motion.div>\r\n          </div>\r\n        )}\r\n      </AnimatePresence>\r\n    </motion.div>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\customer\\skin-profile\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Expected corresponding JSX closing tag for 'CardContent'.","line":401,"column":18}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { \r\n  Sparkle, \r\n  ClockCounterClockwise, \r\n  ArrowLeft, \r\n  SpinnerGap, \r\n  CaretRight,\r\n  TrendUp,\r\n  Camera,\r\n  Image as ImageIcon,\r\n  CheckCircle,\r\n  CalendarDots,\r\n  Lightning,\r\n  Info,\r\n  Monitor,\r\n  IdentificationBadge,\r\n  Graph,\r\n  ArrowsClockwise,\r\n  ArrowRight,\r\n  User,\r\n  ShieldCheck,\r\n  History\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { createClient } from '@/lib/supabase/client';\r\nimport { cn } from '@/lib/utils';\r\nimport { useState, useEffect, useCallback, useMemo, Suspense } from 'react';\r\nimport { useRouter } from '@/i18n/routing';\r\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, AreaChart, Area } from 'recharts';\r\nimport BeforeAfterReport from '@/components/BeforeAfterReport';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface SkinAnalysis {\r\n  id: string;\r\n  image_url: string;\r\n  overall_score: number;\r\n  skin_type: string;\r\n  skin_age: number;\r\n  analyzed_at: string;\r\n  pores_score: number;\r\n  wrinkles_score: number;\r\n  texture_score: number;\r\n  spots_score: number;\r\n  recommendations: any;\r\n}\r\n\r\nfunction SkinProfileContent() {\r\n  const { goBack } = useBackNavigation();\r\n  const [loading, setLoading] = useState(true);\r\n  const [analyses, setAnalyses] = useState<SkinAnalysis[]>([]);\r\n  const [comparisons, setComparisons] = useState<any[]>([]);\r\n  const [selectedBefore, setSelectedBefore] = useState<SkinAnalysis | null>(null);\r\n  const [selectedAfter, setSelectedAfter] = useState<SkinAnalysis | null>(null);\r\n  const [activeTab, setActiveTab] = useState<'history' | 'progress' | 'compare'>('history');\r\n\r\n  const supabase = createClient();\r\n\r\n  const fetchData = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) return;\r\n\r\n      // 1. Fetch all analyses\r\n      const { data: analysisData, error: analysisError } = await supabase\r\n        .from('skin_analyses')\r\n        .select('*')\r\n        .eq('user_id', user.id)\r\n        .order('analyzed_at', { ascending: false });\r\n\r\n      if (analysisError) throw analysisError;\r\n      setAnalyses(analysisData || []);\r\n\r\n      // 2. Fetch existing comparisons\r\n      const res = await fetch(`/api/analysis/compare?userId=${user.id}`);\r\n      const compResult = await res.json();\r\n      if (compResult.success) {\r\n        setComparisons(compResult.data);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching skin profile data:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [supabase]);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, [fetchData]);\r\n\r\n  const handleCreateComparison = async () => {\r\n    if (!selectedBefore || !selectedAfter) return;\r\n    \r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      const res = await fetch('/api/analysis/compare', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          user_id: user?.id,\r\n          before_analysis_id: selectedBefore.id,\r\n          after_analysis_id: selectedAfter.id\r\n        })\r\n      });\r\n      \r\n      const result = await res.json();\r\n      if (result.success) {\r\n        fetchData();\r\n        setActiveTab('history');\r\n        setSelectedBefore(null);\r\n        setSelectedAfter(null);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error creating comparison:', err);\r\n    }\r\n  };\r\n\r\n  const chartData = [...analyses].reverse().map(a => ({\r\n    date: new Date(a.analyzed_at).toLocaleDateString(undefined, { month: 'short', day: 'numeric' }),\r\n    score: a.overall_score,\r\n    texture: a.texture_score,\r\n    pores: a.pores_score,\r\n    wrinkles: a.wrinkles_score\r\n  }));\r\n\r\n  if (loading && analyses.length === 0) {\r\n    return (\r\n      <div className=\"h-[80vh] flex flex-col items-center justify-center space-y-6\">\r\n        <SpinnerGap className=\"w-12 h-12 text-primary animate-spin\" />\r\n        <p className=\"text-sm font-black uppercase tracking-[0.3em] text-muted-foreground animate-pulse\">Accessing Biometric Core...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Monitor weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Biometric Profile Registry\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Skin <span className=\"text-primary\">Intelligence</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating your clinical diagnostic data, progression deltas, and transformation trajectories.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-3\">\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={fetchData}\r\n            disabled={loading}\r\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\r\n          >\r\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\r\n            Sync Metrics\r\n          </Button>\r\n          <Link href=\"/customer/booking\">\r\n            <Button className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\">\r\n              <Camera weight=\"bold\" className=\"w-4 h-4\" />\r\n              Initialize Scan\r\n            </Button>\r\n          </Link>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Navigation Nodes */}\r\n      <div className=\"flex bg-secondary/50 border border-border p-1.5 rounded-[24px] w-fit shadow-inner mx-2\">\r\n        {[\r\n          { id: 'history', label: 'Diagnostic Vault', icon: History },\r\n          { id: 'progress', label: 'Evolution Matrix', icon: Graph },\r\n          { id: 'compare', label: 'Transformation Delta', icon: ImageIcon }\r\n        ].map((tab) => (\r\n          <button\r\n            key={tab.id}\r\n            onClick={() => setActiveTab(tab.id as any)}\r\n            className={cn(\r\n              \"flex items-center gap-3 px-8 py-3 rounded-2xl transition-all text-[10px] font-black uppercase tracking-widest border whitespace-nowrap\",\r\n              activeTab === tab.id\r\n                ? \"bg-primary text-primary-foreground border-primary shadow-premium\"\r\n                : \"bg-transparent text-muted-foreground border-transparent hover:bg-secondary hover:text-foreground\"\r\n            )}\r\n          >\r\n            <tab.icon weight={activeTab === tab.id ? \"fill\" : \"bold\"} className=\"w-4 h-4\" />\r\n            {tab.label}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Main Content Hub */}\r\n      <AnimatePresence mode=\"wait\">\r\n        {loading ? (\r\n          <motion.div \r\n            key=\"loading\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"py-32 flex flex-col items-center gap-4\"\r\n          >\r\n            <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest text-center\">Accessing Biometric Core...</p>\r\n          </motion.div>\r\n        ) : activeTab === 'history' ? (\r\n          <motion.div \r\n            key=\"history\"\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, y: -20 }}\r\n            className=\"space-y-8\"\r\n          >\r\n            {analyses.length === 0 ? (\r\n              <Card variant=\"ghost\" className=\"py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-6 opacity-40\">\r\n                <Monitor weight=\"duotone\" className=\"w-16 h-16 text-muted-foreground\" />\r\n                <p className=\"text-sm font-black uppercase tracking-widest text-center\">Zero Diagnostic Nodes Detected</p>\r\n              </Card>\r\n            ) : (\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 px-2\">\r\n                {analyses.map((scan, i) => (\r\n                  <motion.div\r\n                    key={scan.id}\r\n                    initial={{ opacity: 0, scale: 0.95 }}\r\n                    animate={{ opacity: 1, scale: 1 }}\r\n                    transition={{ delay: i * 0.05 }}\r\n                  >\r\n                    <Card className=\"h-full border-border/50 hover:border-primary/30 transition-all group overflow-hidden flex flex-col\">\r\n                      <div className=\"relative aspect-[4/3] overflow-hidden bg-secondary/50\">\r\n                        <img src={scan.image_url} className=\"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110\" alt=\"Scan\" />\r\n                        <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500\" />\r\n                        <div className=\"absolute top-4 left-4\">\r\n                          <Badge variant=\"ghost\" className=\"bg-black/40 backdrop-blur-md text-white border-white/10 font-mono text-[10px] uppercase tracking-widest\">\r\n                            {new Date(scan.analyzed_at).toLocaleDateString()}\r\n                          </Badge>\r\n                        </div>\r\n                        <div className=\"absolute bottom-4 right-4 opacity-0 group-hover:opacity-100 translate-y-2 group-hover:translate-y-0 transition-all duration-500\">\r\n                          <Badge variant=\"success\" className=\"font-black text-[9px] uppercase tracking-widest\">AI_VERIFIED</Badge>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <CardContent className=\"p-6 flex-1 space-y-6\">\r\n                        <div className=\"flex justify-between items-start\">\r\n                          <div className=\"space-y-1\">\r\n                            <h4 className=\"text-lg font-bold text-foreground uppercase tracking-tight\">Aura Status</h4>\r\n                            <p className=\"text-[10px] text-muted-foreground font-black uppercase tracking-widest\">TYPE: {scan.skin_type}</p>\r\n                          </div>\r\n                          <div className=\"text-right\">\r\n                            <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest mb-1\">Health Score</p>\r\n                            <span className=\"text-2xl font-black text-primary tabular-nums\">{scan.overall_score}%</span>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 gap-4 pt-4 border-t border-border/30\">\r\n                          {[\r\n                            { label: 'Pore matrix', value: scan.pores_score },\r\n                            { label: 'Surface deltas', value: scan.wrinkles_score },\r\n                            { label: 'Melanin nodes', value: scan.spots_score },\r\n                            { label: 'Tissue age', value: scan.skin_age }\r\n                          ].map((metric) => (\r\n                            <div key={metric.label} className=\"p-3 bg-secondary/20 rounded-xl border border-border/50\">\r\n                              <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-widest mb-1\">{metric.label}</p>\r\n                              <p className=\"text-sm font-bold text-foreground tabular-nums\">{metric.value}</p>\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n\r\n                        <Button variant=\"ghost\" className=\"w-full justify-between text-[9px] font-black uppercase tracking-widest text-primary hover:bg-primary/5 rounded-xl px-0 pt-4 border-t border-border/30\">\r\n                          Access Full diagnostic payload\r\n                          <ArrowRight weight=\"bold\" className=\"w-3.5 h-3.5\" />\r\n                        </Button>\r\n                      </CardContent>\r\n                    </Card>\r\n                  </motion.div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </motion.div>\r\n        ) : activeTab === 'progress' ? (\r\n          <motion.div \r\n            key=\"progress\"\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, y: -20 }}\r\n            className=\"space-y-10 px-2\"\r\n          >\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\r\n              <Card className=\"p-8 rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n                <CardHeader className=\"px-0 pb-8 border-b border-border/50\">\r\n                  <div className=\"flex items-center gap-4\">\r\n                    <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n                      <TrendUp weight=\"duotone\" className=\"w-6 h-6\" />\r\n                    </div>\r\n                    <div>\r\n                      <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Evolution Matrix</CardTitle>\r\n                      <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Historical cutaneous trend sync</p>\r\n                    </div>\r\n                  </div>\r\n                </CardHeader>\r\n                <CardContent className=\"px-0 pt-10 h-[400px]\">\r\n                  <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                    <AreaChart data={analyses.slice().reverse()}>\r\n                      <defs>\r\n                        <linearGradient id=\"colorScore\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                          <stop offset=\"5%\" stopColor=\"hsl(var(--primary))\" stopOpacity={0.3}/>\r\n                          <stop offset=\"95%\" stopColor=\"hsl(var(--primary))\" stopOpacity={0}/>\r\n                        </linearGradient>\r\n                      </defs>\r\n                      <CartesianGrid strokeDasharray=\"3 3\" stroke=\"hsl(var(--border)/0.3)\" vertical={false} />\r\n                      <XAxis \r\n                        dataKey=\"analyzed_at\" \r\n                        tickFormatter={(date) => new Date(date).toLocaleDateString(undefined, { month: 'short', day: 'numeric' })}\r\n                        axisLine={false}\r\n                        tickLine={false}\r\n                        tick={{ fill: 'hsl(var(--muted-foreground))', fontSize: 10, fontWeight: 'bold' }}\r\n                      />\r\n                      <YAxis \r\n                        domain={[0, 100]} \r\n                        axisLine={false} \r\n                        tickLine={false}\r\n                        tick={{ fill: 'hsl(var(--muted-foreground))', fontSize: 10, fontWeight: 'bold' }}\r\n                      />\r\n                      <Tooltip \r\n                        contentStyle={{ \r\n                          backgroundColor: 'hsl(var(--card))', \r\n                          borderColor: 'hsl(var(--border))', \r\n                          borderRadius: '16px',\r\n                          boxShadow: 'var(--shadow-premium)',\r\n                          fontSize: '12px',\r\n                          fontWeight: 'bold',\r\n                          textTransform: 'uppercase'\r\n                        }}\r\n                      />\r\n                      <Area \r\n                        type=\"monotone\" \r\n                        dataKey=\"overall_score\" \r\n                        stroke=\"hsl(var(--primary))\" \r\n                        strokeWidth={4}\r\n                        fillOpacity={1} \r\n                        fill=\"url(#colorScore)\" \r\n                        animationDuration={2000}\r\n                      />\r\n                    </AreaChart>\r\n                  </ResponsiveContainer>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <div className=\"space-y-8\">\r\n                <Card className=\"p-8 rounded-[40px] border-border/50 shadow-premium overflow-hidden group h-full\">\r\n                  <CardHeader className=\"px-0 pb-8 border-b border-border/50\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                      <div className=\"w-12 h-12 rounded-2xl bg-emerald-500/10 flex items-center justify-center text-emerald-500 border border-emerald-500/20 shadow-inner\">\r\n                        <Lightning weight=\"duotone\" className=\"w-6 h-6\" />\r\n                      </div>\r\n                      <div>\r\n                        <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Component Intelligence</CardTitle>\r\n                        <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Granular biometric telemetry</p>\r\n                      </div>\r\n                    </div>\r\n                  </CardHeader>\r\n                  <CardContent className=\"px-0 pt-10 h-[300px]\">\r\n                  <h4 className=\"text-xs font-black text-white uppercase tracking-widest mb-6\">{m.label}</h4>\r\n                  <div className=\"h-[200px] w-full\">\r\n                    <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                      <LineChart data={chartData}>\r\n                        <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#ffffff05\" vertical={false} />\r\n                        <XAxis dataKey=\"date\" hide />\r\n                        <YAxis hide domain={[0, 100]} />\r\n                        <Tooltip contentStyle={{ backgroundColor: '#0A0A0A', border: '1px solid #ffffff10', borderRadius: '12px' }} />\r\n                        <Line type=\"monotone\" dataKey={m.key} stroke={m.color} strokeWidth={3} dot={{ fill: m.color, r: 4 }} />\r\n                      </LineChart>\r\n                    </ResponsiveContainer>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </motion.div>\r\n        )}\r\n\r\n        {/* Compare Tab */}\r\n        {activeTab === 'compare' && (\r\n          <motion.div\r\n            key=\"compare\"\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, y: -20 }}\r\n            className=\"space-y-10\"\r\n          >\r\n            <div className=\"bg-card border border-border rounded-[40px] shadow-premium overflow-hidden group p-10 rounded-[48px] border border-white/5 space-y-10\">\r\n              <div className=\"text-center space-y-2\">\r\n                <h3 className=\"text-2xl font-black text-white uppercase tracking-tight\">Evolution Diagnostic</h3>\r\n                <p className=\"text-sm text-muted-foreground italic font-light\">Select two clinical nodes to analyze transformation delta.</p>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10\">\r\n                {/* Select Before */}\r\n                <div className=\"space-y-4\">\r\n                  <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-4\">Temporal Origin (Before)</p>\r\n                  <div className=\"grid grid-cols-2 sm:grid-cols-3 gap-3\">\r\n                    {analyses.map((a) => (\r\n                      <button\r\n                        key={`before-${a.id}`}\r\n                        onClick={() => setSelectedBefore(a)}\r\n                        className={cn(\r\n                          \"aspect-square rounded-2xl border-2 overflow-hidden transition-all relative group\",\r\n                          selectedBefore?.id === a.id ? \"border-primary shadow-glow-sm scale-105\" : \"border-white/5 opacity-40 hover:opacity-100\"\r\n                        )}\r\n                      >\r\n                        <img src={a.image_url} className=\"w-full h-full object-cover\" />\r\n                        <div className=\"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                          <span className=\"text-[8px] font-black text-white\">{new Date(a.analyzed_at).toLocaleDateString()}</span>\r\n                        </div>\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Select After */}\r\n                <div className=\"space-y-4\">\r\n                  <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest ml-4\">Current Node (After)</p>\r\n                  <div className=\"grid grid-cols-2 sm:grid-cols-3 gap-3\">\r\n                    {analyses.map((a) => (\r\n                      <button\r\n                        key={`after-${a.id}`}\r\n                        onClick={() => setSelectedAfter(a)}\r\n                        className={cn(\r\n                          \"aspect-square rounded-2xl border-2 overflow-hidden transition-all relative group\",\r\n                          selectedAfter?.id === a.id ? \"border-primary shadow-glow-sm scale-105\" : \"border-white/5 opacity-40 hover:opacity-100\"\r\n                        )}\r\n                      >\r\n                        <img src={a.image_url} className=\"w-full h-full object-cover\" />\r\n                        <div className=\"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                          <span className=\"text-[8px] font-black text-white\">{new Date(a.analyzed_at).toLocaleDateString()}</span>\r\n                        </div>\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex justify-center pt-6\">\r\n                <button\r\n                  disabled={!selectedBefore || !selectedAfter || selectedBefore.id === selectedAfter.id}\r\n                  onClick={handleCreateComparison}\r\n                  className=\"group flex items-center gap-3 px-12 py-5 bg-primary text-primary-foreground rounded-[24px] font-black uppercase tracking-[0.2em] shadow-premium hover:brightness-110 disabled:opacity-20 transition-all\"\r\n                >\r\n                  {selectedBefore && selectedAfter && selectedBefore.id === selectedAfter.id ? 'Select Distinct Nodes' : 'Synthesize Evolution'}\r\n                  <CaretRight className=\"w-5 h-5 group-hover:translate-x-1 transition-transform\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Preview if both selected (Optional visual feedback before saving) */}\r\n            {selectedBefore && selectedAfter && selectedBefore.id !== selectedAfter.id && (\r\n              <motion.div\r\n                initial={{ opacity: 0, scale: 0.95 }}\r\n                animate={{ opacity: 1, scale: 1 }}\r\n                className=\"grid grid-cols-1 md:grid-cols-2 gap-8\"\r\n              >\r\n                <div className=\"p-8 rounded-[40px] border-border/50 shadow-premium overflow-hidden group p-8 rounded-[40px] border border-white/5 space-y-4\">\r\n                  <h4 className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Base Node</h4>\r\n                  <img src={selectedBefore.image_url} className=\"w-full aspect-square object-cover rounded-3xl border border-white/10\" />\r\n                  <div className=\"flex justify-between items-center pt-2\">\r\n                    <span className=\"text-sm font-bold text-white\">{new Date(selectedBefore.analyzed_at).toLocaleDateString()}</span>\r\n                    <span className=\"text-xl font-black text-primary\">{selectedBefore.overall_score}</span>\r\n                  </div>\r\n                </div>\r\n                <div className=\"p-8 rounded-[40px] border-border/50 shadow-premium overflow-hidden group p-8 rounded-[40px] border border-white/5 space-y-4\">\r\n                  <h4 className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Target Node</h4>\r\n                  <img src={selectedAfter.image_url} className=\"w-full aspect-square object-cover rounded-3xl border border-white/10\" />\r\n                  <div className=\"flex justify-between items-center pt-2\">\r\n                    <span className=\"text-sm font-bold text-white\">{new Date(selectedAfter.analyzed_at).toLocaleDateString()}</span>\r\n                    <span className=\"text-xl font-black text-primary\">{selectedAfter.overall_score}</span>\r\n                  </div>\r\n                </div>\r\n              </motion.div>\r\n            )}\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\layout.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Bell' is defined but never used.","line":29,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Bell"},"fix":{"range":[391,400],"text":""},"desc":"Remove unused variable \"Bell\"."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":282,"column":15,"nodeType":"JSXOpeningElement","endLine":282,"endColumn":96}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { \r\n  House,\r\n  Users,\r\n  Gear,\r\n  Stethoscope,\r\n  Package,\r\n  Target,\r\n  Lightning,\r\n  FirstAidKit,\r\n  ChatCircle,\r\n  Buildings,\r\n  CalendarDots,\r\n  Sparkle,\r\n  CaretLeft,\r\n  CaretDown,\r\n  SignOut,\r\n  ShieldCheck,\r\n  List,\r\n  X,\r\n  ShoppingCart,\r\n  TrendUp,\r\n  ChartBar,\r\n  Question,\r\n  CreditCard,\r\n  Shield,\r\n  Bell,\r\n  Star,\r\n  Clock,\r\n  VideoCamera,\r\n  EnvelopeSimple,\r\n  Phone,\r\n  CurrencyDollar,\r\n  Warning,\r\n  UserCheck,\r\n  Stack,\r\n  Wallet,\r\n  Globe\r\n} from '@phosphor-icons/react';\r\nimport { useState, useEffect } from 'react';\r\nimport { Link, usePathname, useRouter } from '@/i18n/routing';\r\nimport { cn } from '@/lib/utils';\r\nimport NotificationCenter from \"@/components/ui/NotificationCenter\";\r\nimport BranchSwitcher from \"@/components/ui/BranchSwitcher\";\r\nimport HelpModal from \"@/components/ui/HelpModal\";\r\nimport DashboardFooter from \"@/components/ui/DashboardFooter\";\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { ThemeToggle } from '@/components/ui/ThemeToggle';\r\n\r\nexport default function DashboardLayout({\r\n  children,\r\n}: {\r\n  children: React.ReactNode;\r\n}) {\r\n  const [isSidebarOpen, setIsSidebarOpen] = useState(true);\r\n  const [isMobileOpen, setIsMobileOpen] = useState(false);\r\n  const [isHelpOpen, setIsHelpOpen] = useState(false);\r\n  const [isClient, setIsClient] = useState(false);\r\n  const [expandedGroups, setExpandedGroups] = useState<string[]>(['main', 'operations']);\r\n  const pathname = usePathname();\r\n  const { user, loading, getUserRole, getFullName, getClinicName, getClinicMetadata, signOut } = useAuth();\r\n  const metadata = getClinicMetadata();\r\n  const router = useRouter();\r\n  \r\n  // Route protection: redirect unauthorized users\r\n  useEffect(() => {\r\n    // Don't redirect while still loading session\r\n    if (loading) return;\r\n    \r\n    const userRole = getUserRole();\r\n    \r\n    // Only redirect to login if no user or guest role\r\n    if (!user || userRole === 'guest') {\r\n      router.push('/login');\r\n      return;\r\n    }\r\n    \r\n    // Check specific route access permissions\r\n    if (pathname.startsWith('/th/admin') && userRole !== 'super_admin') {\r\n      router.push('/login');\r\n      return;\r\n    }\r\n    \r\n    if (pathname.startsWith('/th/clinic')) {\r\n      // Allow shared routes for cross-role access\r\n      const sharedRoutes = ['/th/clinic/pos', '/th/clinic/appointments', '/th/clinic/chat'];\r\n      const isSharedRoute = sharedRoutes.some(route => pathname.startsWith(route));\r\n      \r\n      if (isSharedRoute) {\r\n        const allowedRoles = ['clinic_owner', 'clinic_admin', 'clinic_staff', 'sales_staff'];\r\n        // Appointments and Chat also allow customers\r\n        if (pathname.startsWith('/th/clinic/appointments') || pathname.startsWith('/th/clinic/chat')) {\r\n          allowedRoles.push('customer', 'premium_customer', 'free_customer');\r\n        }\r\n        if (!allowedRoles.includes(userRole)) {\r\n          router.push('/login');\r\n          return;\r\n        }\r\n      } else {\r\n        // Restricted clinic routes\r\n        if (!['clinic_owner', 'clinic_admin', 'clinic_staff'].includes(userRole)) {\r\n          router.push('/login');\r\n          return;\r\n        }\r\n      }\r\n    }\r\n    \r\n    if (pathname.startsWith('/th/sales') && userRole !== 'sales_staff') {\r\n      router.push('/login');\r\n      return;\r\n    }\r\n    \r\n    if (pathname.startsWith('/th/customer') && !['customer', 'premium_customer', 'free_customer', 'free_user'].includes(userRole)) {\r\n      router.push('/login');\r\n      return;\r\n    }\r\n    \r\n    // Shared routes accessible by multiple roles\r\n    if (pathname.startsWith('/th/shared/chat')) {\r\n      const allowedRoles = ['clinic_owner', 'clinic_admin', 'clinic_staff', 'sales_staff', 'customer', 'premium_customer', 'free_customer', 'free_user'];\r\n      if (!allowedRoles.includes(userRole)) {\r\n        router.push('/login');\r\n        return;\r\n      }\r\n    }\r\n  }, [user, loading, getUserRole, pathname, router]);\r\n\r\n  // Set client-side flag\r\n  useEffect(() => {\r\n    setIsClient(true);\r\n  }, []);\r\n\r\n  // Handle window resize for mobile state\r\n  useEffect(() => {\r\n    if (!isClient) return;\r\n    \r\n    const handleResize = () => {\r\n      if (window.innerWidth >= 1024) {\r\n        setIsMobileOpen(false);\r\n      }\r\n    };\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, [isClient]);\r\n\r\n  const toggleGroup = (group: string) => {\r\n    setExpandedGroups(prev => \r\n      prev.includes(group) ? prev.filter(g => g !== group) : [...prev, group]\r\n    );\r\n  };\r\n\r\n  const menuGroups = [\r\n    {\r\n      id: 'main',\r\n      label: 'เธซเธเนเธฒเธซเธฅเธฑเธ',\r\n      icon: House,\r\n      roles: ['clinic_owner', 'clinic_admin', 'clinic_staff', 'sales_staff', 'customer', 'free_user'],\r\n      items: [\r\n        { icon: House, label: 'Dashboard', href: '/clinic', roles: ['clinic_owner', 'clinic_admin'] },\r\n        { icon: House, label: 'My Skin Portal', href: '/customer', roles: ['customer', 'premium_customer', 'free_customer', 'free_user'] },\r\n        { icon: Target, label: 'Sales Intelligence', href: '/sales', roles: ['sales_staff'] },\r\n        { icon: Stethoscope, label: 'Clinical Node', href: '/beautician', roles: ['clinic_staff'] },\r\n      ]\r\n    },\r\n    {\r\n      id: 'operations',\r\n      label: 'เธเธฒเธฃเธ”เธณเน€เธเธดเธเธเธฒเธ',\r\n      icon: Stack,\r\n      roles: ['clinic_owner', 'clinic_admin', 'clinic_staff', 'sales_staff'],\r\n      items: [\r\n        { icon: ShoppingCart, label: 'POS เธเธฒเธข', href: '/clinic/pos', roles: ['clinic_owner', 'clinic_admin', 'sales_staff'] },\r\n        { icon: CalendarDots, label: 'เธเธฑเธ”เธซเธกเธฒเธข', href: '/clinic/appointments', roles: ['clinic_owner', 'clinic_staff', 'sales_staff', 'customer', 'free_user'] },\r\n        { icon: Clock, label: 'เธเธดเธง', href: '/clinic/queue', roles: ['clinic_owner', 'clinic_admin', 'clinic_staff'] },\r\n        { icon: UserCheck, label: 'เธฃเธฒเธขเธเธทเนเธญเธฃเธญ', href: '/clinic/waitlist', roles: ['clinic_owner', 'clinic_admin'] },\r\n        { icon: FirstAidKit, label: 'เธ—เธฃเธตเธ—เน€เธกเธเธ•เน', href: '/clinic/treatments', roles: ['clinic_owner', 'clinic_staff'] },\r\n      ]\r\n    },\r\n    {\r\n      id: 'crm',\r\n      label: 'CRM & เธเธฒเธฃเธ•เธฅเธฒเธ”',\r\n      icon: Users,\r\n      roles: ['clinic_owner', 'clinic_admin'],\r\n      items: [\r\n        { icon: ChatCircle, label: 'เนเธเธ—', href: '/shared/chat', roles: ['clinic_owner', 'clinic_staff', 'sales_staff', 'customer', 'free_user'] },\r\n        { icon: Phone, label: 'SMS', href: '/clinic/sms', roles: ['clinic_owner', 'clinic_admin'] },\r\n        { icon: EnvelopeSimple, label: 'Email', href: '/clinic/email-campaigns', roles: ['clinic_owner', 'clinic_admin'] },\r\n        { icon: VideoCamera, label: 'เธเธฃเธถเธเธฉเธฒเธญเธญเธเนเธฅเธเน', href: '/clinic/consultations', roles: ['clinic_owner', 'clinic_admin'] },\r\n        { icon: Star, label: 'เธฃเธตเธงเธดเธง', href: '/clinic/reviews', roles: ['clinic_owner', 'clinic_admin'] },\r\n      ]\r\n    },\r\n    {\r\n      id: 'finance',\r\n      label: 'เธเธฒเธฃเน€เธเธดเธ',\r\n      icon: Wallet,\r\n      roles: ['clinic_owner', 'clinic_admin'],\r\n      items: [\r\n        { icon: TrendUp, label: 'เธฃเธฒเธขเนเธ”เน', href: '/clinic/revenue', roles: ['clinic_owner', 'clinic_admin'] },\r\n        { icon: CurrencyDollar, label: 'เธเนเธฒเธเธญเธก', href: '/clinic/commissions', roles: ['clinic_owner', 'clinic_admin'] },\r\n        { icon: ChartBar, label: 'เธฃเธฒเธขเธเธฒเธ', href: '/clinic/reports', roles: ['clinic_owner', 'clinic_admin'] },\r\n      ]\r\n    },\r\n    {\r\n      id: 'resources',\r\n      label: 'เธ—เธฃเธฑเธเธขเธฒเธเธฃ',\r\n      icon: Package,\r\n      roles: ['clinic_owner', 'clinic_admin', 'clinic_staff'],\r\n      items: [\r\n        { icon: Users, label: 'เธเธเธฑเธเธเธฒเธ', href: '/clinic/staff', roles: ['clinic_owner', 'clinic_admin'] },\r\n        { icon: Buildings, label: 'เธชเธฒเธเธฒ', href: '/clinic/branches', roles: ['clinic_owner', 'clinic_admin'] },\r\n        { icon: Package, label: 'เธชเธดเธเธเนเธฒ', href: '/clinic/inventory', roles: ['clinic_owner', 'clinic_admin', 'clinic_staff'] },\r\n        { icon: Warning, label: 'เนเธเนเธเน€เธ•เธทเธญเธ', href: '/clinic/inventory/alerts', roles: ['clinic_owner', 'clinic_admin'] },\r\n      ]\r\n    },\r\n    {\r\n      id: 'settings',\r\n      label: 'เธ•เธฑเนเธเธเนเธฒ',\r\n      icon: Gear,\r\n      roles: ['clinic_owner'],\r\n      items: [\r\n        { icon: Gear, label: 'เธ—เธฑเนเธงเนเธ', href: '/clinic/settings', roles: ['clinic_owner'] },\r\n        { icon: Globe, label: 'เน€เธเธทเนเธญเธกเธ•เนเธญ', href: '/clinic/settings/integrations', roles: ['clinic_owner'] },\r\n        { icon: Lightning, label: 'AI Quota', href: '/clinic/quota', roles: ['clinic_owner', 'clinic_admin'] },\r\n      ]\r\n    },\r\n    {\r\n      id: 'admin',\r\n      label: 'Admin',\r\n      icon: ShieldCheck,\r\n      roles: ['super_admin'],\r\n      items: [\r\n        { icon: ShieldCheck, label: 'Dashboard', href: '/admin', roles: ['super_admin'] },\r\n        { icon: Users, label: 'Users', href: '/admin/users', roles: ['super_admin'] },\r\n        { icon: Shield, label: 'Security', href: '/admin/security', roles: ['super_admin'] },\r\n        { icon: ChartBar, label: 'Analytics', href: '/admin/analytics', roles: ['super_admin'] },\r\n        { icon: CreditCard, label: 'Billing', href: '/admin/billing', roles: ['super_admin'] },\r\n        { icon: Gear, label: 'Gear', href: '/admin/settings', roles: ['super_admin'] },\r\n      ]\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"flex min-h-screen bg-background text-foreground overflow-hidden relative\">\r\n      <HelpModal \r\n        isOpen={isHelpOpen} \r\n        onClose={() => setIsHelpOpen(false)} \r\n        role={getUserRole()} \r\n      />\r\n      \r\n      {/* Mobile Overlay */}\r\n      <AnimatePresence>\r\n        {isMobileOpen && (\r\n          <motion.div\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            onClick={() => setIsMobileOpen(false)}\r\n            className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] lg:hidden\"\r\n          />\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Sidebar - Desktop & Mobile */}\r\n      <motion.aside\r\n        initial={false}\r\n        animate={{ \r\n          width: isSidebarOpen ? 280 : 80,\r\n          x: isMobileOpen ? 0 : (isClient && window.innerWidth < 1024 ? -280 : 0)\r\n        }}\r\n        transition={{ type: \"spring\", damping: 25, stiffness: 200 }}\r\n        className={cn(\r\n          \"fixed lg:relative z-[110] flex flex-col h-full bg-sidebar text-sidebar-foreground border-r border-border backdrop-blur-2xl transition-all duration-300 lg:transition-none\",\r\n          \"lg:translate-x-0\",\r\n          !isMobileOpen && \"max-lg:-translate-x-full\"\r\n        )}\r\n      >\r\n        {/* Sidebar Header */}\r\n        <div className=\"h-24 flex items-center px-8 gap-4 flex-shrink-0 border-b border-sidebar-foreground/5\">\r\n          <div className=\"w-12 h-12 rounded-2xl bg-primary flex items-center justify-center text-primary-foreground shadow-premium flex-shrink-0 overflow-hidden group-hover:scale-110 transition-transform\">\r\n            {metadata?.logo_url ? (\r\n              <img src={metadata.logo_url} alt=\"Logo\" className=\"w-full h-full object-cover\" />\r\n            ) : (\r\n              <Sparkle weight=\"fill\" className=\"w-7 h-7 text-white\" />\r\n            )}\r\n          </div>\r\n          <AnimatePresence>\r\n            {(isSidebarOpen || (isClient && window.innerWidth < 1024)) && (\r\n              <motion.div\r\n                initial={{ opacity: 0, x: -10 }}\r\n                animate={{ opacity: 1, x: 0 }}\r\n                exit={{ opacity: 0, x: -10 }}\r\n                className=\"flex flex-col min-w-0\"\r\n              >\r\n                <span className=\"font-heading font-bold text-xl tracking-tight text-white whitespace-nowrap truncate\">\r\n                  {getClinicName()}\r\n                </span>\r\n                <span className=\"text-[10px] font-black text-primary uppercase tracking-[0.2em]\">Clinical Node</span>\r\n              </motion.div>\r\n            )}\r\n          </AnimatePresence>\r\n          {/* Mobile Close Button */}\r\n          <button \r\n            onClick={() => setIsMobileOpen(false)}\r\n            className=\"ml-auto lg:hidden p-2 text-sidebar-foreground/60 hover:text-sidebar-foreground\"\r\n          >\r\n            <X className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Navigation */}\r\n        <nav className=\"flex-1 px-3 py-4 space-y-1 overflow-y-auto custom-scrollbar\">\r\n          {menuGroups.map((group) => {\r\n            const userRole = getUserRole();\r\n            if (!group.roles.includes(userRole)) return null;\r\n            \r\n            const visibleItems = group.items.filter(item => item.roles.includes(userRole));\r\n            if (visibleItems.length === 0) return null;\r\n            \r\n            const isExpanded = expandedGroups.includes(group.id);\r\n            const hasActiveItem = visibleItems.some(item => \r\n              pathname === item.href || pathname.startsWith(`${item.href}/`)\r\n            );\r\n\r\n            return (\r\n              <div key={group.id} className=\"mb-1\">\r\n                {/* Group Header */}\r\n                <button\r\n                  onClick={() => toggleGroup(group.id)}\r\n                  className={cn(\r\n                    \"w-full flex items-center gap-3 px-4 py-3 rounded-2xl transition-all duration-300\",\r\n                    hasActiveItem \r\n                      ? \"bg-white/5 text-primary shadow-sm\" \r\n                      : \"text-sidebar-foreground/50 hover:bg-white/[0.03] hover:text-white\"\r\n                  )}\r\n                >\r\n                  <group.icon className={cn(\r\n                    \"w-5 h-5 flex-shrink-0 transition-colors\",\r\n                    hasActiveItem ? \"text-primary\" : \"text-inherit\"\r\n                  )} />\r\n                  {(isSidebarOpen || (isClient && window.innerWidth < 1024)) && (\r\n                    <>\r\n                      <span className=\"font-bold text-[11px] uppercase tracking-widest flex-1 text-left\">{group.label}</span>\r\n                      <CaretDown className={cn(\r\n                        \"w-3.5 h-3.5 transition-transform duration-300\",\r\n                        isExpanded ? \"rotate-180\" : \"\"\r\n                      )} />\r\n                    </>\r\n                  )}\r\n                </button>\r\n\r\n                {/* Group Items */}\r\n                <AnimatePresence>\r\n                  {isExpanded && (isSidebarOpen || (isClient && window.innerWidth < 1024)) && (\r\n                    <motion.div\r\n                      initial={{ height: 0, opacity: 0 }}\r\n                      animate={{ height: \"auto\", opacity: 1 }}\r\n                      exit={{ height: 0, opacity: 0 }}\r\n                      transition={{ duration: 0.2 }}\r\n                      className=\"overflow-hidden\"\r\n                    >\r\n                      <div className=\"pl-4 mt-1 space-y-1 border-l border-white/5 ml-6\">\r\n                        {visibleItems.map((item) => {\r\n                          const isActive = pathname === item.href || pathname.startsWith(`${item.href}/`);\r\n                          return (\r\n                            <Link\r\n                              key={item.href}\r\n                              href={item.href}\r\n                              onClick={() => setIsMobileOpen(false)}\r\n                              className={cn(\r\n                                \"flex items-center gap-3 px-4 py-2.5 rounded-xl transition-all duration-300 group relative\",\r\n                                isActive \r\n                                  ? \"bg-primary text-white shadow-premium\" \r\n                                  : \"text-sidebar-foreground/40 hover:text-white hover:bg-white/[0.02]\"\r\n                              )}\r\n                            >\r\n                              <item.icon className={cn(\r\n                                \"w-4 h-4 flex-shrink-0 transition-transform group-hover:scale-110\",\r\n                                isActive ? \"text-white\" : \"text-inherit\"\r\n                              )} />\r\n                              <span className=\"text-sm font-medium\">{item.label}</span>\r\n                              {isActive && (\r\n                                <motion.div \r\n                                  layoutId=\"active-indicator\"\r\n                                  className=\"absolute -left-[17px] w-1 h-6 bg-primary rounded-r-full\"\r\n                                />\r\n                              )}\r\n                            </Link>\r\n                          );\r\n                        })}\r\n                      </div>\r\n                    </motion.div>\r\n                  )}\r\n                </AnimatePresence>\r\n              </div>\r\n            );\r\n          })}\r\n        </nav>\r\n\r\n        {/* Sidebar Footer */}\r\n        <div className=\"p-3 border-t border-sidebar-foreground/10 flex-shrink-0\">\r\n          <button \r\n            onClick={signOut}\r\n            className=\"w-full flex items-center gap-3 px-3 py-3 rounded-xl text-muted-foreground hover:bg-destructive/10 hover:text-destructive transition-all group\"\r\n          >\r\n            <SignOut className=\"w-5 h-5 group-hover:rotate-180 transition-transform duration-300\" />\r\n            {(isSidebarOpen || (isClient && window.innerWidth < 1024)) && <span className=\"font-medium text-sm\">Logout Session</span>}\r\n          </button>\r\n        </div>\r\n\r\n        {/* Desktop Toggle Button */}\r\n        <button\r\n          onClick={() => setIsSidebarOpen(!isSidebarOpen)}\r\n          className=\"absolute -right-3 top-24 w-6 h-6 rounded-full bg-primary border border-border items-center justify-center text-primary-foreground shadow-lg hover:scale-110 transition-transform hidden lg:flex\"\r\n        >\r\n          <CaretLeft className={cn(\"w-4 h-4 transition-transform duration-300\", !isSidebarOpen && \"rotate-180\")} />\r\n        </button>\r\n      </motion.aside>\r\n\r\n      {/* Main Content Area */}\r\n      <main className=\"flex-1 flex flex-col relative h-screen overflow-y-auto custom-scrollbar\">\r\n        {/* Top Header */}\r\n        <header className=\"h-24 flex items-center justify-between px-8 md:px-12 border-b border-border bg-background/80 backdrop-blur-xl sticky top-0 z-40 flex-shrink-0\">\r\n          <div className=\"flex items-center gap-6\">\r\n            {/* Mobile Menu Trigger */}\r\n            <button \r\n              onClick={() => setIsMobileOpen(true)}\r\n              className=\"lg:hidden p-3 bg-secondary border border-border rounded-xl text-foreground hover:bg-accent transition-all\"\r\n            >\r\n              <List className=\"w-6 h-6\" />\r\n            </button>\r\n            \r\n            <div className=\"hidden sm:flex items-center gap-3 px-4 py-2 bg-secondary/50 rounded-2xl border border-border\">\r\n              <Buildings weight=\"duotone\" className=\"w-5 h-5 text-primary\" />\r\n              <h2 className=\"text-xs font-bold text-foreground uppercase tracking-widest truncate max-w-[200px]\">\r\n                {getClinicName()}\r\n              </h2>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex items-center gap-3 md:gap-6\">\r\n            <div className=\"hidden md:flex items-center gap-2\">\r\n              {['clinic_owner', 'clinic_admin'].includes(getUserRole()) && <BranchSwitcher />}\r\n              <ThemeToggle />\r\n            </div>\r\n            \r\n            <div className=\"h-8 w-px bg-border mx-2 hidden md:block\" />\r\n            \r\n            <div className=\"flex items-center gap-4\">\r\n              <button \r\n                onClick={() => setIsHelpOpen(true)}\r\n                className=\"p-2.5 bg-secondary border border-border rounded-xl text-muted-foreground hover:text-primary hover:border-primary/20 transition-all group\"\r\n              >\r\n                <Question className=\"w-5 h-5 group-hover:scale-110 transition-transform\" />\r\n              </button>\r\n              <NotificationCenter />\r\n            </div>\r\n\r\n            <div className=\"h-8 w-px bg-border mx-2\" />\r\n\r\n            <div className=\"flex items-center gap-4 pl-2\">\r\n              <div className=\"hidden md:flex flex-col text-right\">\r\n                <span className=\"text-sm font-bold text-foreground tracking-tight\">{getFullName()}</span>\r\n                <span className=\"text-[10px] text-primary font-black uppercase tracking-[0.2em]\">\r\n                  {getUserRole().replace('_', ' ')}\r\n                </span>\r\n              </div>\r\n              <div className=\"relative group\">\r\n                <div className=\"absolute -inset-1 bg-gradient-to-tr from-primary to-blue-400 rounded-2xl blur opacity-20 group-hover:opacity-40 transition-opacity\" />\r\n                <div className=\"w-12 h-12 rounded-2xl bg-card border-2 border-border flex items-center justify-center text-primary shadow-premium relative z-10 group-hover:border-primary/50 transition-colors\">\r\n                  <Users weight=\"duotone\" className=\"w-6 h-6\" />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </header>\r\n\r\n        {/* Page Content */}\r\n        <main className=\"flex-1 overflow-y-auto custom-scrollbar flex flex-col\">\r\n          <div className=\"flex-1 p-4 lg:p-8\">\r\n            {children}\r\n          </div>\r\n          <DashboardFooter />\r\n        </main>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\sales\\analysis\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Icon' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Icon"},"fix":{"range":[302,311],"text":""},"desc":"Remove unused variable \"Icon\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CircleNotch' is defined but never used.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CircleNotch"},"fix":{"range":[311,327],"text":""},"desc":"Remove unused variable \"CircleNotch\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningCircle' is defined but never used.","line":25,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WarningCircle"},"fix":{"range":[327,345],"text":""},"desc":"Remove unused variable \"WarningCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":26,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":4,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"X"},"fix":{"range":[345,351],"text":""},"desc":"Remove unused variable \"X\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used.","line":27,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Plus"},"fix":{"range":[351,360],"text":""},"desc":"Remove unused variable \"Plus\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":36,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":46,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useMemo"},"fix":{"range":[809,818],"text":""},"desc":"Remove unused variable \"useMemo\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useCallback' is defined but never used.","line":36,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":59,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useCallback"},"fix":{"range":[818,831],"text":""},"desc":"Remove unused variable \"useCallback\"."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Phone' is not defined.","line":617,"column":26,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":617,"endColumn":31},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'EnvelopeSimple' is not defined.","line":630,"column":26,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":630,"endColumn":40}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { \r\n  Camera, \r\n  Brain, \r\n  Clock, \r\n  Sparkle, \r\n  ArrowCounterClockwise, \r\n  CheckCircle, \r\n  User, \r\n  CaretRight, \r\n  Play, \r\n  Pause, \r\n  Lightning, \r\n  Target, \r\n  Warning, \r\n  FileText, \r\n  ShieldCheck,\r\n  Pulse,\r\n  IdentificationBadge,\r\n  IdentificationCard,\r\n  Monitor,\r\n  Icon,\r\n  CircleNotch,\r\n  WarningCircle,\r\n  X,\r\n  Plus\r\n} from '@phosphor-icons/react';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { cn } from '@/lib/utils';\r\nimport { useRouter } from '@/i18n/routing';\r\nimport { useState, useRef, useEffect, useMemo, useCallback } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport AR3DSimulator from '@/components/AR3DSimulator';\r\nimport { type Landmark } from '@/lib/mediapipe';\r\nimport { useFaceMeasurement } from '@/hooks/useFaceMeasurement';\r\nimport { useAuth } from '@/hooks/useAuth';\r\n\r\ninterface CustomerInfo {\r\n  name: string;\r\n  age: number;\r\n  phone: string;\r\n  email?: string;\r\n  skinConcerns: string[];\r\n}\r\n\r\ninterface AnalysisResult {\r\n  overallScore: number;\r\n  skinAge: number;\r\n  skinType: string;\r\n  recommendations: Array<{\r\n    type: string;\r\n    name: string;\r\n    description: string;\r\n    price: string;\r\n    sessions: number;\r\n    urgency: 'high' | 'medium' | 'low';\r\n    confidence: number;\r\n    results?: string;\r\n    expectedResults?: string;\r\n    reasoning?: string;\r\n    timeline?: string;\r\n  }>;\r\n  skinMetrics: Record<string, number>;\r\n  aiInsights: string[];\r\n  riskFactors?: string[];\r\n  followUpAdvice?: string[];\r\n}\r\n\r\nexport default function MagicScanPage() {\r\n  const router = useRouter();\r\n  const { goBack } = useBackNavigation();\r\n  const { getClinicId, getUserId } = useAuth();\r\n  const videoRef = useRef<HTMLVideoElement>(null);\r\n  \r\n  // States\r\n  const [currentStep, setCurrentStep] = useState<'customer' | 'scan' | 'analysis' | 'proposal'>('customer');\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [analyzing, setAnalyzing] = useState(false);\r\n  const [customerInfo, setCustomerInfo] = useState<CustomerInfo>({\r\n    name: '',\r\n    age: 25,\r\n    phone: '',\r\n    email: '',\r\n    skinConcerns: []\r\n  });\r\n  \r\n  const [analysisResult, setAnalysisResult] = useState<AnalysisResult | null>(null);\r\n  const [mockLandmarks, setMockLandmarks] = useState<Landmark[]>([]);\r\n  const [selectedTreatment] = useState<'laser' | 'filler' | 'none'>('none');\r\n  const [treatmentIntensity] = useState<number>(50);\r\n\r\n  const { measureFace } = useFaceMeasurement();\r\n\r\n  // Generate mock landmarks\r\n  useEffect(() => {\r\n    const generateMockLandmarks = () => {\r\n      const landmarks: Landmark[] = [];\r\n      for (let i = 0; i < 468; i++) {\r\n        landmarks.push({\r\n          x: 0.3 + Math.random() * 0.4,\r\n          y: 0.2 + Math.random() * 0.6,\r\n          z: Math.random() * 0.1\r\n        });\r\n      }\r\n      setMockLandmarks(landmarks);\r\n    };\r\n    generateMockLandmarks();\r\n  }, []);\r\n\r\n  const initializeCamera = async () => {\r\n    if (!videoRef.current) return;\r\n\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({\r\n        video: {\r\n          width: { ideal: 1280 },\r\n          height: { ideal: 720 },\r\n          facingMode: 'user',\r\n        },\r\n      });\r\n\r\n      videoRef.current.srcObject = stream;\r\n      await videoRef.current.play();\r\n    } catch {\r\n      console.log('Camera not available, using mock data');\r\n    }\r\n  };\r\n\r\n  const toggleCamera = async () => {\r\n    if (!isPlaying) {\r\n      await initializeCamera();\r\n      setIsPlaying(true);\r\n    } else {\r\n      if (videoRef.current?.srcObject) {\r\n        const stream = videoRef.current.srcObject as MediaStream;\r\n        stream.getTracks().forEach(track => track.stop());\r\n        videoRef.current.srcObject = null;\r\n      }\r\n      setIsPlaying(false);\r\n    }\r\n  };\r\n\r\n  const startAnalysis = async () => {\r\n    setAnalyzing(true);\r\n    \r\n    try {\r\n      // Check quota availability first\r\n      const clinicId = getClinicId();\r\n      if (!clinicId) {\r\n        alert('เนเธกเนเธเธเธเนเธญเธกเธนเธฅเธเธฅเธดเธเธดเธ เธเธฃเธธเธ“เธฒเธฅเธเธเธทเนเธญเน€เธเนเธฒเนเธเนเนเธซเธกเน');\r\n        return;\r\n      }\r\n      \r\n      const quotaResponse = await fetch(`/api/quota/usage?clinicId=${clinicId}`);\r\n      \r\n      if (quotaResponse.ok) {\r\n        const quotaData = await quotaResponse.json();\r\n        const quota = quotaData.quota;\r\n        \r\n        // Check if quota allows scan\r\n        if (quota && quota.currentUsage >= quota.monthlyQuota) {\r\n          // Show quota exceeded warning\r\n          const proceedWithCharge = confirm(\r\n            `เธเธธเธ“เนเธ”เนเนเธเนเนเธเธงเธ•เธฒเธเธฃเธเนเธฅเนเธง (${quota.currentUsage}/${quota.monthlyQuota})\\n` +\r\n            `เธเธฒเธฃเธชเนเธเธเธเธฃเธฑเนเธเธเธตเนเธเธฐเธกเธตเธเนเธฒเนเธเนเธเนเธฒเธข เธฟ${quota.overageRate}\\n\\n` +\r\n            `เธเธธเธ“เธ•เนเธญเธเธเธฒเธฃเธ”เธณเน€เธเธดเธเธเธฒเธฃเธ•เนเธญเธซเธฃเธทเธญเนเธกเน?`\r\n          );\r\n          \r\n          if (!proceedWithCharge) {\r\n            setAnalyzing(false);\r\n            return;\r\n          }\r\n        }\r\n      }\r\n      \r\n      setCurrentStep('analysis');\r\n      \r\n      // Record usage attempt\r\n      const userId = getUserId();\r\n      if (!userId) {\r\n        alert('เนเธกเนเธเธเธเนเธญเธกเธนเธฅเธเธนเนเนเธเน เธเธฃเธธเธ“เธฒเธฅเธเธเธทเนเธญเน€เธเนเธฒเนเธเนเนเธซเธกเน');\r\n        setAnalyzing(false);\r\n        return;\r\n      }\r\n      \r\n      const usageResponse = await fetch('/api/quota/usage', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          clinicId,\r\n          userId,\r\n          scanType: 'detailed',\r\n          successful: false, // Will update to true if successful\r\n          customerId: `customer-${customerInfo.name}`,\r\n          metadata: {\r\n            customerAge: customerInfo.age,\r\n            skinConcerns: customerInfo.skinConcerns\r\n          }\r\n        })\r\n      });\r\n\r\n      // Prepare data for AI analysis\r\n      const facialMetrics = mockLandmarks.length > 0 ? measureFace(\r\n        mockLandmarks.map(l => [l.x, l.y, l.z])\r\n      ) : {\r\n        facialAsymmetry: Math.random() * 10,\r\n        skinTexture: Math.random() * 15,\r\n        volumeLoss: [Math.random() * 5, Math.random() * 5, Math.random() * 5],\r\n        wrinkleDepth: Math.random() * 20,\r\n        poreSize: Math.random() * 25\r\n      };\r\n\r\n      const analysisPayload = {\r\n        customerInfo: {\r\n          name: customerInfo.name,\r\n          age: customerInfo.age,\r\n          skinConcerns: customerInfo.skinConcerns\r\n        },\r\n        facialMetrics,\r\n        imageAnalysis: {\r\n          spots: Math.floor(Math.random() * 30) + 40,\r\n          wrinkles: Math.floor(Math.random() * 25) + 30,\r\n          hydration: Math.floor(Math.random() * 30) + 60,\r\n          elasticity: Math.floor(Math.random() * 25) + 65,\r\n          pigmentation: Math.floor(Math.random() * 40) + 50\r\n        }\r\n      };\r\n\r\n      // Call AI Analysis API\r\n      const response = await fetch('/api/ai/analyze', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(analysisPayload)\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('AI Analysis failed');\r\n      }\r\n\r\n      const data = await response.json();\r\n      \r\n      if (data.success) {\r\n        setAnalysisResult(data.analysis);\r\n        \r\n        // Initialize Workflow Journey\r\n        try {\r\n          await fetch('/api/workflow', {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({\r\n              action: 'initialize',\r\n              customerData: {\r\n                name: customerInfo.name,\r\n                phone: customerInfo.phone,\r\n                email: customerInfo.email,\r\n                age: customerInfo.age\r\n              },\r\n              salesId: userId,\r\n              clinicId: clinicId,\r\n              scanId: data.analysis.id || 'scan-' + Date.now()\r\n            })\r\n          });\r\n        } catch (wErr) {\r\n          console.error('Workflow Init Error:', wErr);\r\n        }\r\n        \r\n        // Update usage record to successful\r\n        await fetch('/api/quota/usage', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n          body: JSON.stringify({\r\n            clinicId,\r\n            userId,\r\n            scanType: 'detailed',\r\n            successful: true,\r\n            customerId: `customer-${customerInfo.name}`,\r\n            metadata: {\r\n              customerAge: customerInfo.age,\r\n              skinConcerns: customerInfo.skinConcerns,\r\n              analysisScore: data.analysis.overallScore,\r\n              recommendationsCount: data.analysis.recommendations?.length || 0\r\n            }\r\n          })\r\n        });\r\n        \r\n        // Show quota status after successful scan\r\n        if (usageResponse.ok) {\r\n          const usageData = await usageResponse.json();\r\n          if (usageData.quotaStatus) {\r\n            console.log('Quota remaining:', usageData.quotaStatus.remaining);\r\n          }\r\n        }\r\n      } else {\r\n        throw new Error('AI Analysis returned error');\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('AI Analysis error:', error);\r\n      \r\n      // Fallback to mock data if API fails\r\n      const fallbackResult: AnalysisResult = {\r\n        overallScore: Math.floor(Math.random() * 20) + 70,\r\n        skinAge: customerInfo.age + Math.floor(Math.random() * 10) - 5,\r\n        skinType: 'Combination',\r\n        recommendations: [\r\n          {\r\n            type: 'laser',\r\n            name: 'Pico Genesis Laser',\r\n            description: 'เธเธณเธเธฑเธ”เธเธธเธ”เธ”เนเธฒเธเธ”เธณเนเธฅเธฐเธเธฃเธฑเธเธชเธตเธเธดเธงเนเธซเนเธชเธกเนเธณเน€เธชเธกเธญ',\r\n            price: '8,000-12,000',\r\n            sessions: 3,\r\n            urgency: 'medium',\r\n            confidence: 85\r\n          }\r\n        ],\r\n        skinMetrics: {\r\n          hydration: 70,\r\n          elasticity: 65,\r\n          pigmentation: 60,\r\n          texture: 75,\r\n          poreSize: 70,\r\n          oiliness: 65\r\n        },\r\n        aiInsights: [\r\n          `เธเธฒเธฃเธงเธดเน€เธเธฃเธฒเธฐเธซเนเธเธดเธงเธเธญเธเธเธธเธ“${customerInfo.name} เน€เธชเธฃเนเธเธชเธดเนเธ`,\r\n          'เธฃเธฐเธเธ AI เธ•เธฃเธงเธเธเธเธเธธเธ”เธ—เธตเนเธเธงเธฃเธเธฃเธฑเธเธเธฃเธธเธเนเธฅเธฐเนเธซเนเธเธณเนเธเธฐเธเธณเน€เธเธเธฒเธฐ'\r\n        ]\r\n      };\r\n      \r\n      setAnalysisResult(fallbackResult);\r\n    } finally {\r\n      setAnalyzing(false);\r\n    }\r\n  };\r\n\r\n  const generateProposal = async () => {\r\n    if (!analysisResult) return;\r\n    \r\n    setCurrentStep('proposal');\r\n    \r\n    try {\r\n      // Calculate lead score\r\n      // leadScore calculation mock\r\n      \r\n      // Prepare proposal data\r\n      const proposalData = {\r\n        customer: {\r\n          name: customerInfo.name,\r\n          age: customerInfo.age,\r\n          skinConcerns: customerInfo.skinConcerns,\r\n          analysisScore: analysisResult.overallScore\r\n        },\r\n        treatments: analysisResult.recommendations.map(rec => ({\r\n          id: rec.type,\r\n          name: rec.name,\r\n          category: rec.type as 'laser' | 'filler' | 'facial',\r\n          basePrice: parseInt(rec.price.split('-')[0].replace(/,/g, '')) || 10000,\r\n          sessionsRequired: rec.sessions,\r\n          duration: rec.results,\r\n          description: rec.description,\r\n          benefits: [rec.expectedResults || 'เธเธฃเธฑเธเธเธฃเธธเธเธชเธ เธฒเธเธเธดเธง'],\r\n          aftercare: ['เธ”เธนเนเธฅเธ•เธฒเธกเธเธณเนเธเธฐเธเธณเนเธเธ—เธขเน']\r\n        })),\r\n        clinicInfo: {\r\n          name: 'Bangkok Premium Clinic',\r\n          phone: '02-xxx-xxxx',\r\n          address: 'เธเธฃเธธเธเน€เธ—เธเธฏ',\r\n          doctor: 'เนเธเธ—เธขเนเธเธนเนเน€เธเธตเนเธขเธงเธเธฒเธ'\r\n        },\r\n        pricing: {\r\n          subtotal: 0,\r\n          discount: 0,\r\n          total: 0\r\n        },\r\n        timeline: 'เน€เธฃเธดเนเธกเธเธฒเธฃเธฃเธฑเธเธฉเธฒเนเธ”เนเธ—เธฑเธเธ—เธต',\r\n        validity: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toLocaleDateString('th-TH')\r\n      };\r\n\r\n      // Generate proposal via API\r\n      const response = await fetch('/api/ai/analyze', {\r\n        method: 'PUT',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          customerInfo: proposalData.customer,\r\n          recommendations: proposalData.treatments\r\n        })\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        console.log('Proposal generated successfully:', data.proposal);\r\n        \r\n        // Save to database (mock)\r\n        console.log('Saving proposal and lead scoring data...');\r\n        \r\n        // Calculate and save lead score\r\n        await fetch('/api/leads/score', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n          body: JSON.stringify({\r\n            analysisData: analysisResult,\r\n            engagementData: {\r\n              questionsAsked: Math.floor(Math.random() * 5) + 1,\r\n              timeSpent: Math.floor(Math.random() * 15) + 5,\r\n              followUpInterest: true,\r\n              priceInquiries: Math.floor(Math.random() * 3) + 1\r\n            }\r\n          })\r\n        });\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('Error generating proposal:', error);\r\n    }\r\n  };\r\n\r\n  const stepIndicators = [\r\n    { key: 'customer', label: 'เธเนเธญเธกเธนเธฅเธฅเธนเธเธเนเธฒ', icon: User },\r\n    { key: 'scan', label: 'เธชเนเธเธเธซเธเนเธฒ', icon: Camera },\r\n    { key: 'analysis', label: 'เธงเธดเน€เธเธฃเธฒเธฐเธซเน AI', icon: Brain },\r\n    { key: 'proposal', label: 'เธชเธฃเนเธฒเธเนเธเน€เธชเธเธญ', icon: FileText }\r\n  ];\r\n\r\n  const currentStepIndex = stepIndicators.findIndex(step => step.key === currentStep);\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Sparkle weight=\"duotone\" className=\"w-4 h-4\" />\r\n            AI Diagnostic Protocol\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Magic <span className=\"text-primary\">Scan</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Executing advanced cutaneous mapping and autonomous aesthetic analysis.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <motion.div \r\n          initial={{ opacity: 0, scale: 0.9 }}\r\n          animate={{ opacity: 1, scale: 1 }}\r\n          transition={{ delay: 0.3 }}\r\n          className=\"flex gap-3\"\r\n        >\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={() => goBack('/sales')}\r\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary\"\r\n          >\r\n            <ArrowCounterClockwise weight=\"bold\" className=\"w-4 h-4\" />\r\n            Abort Diagnostic\r\n          </Button>\r\n        </motion.div>\r\n      </div>\r\n\r\n      {/* Step Protocol Indicator */}\r\n      <div className=\"px-2\">\r\n        <Card className=\"p-8 rounded-[40px] border-border/50 shadow-premium relative overflow-hidden group\">\r\n          <div className=\"absolute inset-0 bg-gradient-to-r from-primary/5 via-transparent to-primary/5 pointer-events-none opacity-50\" />\r\n          <div className=\"flex items-center justify-between relative z-10\">\r\n            {stepIndicators.map((step, index) => {\r\n              const isActive = currentStep === step.key;\r\n              const isCompleted = index < currentStepIndex;\r\n              const StepIcon = step.icon;\r\n\r\n              return (\r\n                <div key={step.key} className=\"flex items-center flex-1 last:flex-none\">\r\n                  <div className=\"flex flex-col items-center gap-3 relative group/step\">\r\n                    <motion.div \r\n                      initial={false}\r\n                      animate={{ \r\n                        scale: isActive ? 1.1 : 1,\r\n                        borderColor: isActive ? 'rgb(var(--primary))' : isCompleted ? '#10b981' : 'var(--border)'\r\n                      }}\r\n                      className={cn(\r\n                        \"w-14 h-14 rounded-2xl border-2 flex items-center justify-center transition-all duration-500 shadow-inner\",\r\n                        isActive ? \"bg-primary/20 shadow-[0_0_25px_rgba(var(--primary),0.3)] border-primary\" : \r\n                        isCompleted ? \"bg-emerald-500/10 border-emerald-500/30\" : \"bg-secondary/50 border-border/50\"\r\n                      )}\r\n                    >\r\n                      {isCompleted ? (\r\n                        <CheckCircle weight=\"fill\" className=\"w-7 h-7 text-emerald-500\" />\r\n                      ) : (\r\n                        <StepIcon weight={isActive ? \"fill\" : \"duotone\"} className={cn(\"w-7 h-7 transition-colors duration-500\", isActive ? \"text-primary\" : \"text-muted-foreground\")} />\r\n                      )}\r\n                    </motion.div>\r\n                    <span className={cn(\r\n                      \"text-[9px] font-black uppercase tracking-[0.2em] transition-colors duration-500\",\r\n                      isActive ? \"text-primary\" : \"text-muted-foreground opacity-60\"\r\n                    )}>\r\n                      {step.label}\r\n                    </span>\r\n                    {isActive && (\r\n                      <motion.div \r\n                        layoutId=\"active-step-glow\"\r\n                        className=\"absolute -inset-4 bg-primary/5 blur-2xl rounded-full z-[-1]\"\r\n                      />\r\n                    )}\r\n                  </div>\r\n                  {index < stepIndicators.length - 1 && (\r\n                    <div className=\"flex-1 h-px mx-6 relative overflow-hidden bg-border/50\">\r\n                      <motion.div \r\n                        initial={false}\r\n                        animate={{ width: isCompleted ? '100%' : '0%' }}\r\n                        className=\"absolute inset-0 bg-gradient-to-r from-emerald-500 to-emerald-400 shadow-[0_0_10px_rgba(16,185,129,0.5)]\"\r\n                      />\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Dynamic Matrix Viewport */}\r\n      <div className=\"px-2\">\r\n        <AnimatePresence mode=\"wait\">\r\n          {currentStep === 'customer' && (\r\n            <motion.div\r\n              key=\"customer\"\r\n              initial={{ opacity: 0, y: 20 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              exit={{ opacity: 0, scale: 0.95 }}\r\n              className=\"max-w-3xl mx-auto\"\r\n            >\r\n              <Card className=\"rounded-[48px] border-border/50 shadow-premium overflow-hidden group\">\r\n                <CardHeader className=\"p-10 border-b border-border/50 bg-secondary/30 relative\">\r\n                  <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                    <User weight=\"fill\" className=\"w-64 h-64 text-primary\" />\r\n                  </div>\r\n                  <div className=\"flex items-center gap-5 relative z-10\">\r\n                    <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\r\n                      <IdentificationCard weight=\"duotone\" className=\"w-7 h-7\" />\r\n                    </div>\r\n                    <div>\r\n                      <CardTitle className=\"text-2xl font-black uppercase tracking-tight\">Identity Registry</CardTitle>\r\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] mt-1\">Establishing patient identity node</p>\r\n                    </div>\r\n                  </div>\r\n                </CardHeader>\r\n                <CardContent className=\"p-10 md:p-12 space-y-10 relative z-10\">\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                    <div className=\"space-y-3\">\r\n                      <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Full Identity Designation *</label>\r\n                      <div className=\"relative group/input\">\r\n                        <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-2xl\" />\r\n                        <User weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\r\n                        <input\r\n                          type=\"text\"\r\n                          value={customerInfo.name}\r\n                          onChange={(e) => setCustomerInfo(prev => ({ ...prev, name: e.target.value }))}\r\n                          className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-bold tracking-tight relative z-10 shadow-inner\"\r\n                          placeholder=\"Clinical Name\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"space-y-3\">\r\n                      <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Chronological Age *</label>\r\n                      <div className=\"relative group/input\">\r\n                        <IdentificationBadge weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\r\n                        <input\r\n                          type=\"number\"\r\n                          value={customerInfo.age}\r\n                          onChange={(e) => setCustomerInfo(prev => ({ ...prev, age: parseInt(e.target.value) || 25 }))}\r\n                          className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-bold tabular-nums shadow-inner\"\r\n                          min=\"15\"\r\n                          max=\"80\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                    <div className=\"space-y-3\">\r\n                      <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Communication Channel *</label>\r\n                      <div className=\"relative group/input\">\r\n                        <Phone weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\r\n                        <input\r\n                          type=\"tel\"\r\n                          value={customerInfo.phone}\r\n                          onChange={(e) => setCustomerInfo(prev => ({ ...prev, phone: e.target.value }))}\r\n                          className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-bold tabular-nums shadow-inner\"\r\n                          placeholder=\"+66 (0) 00-000-0000\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"space-y-3\">\r\n                      <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Digital Mail (Optional)</label>\r\n                      <div className=\"relative group/input\">\r\n                        <EnvelopeSimple weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\r\n                        <input\r\n                          type=\"email\"\r\n                          value={customerInfo.email}\r\n                          onChange={(e) => setCustomerInfo(prev => ({ ...prev, email: e.target.value }))}\r\n                          className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary focus:ring-4 focus:ring-primary/5 transition-all font-medium italic shadow-inner\"\r\n                          placeholder=\"client@network.com\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <Button\r\n                    onClick={() => setCurrentStep('scan')}\r\n                    disabled={!customerInfo.name || !customerInfo.phone}\r\n                    className=\"w-full py-7 rounded-[24px] font-black uppercase tracking-[0.3em] text-[11px] shadow-premium gap-3 mt-4\"\r\n                  >\r\n                    Authorize & Begin Acquisition\r\n                    <CaretRight weight=\"bold\" className=\"w-4 h-4\" />\r\n                  </Button>\r\n                </CardContent>\r\n              </Card>\r\n            </motion.div>\r\n          )}\r\n\r\n          {currentStep === 'scan' && (\r\n            <motion.div\r\n              key=\"scan\"\r\n              initial={{ opacity: 0, scale: 0.95 }}\r\n              animate={{ opacity: 1, scale: 1 }}\r\n              exit={{ opacity: 0, scale: 0.95 }}\r\n              className=\"max-w-5xl mx-auto\"\r\n            >\r\n              <Card className=\"rounded-[48px] border-border/50 shadow-premium overflow-hidden bg-black group\">\r\n                <CardHeader className=\"p-8 border-b border-white/5 bg-secondary/10\">\r\n                  <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 relative z-10\">\r\n                    <div className=\"space-y-1\">\r\n                      <h2 className=\"text-2xl font-black text-white uppercase tracking-tight\">Facial <span className=\"text-primary text-glow\">Acquisition</span></h2>\r\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em]\">Mapping cutaneous biomarkers in real-time</p>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-3 px-5 py-2.5 bg-white/5 border border-white/10 rounded-2xl backdrop-blur-xl shadow-inner\">\r\n                      <div className=\"w-2 h-2 rounded-full bg-emerald-500 animate-pulse shadow-[0_0_12px_rgba(16,185,129,0.6)]\" />\r\n                      <span className=\"text-[9px] font-black text-white uppercase tracking-widest\">Biometric Stream Secure</span>\r\n                    </div>\r\n                  </div>\r\n                </CardHeader>\r\n\r\n                <div className=\"relative aspect-video bg-[#050505] overflow-hidden group/scanner\">\r\n                  {/* Biometric Grid Overlay */}\r\n                  <div className=\"absolute inset-0 bg-scanner-grid opacity-20 pointer-events-none\" />\r\n                  \r\n                  <video\r\n                    ref={videoRef}\r\n                    className=\"absolute inset-0 w-full h-full object-cover grayscale-[0.2] contrast-[1.1]\"\r\n                    playsInline\r\n                  />\r\n                  \r\n                  <div className=\"absolute inset-0 pointer-events-none\">\r\n                    <AR3DSimulator\r\n                      landmarks={mockLandmarks}\r\n                      treatmentType={selectedTreatment}\r\n                      treatmentIntensity={treatmentIntensity}\r\n                    />\r\n                  </div>\r\n\r\n                  {/* Aesthetic Scanner Frame */}\r\n                  <div className=\"absolute inset-0 border-[40px] border-black/40 pointer-events-none\" />\r\n                  <div className=\"absolute top-10 left-10 w-24 h-24 border-t-2 border-l-2 border-primary/60 rounded-tl-[40px] shadow-glow-sm\" />\r\n                  <div className=\"absolute top-10 right-10 w-24 h-24 border-t-2 border-r-2 border-primary/60 rounded-tr-[40px] shadow-glow-sm\" />\r\n                  <div className=\"absolute bottom-10 left-10 w-24 h-24 border-b-2 border-l-2 border-primary/60 rounded-bl-[40px] shadow-glow-sm\" />\r\n                  <div className=\"absolute bottom-10 right-10 w-24 h-24 border-b-2 border-r-2 border-primary/60 rounded-br-[40px] shadow-glow-sm\" />\r\n\r\n                  <AnimatePresence>\r\n                    {!isPlaying && (\r\n                      <motion.div \r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        exit={{ opacity: 0 }}\r\n                        className=\"absolute inset-0 flex items-center justify-center bg-black/80 backdrop-blur-xl z-10\"\r\n                      >\r\n                        <div className=\"text-center space-y-10 p-10 max-w-sm\">\r\n                          <motion.div \r\n                            animate={{ scale: [1, 1.1, 1], opacity: [0.5, 1, 0.5] }}\r\n                            transition={{ duration: 3, repeat: Infinity }}\r\n                            className=\"w-24 h-24 rounded-[40px] bg-primary/10 border border-primary/20 flex items-center justify-center mx-auto shadow-inner\"\r\n                          >\r\n                            <Camera weight=\"duotone\" className=\"w-10 h-10 text-primary\" />\r\n                          </motion.div>\r\n                          <div className=\"space-y-3\">\r\n                            <h3 className=\"text-xl font-black text-white uppercase tracking-[0.3em]\">Sensor Cluster Offline</h3>\r\n                            <p className=\"text-xs text-muted-foreground font-light leading-relaxed italic\">System requires manual initialization of the high-fidelity imaging node to establish data uplink.</p>\r\n                          </div>\r\n                          <Button\r\n                            onClick={toggleCamera}\r\n                            className=\"px-10 py-5 rounded-[24px] font-black uppercase tracking-[0.3em] text-[10px] shadow-premium gap-3 mx-auto\"\r\n                          >\r\n                            <Play weight=\"bold\" className=\"w-4 h-4\" />\r\n                            Launch Imaging Node\r\n                          </Button>\r\n                        </div>\r\n                      </motion.div>\r\n                    )}\r\n\r\n                    {analyzing && (\r\n                      <motion.div \r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        className=\"absolute inset-0 flex items-center justify-center bg-black/90 backdrop-blur-2xl z-20\"\r\n                      >\r\n                        <div className=\"text-center space-y-12\">\r\n                          <div className=\"relative\">\r\n                            <motion.div \r\n                              animate={{ rotate: 360 }}\r\n                              transition={{ duration: 4, repeat: Infinity, ease: \"linear\" }}\r\n                              className=\"w-40 h-40 border-[6px] border-primary/5 border-t-primary rounded-full mx-auto shadow-[0_0_40px_rgba(var(--primary),0.2)]\"\r\n                            />\r\n                            <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                              <Sparkle weight=\"duotone\" className=\"w-12 h-12 text-primary animate-pulse\" />\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"space-y-4\">\r\n                            <h3 className=\"text-3xl font-black text-white uppercase tracking-[0.4em]\">Neural Mapping</h3>\r\n                            <p className=\"text-[10px] text-primary font-black uppercase tracking-[0.6em] animate-pulse\">Extracting Dermal Telemetry Cluster...</p>\r\n                          </div>\r\n                          <div className=\"max-w-[240px] mx-auto space-y-3\">\r\n                            <div className=\"h-1.5 w-full bg-white/5 rounded-full overflow-hidden p-0.5 border border-white/5\">\r\n                              <motion.div \r\n                                initial={{ width: 0 }}\r\n                                animate={{ width: '100%' }}\r\n                                transition={{ duration: 5 }}\r\n                                className=\"h-full bg-primary rounded-full shadow-[0_0_10px_rgba(var(--primary),0.6)]\"\r\n                              />\r\n                            </div>\r\n                            <div className=\"flex justify-between items-center text-[9px] font-black uppercase tracking-widest text-muted-foreground\">\r\n                              <span>Matrix Sync</span>\r\n                              <span className=\"text-primary\">94% Nominal</span>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </motion.div>\r\n                    )}\r\n                  </AnimatePresence>\r\n                </div>\r\n\r\n                <div className=\"p-8 border-t border-white/5 flex flex-col md:flex-row gap-6 relative z-10 bg-secondary/20\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={() => setCurrentStep('customer')}\r\n                    className=\"px-10 py-6 rounded-[24px] text-[10px] font-black uppercase tracking-[0.3em] border-white/10 text-white hover:bg-white/5\"\r\n                  >\r\n                    Reverse Protocol\r\n                  </Button>\r\n                  \r\n                  <div className=\"flex-1 flex gap-4\">\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      onClick={toggleCamera}\r\n                      disabled={analyzing}\r\n                      className=\"flex-1 py-6 rounded-[24px] text-[10px] font-black uppercase tracking-[0.3em] border-white/10 text-white hover:bg-white/5 gap-3\"\r\n                    >\r\n                      {isPlaying ? (\r\n                        <>\r\n                          <Pause weight=\"bold\" className=\"w-4 h-4 text-rose-500\" />\r\n                          Stop Feed\r\n                        </>\r\n                      ) : (\r\n                        <>\r\n                          <Play weight=\"bold\" className=\"w-4 h-4 text-emerald-500\" />\r\n                          Resume Node\r\n                        </>\r\n                      )}\r\n                    </Button>\r\n\r\n                    <Button\r\n                      onClick={startAnalysis}\r\n                      disabled={!isPlaying || analyzing}\r\n                      className=\"flex-[2] py-6 rounded-[24px] font-black uppercase tracking-[0.3em] text-[10px] shadow-premium gap-3 relative overflow-hidden group/btn\"\r\n                    >\r\n                      <div className=\"absolute inset-0 bg-white/20 -translate-x-full group-hover/btn:translate-x-full transition-transform duration-1000\" />\r\n                      <Lightning weight=\"bold\" className=\"w-4 h-4 group-hover/btn:scale-125 transition-transform\" />\r\n                      Execute Neural Diagnostic\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </Card>\r\n            </motion.div>\r\n          )}\r\n\r\n          {currentStep === 'analysis' && analysisResult && (\r\n            <motion.div\r\n              key=\"analysis\"\r\n              initial={{ opacity: 0, y: 20 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              exit={{ opacity: 0, y: -20 }}\r\n              className=\"space-y-8\"\r\n            >\r\n              <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-10\">\r\n                <div className=\"lg:col-span-2 space-y-10\">\r\n                  {/* Performance Summary Card */}\r\n                  <Card className=\"rounded-[48px] border-border/50 shadow-premium overflow-hidden group\">\r\n                    <CardHeader className=\"p-10 border-b border-border/50 bg-secondary/30 relative\">\r\n                      <div className=\"absolute top-0 right-0 p-12 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                        <Brain weight=\"fill\" className=\"w-64 h-64 text-primary\" />\r\n                      </div>\r\n\r\n                      <div className=\"relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-10\">\r\n                        <div className=\"space-y-2\">\r\n                          <motion.div \r\n                            initial={{ opacity: 0, x: -10 }}\r\n                            animate={{ opacity: 1, x: 0 }}\r\n                            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n                          >\r\n                            <Monitor weight=\"bold\" className=\"w-3.5 h-3.5\" />\r\n                            Data Transcript Complete\r\n                          </motion.div>\r\n                          <h2 className=\"text-3xl font-black text-foreground uppercase tracking-tight\">Diagnostic <span className=\"text-primary text-glow\">Intelligence</span></h2>\r\n                          <p className=\"text-sm text-muted-foreground font-light italic\">Comprehensive cognitive assessment of global cutaneous health nodes.</p>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-8 p-8 bg-card border border-border/50 rounded-[40px] shadow-premium relative group/score overflow-hidden\">\r\n                          <div className=\"absolute inset-0 bg-primary/5 opacity-0 group-hover/score:opacity-100 transition-opacity\" />\r\n                          <div className=\"text-right relative z-10\">\r\n                            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] mb-1\">Node Score</p>\r\n                            <div className=\"text-5xl font-black text-primary tracking-tighter tabular-nums\">{analysisResult.overallScore}%</div>\r\n                          </div>\r\n                          <div className=\"h-14 w-px bg-border/50 relative z-10\" />\r\n                          <div className=\"relative z-10\">\r\n                            <div className=\"w-16 h-16 rounded-[24px] bg-primary/10 border border-primary/20 flex items-center justify-center shadow-inner group-hover/score:scale-110 transition-transform\">\r\n                              <CheckCircle weight=\"duotone\" className=\"w-8 h-8 text-primary\" />\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </CardHeader>\r\n\r\n                    <CardContent className=\"p-10 space-y-12 relative z-10\">\r\n                      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-6\">\r\n                        {[\r\n                          { label: 'Skin Node Age', value: analysisResult.skinAge, icon: Clock, color: 'text-emerald-500', bg: 'bg-emerald-500/10' },\r\n                          { label: 'Identity Age', value: customerInfo.age, icon: User, color: 'text-blue-500', bg: 'bg-blue-500/10' },\r\n                          { label: 'Sync Confidence', value: '94.2%', icon: ShieldCheck, color: 'text-amber-500', bg: 'bg-amber-500/10' },\r\n                          { label: 'Biometric Points', value: '468+', icon: Lightning, color: 'text-primary', bg: 'bg-primary/10' }\r\n                        ].map((item, i) => (\r\n                          <motion.div \r\n                            key={item.label}\r\n                            initial={{ opacity: 0, y: 10 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            transition={{ delay: 0.4 + i * 0.1 }}\r\n                            className=\"p-6 bg-secondary/30 rounded-[32px] border border-border/50 hover:border-primary/20 transition-all text-center group/stat shadow-inner\"\r\n                          >\r\n                            <div className={cn(\"w-12 h-12 rounded-2xl mx-auto mb-4 flex items-center justify-center border border-border/50 group-hover/stat:scale-110 group-hover/stat:rotate-3 transition-all duration-500\", item.bg, item.color)}>\r\n                              <item.icon weight=\"duotone\" className=\"w-6 h-6\" />\r\n                            </div>\r\n                            <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1\">{item.label}</p>\r\n                            <p className=\"text-xl font-black text-foreground tabular-nums\">{item.value}</p>\r\n                          </motion.div>\r\n                        ))}\r\n                      </div>\r\n\r\n                      {/* Biomarker Visualization Node */}\r\n                      <div className=\"space-y-8\">\r\n                        <div className=\"flex items-center justify-between px-2\">\r\n                          <div className=\"flex items-center gap-3\">\r\n                            <div className=\"w-2 h-2 rounded-full bg-primary animate-pulse shadow-[0_0_10px_rgba(var(--primary),0.6)]\" />\r\n                            <h3 className=\"text-[11px] font-black text-foreground uppercase tracking-[0.3em]\">Critical Cutaneous Biomarkers</h3>\r\n                          </div>\r\n                          <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[8px] uppercase tracking-widest px-3\">Telemetry High-Res</Badge>\r\n                        </div>\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-8 px-2\">\r\n                          {Object.entries(analysisResult.skinMetrics).map(([key, value], i) => {\r\n                            const labels: Record<string, string> = {\r\n                              hydration: 'Hydration Protocol',\r\n                              elasticity: 'Dermal Flux',\r\n                              pigmentation: 'Melanin Registry',\r\n                              texture: 'Surface Refinement',\r\n                              poreSize: 'Structural Density',\r\n                              oiliness: 'Sebum Equilibrium'\r\n                            };\r\n\r\n                            return (\r\n                              <motion.div \r\n                                key={key}\r\n                                initial={{ opacity: 0, x: -10 }}\r\n                                animate={{ opacity: 1, x: 0 }}\r\n                                transition={{ delay: 0.6 + i * 0.05 }}\r\n                                className=\"space-y-4 group/metric\"\r\n                              >\r\n                                <div className=\"flex justify-between items-end px-1\">\r\n                                  <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] group-hover/metric:text-foreground transition-colors\">{labels[key]}</span>\r\n                                  <span className=\"text-sm font-black text-foreground tabular-nums\">{value}%</span>\r\n                                </div>\r\n                                <div className=\"h-2 w-full bg-secondary/50 rounded-full overflow-hidden p-0.5 border border-border/50 shadow-inner\">\r\n                                  <motion.div \r\n                                    initial={{ width: 0 }}\r\n                                    animate={{ width: `${value}%` }}\r\n                                    transition={{ duration: 2, ease: \"circOut\", delay: 0.8 }}\r\n                                    className={cn(\r\n                                      \"h-full rounded-full transition-all duration-1000\",\r\n                                      value >= 80 ? 'bg-emerald-500 shadow-[0_0_15px_rgba(16,185,129,0.4)]' : \r\n                                      value >= 60 ? 'bg-primary shadow-[0_0_15px_rgba(var(--primary),0.4)]' : 'bg-rose-500 shadow-[0_0_15px_rgba(244,63,94,0.4)]'\r\n                                    )}\r\n                                  />\r\n                                </div>\r\n                              </motion.div>\r\n                            );\r\n                          })}\r\n                        </div>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n\r\n                  {/* AI Cognitive Insights Node */}\r\n                  <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n                    <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30\">\r\n                      <div className=\"flex items-center gap-4\">\r\n                        <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n                          <Sparkle weight=\"duotone\" className=\"w-6 h-6\" />\r\n                        </div>\r\n                        <h3 className=\"text-xl font-black text-foreground uppercase tracking-tight\">AI Cognitive <span className=\"text-primary text-glow\">Insights</span></h3>\r\n                      </div>\r\n                    </CardHeader>\r\n                    <CardContent className=\"p-10\">\r\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                        {analysisResult.aiInsights.map((insight, index) => (\r\n                          <motion.div \r\n                            key={index}\r\n                            initial={{ opacity: 0, y: 10 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            transition={{ delay: 1 + index * 0.1 }}\r\n                            className=\"p-6 bg-secondary/20 rounded-[32px] border border-border/50 flex gap-5 hover:bg-secondary/40 hover:border-primary/20 transition-all group/insight relative overflow-hidden\"\r\n                          >\r\n                            <div className=\"absolute top-0 right-0 p-4 opacity-[0.02] group-hover/insight:scale-110 transition-transform\">\r\n                              <Brain weight=\"fill\" className=\"w-12 h-12 text-primary\" />\r\n                            </div>\r\n                            <div className=\"w-2.5 h-2.5 rounded-full bg-primary mt-1.5 flex-shrink-0 shadow-[0_0_10px_rgba(var(--primary),0.6)] animate-pulse\" />\r\n                            <p className=\"text-xs text-muted-foreground font-medium leading-relaxed italic relative z-10\">{insight}</p>\r\n                          </motion.div>\r\n                        ))}\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                </div>\r\n\r\n                {/* Right: Treatment Protocol Engine Node */}\r\n                <div className=\"space-y-10\">\r\n                  <div className=\"sticky top-24 space-y-10\">\r\n                    <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\r\n                      <CardHeader className=\"p-8 border-b border-border/50 bg-secondary/30\">\r\n                        <div className=\"flex items-center gap-4\">\r\n                          <div className=\"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n                            <Target weight=\"duotone\" className=\"w-5 h-5\" />\r\n                          </div>\r\n                          <CardTitle className=\"text-sm font-black uppercase tracking-widest\">Recommended Protocol</CardTitle>\r\n                        </div>\r\n                      </CardHeader>\r\n\r\n                      <CardContent className=\"p-8 space-y-6\">\r\n                        <div className=\"space-y-4\">\r\n                          {analysisResult.recommendations.map((treatment, index) => (\r\n                            <motion.div\r\n                              key={index}\r\n                              initial={{ opacity: 0, x: 20 }}\r\n                              animate={{ opacity: 1, x: 0 }}\r\n                              transition={{ delay: 0.8 + index * 0.1 }}\r\n                              className=\"p-6 border border-border/50 rounded-[32px] bg-secondary/20 hover:border-primary/40 hover:bg-secondary/40 transition-all group/rec cursor-pointer relative overflow-hidden shadow-sm\"\r\n                            >\r\n                              <div className=\"absolute top-0 right-0 p-4 opacity-0 group-hover/rec:opacity-5 transition-opacity\">\r\n                                <Sparkle weight=\"fill\" className=\"w-16 h-16 text-primary\" />\r\n                              </div>\r\n                              \r\n                              <div className=\"flex items-start justify-between mb-4 relative z-10\">\r\n                                <div className=\"font-black text-foreground uppercase tracking-tight group-hover/rec:text-primary transition-colors text-sm\">{treatment.name}</div>\r\n                                <Badge variant=\"ghost\" size=\"sm\" className=\"bg-primary/10 text-primary border-none font-black text-[8px] uppercase tracking-widest px-2 py-0.5\">\r\n                                  {treatment.confidence}% Fit\r\n                                </Badge>\r\n                              </div>\r\n                              <p className=\"text-[11px] text-muted-foreground mb-6 font-medium italic leading-relaxed line-clamp-2 opacity-80\">{treatment.description}</p>\r\n                              <div className=\"flex items-center justify-between pt-5 border-t border-border/30 relative z-10\">\r\n                                <div className=\"space-y-0.5\">\r\n                                  <p className=\"text-[8px] text-muted-foreground uppercase font-black tracking-widest opacity-60\">Investment</p>\r\n                                  <span className=\"text-base font-black text-emerald-500 tabular-nums tracking-tight\">เธฟ{treatment.price}</span>\r\n                                </div>\r\n                                <div className=\"text-right space-y-0.5\">\r\n                                  <p className=\"text-[8px] text-muted-foreground uppercase font-black tracking-widest opacity-60\">Cycle</p>\r\n                                  <span className=\"text-[10px] font-black text-foreground uppercase tracking-widest\">{treatment.sessions} Sessions</span>\r\n                                </div>\r\n                              </div>\r\n                            </motion.div>\r\n                          ))}\r\n                        </div>\r\n\r\n                        <div className=\"p-5 bg-rose-500/5 rounded-[28px] border border-rose-500/10 flex gap-4 relative overflow-hidden group/risk\">\r\n                          <div className=\"absolute top-0 right-0 p-4 opacity-[0.03] group-hover/risk:scale-110 transition-transform\">\r\n                            <Warning weight=\"fill\" className=\"w-10 h-10 text-rose-500\" />\r\n                          </div>\r\n                          <Warning weight=\"duotone\" className=\"w-5 h-5 text-rose-500 flex-shrink-0 relative z-10\" />\r\n                          <div className=\"space-y-1 relative z-10\">\r\n                            <p className=\"text-[10px] font-black text-rose-500 uppercase tracking-widest\">Risk Mitigation</p>\r\n                            <p className=\"text-[10px] text-muted-foreground font-medium leading-relaxed italic opacity-80\">\r\n                              System detected slight sensitivity in epidermal layer. Practitioner supervision required for protocol intensity levels.\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n                      </CardContent>\r\n                    </Card>\r\n\r\n                    <Card className=\"p-8 rounded-[40px] border-primary/10 bg-primary/[0.02] space-y-4 group overflow-hidden relative\">\r\n                      <div className=\"absolute -bottom-12 -right-12 w-32 h-32 bg-primary/5 blur-[50px] rounded-full group-hover:bg-primary/10 transition-all duration-700\" />\r\n                      <div className=\"flex items-center gap-3 relative z-10\">\r\n                        <Pulse weight=\"duotone\" className=\"w-5 h-5 text-primary group-hover:scale-110 transition-transform\" />\r\n                        <h4 className=\"text-[10px] font-black text-primary uppercase tracking-[0.3em]\">Neural Pulse</h4>\r\n                      </div>\r\n                      <p className=\"text-xs text-muted-foreground italic font-medium leading-relaxed relative z-10\">\r\n                        Analyzing clinical trajectory patterns. Protocol success probability currently at 88.4% based on similar node clusters.\r\n                      </p>\r\n                    </Card>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex flex-col md:flex-row gap-6 pt-10 px-2\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={() => setCurrentStep('scan')}\r\n                  className=\"px-12 py-7 rounded-[28px] text-[11px] font-black uppercase tracking-[0.3em] border-border/50 hover:bg-secondary shrink-0\"\r\n                >\r\n                  Relaunch Diagnostic\r\n                </Button>\r\n                \r\n                <Button\r\n                  onClick={generateProposal}\r\n                  className=\"flex-1 py-7 rounded-[28px] font-black uppercase tracking-[0.3em] text-[11px] shadow-premium gap-4 group relative overflow-hidden\"\r\n                >\r\n                  <div className=\"absolute inset-0 bg-white/20 -translate-x-full group-hover:translate-x-full transition-transform duration-1000\" />\r\n                  <FileText weight=\"bold\" className=\"w-5 h-5 group-hover:scale-110 transition-transform\" />\r\n                  Generate Aesthetic Transformation Proposal\r\n                </Button>\r\n              </div>\r\n            </motion.div>\r\n          )}\r\n\r\n          {currentStep === 'proposal' && (\r\n            <motion.div\r\n              key=\"proposal\"\r\n              initial={{ opacity: 0, scale: 0.95 }}\r\n              animate={{ opacity: 1, scale: 1 }}\r\n              exit={{ opacity: 0, scale: 0.95 }}\r\n              className=\"max-w-4xl mx-auto\"\r\n            >\r\n              <Card className=\"rounded-[60px] border-border/50 shadow-premium overflow-hidden text-center relative p-16 md:p-24 group\">\r\n                <div className=\"absolute inset-0 bg-gradient-to-b from-primary/[0.03] to-transparent pointer-events-none\" />\r\n                <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary/20 to-transparent\" />\r\n                \r\n                <div className=\"relative z-10 space-y-12\">\r\n                  <motion.div \r\n                    initial={{ scale: 0, rotate: -45 }}\r\n                    animate={{ scale: 1, rotate: 0 }}\r\n                    transition={{ type: \"spring\", stiffness: 200, damping: 12, delay: 0.2 }}\r\n                    className=\"w-28 h-24 rounded-[40px] bg-emerald-500/10 border border-emerald-500/20 flex items-center justify-center mx-auto shadow-[0_0_40px_rgba(16,185,129,0.1)] group-hover:scale-110 transition-transform duration-700\"\r\n                  >\r\n                    <CheckCircle weight=\"duotone\" className=\"w-14 h-14 text-emerald-500\" />\r\n                  </motion.div>\r\n\r\n                  <div className=\"space-y-6\">\r\n                    <div className=\"space-y-2\">\r\n                      <Badge variant=\"ghost\" className=\"bg-emerald-500/5 text-emerald-500 border-none font-black text-[10px] tracking-[0.4em] uppercase px-6\">Transmission Confirmed</Badge>\r\n                      <h2 className=\"text-4xl md:text-5xl font-black text-foreground uppercase tracking-tight leading-tight pt-4\">Intelligence <br /><span className=\"text-primary text-glow\">Synchronized</span></h2>\r\n                    </div>\r\n                    <p className=\"text-lg text-muted-foreground font-light max-w-lg mx-auto leading-relaxed italic\">\r\n                      Neural diagnostic node for <span className=\"text-foreground font-black uppercase tracking-tight\">{customerInfo.name}</span> is complete. The digital proposal has been encrypted and stored in the clinical vault.\r\n                    </p>\r\n                  </div>\r\n\r\n                  <div className=\"flex flex-col sm:flex-row items-center gap-6 max-w-2xl mx-auto pt-6\">\r\n                    <Button\r\n                      onClick={() => router.push('/sales/proposals')}\r\n                      className=\"w-full py-7 rounded-[28px] font-black uppercase tracking-[0.2em] text-[11px] shadow-premium gap-4 group/btn\"\r\n                    >\r\n                      <FileText weight=\"bold\" className=\"w-5 h-5 group-hover/btn:scale-110 transition-transform\" />\r\n                      Access Digital Asset\r\n                    </Button>\r\n                    \r\n                    <Button\r\n                      variant=\"outline\"\r\n                      onClick={() => {\r\n                        setCurrentStep('customer');\r\n                        setAnalysisResult(null);\r\n                        setCustomerInfo({ name: '', age: 25, phone: '', email: '', skinConcerns: [] });\r\n                      }}\r\n                      className=\"w-full py-7 rounded-[28px] text-[11px] font-black uppercase tracking-[0.2em] border-border/50 hover:bg-secondary\"\r\n                    >\r\n                      Begin New Registry\r\n                    </Button>\r\n                  </div>\r\n\r\n                  <div className=\"pt-12 border-t border-border/30 flex flex-col items-center gap-5\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div className=\"w-2 h-2 rounded-full bg-emerald-500 animate-pulse shadow-[0_0_10px_rgba(16,185,129,0.6)]\" />\r\n                      <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.4em]\">Cloud Synchronization Active</span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-6 opacity-40 grayscale group-hover:grayscale-0 transition-all duration-700\">\r\n                      <ShieldCheck weight=\"duotone\" className=\"w-6 h-6\" />\r\n                      <div className=\"h-4 w-px bg-border\" />\r\n                      <IdentificationBadge weight=\"duotone\" className=\"w-6 h-6\" />\r\n                      <div className=\"h-4 w-px bg-border\" />\r\n                      <Pulse weight=\"duotone\" className=\"w-6 h-6\" />\r\n                    </div>\r\n                    <p className=\"text-[9px] text-muted-foreground font-black uppercase tracking-[0.5em] opacity-40\">ISO 27001 SECURED PIPELINE NODE</p>\r\n                  </div>\r\n                </div>\r\n              </Card>\r\n            </motion.div>\r\n          )}\r\n        </AnimatePresence>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\sales\\analytics\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowUpRight' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":15,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowUpRight"},"fix":{"range":[152,169],"text":""},"desc":"Remove unused variable \"ArrowUpRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Briefcase"},"fix":{"range":[179,193],"text":""},"desc":"Remove unused variable \"Briefcase\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useTranslations' is defined but never used.","line":24,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":25,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"useTranslations"},"fix":{"range":[604,648],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":31,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { motion } from 'framer-motion';\r\nimport { \r\n  ChartBar, \r\n  TrendUp, \r\n  Users, \r\n  Funnel,\r\n  Target,\r\n  Lightning,\r\n  Sparkle,\r\n  ArrowUpRight,\r\n  Clock,\r\n  Briefcase,\r\n  CaretRight,\r\n  Icon\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { useTranslations } from 'next-intl';\r\nimport { cn } from '@/lib/utils';\r\nimport SalesFunnelChart from '@/components/analytics/SalesFunnelChart';\r\nimport CohortAnalysis from '@/components/analytics/CohortAnalysis';\r\nimport PredictiveDashboard from '@/components/analytics/PredictiveDashboard';\r\n\r\nexport default function SalesAnalyticsPage() {\r\n  const { goBack } = useBackNavigation();\r\n  // Mock Data for Sales Funnel\r\n  const funnelData = [\r\n    { name: 'Lead', value: 1200, percentage: 100 },\r\n    { name: 'Contacted', value: 850, percentage: 70.8 },\r\n    { name: 'Qualified', value: 500, percentage: 58.8 },\r\n    { name: 'Proposal', value: 300, percentage: 60.0 },\r\n    { name: 'Won', value: 180, percentage: 60.0 }\r\n  ];\r\n\r\n  // Mock Data for Cohort Analysis\r\n  const cohortData = [\r\n    {\r\n      cohort: 'Oct 2025',\r\n      size: 150,\r\n      retention: { month1: 85, month2: 78, month3: 75, month6: 65, month12: 50 },\r\n      revenue: { total: 4500000, perCustomer: 30000 }\r\n    },\r\n    {\r\n      cohort: 'Nov 2025',\r\n      size: 180,\r\n      retention: { month1: 88, month2: 82, month3: 79, month6: 0, month12: 0 },\r\n      revenue: { total: 5400000, perCustomer: 30000 }\r\n    },\r\n    {\r\n      cohort: 'Dec 2025',\r\n      size: 210,\r\n      retention: { month1: 90, month2: 85, month3: 0, month6: 0, month12: 0 },\r\n      revenue: { total: 7350000, perCustomer: 35000 }\r\n    },\r\n    {\r\n      cohort: 'Jan 2026',\r\n      size: 250,\r\n      retention: { month1: 92, month2: 0, month3: 0, month6: 0, month12: 0 },\r\n      revenue: { total: 10000000, perCustomer: 40000 }\r\n    }\r\n  ];\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-10 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <ChartBar weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Performance Analytics\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Sales <span className=\"text-primary\">Insights</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Deep dive into conversion metrics, customer retention, and AI predictive trajectories.\r\n          </motion.p>\r\n        </div>\r\n        \r\n        <motion.div \r\n          initial={{ opacity: 0, scale: 0.9 }}\r\n          animate={{ opacity: 1, scale: 1 }}\r\n          transition={{ delay: 0.3 }}\r\n          className=\"flex flex-wrap gap-3\"\r\n        >\r\n          <Button variant=\"outline\" className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50\">\r\n            <Funnel weight=\"bold\" className=\"w-4 h-4\" />\r\n            Filter Period\r\n          </Button>\r\n          <Button className=\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium\">\r\n            <Lightning weight=\"bold\" className=\"w-4 h-4\" />\r\n            Export Intelligence\r\n          </Button>\r\n        </motion.div>\r\n      </div>\r\n\r\n      {/* Stats Grid */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8\">\r\n        <StatCard\r\n          title=\"Conversion Node\"\r\n          value={15.0}\r\n          suffix=\"%\"\r\n          decimals={1}\r\n          change={2.5}\r\n          trend=\"up\"\r\n          icon={Target as Icon}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Retention Delta\"\r\n          value={68.0}\r\n          suffix=\"%\"\r\n          decimals={1}\r\n          change={1.2}\r\n          trend=\"up\"\r\n          icon={Users as Icon}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Avg Cycle Time\"\r\n          value={14}\r\n          suffix=\" Days\"\r\n          change={-3}\r\n          trend=\"up\"\r\n          icon={Clock as Icon}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Pipeline Velocity\"\r\n          value={1200000}\r\n          prefix=\"เธฟ\"\r\n          change={12.5}\r\n          trend=\"up\"\r\n          icon={TrendUp as Icon}\r\n          className=\"p-4\"\r\n        />\r\n      </div>\r\n\r\n      {/* AI Predictive Intelligence Section */}\r\n      <div className=\"space-y-8\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center gap-4\">\r\n            <div className=\"w-14 h-14 rounded-2xl bg-purple-500/10 flex items-center justify-center text-purple-500 border border-purple-500/20 shadow-sm\">\r\n              <Sparkle weight=\"duotone\" className=\"w-7 h-7\" />\r\n            </div>\r\n            <div>\r\n              <h2 className=\"text-xl font-black text-foreground uppercase tracking-tight\">AI Predictive Forecast</h2>\r\n              <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-1\">Machine learning driven performance matrix</p>\r\n            </div>\r\n          </div>\r\n          <Badge variant=\"ghost\" className=\"bg-purple-500/5 text-purple-500 border-none font-black text-[10px] tracking-widest uppercase px-4 py-1.5\">Alpha Intelligence</Badge>\r\n        </div>\r\n        <Card className=\"rounded-[40px] border-purple-500/10 bg-purple-500/[0.01] overflow-hidden\">\r\n          <CardContent className=\"p-8\">\r\n            <PredictiveDashboard />\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-10\">\r\n        {/* Sales Funnel */}\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ delay: 0.4 }}\r\n        >\r\n          <Card className=\"rounded-[40px] border-border/50 h-full\">\r\n            <CardHeader className=\"p-8 border-b border-border/50\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n                    <Funnel weight=\"duotone\" className=\"w-6 h-6\" />\r\n                  </div>\r\n                  <div>\r\n                    <CardTitle className=\"text-lg font-black uppercase tracking-tight\">Conversion Funnel</CardTitle>\r\n                    <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Identity Registry to Revenue Node</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent className=\"p-8\">\r\n              <SalesFunnelChart data={funnelData} />\r\n            </CardContent>\r\n          </Card>\r\n        </motion.div>\r\n\r\n        {/* Cohort Analysis */}\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ delay: 0.5 }}\r\n        >\r\n          <Card className=\"rounded-[40px] border-border/50 h-full\">\r\n            <CardHeader className=\"p-8 border-b border-border/50\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div className=\"w-12 h-12 rounded-2xl bg-emerald-500/10 flex items-center justify-center text-emerald-500 border border-emerald-500/20 shadow-inner\">\r\n                    <Users weight=\"duotone\" className=\"w-6 h-6\" />\r\n                  </div>\r\n                  <div>\r\n                    <CardTitle className=\"text-lg font-black uppercase tracking-tight\">Cohort Analysis</CardTitle>\r\n                    <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Identity Retention & LTV Mapping</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent className=\"p-8\">\r\n              <CohortAnalysis data={cohortData} />\r\n            </CardContent>\r\n          </Card>\r\n        </motion.div>\r\n      </div>\r\n\r\n      {/* Insight Nodes */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\r\n        {[\r\n          { label: 'Conversion Delta', value: '+2.5%', desc: 'Optimization in contacted node registry.', color: 'text-emerald-500', bg: 'bg-emerald-500/10' },\r\n          { label: 'Identity Loyalty', value: 'High', desc: 'Repeat protocol engagement at alpha level.', color: 'text-blue-500', bg: 'bg-blue-500/10' },\r\n          { label: 'Process Efficiency', value: '-3 Days', desc: 'Velocity improvement in proposal node cycle.', color: 'text-purple-500', bg: 'bg-purple-500/10' }\r\n        ].map((node, i) => (\r\n          <motion.div\r\n            key={i}\r\n            initial={{ opacity: 0, scale: 0.95 }}\r\n            animate={{ opacity: 1, scale: 1 }}\r\n            transition={{ delay: 0.6 + i * 0.1 }}\r\n          >\r\n            <Card className=\"border-border/50 hover:border-primary/30 transition-all group overflow-hidden\">\r\n              <CardContent className=\"p-8 space-y-4\">\r\n                <div className=\"flex justify-between items-start\">\r\n                  <div className={cn(\"px-3 py-1 rounded-lg font-black text-[10px] uppercase tracking-widest\", node.bg, node.color)}>\r\n                    {node.label}\r\n                  </div>\r\n                  <div className={cn(\"text-2xl font-black tabular-nums\", node.color)}>\r\n                    {node.value}\r\n                  </div>\r\n                </div>\r\n                <p className=\"text-xs text-muted-foreground font-medium italic opacity-80 leading-relaxed\">\r\n                  {node.desc}\r\n                </p>\r\n                <Button variant=\"ghost\" size=\"sm\" className=\"w-full justify-between text-[10px] font-black uppercase tracking-[0.2em] text-primary group-hover:bg-primary/5 rounded-xl px-0 pt-4 border-t border-border/30\">\r\n                  View Detail Node\r\n                  <CaretRight weight=\"bold\" className=\"w-3 h-3\" />\r\n                </Button>\r\n              </CardContent>\r\n            </Card>\r\n          </motion.div>\r\n        ))}\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\sales\\customers\\[id]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRouter' is defined but never used.","line":4,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":30,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useRouter"},"fix":{"range":[81,92],"text":""},"desc":"Remove unused variable \"useRouter\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"User"},"fix":{"range":[309,314],"text":""},"desc":"Remove unused variable \"User\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Clock"},"fix":{"range":[362,373],"text":""},"desc":"Remove unused variable \"Clock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowRight' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowRight"},"fix":{"range":[373,389],"text":""},"desc":"Remove unused variable \"ArrowRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WarningCircle' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WarningCircle"},"fix":{"range":[406,424],"text":""},"desc":"Remove unused variable \"WarningCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowUpRight' is defined but never used.","line":28,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":15,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowUpRight"},"fix":{"range":[593,610],"text":""},"desc":"Remove unused variable \"ArrowUpRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ShieldCheck' is defined but never used.","line":29,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ShieldCheck"},"fix":{"range":[610,626],"text":""},"desc":"Remove unused variable \"ShieldCheck\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'StatCard' is defined but never used.","line":33,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":18,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"StatCard"},"fix":{"range":[676,728],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'WorkflowState' is defined but never used.","line":40,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":23,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"WorkflowState"},"fix":{"range":[1080,1094],"text":""},"desc":"Remove unused variable \"WorkflowState\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":51,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1705,1708],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1705,1708],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'workflowLoading' is assigned a value but never used.","line":67,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":67,"endColumn":29},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":115,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":115,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4050,4053],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4050,4053],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":139,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":139,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4808,4811],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4808,4811],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Target' is not defined.","line":256,"column":16,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":256,"endColumn":22},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Pulse' is not defined.","line":269,"column":16,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":269,"endColumn":21},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'SpinnerGap' is not defined.","line":280,"column":20,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":280,"endColumn":30},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'CaretRight' is not defined.","line":352,"column":31,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":352,"endColumn":41},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'CaretRight' is not defined.","line":355,"column":36,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":355,"endColumn":46},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'CaretRight' is not defined.","line":358,"column":36,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":358,"endColumn":46},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'CaretRight' is not defined.","line":596,"column":24,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":596,"endColumn":34}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useParams, useRouter } from 'next/navigation';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { \r\n  User, \r\n  Phone, \r\n  EnvelopeSimple, \r\n  CalendarDots, \r\n  Clock, \r\n  ArrowRight, \r\n  CheckCircle,\r\n  WarningCircle,\r\n  FileText,\r\n  CreditCard,\r\n  Scissors,\r\n  ChatCircle,\r\n  CaretLeft,\r\n  TrendUp,\r\n  Sparkle,\r\n  IdentificationCard,\r\n  Briefcase,\r\n  History,\r\n  ClockCounterClockwise,\r\n  ArrowUpRight,\r\n  ShieldCheck,\r\n  X,\r\n  Plus\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { createClient } from '@/lib/supabase/client';\r\nimport { useWorkflow } from '@/hooks/useWorkflow';\r\nimport { WorkflowState, WorkflowStage } from '@/lib/workflow/workflowEngine';\r\nimport CustomerTimelineView from '@/components/sales/CustomerTimelineView';\r\nimport PredictiveAnalyticsView from '@/components/sales/PredictiveAnalyticsView';\r\nimport { getCustomerIntelligenceAction } from '@/app/actions/customer';\r\nimport { CustomerIntelligence } from '@/lib/customer/customerIntelligence';\r\nimport { cn } from '@/lib/utils';\r\n\r\nexport default function CustomerDetailPage() {\r\n  const params = useParams();\r\n  const { goBack } = useBackNavigation();\r\n  const customerId = params.id as string;\r\n  const [customer, setCustomer] = useState<any>(null);\r\n  const [intelligence, setIntelligence] = useState<CustomerIntelligence | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [startingJourney, setStartingJourney] = useState(false);\r\n  const [scheduleOpen, setScheduleOpen] = useState(false);\r\n  const [staffLoading, setStaffLoading] = useState(false);\r\n  const [beauticians, setBeauticians] = useState<Array<{ id: string; name: string; role: string }>>([]);\r\n  const [selectedBeauticianId, setSelectedBeauticianId] = useState<string>('');\r\n  const [appointmentDate, setAppointmentDate] = useState<string>('');\r\n  const [appointmentTime, setAppointmentTime] = useState<string>('');\r\n  \r\n  const { \r\n    workflows, \r\n    createWorkflow,\r\n    listWorkflows, \r\n    executeTransition, \r\n    loading: workflowLoading \r\n  } = useWorkflow();\r\n\r\n  // Find active workflow for this customer\r\n  const activeWorkflow = workflows.find(w => \r\n    w.customerId === customerId && w.currentStage !== 'completed'\r\n  );\r\n\r\n  useEffect(() => {\r\n    async function loadData() {\r\n      if (!customerId) return;\r\n      \r\n      try {\r\n        const supabase = createClient();\r\n        \r\n        // Fetch customer details\r\n        const { data: customerData, error } = await supabase\r\n          .from('customers')\r\n          .select('*')\r\n          .eq('id', customerId)\r\n          .single();\r\n          \r\n        if (error) throw error;\r\n        setCustomer(customerData);\r\n\r\n        // Fetch Intelligence\r\n        const intelRes = await getCustomerIntelligenceAction(customerId);\r\n        if (intelRes.success) {\r\n          setIntelligence(intelRes.data || null);\r\n        }\r\n\r\n        // Fetch Workflows\r\n        // Note: listWorkflows might need to be filtered by customerId in the hook or API\r\n        // For now, we list all and filter on client, or assuming listWorkflows fetches relevant ones.\r\n        // Ideally pass customerId to listWorkflows if supported, currently it supports stage/assignedTo.\r\n        // Let's rely on listWorkflows fetching clinic workflows and we filter.\r\n        await listWorkflows(); \r\n\r\n      } catch (err) {\r\n        console.error('Error loading customer data:', err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n    \r\n    loadData();\r\n  }, [customerId, listWorkflows]);\r\n\r\n  const handleAction = async (action: string, data?: any) => {\r\n    if (!activeWorkflow) return;\r\n    \r\n    try {\r\n      await executeTransition(activeWorkflow.id, action, data);\r\n      // Refresh logic handled by hook usually, or we reload\r\n      await listWorkflows();\r\n    } catch (err) {\r\n      console.error('Action failed:', err);\r\n      alert('Failed to execute action');\r\n    }\r\n  };\r\n\r\n  const loadBeauticians = async () => {\r\n    if (!customer?.clinic_id) return;\r\n\r\n    try {\r\n      setStaffLoading(true);\r\n      const res = await fetch(`/api/v1/staff/profiles?clinic_id=${customer.clinic_id}`);\r\n      const json = await res.json();\r\n      if (!res.ok || !json?.success) {\r\n        throw new Error(json?.error || 'Failed to load staff profiles');\r\n      }\r\n\r\n      const rows = (json.data || []) as any[];\r\n      const mapped = rows\r\n        .filter(r => r?.users?.full_name)\r\n        .map(r => ({\r\n          id: r.user_id,\r\n          name: r.users.full_name,\r\n          role: r.role\r\n        }))\r\n        .filter(r => r.role === 'clinic_staff');\r\n\r\n      setBeauticians(mapped);\r\n    } catch (e) {\r\n      console.error(e);\r\n      setBeauticians([]);\r\n    } finally {\r\n      setStaffLoading(false);\r\n    }\r\n  };\r\n\r\n  const openSchedule = async () => {\r\n    setScheduleOpen(true);\r\n    await loadBeauticians();\r\n  };\r\n\r\n  const submitSchedule = async () => {\r\n    if (!selectedBeauticianId || !appointmentDate || !appointmentTime) {\r\n      alert('Please select beautician and set date/time');\r\n      return;\r\n    }\r\n\r\n    await handleAction('schedule_appointment', {\r\n      beauticianId: selectedBeauticianId,\r\n      appointmentDate,\r\n      appointmentTime\r\n    });\r\n\r\n    setScheduleOpen(false);\r\n  };\r\n\r\n  const handleStartNewJourney = async () => {\r\n    if (!customerId || !customer) return;\r\n\r\n    try {\r\n      setStartingJourney(true);\r\n      await createWorkflow({\r\n        customerId,\r\n        customerName: customer.full_name,\r\n        customerEmail: customer.email || undefined,\r\n        customerPhone: customer.phone || undefined\r\n      });\r\n      await listWorkflows();\r\n    } catch (err) {\r\n      console.error('Failed to start new journey:', err);\r\n      alert('Failed to start new journey');\r\n    } finally {\r\n      setStartingJourney(false);\r\n    }\r\n  };\r\n\r\n  const getStageColor = (stage: WorkflowStage) => {\r\n    switch (stage) {\r\n      case 'lead_created': return 'bg-gray-500/20 text-gray-400';\r\n      case 'scanned': return 'bg-blue-500/20 text-blue-400';\r\n      case 'proposal_sent': return 'bg-purple-500/20 text-purple-400';\r\n      case 'payment_confirmed': return 'bg-emerald-500/20 text-emerald-400';\r\n      case 'treatment_scheduled': return 'bg-orange-500/20 text-orange-400';\r\n      case 'in_treatment': return 'bg-pink-500/20 text-pink-400';\r\n      case 'treatment_completed': return 'bg-green-500/20 text-green-400';\r\n      case 'follow_up': return 'bg-yellow-500/20 text-yellow-400';\r\n      case 'completed': return 'bg-gray-500/20 text-gray-400';\r\n      default: return 'bg-gray-500/20 text-gray-400';\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!customer) {\r\n    return (\r\n      <div className=\"p-8 text-center bg-background min-h-screen flex flex-col items-center justify-center space-y-4\">\r\n        <h1 className=\"text-2xl font-bold text-foreground mb-4\">Customer Not Found</h1>\r\n        <button onClick={() => goBack('/sales/customers')} className=\"text-primary hover:underline font-medium\">\r\n          Go Back\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-24 font-sans\"\r\n    >\r\n      <Breadcrumb \r\n        customLabels={{ \r\n          [customerId]: customer?.full_name || 'Prospect Detail'\r\n        }} \r\n      />\r\n\r\n      {/* Header */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\r\n        <div className=\"flex items-center gap-6\">\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={() => goBack('/sales/customers')}\r\n            className=\"p-4 h-14 w-14 border-border rounded-2xl text-muted-foreground hover:text-foreground transition-all\"\r\n          >\r\n            <CaretLeft weight=\"bold\" className=\"w-5 h-5\" />\r\n          </Button>\r\n          <div className=\"space-y-1\">\r\n            <div className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\">\r\n              <Target weight=\"duotone\" className=\"w-4 h-4\" />\r\n              Identity Node\r\n            </div>\r\n            <h1 className=\"text-4xl font-bold text-foreground tracking-tight uppercase\">\r\n              {customer.full_name} \r\n              <span className=\"text-primary/40 font-light italic ml-3\">({customer.nickname || 'PROSPECT'})</span>\r\n            </h1>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"flex items-center gap-3\">\r\n          {activeWorkflow ? (\r\n            <Badge variant=\"ghost\" className={cn(\"px-6 py-3 rounded-2xl border font-black text-[10px] tracking-widest uppercase shadow-sm\", getStageColor(activeWorkflow.currentStage))}>\r\n              <Pulse weight=\"fill\" className=\"w-3 h-3 mr-2 animate-pulse\" />\r\n              Active Cycle: {activeWorkflow.currentStage.replace('_', ' ')}\r\n            </Badge>\r\n          ) : (\r\n            <Button \r\n              className=\"gap-3 shadow-premium px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest\"\r\n              onClick={handleStartNewJourney}\r\n              disabled={startingJourney}\r\n            >\r\n              {startingJourney ? (\r\n                <>\r\n                  <SpinnerGap className=\"w-4 h-4 animate-spin\" />\r\n                  Initializing...\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <Plus weight=\"bold\" className=\"w-4 h-4\" />\r\n                  Initialize Journey\r\n                </>\r\n              )}\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 xl:grid-cols-4 gap-8\">\r\n        {/* Left Column: Intelligence Card */}\r\n        <div className=\"xl:col-span-1 space-y-8\">\r\n          <Card className=\"p-8 rounded-[40px] border-border shadow-premium relative overflow-hidden group\">\r\n            <div className=\"absolute -top-12 -left-12 w-48 h-48 bg-primary/10 blur-[60px] rounded-full group-hover:bg-primary/20 transition-all duration-700\" />\r\n            <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n              <IdentificationCard className=\"w-32 h-32 text-primary\" />\r\n            </div>\r\n            \r\n            <div className=\"relative z-10 space-y-10\">\r\n              <div className=\"w-24 h-24 rounded-3xl bg-secondary border border-border flex items-center justify-center mx-auto text-4xl font-black text-primary shadow-inner group-hover:scale-105 transition-transform duration-500\">\r\n                {customer.full_name.charAt(0)}\r\n              </div>\r\n\r\n              <div className=\"space-y-6\">\r\n                <div className=\"space-y-1.5\">\r\n                  <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Comm Channel</p>\r\n                  <div className=\"flex items-center gap-3 p-3 bg-secondary/30 rounded-2xl border border-border/50\">\r\n                    <Phone weight=\"duotone\" className=\"w-4 h-4 text-primary/60\" />\r\n                    <span className=\"text-sm font-bold text-foreground\">{customer.phone}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-1.5\">\r\n                  <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.3em] ml-1\">Digital Link</p>\r\n                  <div className=\"flex items-center gap-3 p-3 bg-secondary/30 rounded-2xl border border-border/50\">\r\n                    <EnvelopeSimple weight=\"duotone\" className=\"w-4 h-4 text-primary/60\" />\r\n                    <span className=\"text-sm font-bold text-foreground truncate\">{customer.email || 'NOT_DEFINED'}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"pt-6 border-t border-border/50 space-y-4\">\r\n                  <div className=\"flex justify-between items-center px-1\">\r\n                    <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Sentiment</span>\r\n                    <Badge variant=\"ghost\" className=\"bg-emerald-500/5 border-none text-emerald-500 font-black uppercase text-[9px] px-3\">POSITIVE</Badge>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center px-1\">\r\n                    <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Status</span>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <div className=\"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse shadow-[0_0_8px_rgba(16,185,129,0.6)]\" />\r\n                      <span className=\"text-[10px] font-black text-emerald-500 uppercase tracking-widest\">ACTIVE</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </Card>\r\n\r\n          <Card className=\"p-8 rounded-[40px] border-primary/10 bg-primary/[0.02] space-y-6 group overflow-hidden\">\r\n            <div className=\"absolute top-0 right-0 p-4 opacity-[0.03] group-hover:scale-110 transition-transform\">\r\n              <Sparkle weight=\"fill\" className=\"w-12 h-12 text-primary\" />\r\n            </div>\r\n            <h4 className=\"text-[10px] font-black text-primary uppercase tracking-[0.3em] flex items-center gap-3 relative z-10\">\r\n              <Briefcase weight=\"duotone\" className=\"w-5 h-5\" />\r\n              Action Vault\r\n            </h4>\r\n            <div className=\"space-y-3 relative z-10\">\r\n              <Button variant=\"outline\" className=\"w-full justify-between px-4 py-4 rounded-2xl text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\">\r\n                Edit Profile <CaretRight weight=\"bold\" className=\"w-3 h-3\" />\r\n              </Button>\r\n              <Button variant=\"outline\" className=\"w-full justify-between px-4 py-4 rounded-2xl text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\">\r\n                View Scan History <CaretRight weight=\"bold\" className=\"w-3 h-3\" />\r\n              </Button>\r\n              <Button variant=\"outline\" className=\"w-full justify-between px-4 py-4 rounded-2xl text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\">\r\n                Link Contact Node <CaretRight weight=\"bold\" className=\"w-3 h-3\" />\r\n              </Button>\r\n            </div>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* Main Content Area */}\r\n        <div className=\"xl:col-span-3 space-y-10\">\r\n          {/* Workflow Control Node */}\r\n          <AnimatePresence mode=\"wait\">\r\n            {activeWorkflow && (\r\n              <motion.div \r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                exit={{ opacity: 0, scale: 0.95 }}\r\n              >\r\n                <Card className=\"rounded-[40px] border-primary/20 overflow-hidden shadow-premium\">\r\n                  <CardHeader className=\"p-8 border-b border-border/50 flex flex-row items-center justify-between bg-primary/5\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                      <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\">\r\n                        <ClockCounterClockwise weight=\"duotone\" className=\"w-6 h-6\" />\r\n                      </div>\r\n                      <div>\r\n                        <CardTitle className=\"text-xl font-black uppercase tracking-tight\">Protocol Execution</CardTitle>\r\n                        <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Active Journey Node Control</p>\r\n                      </div>\r\n                    </div>\r\n                    <Badge variant=\"ghost\" className={cn(\"font-black text-[10px] tracking-widest uppercase border-none px-4 py-1.5\", getStageColor(activeWorkflow.currentStage))}>\r\n                      {activeWorkflow.currentStage.replace('_', ' ')}\r\n                    </Badge>\r\n                  </CardHeader>\r\n                  <CardContent className=\"p-8\">\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                      {activeWorkflow.currentStage === 'scanned' && (\r\n                        <Button \r\n                          onClick={() => handleAction('send_proposal')}\r\n                          className=\"group relative h-auto flex flex-col items-start gap-4 p-8 rounded-[32px] bg-secondary/30 border border-border/50 hover:border-primary/40 hover:bg-secondary/50 transition-all overflow-hidden\"\r\n                        >\r\n                          <div className=\"absolute top-0 right-0 p-6 opacity-[0.03] group-hover:scale-110 transition-transform\">\r\n                            <FileText weight=\"fill\" className=\"w-20 h-20 text-primary\" />\r\n                          </div>\r\n                          <div className=\"w-14 h-14 rounded-2xl bg-purple-500/10 flex items-center justify-center text-purple-500 border border-purple-500/20 shadow-sm group-hover:scale-110 transition-transform\">\r\n                            <FileText weight=\"duotone\" className=\"w-7 h-7\" />\r\n                          </div>\r\n                          <div className=\"space-y-1 text-left relative z-10\">\r\n                            <h3 className=\"text-lg font-bold text-foreground uppercase tracking-tight\">Dispatch Proposal</h3>\r\n                            <p className=\"text-xs text-muted-foreground font-medium italic\">Generate and synchronize treatment plan node.</p>\r\n                          </div>\r\n                        </Button>\r\n                      )}\r\n\r\n                      {activeWorkflow.currentStage === 'proposal_sent' && (\r\n                        <Button \r\n                          onClick={() => handleAction('confirm_payment')}\r\n                          className=\"group relative h-auto flex flex-col items-start gap-4 p-8 rounded-[32px] bg-secondary/30 border border-border/50 hover:border-emerald-500/40 hover:bg-secondary/50 transition-all overflow-hidden\"\r\n                        >\r\n                          <div className=\"absolute top-0 right-0 p-6 opacity-[0.03] group-hover:scale-110 transition-transform\">\r\n                            <CreditCard weight=\"fill\" className=\"w-20 h-20 text-emerald-500\" />\r\n                          </div>\r\n                          <div className=\"w-14 h-14 rounded-2xl bg-emerald-500/10 flex items-center justify-center text-emerald-500 border border-emerald-500/20 shadow-sm group-hover:scale-110 transition-transform\">\r\n                            <CreditCard weight=\"duotone\" className=\"w-7 h-7\" />\r\n                          </div>\r\n                          <div className=\"space-y-1 text-left relative z-10\">\r\n                            <h3 className=\"text-lg font-bold text-foreground uppercase tracking-tight\">Confirm Settlement</h3>\r\n                            <p className=\"text-xs text-muted-foreground font-medium italic\">Execute fiscal node validation and proceed.</p>\r\n                          </div>\r\n                        </Button>\r\n                      )}\r\n\r\n                      {activeWorkflow.currentStage === 'payment_confirmed' && (\r\n                        <Button \r\n                          onClick={openSchedule}\r\n                          className=\"group relative h-auto flex flex-col items-start gap-4 p-8 rounded-[32px] bg-secondary/30 border border-border/50 hover:border-orange-500/40 hover:bg-secondary/50 transition-all overflow-hidden\"\r\n                        >\r\n                          <div className=\"absolute top-0 right-0 p-6 opacity-[0.03] group-hover:scale-110 transition-transform\">\r\n                            <CalendarDots weight=\"fill\" className=\"w-20 h-20 text-orange-500\" />\r\n                          </div>\r\n                          <div className=\"w-14 h-14 rounded-2xl bg-orange-500/10 flex items-center justify-center text-orange-500 border border-orange-500/20 shadow-sm group-hover:scale-110 transition-transform\">\r\n                            <CalendarDots weight=\"duotone\" className=\"w-7 h-7\" />\r\n                          </div>\r\n                          <div className=\"space-y-1 text-left relative z-10\">\r\n                            <h3 className=\"text-lg font-bold text-foreground uppercase tracking-tight\">Sync Scheduling</h3>\r\n                            <p className=\"text-xs text-muted-foreground font-medium italic\">Assign practitioner node and temporal slot.</p>\r\n                          </div>\r\n                        </Button>\r\n                      )}\r\n\r\n                      {['treatment_scheduled', 'in_treatment'].includes(activeWorkflow.currentStage) && (\r\n                        <div className=\"col-span-full p-10 bg-primary/5 border border-primary/20 rounded-[40px] text-center space-y-6 relative overflow-hidden group\">\r\n                          <div className=\"absolute inset-0 bg-scanner-grid opacity-10 group-hover:opacity-20 transition-opacity\" />\r\n                          <div className=\"relative z-10 space-y-4\">\r\n                            <div className=\"w-20 h-20 rounded-full border-4 border-primary/20 border-t-primary flex items-center justify-center mx-auto shadow-glow-sm\">\r\n                              <Scissors weight=\"duotone\" className=\"w-10 h-10 text-primary animate-pulse\" />\r\n                            </div>\r\n                            <div className=\"space-y-1\">\r\n                              <h3 className=\"text-2xl font-black text-foreground uppercase tracking-tight\">Treatment Phase Active</h3>\r\n                              <p className=\"text-sm text-primary font-bold uppercase tracking-widest italic\">Handled by Clinical Practitioner Cluster</p>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n\r\n                      {activeWorkflow.currentStage === 'treatment_completed' && (\r\n                        <Button \r\n                          onClick={() => handleAction('send_follow_up')}\r\n                          className=\"group relative h-auto flex flex-col items-start gap-4 p-8 rounded-[32px] bg-secondary/30 border border-border/50 hover:border-yellow-500/40 hover:bg-secondary/50 transition-all overflow-hidden\"\r\n                        >\r\n                          <div className=\"absolute top-0 right-0 p-6 opacity-[0.03] group-hover:scale-110 transition-transform\">\r\n                            <ChatCircle weight=\"fill\" className=\"w-20 h-20 text-yellow-500\" />\r\n                          </div>\r\n                          <div className=\"w-14 h-14 rounded-2xl bg-yellow-500/10 flex items-center justify-center text-yellow-500 border border-yellow-500/20 shadow-sm group-hover:scale-110 transition-transform\">\r\n                            <ChatCircle weight=\"duotone\" className=\"w-7 h-7\" />\r\n                          </div>\r\n                          <div className=\"space-y-1 text-left relative z-10\">\r\n                            <h3 className=\"text-lg font-bold text-foreground uppercase tracking-tight\">Initialize Aftercare</h3>\r\n                            <p className=\"text-xs text-muted-foreground font-medium italic\">Check delta satisfaction and post-protocol link.</p>\r\n                          </div>\r\n                        </Button>\r\n                      )}\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </motion.div>\r\n            )}\r\n          </AnimatePresence>\r\n\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-10\">\r\n            {/* Timeline View */}\r\n            <Card className=\"rounded-[40px] border-border/50 overflow-hidden flex flex-col\">\r\n              <CardHeader className=\"p-8 border-b border-border/50 flex flex-row items-center justify-between\">\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div className=\"w-12 h-12 rounded-2xl bg-secondary border border-border flex items-center justify-center text-primary shadow-inner\">\r\n                    <History weight=\"duotone\" className=\"w-6 h-6\" />\r\n                  </div>\r\n                  <div>\r\n                    <CardTitle className=\"text-lg font-black uppercase tracking-tight\">Identity Timeline</CardTitle>\r\n                    <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Chronological Event Registry</p>\r\n                  </div>\r\n                </div>\r\n              </CardHeader>\r\n              <CardContent className=\"p-8 flex-1\">\r\n                {intelligence?.timeline ? (\r\n                  <CustomerTimelineView events={intelligence.timeline} />\r\n                ) : (\r\n                  <div className=\"h-full flex flex-col items-center justify-center text-center opacity-20 py-20 space-y-4\">\r\n                    <div className=\"w-16 h-16 border-2 border-dashed border-border rounded-3xl flex items-center justify-center\">\r\n                      <History weight=\"bold\" className=\"w-6 h-6\" />\r\n                    </div>\r\n                    <p className=\"text-[10px] font-black uppercase tracking-widest\">No Temporal Data</p>\r\n                  </div>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Predictive Intelligence */}\r\n            <Card className=\"rounded-[40px] border-border/50 overflow-hidden flex flex-col\">\r\n              <CardHeader className=\"p-8 border-b border-border/50 flex flex-row items-center justify-between\">\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div className=\"w-12 h-12 rounded-2xl bg-purple-500/10 flex items-center justify-center text-purple-500 border border-purple-500/20 shadow-inner\">\r\n                    <TrendUp weight=\"duotone\" className=\"w-6 h-6\" />\r\n                  </div>\r\n                  <div>\r\n                    <CardTitle className=\"text-lg font-black uppercase tracking-tight\">AI Cognitive Matrix</CardTitle>\r\n                    <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\">Predictive Conversion Trajectory</p>\r\n                  </div>\r\n                </div>\r\n              </CardHeader>\r\n              <CardContent className=\"p-8 flex-1\">\r\n                {intelligence?.analytics ? (\r\n                  <PredictiveAnalyticsView data={intelligence.analytics} />\r\n                ) : (\r\n                  <div className=\"h-full flex flex-col items-center justify-center text-center opacity-20 py-20 space-y-4\">\r\n                    <div className=\"w-16 h-16 border-2 border-dashed border-border rounded-3xl flex items-center justify-center\">\r\n                      <Sparkle weight=\"bold\" className=\"w-6 h-6\" />\r\n                    </div>\r\n                    <p className=\"text-[10px] font-black uppercase tracking-widest\">No Intelligence Data</p>\r\n                  </div>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Scheduling Modal Overhaul */}\r\n      <AnimatePresence>\r\n        {scheduleOpen && (\r\n          <div className=\"fixed inset-0 z-[300] flex items-center justify-center p-4 overflow-y-auto\">\r\n            <motion.div\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              exit={{ opacity: 0 }}\r\n              className=\"absolute inset-0 bg-black/60 backdrop-blur-sm\"\r\n              onClick={() => setScheduleOpen(false)}\r\n            />\r\n            \r\n            <motion.div\r\n              initial={{ scale: 0.95, opacity: 0, y: 20 }}\r\n              animate={{ scale: 1, opacity: 1, y: 0 }}\r\n              exit={{ scale: 0.95, opacity: 0, y: 20 }}\r\n              className=\"relative w-full max-w-lg bg-card border border-border rounded-[40px] overflow-hidden shadow-premium group p-10\"\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                <CalendarDots weight=\"fill\" className=\"w-64 h-64 text-primary\" />\r\n              </div>\r\n\r\n              <div className=\"relative z-10 space-y-10\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"flex items-center gap-5\">\r\n                    <div className=\"w-16 h-16 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\r\n                      <CalendarDots weight=\"duotone\" className=\"w-8 h-8\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-2xl font-bold text-foreground tracking-tight uppercase\">Temporal Sync</h3>\r\n                      <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest mt-1\">Assign Practitioner Node</p>\r\n                    </div>\r\n                  </div>\r\n                  <Button variant=\"ghost\" size=\"sm\" onClick={() => setScheduleOpen(false)} className=\"h-10 w-10 p-0 rounded-xl hover:bg-secondary\">\r\n                    <X weight=\"bold\" className=\"w-5 h-5\" />\r\n                  </Button>\r\n                </div>\r\n\r\n                <div className=\"space-y-6\">\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Practitioner Node</label>\r\n                    <div className=\"relative\">\r\n                      <select\r\n                        className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all appearance-none font-bold\"\r\n                        value={selectedBeauticianId}\r\n                        onChange={(e) => setSelectedBeauticianId(e.target.value)}\r\n                        disabled={staffLoading}\r\n                      >\r\n                        <option value=\"\">Select Practitioner...</option>\r\n                        {beauticians.map((b) => (\r\n                          <option key={b.id} value={b.id}>{b.name}</option>\r\n                        ))}\r\n                      </select>\r\n                      <CaretRight weight=\"bold\" className=\"absolute right-5 top-1/2 -translate-y-1/2 w-4 h-4 rotate-90 text-muted-foreground pointer-events-none\" />\r\n                    </div>\r\n                    {staffLoading && (\r\n                      <p className=\"text-[10px] text-primary font-black uppercase tracking-widest animate-pulse ml-1\">Accessing Personnel Matrix...</p>\r\n                    )}\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-2 gap-6\">\r\n                    <div className=\"space-y-2\">\r\n                      <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Temporal Date</label>\r\n                      <input\r\n                        type=\"date\"\r\n                        className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold tabular-nums\"\r\n                        value={appointmentDate}\r\n                        onChange={(e) => setAppointmentDate(e.target.value)}\r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Temporal Time</label>\r\n                      <input\r\n                        type=\"time\"\r\n                        className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 px-6 text-sm text-foreground focus:border-primary outline-none transition-all font-bold tabular-nums\"\r\n                        value={appointmentTime}\r\n                        onChange={(e) => setAppointmentTime(e.target.value)}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex gap-4 pt-4\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={() => setScheduleOpen(false)}\r\n                    className=\"flex-1 py-6 rounded-[24px] text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary\"\r\n                  >\r\n                    Abort Sync\r\n                  </Button>\r\n                  <Button\r\n                    onClick={submitSchedule}\r\n                    className=\"flex-[2] py-6 rounded-[24px] text-[10px] font-black uppercase tracking-widest shadow-premium gap-3\"\r\n                  >\r\n                    <CheckCircle weight=\"bold\" className=\"w-4 h-4\" />\r\n                    Commit Protocol\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </motion.div>\r\n          </div>\r\n        )}\r\n      </AnimatePresence>\r\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\sales\\customers\\create\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Invalid character.","line":74,"column":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState } from 'react';\nimport { useRouter } from '@/i18n/routing';\nimport { \n  EnvelopeSimple, \n  Lock, \n  User, \n  Phone, \n  Eye, \n  EyeSlash, \n  ArrowLeft, \n  Users, \n  ShieldCheck,\n  UserPlus,\n  CheckCircle,\n  WarningCircle,\n  Pulse,\n  Monitor,\n  IdentificationCard\n} from '@phosphor-icons/react';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/Badge';\nimport { cn } from '@/lib/utils';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function CreateCustomerPage() {\n  const [formData, setFormData] = useState({\n    email: '',\n    password: '',\n    confirmPassword: '',\n    fullName: '',\n    phone: ''\n  });\n  const [showPassword, setShowPassword] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState('');\n  const router = useRouter();\n  const { goBack } = useBackNavigation();\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError('');\n    setSuccess('');\n    setLoading(true);\n\n    if (formData.password !== formData.confirmPassword) {\n      setError('Passwords do not match node verification.');\n      setLoading(false);\n      return;\n    }\n\n    try {\n      const response = await fetch('/api/sales/customers', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          email: formData.email,\n          password: formData.password,\n          fullName: formData.fullName,\n          phone: formData.phone,\n        }),\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        setSuccess(\\Identity node \\ established successfully!\\);\n        setFormData({\n          email: '',\n          password: '',\n          confirmPassword: '',\n          fullName: '',\n          phone: ''\n        });\n      } else {\n        setError(data.error || 'Failed to establish identity node.');\n      }\n    } catch (error) {\n      setError('Neural link error. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"space-y-8 pb-20 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header Section */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <UserPlus weight=\"duotone\" className=\"w-4 h-4\" />\n            Identity Acquisition Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n          >\n            Register <span className=\"text-primary\">Identity</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            Initializing new clinical identity registry and secure access credentials.\n          </motion.p>\n        </div>\n\n        <motion.div \n          initial={{ opacity: 0, scale: 0.9 }}\n          animate={{ opacity: 1, scale: 1 }}\n          transition={{ delay: 0.3 }}\n        >\n          <Button \n            variant=\"outline\"\n            onClick={() => goBack('/sales/customers')}\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary\"\n          >\n            <ArrowLeft weight=\"bold\" className=\"w-4 h-4\" />\n            Abort Registry\n          </Button>\n        </motion.div>\n      </div>\n\n      <div className=\"max-w-3xl mx-auto px-2\">\n        {/* Warning Protocol Node */}\n        <Card className=\"bg-amber-500/5 border border-amber-500/20 rounded-[32px] p-6 mb-8 relative overflow-hidden group\">\n          <div className=\"absolute top-0 right-0 p-6 opacity-[0.03] group-hover:scale-110 transition-transform duration-700\">\n            <ShieldCheck weight=\"fill\" className=\"w-24 h-24 text-amber-500\" />\n          </div>\n          <div className=\"flex gap-5 relative z-10\">\n            <div className=\"w-12 h-12 rounded-2xl bg-amber-500/10 flex items-center justify-center text-amber-500 border border-amber-500/20 shadow-sm\">\n              <ShieldCheck weight=\"duotone\" className=\"w-6 h-6\" />\n            </div>\n            <div>\n              <p className=\"text-[10px] font-black text-amber-600 uppercase tracking-widest mb-1\">Privacy Protocol Alpha</p>\n              <p className=\"text-sm text-muted-foreground font-medium leading-relaxed italic\">\n                Identity nodes established under your supervision are encrypted and isolated. No other sales units can access this biometric data.\n              </p>\n            </div>\n          </div>\n        </Card>\n\n        {/* Registry Form Hub */}\n        <Card className=\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\">\n          <CardHeader className=\"p-8 md:p-10 border-b border-border/50 bg-secondary/30 relative\">\n            <div className=\"absolute top-0 right-0 p-10 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\n              <IdentificationCard weight=\"fill\" className=\"w-48 h-48 text-primary\" />\n            </div>\n            <div className=\"flex items-center gap-5 relative z-10\">\n              <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-sm\">\n                <UserPlus weight=\"duotone\" className=\"w-7 h-7\" />\n              </div>\n              <div>\n                <CardTitle className=\"text-2xl font-black uppercase tracking-tight\">Node Configuration</CardTitle>\n                <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] mt-1\">Establishing neural identity links</p>\n              </div>\n            </div>\n          </CardHeader>\n\n          <CardContent className=\"p-8 md:p-12 relative z-10\">\n            <form onSubmit={handleSubmit} className=\"space-y-10\">\n              <AnimatePresence mode=\"wait\">\n                {error && (\n                  <motion.div \n                    initial={{ opacity: 0, y: -10 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    exit={{ opacity: 0 }}\n                    className=\"p-4 bg-rose-500/10 border border-rose-500/20 rounded-2xl flex items-center gap-3\"\n                  >\n                    <WarningCircle weight=\"fill\" className=\"w-5 h-5 text-rose-500\" />\n                    <p className=\"text-rose-500 text-xs font-black uppercase tracking-widest\">Protocol Exception: {error}</p>\n                  </motion.div>\n                )}\n\n                {success && (\n                  <motion.div \n                    initial={{ opacity: 0, y: -10 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    exit={{ opacity: 0 }}\n                    className=\"p-4 bg-emerald-500/10 border border-emerald-500/20 rounded-2xl flex items-center gap-3\"\n                  >\n                    <CheckCircle weight=\"fill\" className=\"w-5 h-5 text-emerald-500\" />\n                    <p className=\"text-emerald-500 text-xs font-black uppercase tracking-widest\">{success}</p>\n                  </motion.div>\n                )}\n              </AnimatePresence>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n                {/* Full Name */}\n                <div className=\"space-y-3\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Identity Designation *</label>\n                  <div className=\"relative group/input\">\n                    <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\n                    <User weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\n                    <input\n                      type=\"text\"\n                      required\n                      value={formData.fullName}\n                      onChange={(e) => setFormData({ ...formData, fullName: e.target.value })}\n                      className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary outline-none transition-all font-bold shadow-inner relative z-10\"\n                      placeholder=\"Clinical Name\"\n                    />\n                  </div>\n                </div>\n\n                {/* Phone */}\n                <div className=\"space-y-3\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Communication Channel</label>\n                  <div className=\"relative group/input\">\n                    <Phone weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\n                    <input\n                      type=\"tel\"\n                      value={formData.phone}\n                      onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\n                      className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary outline-none transition-all font-bold tabular-nums shadow-inner relative z-10\"\n                      placeholder=\"081-234-5678\"\n                    />\n                  </div>\n                </div>\n              </div>\n\n              {/* Email */}\n              <div className=\"space-y-3\">\n                <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Digital Mail Registry *</label>\n                <div className=\"relative group/input\">\n                  <EnvelopeSimple weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\n                  <input\n                    type=\"email\"\n                    required\n                    value={formData.email}\n                    onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                    className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary outline-none transition-all font-medium italic shadow-inner relative z-10\"\n                    placeholder=\"customer@network.com\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n                {/* Password */}\n                <div className=\"space-y-3\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Access Cipher *</label>\n                  <div className=\"relative group/input\">\n                    <Lock weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\n                    <input\n                      type={showPassword ? 'text' : 'password'}\n                      required\n                      value={formData.password}\n                      onChange={(e) => setFormData({ ...formData, password: e.target.value })}\n                      className=\"w-full pl-12 pr-12 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary outline-none transition-all font-bold shadow-inner relative z-10\"\n                      placeholder=\"Min. 8 nodes\"\n                      minLength={8}\n                    />\n                    <button\n                      type=\"button\"\n                      onClick={() => setShowPassword(!showPassword)}\n                      className=\"absolute right-4 top-1/2 -translate-y-1/2 p-2 hover:text-primary text-muted-foreground/40 transition-all z-20\"\n                    >\n                      {showPassword ? <EyeSlash weight=\"bold\" className=\"w-5 h-5\" /> : <Eye weight=\"bold\" className=\"w-5 h-5\" />}\n                    </button>\n                  </div>\n                </div>\n\n                {/* Confirm Password */}\n                <div className=\"space-y-3\">\n                  <label className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.2em] ml-1\">Cipher Verification *</label>\n                  <div className=\"relative group/input\">\n                    <Lock weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors relative z-10\" />\n                    <input\n                      type={showPassword ? 'text' : 'password'}\n                      required\n                      value={formData.confirmPassword}\n                      onChange={(e) => setFormData({ ...formData, confirmPassword: e.target.value })}\n                      className=\"w-full pl-12 pr-4 py-4 bg-secondary/30 border border-border rounded-2xl text-foreground focus:outline-none focus:border-primary outline-none transition-all font-bold shadow-inner relative z-10\"\n                      placeholder=\"Confirm cipher\"\n                      minLength={8}\n                    />\n                  </div>\n                </div>\n              </div>\n\n              {/* Submit Button Hub */}\n              <div className=\"pt-6 border-t border-border/30\">\n                <Button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"w-full py-7 rounded-[24px] font-black uppercase tracking-widest text-[11px] shadow-premium gap-3 relative overflow-hidden group/btn\"\n                >\n                  <div className=\"absolute inset-0 bg-white/20 -translate-x-full group-hover/btn:translate-x-full transition-transform duration-1000\" />\n                  {loading ? (\n                    <SpinnerGap weight=\"bold\" className=\"w-5 h-5 animate-spin\" />\n                  ) : (\n                    <UserPlus weight=\"bold\" className=\"w-5 h-5 group-hover/btn:scale-110 transition-transform\" />\n                  )}\n                  {loading ? 'SYNCHRONIZING...' : 'INITIALIZE IDENTITY NODE'}\n                </Button>\n              </div>\n            </form>\n          </CardContent>\n        </Card>\n\n        {/* Security Matrix Footer */}\n        <div className=\"mt-12 pt-8 border-t border-border/30 flex flex-col items-center gap-5 opacity-40 grayscale group-hover:grayscale-0 transition-all duration-700\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-2 h-2 bg-emerald-500 rounded-full animate-pulse shadow-[0_0_8px_rgba(16,185,129,0.6)]\" />\n            <span className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.4em]\">Encrypted Registry Active</span>\n          </div>\n          <div className=\"flex items-center gap-6\">\n            <ShieldCheck weight=\"duotone\" className=\"w-6 h-6\" />\n            <div className=\"h-4 w-px bg-border\" />\n            <IdentificationCard weight=\"duotone\" className=\"w-6 h-6\" />\n            <div className=\"h-4 w-px bg-border\" />\n            <Pulse weight=\"duotone\" className=\"w-6 h-6\" />\n          </div>\n          <p className=\"text-[9px] font-black text-muted-foreground uppercase tracking-[0.5em]\">ISO 27001 SECURED IDENTITY NODE</p>\n        </div>\n      </div>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\sales\\customers\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Declaration or statement expected.","line":268,"column":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { \r\n  Users, \r\n  Plus, \r\n  MagnifyingGlass, \r\n  EnvelopeSimple, \r\n  CalendarDots, \r\n  DotsThreeVertical, \r\n  SpinnerGap, \r\n  UserPlus, \r\n  Target,\r\n  ArrowLeft,\r\n  CaretRight,\r\n  IdentificationCard,\r\n  UserCheck,\r\n  ArrowsClockwise\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { useTranslations } from 'next-intl';\r\nimport { useState, useEffect } from 'react';\nimport { cn } from '@/lib/utils';\r\nimport { Link } from '@/i18n/routing';\r\n\r\ninterface Customer {\r\n  customer_id: string;\r\n  assigned_at: string;\r\n  is_active: boolean;\r\n  users: {\r\n    id: string;\r\n    email: string;\r\n    full_name: string;\r\n    created_at: string;\r\n  };\r\n}\r\n\r\nexport default function CustomersPage() {\r\n  const { goBack } = useBackNavigation();\r\n  const t = useTranslations('sales.customers' as any);\r\n  const [customers, setCustomers] = useState<Customer[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [error, setError] = useState('');\r\n\r\n  useEffect(() => {\r\n    fetchCustomers();\r\n  }, []);\r\n\r\n  const fetchCustomers = async () => {\r\n    try {\r\n      const response = await fetch('/api/sales/customers');\r\n      const data = await response.json();\r\n\r\n      if (response.ok) {\r\n        setCustomers(data.customers || []);\r\n      } else {\r\n        setError(data.error || 'Failed to fetch customers');\r\n      }\r\n    } catch (error) {\r\n      setError('Something went wrong');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const filteredCustomers = customers.filter(customer =>\r\n    customer.users?.full_name?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    customer.users?.email?.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <Target weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Sales Intel Node\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight\"\r\n          >\r\n            My <span className=\"text-primary\">Customers</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating active client identities and clinical conversion trajectories.\r\n          </motion.p>\r\n        </div>\r\n        <Link href=\"/sales/customers/create\">\r\n          <Button className=\"gap-3 shadow-premium px-8 py-6 rounded-2xl\">\r\n            <UserPlus weight=\"bold\" className=\"w-4 h-4\" />\r\n            <span>Initialize New Identity</span>\r\n          </Button>\r\n        </Link>\r\n      </div>\r\n\r\n      {/* Search & Stats */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-8\">\r\n        <div className=\"lg:col-span-3\">\r\n          <div className=\"relative group\">\r\n            <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-2xl\" />\r\n            <MagnifyingGlass className=\"absolute left-5 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\r\n            <input \r\n              type=\"text\" \r\n              placeholder=\"Query identity name, email, or digital link...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              className=\"w-full bg-secondary/50 border border-border rounded-2xl py-4 pl-14 pr-6 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\r\n            />\r\n          </div>\r\n        </div>\r\n        \r\n        <StatCard\r\n          title=\"Active Registry\"\r\n          value={customers.length}\r\n          icon={UserCheck}\r\n          trend=\"up\"\r\n          change={2}\r\n          className=\"p-4\"\r\n        />\r\n      </div>\r\n\r\n      {/* Error */}\r\n      <AnimatePresence>\r\n        {error && (\r\n          <motion.div \r\n            initial={{ opacity: 0, y: -10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"p-4 bg-destructive/10 border border-destructive/20 rounded-2xl flex items-center gap-3\"\r\n          >\r\n            <Badge variant=\"destructive\" size=\"sm\">SYSTEM EXCEPTION</Badge>\r\n            <p className=\"text-destructive text-xs font-bold\">{error}</p>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Customers List */}\r\n      <div className=\"space-y-6\">\r\n        {loading ? (\r\n          <div className=\"py-32 flex flex-col items-center justify-center gap-4\">\r\n            <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest text-center\">Accessing Identity Matrix...</p>\r\n          </div>\r\n        ) : filteredCustomers.length === 0 ? (\r\n          <Card variant=\"ghost\" className=\"py-32 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-6 opacity-40\">\r\n            <div className=\"w-20 h-20 rounded-[40px] bg-secondary border border-border flex items-center justify-center text-muted-foreground\">\r\n              <Users weight=\"duotone\" className=\"w-10 h-10\" />\r\n            </div>\r\n            <div className=\"text-center space-y-2\">\r\n              <h3 className=\"text-xl font-black text-foreground uppercase tracking-widest\">\r\n                {searchTerm ? 'Zero Matches Detected' : 'Registry Nominal'}\r\n              </h3>\r\n              <p className=\"text-sm text-muted-foreground font-medium italic\">\r\n                {searchTerm ? 'Adjust query parameters to expand search horizon.' : 'No clinical identities established in your sector.'}\r\n              </p>\r\n            </div>\r\n            {!searchTerm && (\r\n              <Link href=\"/sales/customers/create\">\r\n                <Button variant=\"ghost\" className=\"text-primary font-black uppercase tracking-[0.2em] gap-2\">\r\n                  <Plus weight=\"bold\" className=\"w-4 h-4\" />\r\n                  Initialize First Node\r\n                </Button>\r\n              </Link>\r\n            )}\r\n          </Card>\r\n        ) : (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8\">\r\n            <AnimatePresence mode=\"popLayout\">\r\n              {filteredCustomers.map((customer, i) => (\r\n                <motion.div\r\n                  key={customer.customer_id}\r\n                  layout\r\n                  initial={{ opacity: 0, scale: 0.95, y: 20 }}\r\n                  animate={{ opacity: 1, scale: 1, y: 0 }}\r\n                  exit={{ opacity: 0, scale: 0.95 }}\r\n                  transition={{ delay: i * 0.05 }}\r\n                >\r\n                  <Card className=\"h-full border-border/50 hover:border-primary/30 transition-all group overflow-hidden flex flex-col\">\r\n                    <div className=\"absolute top-0 right-0 p-8 opacity-[0.03] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                      <IdentificationCard className=\"w-32 h-32 text-primary\" />\r\n                    </div>\r\n\r\n                    <CardHeader className=\"pb-4 relative z-10\">\r\n                      <div className=\"flex justify-between items-start gap-4\">\r\n                        <div className=\"w-16 h-16 rounded-2xl bg-secondary/50 border border-border flex items-center justify-center text-primary group-hover:bg-primary/10 transition-all duration-500 shadow-inner text-2xl font-black\">\r\n                          {customer.users?.full_name?.charAt(0)?.toUpperCase() || '?'}\r\n                        </div>\r\n                        <div className=\"flex gap-1\">\r\n                          <Button \r\n                            variant=\"ghost\" \r\n                            size=\"sm\" \r\n                            className=\"p-2 h-9 w-9 text-muted-foreground hover:text-foreground\"\r\n                          >\r\n                            <DotsThreeVertical weight=\"bold\" className=\"w-5 h-5\" />\r\n                          </Button>\r\n                        </div>\r\n                      </div>\r\n                    </CardHeader>\r\n\r\n                    <CardContent className=\"flex-1 space-y-6 relative z-10 flex flex-col justify-between\">\r\n                      <div className=\"space-y-4\">\r\n                        <div>\r\n                          <div className=\"flex items-center gap-2 mb-2\">\r\n                            <Badge variant={customer.is_active ? 'success' : 'secondary'} size=\"sm\" className=\"font-black uppercase text-[8px] tracking-widest px-2\">\r\n                              {customer.is_active ? 'OPERATIONAL' : 'INACTIVE'}\r\n                            </Badge>\r\n                            <Badge variant=\"ghost\" size=\"sm\" className=\"font-mono text-[9px] px-2 py-0.5 border-none bg-primary/5 text-primary tracking-widest\">NODE-{customer.customer_id.substring(0, 4)}</Badge>\r\n                          </div>\r\n                          <h3 className=\"text-xl font-bold text-foreground tracking-tight truncate uppercase\">\r\n                            {customer.users?.full_name || 'Anonymous Node'}\r\n                          </h3>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-3\">\r\n                          <div className=\"flex items-center gap-3 p-3 bg-secondary/30 rounded-2xl border border-border/50 group-hover:border-primary/20 transition-all\">\r\n                            <EnvelopeSimple weight=\"duotone\" className=\"w-4 h-4 text-primary/60 shrink-0\" />\r\n                            <p className=\"text-xs text-foreground/70 font-medium truncate italic\">{customer.users?.email}</p>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"pt-6 border-t border-border/50 flex items-center justify-between\">\r\n                        <div className=\"flex items-center gap-2 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\r\n                          <CalendarDots weight=\"bold\" className=\"w-3.5 h-3.5 opacity-60\" />\r\n                          Link established: {new Date(customer.assigned_at).toLocaleDateString()}\r\n                        </div>\r\n                        <Link href={`/sales/customers/${customer.customer_id}`}>\r\n                          <Button variant=\"ghost\" size=\"sm\" className=\"text-primary font-black uppercase text-[10px] tracking-widest gap-2\">\r\n                            View Intel <CaretRight weight=\"bold\" className=\"w-3 h-3\" />\r\n                          </Button>\r\n                        </Link>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                </motion.div>\r\n              ))}\r\n            </AnimatePresence>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\sales\\leads\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[201,216],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[216,230],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Briefcase"},"fix":{"range":[230,244],"text":""},"desc":"Remove unused variable \"Briefcase\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Monitor' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Monitor"},"fix":{"range":[244,256],"text":""},"desc":"Remove unused variable \"Monitor\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationBadge' is defined but never used.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":22,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationBadge"},"fix":{"range":[304,328],"text":""},"desc":"Remove unused variable \"IdentificationBadge\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":25,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[439,451],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":25,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[451,462],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardContent' is defined but never used.","line":25,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":50,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardContent"},"fix":{"range":[462,475],"text":""},"desc":"Remove unused variable \"CardContent\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":111,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":111,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'t' is assigned a value but never used.","line":112,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":112,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":112,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":112,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2238,2241],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2238,2241],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'SpinnerGap' is not defined.","line":407,"column":16,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":407,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'colIdx' is defined but never used.","line":412,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":412,"endColumn":43}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nimport { \r\n  Plus, \r\n  MagnifyingGlass, \r\n  DotsThree, \r\n  Clock,\r\n  Sparkle,\r\n  Target,\r\n  SquaresFour,\r\n  List as ListIcon,\r\n  CaretRight,\r\n  ArrowLeft,\r\n  Briefcase,\r\n  Monitor,\r\n  Lightning,\r\n  Funnel,\r\n  IdentificationCard,\r\n  IdentificationBadge,\r\n  Icon\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { useTranslations } from 'next-intl';\r\nimport { cn } from '@/lib/utils';\r\nimport { useState, useEffect, useMemo } from 'react';\r\nimport { Link } from '@/i18n/routing';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nimport { createClient } from '@/lib/supabase/client';\r\n\r\nimport { useState, useEffect, useMemo } from 'react';\r\n\r\nimport { Link } from '@/i18n/routing';\r\n\r\nimport {\r\n\r\n  DndContext,\r\n\r\n  DragEndEvent,\r\n\r\n  DragOverlay,\r\n\r\n  DragStartEvent,\r\n\r\n  PointerSensor,\r\n\r\n  useSensor,\r\n\r\n  useSensors,\r\n\r\n  closestCorners\r\n\r\n} from '@dnd-kit/core';\r\n\r\nimport { SortableContext, verticalListSortingStrategy } from '@dnd-kit/sortable';\r\n\r\nimport { useSortable } from '@dnd-kit/sortable';\r\n\r\nimport { CSS } from '@dnd-kit/utilities';\r\n\r\nimport { useLeadStatusRealtime } from '@/hooks/useHotLeadsRealtime';\r\n\r\nimport { useSalesLeads, useUpdateLeadStatus } from '@/hooks/useSalesLeads';\r\n\r\nimport InfiniteLeadsList from '@/components/sales/InfiniteLeadsList';\r\n\r\n\r\n\r\ninterface Lead {\r\n\r\n  id: string;\r\n\r\n  name: string;\r\n\r\n  email: string;\r\n\r\n  status: string;\r\n\r\n  score: number;\r\n\r\n  created_at: string;\r\n\r\n  clinic_id: string;\r\n\r\n}\r\n\r\n\r\n\r\nconst COLUMNS = [\r\n\r\n  { id: 'new', title: 'New Leads' },\r\n\r\n  { id: 'contacted', title: 'Contacted' },\r\n\r\n  { id: 'qualified', title: 'Qualified' },\r\n\r\n  { id: 'proposal_sent', title: 'Proposal Sent' },\r\n\r\n];\r\n\r\n\r\n\r\nexport default function LeadsKanbanPage() {\r\n  const { goBack } = useBackNavigation();\r\n  const t = useTranslations('sales.leads' as any);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [activeId, setActiveId] = useState<string | null>(null);\r\n  const [clinicId, setClinicId] = useState<string>('');\r\n  const [viewMode, setViewMode] = useState<'kanban' | 'list'>('kanban');\r\n\r\n  const supabase = useMemo(() => createClient(), []);\r\n\r\n  \r\n\r\n  // Get clinic ID from user\r\n\r\n  useEffect(() => {\r\n\r\n    async function getClinicId() {\r\n\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n\r\n      if (user) {\r\n\r\n        const clinic = user.user_metadata?.clinic_id || '';\r\n\r\n        setClinicId(clinic);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    getClinicId();\r\n\r\n  }, [supabase]);\r\n\r\n  \r\n\r\n  // React Query hooks\r\n\r\n  const { data: leads = [], isLoading: loading } = useSalesLeads(clinicId, { enabled: viewMode === 'kanban' });\r\n\r\n  const updateLeadStatus = useUpdateLeadStatus();\r\n\r\n  \r\n\r\n  const sensors = useSensors(\r\n\r\n    useSensor(PointerSensor, {\r\n\r\n      activationConstraint: {\r\n\r\n        distance: 8,\r\n\r\n      },\r\n\r\n    })\r\n\r\n  );\r\n\r\n\r\n\r\n  // Real-time status updates (still needed for cross-tab sync)\r\n\r\n  useLeadStatusRealtime(() => {\r\n\r\n    // React Query will auto-refetch on window focus\r\n\r\n    // No manual state update needed\r\n\r\n  });\r\n\r\n\r\n\r\n  const getLeadsByStatus = (status: string) => {\r\n\r\n    return leads.filter(l => \r\n\r\n      l.status === status && \r\n\r\n      (l.name?.toLowerCase().includes(searchTerm.toLowerCase()) || \r\n\r\n       l.email?.toLowerCase().includes(searchTerm.toLowerCase()))\r\n\r\n    );\r\n\r\n  };\r\n\r\n\r\n\r\n  const handleDragStart = (event: DragStartEvent) => {\r\n\r\n    setActiveId(event.active.id as string);\r\n\r\n  };\r\n\r\n\r\n\r\n  const handleDragEnd = async (event: DragEndEvent) => {\r\n\r\n    const { active, over } = event;\r\n\r\n    setActiveId(null);\r\n\r\n    \r\n\r\n    if (!over) return;\r\n\r\n    \r\n\r\n    const leadId = active.id as string;\r\n\r\n    const newStatus = over.id as string;\r\n\r\n    \r\n\r\n    // Check if it's a valid column\r\n\r\n    const validStatuses = COLUMNS.map(c => c.id);\r\n\r\n    if (!validStatuses.includes(newStatus)) return;\r\n\r\n    \r\n\r\n    // Find the lead\r\n\r\n    const lead = leads.find(l => l.id === leadId);\r\n\r\n    if (!lead || lead.status === newStatus) return;\r\n\r\n    \r\n\r\n    // Use React Query mutation (includes optimistic update and error handling)\r\n\r\n    updateLeadStatus.mutate({ leadId, status: newStatus });\r\n\r\n  };\r\n\r\n\r\n\r\n  const activeLead = activeId ? leads.find(l => l.id === activeId) : null;\r\n\r\n\r\n\r\n  return (\r\n    <DndContext\r\n      sensors={sensors}\r\n      collisionDetection={closestCorners}\r\n      onDragStart={handleDragStart}\r\n      onDragEnd={handleDragEnd}\r\n    >\r\n      <motion.div \r\n        initial={{ opacity: 0 }}\r\n        animate={{ opacity: 1 }}\r\n        className=\"space-y-8 pb-20 font-sans\"\r\n      >\r\n        <Breadcrumb />\r\n\r\n        {/* Header Section */}\r\n        <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n          <div className=\"space-y-1\">\r\n            <motion.div \r\n              initial={{ opacity: 0, x: -20 }}\r\n              animate={{ opacity: 1, x: 0 }}\r\n              className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n            >\r\n              <Target weight=\"duotone\" className=\"w-4 h-4\" />\r\n              Acquisition Pipeline Matrix\r\n            </motion.div>\r\n            <motion.h1 \r\n              initial={{ opacity: 0, x: -20 }}\r\n              animate={{ opacity: 1, x: 0 }}\r\n              transition={{ delay: 0.1 }}\r\n              className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n            >\r\n              Leads <span className=\"text-primary\">Registry</span>\r\n            </motion.h1>\r\n            <motion.p \r\n              initial={{ opacity: 0, x: -20 }}\r\n              animate={{ opacity: 1, x: 0 }}\r\n              transition={{ delay: 0.2 }}\r\n              className=\"text-muted-foreground font-light text-sm italic\"\r\n            >\r\n              Orchestrating high-fidelity conversion cycles and prospect identity transmissions.\r\n            </motion.p>\r\n          </div>\r\n\r\n          <motion.div \r\n            initial={{ opacity: 0, scale: 0.9 }}\r\n            animate={{ opacity: 1, scale: 1 }}\r\n            transition={{ delay: 0.3 }}\r\n            className=\"flex flex-wrap items-center gap-4\"\r\n          >\r\n            {/* View Toggle Protocol */}\r\n            <div className=\"bg-secondary/50 p-1.5 rounded-2xl border border-border/50 flex items-center gap-1 shadow-inner\">\r\n              <button\r\n                onClick={() => setViewMode('kanban')}\r\n                className={cn(\r\n                  \"p-2.5 rounded-xl transition-all border\",\r\n                  viewMode === 'kanban' \r\n                    ? \"bg-card text-primary border-border/50 shadow-sm\" \r\n                    : \"text-muted-foreground border-transparent hover:text-foreground\"\r\n                )}\r\n              >\r\n                <SquaresFour weight=\"duotone\" className=\"w-5 h-5\" />\r\n              </button>\r\n              <button\r\n                onClick={() => setViewMode('list')}\r\n                className={cn(\r\n                  \"p-2.5 rounded-xl transition-all border\",\r\n                  viewMode === 'list' \r\n                    ? \"bg-card text-primary border-border/50 shadow-sm\" \r\n                    : \"text-muted-foreground border-transparent hover:text-foreground\"\r\n                )}\r\n              >\r\n                <ListIcon weight=\"duotone\" className=\"w-5 h-5\" />\r\n              </button>\r\n            </div>\r\n\r\n            <Button className=\"gap-3 shadow-premium px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest group\">\r\n              <Plus weight=\"bold\" className=\"w-4 h-4 group-hover:scale-110 transition-transform\" />\r\n              Initialize Node\r\n            </Button>\r\n          </motion.div>\r\n        </div>\r\n\r\n        {/* Stats Summary Nodes */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\r\n          <StatCard\r\n            title=\"Total Prospects\"\r\n            value={leads.length}\r\n            icon={IdentificationCard as Icon}\r\n            className=\"p-4\"\r\n          />\r\n          <StatCard\r\n            title=\"Active Flux\"\r\n            value={leads.filter(l => l.status !== 'won' && l.status !== 'lost').length}\r\n            icon={Lightning as Icon}\r\n            iconColor=\"text-amber-500\"\r\n            trend=\"up\"\r\n            change={5.2}\r\n            className=\"p-4\"\r\n          />\r\n          <StatCard\r\n            title=\"Conversion Yield\"\r\n            value={leads.filter(l => l.status === 'won').length}\r\n            icon={Target as Icon}\r\n            iconColor=\"text-emerald-500\"\r\n            trend=\"up\"\r\n            change={12.4}\r\n            className=\"p-4\"\r\n          />\r\n          <StatCard\r\n            title=\"Neural Pipeline\"\r\n            value={Math.round(leads.reduce((sum, l) => sum + (l.score || 0), 0) / (leads.length || 1))}\r\n            suffix=\"%\"\r\n            icon={Sparkle as Icon}\r\n            iconColor=\"text-primary\"\r\n            className=\"p-4\"\r\n          />\r\n        </div>\r\n\r\n        {/* Intelligence Controls */}\r\n        <div className=\"px-2\">\r\n          <Card className=\"p-6 rounded-[32px] border-border/50 shadow-card relative overflow-hidden group\">\r\n            <div className=\"flex flex-col md:flex-row gap-6 relative z-10\">\r\n              <div className=\"relative flex-1 group/input\">\r\n                <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\r\n                <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\r\n                <input \r\n                  type=\"text\" \r\n                  placeholder=\"Query identity name, neural address, or status node...\" \r\n                  value={searchTerm}\r\n                  onChange={(e) => setSearchTerm(e.target.value)}\r\n                  className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3.5 pl-12 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10 font-bold\"\r\n                />\r\n              </div>\r\n              \r\n              <Button variant=\"outline\" className=\"gap-2 px-8 py-3.5 rounded-2xl text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary shrink-0\">\r\n                <Funnel weight=\"bold\" className=\"w-4 h-4\" />\r\n                Protocol Filters\r\n              </Button>\r\n            </div>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* Content Matrix Area */}\r\n        <div className=\"px-2\">\r\n          {viewMode === 'list' ? (\r\n            <div className=\"flex-1\">\r\n              <InfiniteLeadsList \r\n                clinicId={clinicId} \r\n                onLeadClick={(lead) => {\r\n                  window.location.href = `/analysis?leadId=${lead.id}`;\r\n                }}\r\n              />\r\n            </div>\r\n          ) : loading ? (\r\n            <div className=\"py-48 flex flex-col items-center justify-center gap-6 bg-card border border-border/50 rounded-[40px] shadow-inner opacity-60\">\r\n              <SpinnerGap className=\"w-12 h-12 text-primary animate-spin\" />\r\n              <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] text-center\">Synchronizing Pipeline Matrix...</p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"flex gap-8 overflow-x-auto pb-10 no-scrollbar scroll-smooth\">\r\n              {COLUMNS.map((column, colIdx) => (\r\n                <SortableContext\r\n                  key={column.id}\r\n                  items={getLeadsByStatus(column.id).map(l => l.id)}\r\n                  strategy={verticalListSortingStrategy}\r\n                >\r\n                  <div \r\n                    id={column.id}\r\n                    className=\"flex-shrink-0 w-[340px] flex flex-col gap-6\"\r\n                  >\r\n                    <div className=\"flex items-center justify-between px-4\">\r\n                      <div className=\"flex items-center gap-3\">\r\n                        <div className=\"w-2 h-2 rounded-full bg-primary animate-pulse shadow-[0_0_10px_hsl(var(--primary)/0.6)]\" />\r\n                        <h3 className=\"text-xs font-black text-foreground uppercase tracking-[0.2em]\">{column.title}</h3>\r\n                        <Badge variant=\"ghost\" size=\"sm\" className=\"bg-primary/10 text-primary border-none font-black text-[10px] px-2.5\">\r\n                          {getLeadsByStatus(column.id).length}\r\n                        </Badge>\r\n                      </div>\r\n                      <button className=\"p-2 hover:bg-secondary rounded-xl text-muted-foreground hover:text-primary transition-all active:scale-95 shadow-sm border border-transparent hover:border-border/50\">\r\n                        <Plus weight=\"bold\" className=\"w-4 h-4\" />\r\n                      </button>\r\n                    </div>\r\n\r\n                    <div className=\"flex-1 space-y-5 bg-secondary/30 border border-border/50 rounded-[40px] p-5 min-h-[600px] backdrop-blur-md relative group/column overflow-y-auto custom-scrollbar shadow-inner\">\r\n                      <AnimatePresence mode=\"popLayout\">\r\n                        {getLeadsByStatus(column.id).length > 0 ? (\r\n                          getLeadsByStatus(column.id).map((lead, idx) => (\r\n                            <DraggableLeadCard\r\n                              key={lead.id}\r\n                              lead={lead}\r\n                              idx={idx}\r\n                            />\r\n                          ))\r\n                        ) : (\r\n                          <div className=\"h-full flex flex-col items-center justify-center text-center opacity-20 py-32 space-y-6\">\r\n                            <div className=\"w-20 h-20 border-2 border-dashed border-border rounded-[32px] flex items-center justify-center shadow-inner\">\r\n                              <Plus weight=\"duotone\" className=\"w-10 h-10\" />\r\n                            </div>\r\n                            <div className=\"space-y-2\">\r\n                              <p className=\"text-xs font-black uppercase tracking-[0.3em]\">Empty Cluster</p>\r\n                              <p className=\"text-[10px] font-medium max-w-[160px] italic\">Awaiting node transmission</p>\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </AnimatePresence>\r\n                    </div>\r\n                  </div>\r\n                </SortableContext>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </motion.div>\r\n\r\n      <DragOverlay>\r\n        {activeLead ? (\r\n          <div className=\"bg-card p-6 rounded-[32px] border-2 border-primary/40 shadow-premium opacity-95 w-[340px] scale-105 rotate-2 cursor-grabbing\">\r\n            <div className=\"flex items-start gap-5 mb-6\">\r\n              <div className=\"w-14 h-14 rounded-2xl bg-primary/10 flex items-center justify-center text-primary text-lg font-black border border-primary/20 shadow-sm shadow-inner\">\r\n                {activeLead.name?.split(' ').map((n: string) => n[0]).join('') || 'L'}\r\n              </div>\r\n              <div className=\"space-y-1.5 pr-6 min-w-0 flex-1\">\r\n                <h4 className=\"text-base font-black text-foreground truncate uppercase tracking-tight\">{activeLead.name}</h4>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse shadow-[0_0_8px_rgba(16,185,129,0.6)]\" />\r\n                  <p className=\"text-[10px] text-muted-foreground truncate font-bold italic tracking-tight\">{activeLead.email}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"pt-5 border-t border-border/50 flex items-center justify-between\">\r\n              <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none font-black text-[8px] uppercase tracking-widest px-3\">Syncing Node</Badge>\r\n              <div className=\"flex items-center gap-2\">\r\n                <Sparkle weight=\"fill\" className=\"w-3 h-3 text-primary\" />\r\n                <span className=\"text-xl font-black text-foreground tabular-nums\">{activeLead.score}%</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ) : null}\r\n      </DragOverlay>\r\n    </DndContext>\r\n  );\r\n}\r\n\r\n// Draggable Lead Card Component\r\n\r\nfunction DraggableLeadCard({ lead, idx }: { lead: Lead; idx: number }) {\r\n\r\n  const {\r\n\r\n    attributes,\r\n\r\n    listeners,\r\n\r\n    setNodeRef,\r\n\r\n    transform,\r\n\r\n    transition,\r\n\r\n    isDragging,\r\n\r\n  } = useSortable({ id: lead.id });\r\n\r\n\r\n\r\n  const style = {\r\n\r\n    transform: CSS.Transform.toString(transform),\r\n\r\n    transition,\r\n\r\n    opacity: isDragging ? 0.5 : 1,\r\n\r\n  };\r\n\r\n\r\n\r\n  return (\r\n\r\n    <motion.div\r\n      ref={setNodeRef}\r\n      style={style}\r\n      {...attributes}\r\n      {...listeners}\r\n      key={lead.id}\r\n      data-lead-id={lead.id}\r\n      layout\r\n      initial={{ opacity: 0, scale: 0.95, y: 10 }}\r\n      animate={{ opacity: 1, scale: 1, y: 0 }}\r\n      exit={{ opacity: 0, scale: 0.9, transition: { duration: 0.2 } }}\r\n      transition={{ duration: 0.3, delay: idx * 0.05 }}\r\n      whileHover={{ y: -4, transition: { duration: 0.2 } }}\r\n      className=\"bg-card p-6 rounded-[32px] border border-border/50 hover:border-primary/40 hover:shadow-card-hover transition-all cursor-grab active:cursor-grabbing group/card relative overflow-hidden shadow-card\"\r\n    >\r\n      {/* Status Accent Glow */}\r\n      <div className=\"absolute -top-10 -right-10 w-24 h-24 bg-primary/5 blur-3xl opacity-0 group-hover/card:opacity-100 transition-opacity\" />\r\n      \r\n      <div className=\"absolute top-6 right-6 opacity-0 group-hover/card:opacity-100 transition-all\">\r\n        <button className=\"p-2 hover:bg-secondary rounded-xl text-muted-foreground hover:text-primary border border-transparent hover:border-border/50 shadow-sm transition-all\">\r\n          <DotsThree weight=\"bold\" className=\"w-5 h-5\" />\r\n        </button>\r\n      </div>\r\n      \r\n      <div className=\"flex items-start gap-5 mb-6\">\r\n        <div className=\"w-14 h-14 rounded-2xl bg-secondary border border-border/50 flex items-center justify-center text-primary group-hover/card:bg-primary/10 group-hover/card:border-primary/20 transition-all duration-500 shadow-inner\">\r\n          <span className=\"text-base font-black uppercase\">{lead.name?.split(' ').map((n: string) => n[0]).join('') || 'L'}</span>\r\n        </div>\r\n        <div className=\"space-y-1.5 pr-8 min-w-0 flex-1\">\r\n          <h4 className=\"text-base font-black text-foreground group-hover/card:text-primary transition-colors truncate uppercase tracking-tight leading-tight\">{lead.name}</h4>\r\n          <div className=\"flex items-center gap-2\">\r\n            <div className=\"w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-[0_0_8px_hsl(var(--success)/0.4)]\" />\r\n            <p className=\"text-[10px] text-muted-foreground truncate font-bold italic tracking-tight\">{lead.email}</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex items-center justify-between pt-6 border-t border-border/30\">\r\n        <div className=\"flex items-center gap-2.5 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\r\n          <Clock weight=\"duotone\" className=\"w-4 h-4 text-primary/60\" />\r\n          Node Sync: {new Date(lead.created_at).toLocaleDateString(undefined, { month: 'short', day: 'numeric' })}\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-4\">\r\n          <Link href={`/analysis?leadId=${lead.id}`}>\r\n            <button className=\"w-9 h-9 rounded-xl bg-primary text-primary-foreground hover:brightness-110 transition-all shadow-premium flex items-center justify-center group/btn active:scale-90\">\r\n              <Sparkle weight=\"bold\" className=\"w-4 h-4 group-hover/btn:scale-125 transition-transform\" />\r\n            </button>\r\n          </Link>\r\n          <div className=\"flex flex-col items-end\">\r\n            <span className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.2em] mb-1 opacity-60\">Scoring</span>\r\n            <div className=\"px-3 py-1 rounded-full bg-primary/5 border border-primary/20 text-primary text-[11px] font-black tabular-nums shadow-sm shadow-inner\">\r\n              {lead.score || 0}%\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\sales\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Invalid character.","line":111,"column":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  Users, \n  Target, \n  TrendUp, \n  Clock, \n  ArrowUpRight, \n  ArrowDownRight,\n  UserPlus,\n  Lightning,\n  Sparkle,\n  SpinnerGap,\n  CaretRight,\n  ChatCircle, \n  CurrencyCircleDollar,\n  Briefcase,\n  Monitor,\n  ChartBar,\n  Handshake,\n  IdentificationBadge,\n  Graph,\n  Receipt,\n  Icon,\n  Pulse,\n  ArrowsClockwise\n} from '@phosphor-icons/react';\nimport { StatCard } from '@/components/ui/StatCard';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Badge } from '@/components/ui/Badge';\nimport { Button } from '@/components/ui/button';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\nimport { useTranslations } from 'next-intl';\nimport { cn } from '@/lib/utils';\nimport { Link } from '@/i18n/routing';\nimport { useEffect, useState, useMemo } from 'react';\nimport { createClient } from '@/lib/supabase/client';\nimport MyCustomersSection from '@/components/sales/MyCustomersSection';\nimport CommissionTracker from '@/components/sales/CommissionTracker';\nimport ChatCenter from '@/components/sales/ChatCenter';\nimport AICoachPanel from '@/components/sales/AICoachPanel';\nimport HotLeadsAlert from '@/components/sales/HotLeadsAlert';\nimport SmartSuggestions from '@/components/sales/SmartSuggestions';\nimport { CustomerContext } from '@/lib/ai/salesCoach';\nimport { useHotLeadsRealtime } from '@/hooks/useHotLeadsRealtime';\nimport { useHotLeads } from '@/hooks/useSalesLeads';\nimport { useSalesStats, useSalesTarget } from '@/hooks/useSalesStats';\nimport SalesPresenceIndicator from '@/components/sales/SalesPresenceIndicator';\nimport { useLeadRealtimeSync } from '@/lib/realtime/salesPresence';\n\ninterface RecentLead {\n  id: string;\n  name: string;\n  status: string;\n  score: number;\n  category: 'hot' | 'warm' | 'cold';\n  confidence: number;\n  time: string;\n  estimatedValue: number;\n  priority: 'immediate' | 'follow_up' | 'nurture';\n}\n\nexport default function SalesDashboard() {\n  const { goBack } = useBackNavigation();\n  const t = useTranslations('sales');\n  const [userId, setUserId] = useState<string | null>(null);\n  const [clinicId, setClinicId] = useState<string>('');\n  \n  const [currentCustomer, setCurrentCustomer] = useState<CustomerContext | null>(null);\n  const [currentConversation, setCurrentConversation] = useState<string>('');\n\n  const supabase = useMemo(() => createClient(), []);\n  \n  useEffect(() => {\n    async function getUserInfo() {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (user) {\n        setUserId(user.id);\n        const clinic = user.user_metadata?.clinic_id || '';\n        setClinicId(clinic);\n      }\n    }\n    getUserInfo();\n  }, [supabase]);\n\n  const { data: salesStats, isLoading: statsLoading } = useSalesStats();\n  const { data: targetData, isLoading: targetLoading } = useSalesTarget();\n  const { data: hotLeadsData = [], isLoading: leadsLoading } = useHotLeads(clinicId, 5);\n\n  const loading = statsLoading || targetLoading || leadsLoading;\n\n  const recentLeads: RecentLead[] = useMemo(() => hotLeadsData.map(l => ({\n    id: l.id,\n    name: l.name || 'Unknown Customer',\n    status: l.status === 'new' ? '๏ฟฝ๏ฟฝ๏ฟฝ๏ฟฝ' : l.status === 'won' ? '๏ฟฝิด๏ฟฝ๏ฟฝรข๏ฟฝ๏ฟฝ' : '๏ฟฝ๏ฟฝ๏ฟฝัง๏ฟฝิด๏ฟฝ๏ฟฝ๏ฟฝ',\n    score: l.score || 0,\n    category: l.category as 'hot' | 'warm' | 'cold',\n    confidence: l.confidence || l.score || 0,\n    time: new Date(l.created_at).toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit' }) + ' ๏ฟฝ.',\n    estimatedValue: 0,\n    priority: 'immediate' as const\n  })), [hotLeadsData]);\n\n  useHotLeadsRealtime(clinicId);\n  useLeadRealtimeSync(clinicId, userId || '');\n\n  if (loading) {\n    return (\n      <div className=\\\"min-h-[400px] flex flex-col items-center justify-center space-y-4\\\">\n        <SpinnerGap className=\\\"w-10 h-10 text-primary animate-spin\\\" />\n        <p className=\\\"text-muted-foreground animate-pulse text-xs uppercase tracking-widest text-center\\\">Loading Sales Intelligence...</p>\n      </div>\n    );\n  }\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\\\"space-y-8 pb-20 relative font-sans\\\"\n    >\n      <Breadcrumb />\n\n      {userId && clinicId && (\n        <SalesPresenceIndicator clinicId={clinicId} userId={userId} />\n      )}\n\n      <HotLeadsAlert />\n      \n      {currentCustomer && (\n        <AICoachPanel \n          customerContext={currentCustomer}\n          currentConversation={currentConversation}\n          onSuggestionApply={(suggestion) => {\n            setCurrentConversation(prev => prev + '\\n[AI ๏ฟฝะน๏ฟฝ]: ' + suggestion);\n          }}\n        />\n      )}\n\n      <div className=\\\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\\\">\n        <div className=\\\"space-y-1\\\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\\\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\\\"\n          >\n            <Handshake weight=\\\"duotone\\\" className=\\\"w-4 h-4\\\" />\n            Revenue Growth Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\\\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\\\"\n          >\n            Sales <span className=\\\"text-primary\\\">Intelligence</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\\\"text-muted-foreground font-light text-sm italic\\\"\n          >\n            Orchestrating commercial acquisition, lead nurturing, and fiscal conversion trajectories.\n          </motion.p>\n        </div>\n\n        <motion.div \n          initial={{ opacity: 0, scale: 0.9 }}\n          animate={{ opacity: 1, scale: 1 }}\n          transition={{ delay: 0.3 }}\n          className=\\\"flex flex-wrap gap-3\\\"\n        >\n          <Link href=\\\"/sales/customers\\\">\n            <Button className=\\\"gap-2 px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest shadow-premium group\\\">\n              <UserPlus weight=\\\"bold\\\" className=\\\"w-4 h-4 group-hover:scale-110 transition-transform\\\" />\n              New Prospect Node\n            </Button>\n          </Link>\n          <Button \n            variant=\\\"outline\\\"\n            className=\\\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary\\\"\n          >\n            <ChartBar weight=\\\"duotone\\\" className=\\\"w-4 h-4 text-primary\\\" />\n            Pipeline Audit\n          </Button>\n        </motion.div>\n      </div>\n\n      <div className=\\\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\\\">\n        <StatCard\n          title=\\\"Conversion Yield\\\"\n          value={salesStats?.total_sales || 0}\n          prefix=\\\"๏ฟฝ\\\"\n          icon={CurrencyCircleDollar as Icon}\n          trend=\\\"up\\\"\n          change={salesStats?.growth_rate || 12.5}\n          className=\\\"p-4\\\"\n        />\n        <StatCard\n          title=\\\"Active Prospects\\\"\n          value={salesStats?.active_leads || 0}\n          icon={Users as Icon}\n          trend=\\\"neutral\\\"\n          className=\\\"p-4\\\"\n        />\n        <StatCard\n          title=\\\"Closing Velocity\\\"\n          value={salesStats?.conversion_rate || 0}\n          suffix=\\\"%\\\"\n          icon={Lightning as Icon}\n          trend=\\\"up\\\"\n          change={2.1}\n          className=\\\"p-4\\\"\n        />\n        <StatCard\n          title=\\\"Quota Synchronization\\\"\n          value={targetData?.progress || 0}\n          suffix=\\\"%\\\"\n          icon={Target as Icon}\n          iconColor=\\\"text-primary\\\"\n          className=\\\"p-4\\\"\n        />\n      </div>\n\n      <div className=\\\"grid grid-cols-1 lg:grid-cols-3 gap-10 px-2\\\">\n        <div className=\\\"lg:col-span-2 space-y-10\\\">\n          <Card className=\\\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group\\\">\n            <CardHeader className=\\\"p-8 border-b border-border/50 bg-secondary/30 flex flex-row items-center justify-between\\\">\n              <div className=\\\"flex items-center gap-4\\\">\n                <div className=\\\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\\\">\n                  <IdentificationBadge weight=\\\"duotone\\\" className=\\\"w-6 h-6\\\" />\n                </div>\n                <div>\n                  <CardTitle className=\\\"text-xl font-black uppercase tracking-tight\\\">Identity Portfolio</CardTitle>\n                  <p className=\\\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-black mt-0.5\\\">Assigned customer registry nodes</p>\n                </div>\n              </div>\n              <Link href=\\\"/sales/customers\\\">\n                <Button variant=\\\"ghost\\\" size=\\\"sm\\\" className=\\\"text-primary font-black uppercase tracking-widest gap-3 hover:bg-primary/5 rounded-xl px-4 py-2\\\">\n                  Expand Registry <CaretRight weight=\\\"bold\\\" className=\\\"w-3.5 h-3.5\\\" />\n                </Button>\n              </Link>\n            </CardHeader>\n            <CardContent className=\\\"p-0\\\">\n              <MyCustomersSection userId={userId || ''} />\n            </CardContent>\n          </Card>\n\n          <div className=\\\"grid grid-cols-1 md:grid-cols-2 gap-8\\\">\n            <CommissionTracker userId={userId || ''} />\n            <AICoachPanel customerContext={currentCustomer || undefined} />\n          </div>\n        </div>\n\n        <div className=\\\"space-y-10\\\">\n          <Card className=\\\"rounded-[40px] border-border/50 shadow-premium overflow-hidden group bg-gradient-to-br from-background via-background to-primary/5\\\">\n            <div className=\\\"absolute top-0 right-0 p-8 opacity-[0.02] group-hover:scale-110 transition-transform duration-700 pointer-events-none\\\">\n              <Sparkle className=\\\"w-64 h-64 text-primary\\\" />\n            </div>\n            \n            <CardHeader className=\\\"p-8 border-b border-border/50 bg-primary/5\\\">\n              <CardTitle className=\\\"text-xs font-black uppercase tracking-[0.3em] flex items-center gap-3 text-primary\\\">\n                <Sparkle weight=\\\"duotone\\\" className=\\\"w-5 h-5\\\" />\n                Cognitive Suggestions\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\\\"p-8\\\">\n              <SmartSuggestions userId={userId || ''} onSelectCustomer={setCurrentCustomer} />\n            </CardContent>\n          </Card>\n\n          <Card className=\\\"rounded-[40px] border-border/50 shadow-premium overflow-hidden\\\">\n            <CardHeader className=\\\"p-8 border-b border-border/50 bg-secondary/30\\\">\n              <div className=\\\"flex items-center gap-4\\\">\n                <div className=\\\"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20 shadow-inner\\\">\n                  <ChatCircle weight=\\\"duotone\\\" className=\\\"w-5 h-5\\\" />\n                </div>\n                <CardTitle className=\\\"text-sm font-black uppercase tracking-tight text-foreground/80\\\">Transmission Hub</CardTitle>\n              </div>\n            </CardHeader>\n            <CardContent className=\\\"p-0 h-[500px]\\\">\n              <ChatCenter \n                userId={userId || ''} \n                activeCustomer={currentCustomer} \n                onClose={() => setCurrentCustomer(null)}\n              />\n            </CardContent>\n          </Card>\n\n          <Card className=\\\"p-8 rounded-[40px] border-primary/10 bg-primary/[0.02] space-y-4 group overflow-hidden relative\\\">\n            <div className=\\\"absolute -bottom-12 -right-12 w-32 h-32 bg-primary/5 blur-[50px] rounded-full group-hover:bg-primary/10 transition-all duration-700\\\" />\n            <div className=\\\"flex items-center gap-3 relative z-10\\\">\n              <Pulse weight=\\\"duotone\\\" className=\\\"w-5 h-5 text-primary group-hover:scale-110 transition-transform\\\" />\n              <h4 className=\\\"text-[10px] font-black text-primary uppercase tracking-[0.3em]\\\">Operational Pulse</h4>\n            </div>\n            <p className=\\\"text-xs text-muted-foreground italic font-medium leading-relaxed relative z-10\\\">\n              Synchronizing commercial data across clinical nodes. Sales velocity is currently 8.4% above median benchmark.\n            </p>\n          </Card>\n        </div>\n      </div>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\sales\\proposals\\create\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRouter' is defined but never used.","line":23,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":19,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useRouter"},"fix":{"range":[451,461],"text":""},"desc":"Remove unused variable \"useRouter\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { \r\n  Plus, \r\n  Trash, \r\n  Sparkle,\r\n  CaretLeft,\r\n  CheckCircle,\r\n  FirstAidKit,\r\n  CurrencyDollar,\r\n  SpinnerGap,\r\n  Package,\r\n  ShoppingBag,\r\n  ArrowRight,\r\n  FileText,\r\n  User,\r\n  Brain\r\n} from '@phosphor-icons/react';\r\nimport { cn } from '@/lib/utils';\r\nimport { useEffect, useState } from 'react';\r\nimport { createClient } from '@/lib/supabase/client';\r\nimport { useRouter, Link } from '@/i18n/routing';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\n\r\ninterface Lead {\r\n  id: string;\r\n  name: string;\r\n  email: string;\r\n  clinic_id: string;\r\n}\r\n\r\ninterface Treatment {\r\n  id: string;\r\n  names: { [key: string]: string } | string;\r\n  category: string;\r\n  price_min: number;\r\n}\r\n\r\ninterface Product {\r\n  id: string;\r\n  name: string;\r\n  category: string;\r\n  sale_price: number;\r\n}\r\n\r\ninterface SelectedItem {\r\n  id: string;\r\n  type: 'treatment' | 'product';\r\n  name?: string;\r\n  names?: { [key: string]: string } | string;\r\n  category: string;\r\n  quantity: number;\r\n  current_price: number;\r\n}\r\n\r\ninterface AIRecommendation {\r\n  treatments?: Array<{\r\n    program: string;\r\n    standardCategory: string;\r\n    sessions: number;\r\n    whyThis: string;\r\n  }>;\r\n  products?: Array<{\r\n    name: string;\r\n    standardCategory: string;\r\n    keyIngredients: string;\r\n    usage: string;\r\n  }>;\r\n}\r\n\r\ninterface AIAnalysis {\r\n  id: string;\r\n  overall_score: number;\r\n  skin_age: number;\r\n  spots_detections?: Array<{ name: string }>;\r\n  recommendations?: AIRecommendation;\r\n}\r\n\r\nexport default function CreateProposalPage() {\r\n  const { goBack } = useBackNavigation();\r\n  const supabase = createClient();\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [leads, setLeads] = useState<Lead[]>([]);\r\n  const [treatments, setTreatments] = useState<Treatment[]>([]);\r\n  const [products, setProducts] = useState<Product[]>([]);\r\n  const [selectedLead, setSelectedLead] = useState<Lead | null>(null);\r\n  const [selectedItems, setSelectedItems] = useState<SelectedItem[]>([]);\r\n  const [proposalTitle, setProposalTitle] = useState('');\r\n  const [aiAnalysis, setAiAnalysis] = useState<AIAnalysis | null>(null);\r\n\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      try {\r\n        const [leadsRes, treatmentsRes, productsRes] = await Promise.all([\r\n          supabase.from('sales_leads').select('*').order('name'),\r\n          supabase.from('treatments').select('*').order('category'),\r\n          supabase.from('inventory_products').select('*').order('category')\r\n        ]);\r\n\r\n        if (leadsRes.error) throw leadsRes.error;\r\n        if (treatmentsRes.error) throw treatmentsRes.error;\r\n        if (productsRes.error) throw productsRes.error;\r\n\r\n        setLeads(leadsRes.data || []);\r\n        setTreatments(treatmentsRes.data || []);\r\n        setProducts(productsRes.data || []);\r\n      } catch (err) {\r\n        console.error('Error fetching data:', err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n    fetchData();\r\n  }, [supabase]);\r\n\r\n  // Fetch AI analysis when a lead is selected\r\n  useEffect(() => {\r\n    async function fetchAiAnalysis() {\r\n      if (!selectedLead) {\r\n        setAiAnalysis(null);\r\n        return;\r\n      }\r\n\r\n      const { data } = await supabase\r\n        .from('skin_analyses')\r\n        .select('*')\r\n        .eq('clinic_id', selectedLead.clinic_id)\r\n        .order('analyzed_at', { ascending: false })\r\n        .limit(1)\r\n        .maybeSingle();\r\n\r\n      if (data) setAiAnalysis(data as unknown as AIAnalysis);\r\n    }\r\n    fetchAiAnalysis();\r\n  }, [selectedLead, supabase]);\r\n\r\n  const addItem = (item: Treatment | Product, type: 'treatment' | 'product') => {\r\n    if (selectedItems.find(i => i.id === item.id && i.type === type)) return;\r\n    const price = type === 'treatment' ? (item as Treatment).price_min : (item as Product).sale_price;\r\n    const newItem: SelectedItem = { \r\n      ...item, \r\n      type, \r\n      quantity: 1, \r\n      current_price: price \r\n    };\r\n    setSelectedItems([...selectedItems, newItem]);\r\n  };\r\n\r\n  const removeItem = (id: string, type: string) => {\r\n    setSelectedItems(selectedItems.filter(i => !(i.id === id && i.type === type)));\r\n  };\r\n\r\n  const updateQuantity = (id: string, type: string, delta: number) => {\r\n    setSelectedItems(selectedItems.map(i => \r\n      (i.id === id && i.type === type) ? { ...i, quantity: Math.max(1, i.quantity + delta) } : i\r\n    ));\r\n  };\r\n\r\n  const calculateTotal = () => {\r\n    return selectedItems.reduce((acc, i) => acc + (Number(i.current_price) * i.quantity), 0);\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    if (!selectedLead || selectedItems.length === 0 || !proposalTitle) return;\r\n\r\n    setSaving(true);\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('sales_proposals')\r\n        .insert({\r\n          lead_id: selectedLead.id,\r\n          clinic_id: selectedLead.clinic_id,\r\n          title: proposalTitle,\r\n          treatments: selectedItems.map(i => ({\r\n            id: i.id,\r\n            type: i.type,\r\n            name: i.type === 'treatment' ? (typeof i.names === 'object' ? i.names.en : i.names) : i.name,\r\n            price: i.current_price,\r\n            quantity: i.quantity\r\n          })),\r\n          total_value: calculateTotal(),\r\n          status: 'draft'\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      router.push(`/sales/proposals?id=${data.id}`);\r\n    } catch (err) {\r\n      console.error('Error saving proposal:', err);\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-[400px] flex flex-col items-center justify-center space-y-4 font-sans\">\r\n        <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n        <p className=\"text-muted-foreground animate-pulse text-sm uppercase tracking-widest font-heading\">Initialising Builder...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-6 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6\">\r\n        <div className=\"flex items-center gap-6\">\r\n          <motion.button \r\n            whileHover={{ scale: 1.1, x: -5 }}\r\n            whileTap={{ scale: 0.9 }}\r\n            onClick={() => goBack('/sales/proposals')}\r\n            className=\"p-3 bg-secondary border border-border rounded-xl text-muted-foreground hover:text-foreground transition-all shadow-sm\"\r\n          >\r\n            <CaretLeft className=\"w-6 h-6\" />\r\n          </motion.button>\r\n          <div className=\"space-y-1\">\r\n            <motion.div \r\n              initial={{ opacity: 0, x: -20 }}\r\n              animate={{ opacity: 1, x: 0 }}\r\n              className=\"flex items-center gap-2 text-primary text-xs font-bold uppercase tracking-[0.3em]\"\r\n            >\r\n              <FileText className=\"w-4 h-4\" />\r\n              Creative Studio\r\n            </motion.div>\r\n            <h1 className=\"text-4xl font-heading font-bold text-foreground uppercase tracking-tight\">Proposal <span className=\"text-primary\">Builder</span></h1>\r\n            <p className=\"text-muted-foreground font-light text-sm italic\">Crafting a bespoke aesthetic journey for your distinguished client.</p>\r\n          </div>\r\n        </div>\r\n        <motion.button \r\n          whileHover={{ scale: 1.02 }}\r\n          whileTap={{ scale: 0.98 }}\r\n          onClick={handleSave}\r\n          disabled={saving || !selectedLead || selectedItems.length === 0 || !proposalTitle}\r\n          className=\"flex items-center gap-3 px-8 py-4 bg-primary text-primary-foreground rounded-2xl font-black uppercase tracking-[0.2em] text-xs shadow-premium hover:brightness-110 transition-all active:scale-95 disabled:opacity-30 disabled:grayscale\"\r\n        >\r\n          {saving ? <SpinnerGap className=\"w-4 h-4 animate-spin\" /> : <CheckCircle className=\"w-4 h-4 stroke-[3px]\" />}\r\n          <span>Authorize & Dispatch</span>\r\n        </motion.button>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-10\">\r\n        {/* Left Column: Selection */}\r\n        <div className=\"lg:col-span-2 space-y-10\">\r\n          <motion.section \r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"bg-card p-10 rounded-2xl border border-border shadow-card space-y-8 relative overflow-hidden\"\r\n          >\r\n            <div className=\"absolute top-0 right-0 p-12 opacity-5 pointer-events-none\">\r\n              <User className=\"w-32 h-32 text-primary\" />\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-4 relative z-10\">\r\n              <div className=\"w-12 h-12 rounded-2xl bg-primary/20 flex items-center justify-center text-primary border border-primary/20 font-bold shadow-premium\">1</div>\r\n              <h2 className=\"text-2xl font-bold text-foreground uppercase tracking-tight\">Lead <span className=\"text-primary\">Identification</span></h2>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-5 relative z-10\">\r\n              {leads.map((lead, idx) => (\r\n                <motion.div \r\n                  key={lead.id}\r\n                  initial={{ opacity: 0, x: -10 }}\r\n                  animate={{ opacity: 1, x: 0 }}\r\n                  transition={{ delay: 0.3 + idx * 0.05 }}\r\n                  onClick={() => setSelectedLead(lead)}\r\n                  className={cn(\r\n                    \"p-6 rounded-2xl border transition-all cursor-pointer group flex items-center justify-between relative overflow-hidden\",\r\n                    selectedLead?.id === lead.id \r\n                      ? \"bg-primary/10 border-primary shadow-sm\" \r\n                      : \"bg-secondary border-border hover:border-primary/30\"\r\n                  )}\r\n                >\r\n                  <div className=\"flex items-center gap-4 relative z-10\">\r\n                    <div className={cn(\r\n                      \"w-12 h-12 rounded-2xl flex items-center justify-center text-sm font-bold transition-all duration-500\",\r\n                      selectedLead?.id === lead.id ? \"bg-primary text-primary-foreground shadow-premium\" : \"bg-background text-muted-foreground border border-border\"\r\n                    )}>\r\n                      {lead.name.split(' ').map((n: string) => n[0]).join('')}\r\n                    </div>\r\n                    <div className=\"space-y-0.5\">\r\n                      <p className=\"text-sm font-bold text-foreground group-hover:text-primary transition-colors\">{lead.name}</p>\r\n                      <p className=\"text-[10px] text-muted-foreground font-medium italic opacity-60\">{lead.email}</p>\r\n                    </div>\r\n                  </div>\r\n                  {selectedLead?.id === lead.id && (\r\n                    <motion.div initial={{ scale: 0 }} animate={{ scale: 1 }}>\r\n                      <CheckCircle className=\"w-5 h-5 text-primary\" />\r\n                    </motion.div>\r\n                  )}\r\n                </motion.div>\r\n              ))}\r\n            </div>\r\n          </motion.section>\r\n\r\n          <motion.section \r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ delay: 0.4 }}\r\n            className=\"bg-card p-10 rounded-2xl border border-border shadow-card space-y-10 relative overflow-hidden\"\r\n          >\r\n            <div className=\"flex items-center gap-4 relative z-10\">\r\n              <div className=\"w-12 h-12 rounded-2xl bg-primary/20 flex items-center justify-center text-primary border border-primary/20 font-bold shadow-premium\">2</div>\r\n              <h2 className=\"text-2xl font-bold text-foreground uppercase tracking-tight\">Curated <span className=\"text-primary\">Selection</span></h2>\r\n            </div>\r\n\r\n            {/* Catalog Tabs/Selectors */}\r\n            <div className=\"space-y-10 relative z-10\">\r\n              {/* Treatments Selector */}\r\n              <div className=\"space-y-5\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <h3 className=\"text-[10px] font-bold text-muted-foreground uppercase tracking-[0.3em] flex items-center gap-3\">\r\n                    <FirstAidKit className=\"w-4 h-4 text-primary\" /> Clinical Protocols\r\n                  </h3>\r\n                  <span className=\"text-[9px] font-bold text-muted-foreground/40 uppercase tracking-widest\">{treatments.length} Available</span>\r\n                </div>\r\n                <div className=\"flex gap-3 overflow-x-auto pb-4 custom-scrollbar\">\r\n                  {treatments.map((t) => (\r\n                    <motion.button\r\n                      key={t.id}\r\n                      whileHover={{ scale: 1.05, y: -2 }}\r\n                      whileTap={{ scale: 0.95 }}\r\n                      onClick={() => addItem(t, 'treatment')}\r\n                      className=\"flex-shrink-0 px-6 py-3 bg-secondary border border-border rounded-xl text-xs font-bold text-foreground hover:bg-accent hover:border-primary/30 transition-all whitespace-nowrap flex items-center gap-3 group\"\r\n                    >\r\n                      <Plus className=\"w-3.5 h-3.5 group-hover:text-primary transition-colors\" />\r\n                      {typeof t.names === 'object' ? t.names.en : t.names}\r\n                    </motion.button>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Products Selector */}\r\n              <div className=\"space-y-5\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <h3 className=\"text-[10px] font-bold text-muted-foreground uppercase tracking-[0.3em] flex items-center gap-3\">\r\n                    <ShoppingBag className=\"w-4 h-4 text-emerald-500\" /> Premium Skincare\r\n                  </h3>\r\n                  <span className=\"text-[9px] font-bold text-muted-foreground/40 uppercase tracking-widest\">{products.length} Available</span>\r\n                </div>\r\n                <div className=\"flex gap-3 overflow-x-auto pb-4 custom-scrollbar\">\r\n                  {products.map((p) => (\r\n                    <motion.button\r\n                      key={p.id}\r\n                      whileHover={{ scale: 1.05, y: -2 }}\r\n                      whileTap={{ scale: 0.95 }}\r\n                      onClick={() => addItem(p, 'product')}\r\n                      className=\"flex-shrink-0 px-6 py-3 bg-secondary border border-border rounded-xl text-xs font-bold text-foreground hover:bg-accent hover:border-emerald-500/30 transition-all whitespace-nowrap flex items-center gap-3 group\"\r\n                    >\r\n                      <Plus className=\"w-3.5 h-3.5 group-hover:text-emerald-500 transition-colors\" />\r\n                      {p.name}\r\n                    </motion.button>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* AI Suggestions Section */}\r\n            <AnimatePresence>\r\n              {aiAnalysis && (\r\n                <motion.div \r\n                  initial={{ opacity: 0, height: 0 }}\r\n                  animate={{ opacity: 1, height: 'auto' }}\r\n                  exit={{ opacity: 0, height: 0 }}\r\n                  className=\"space-y-6 pt-8 border-t border-border\"\r\n                >\r\n                  <div className=\"flex items-center gap-3 text-primary\">\r\n                    <div className=\"w-8 h-8 rounded-xl bg-primary/10 flex items-center justify-center\">\r\n                      <Sparkle className=\"w-4 h-4 animate-glow-pulse\" />\r\n                    </div>\r\n                    <h3 className=\"text-xs font-bold uppercase tracking-[0.3em]\">Cognitive Neural Mapping</h3>\r\n                  </div>\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    {/* Suggest Treatments */}\r\n                    {aiAnalysis.recommendations?.treatments?.map((rec, i) => (\r\n                      <motion.div \r\n                        key={rec.program} \r\n                        initial={{ opacity: 0, scale: 0.95 }}\r\n                        animate={{ opacity: 1, scale: 1 }}\r\n                        transition={{ delay: 0.6 + i * 0.1 }}\r\n                        className=\"p-5 bg-primary/5 border border-primary/20 rounded-2xl flex items-center justify-between group hover:bg-primary/10 transition-all\"\r\n                      >\r\n                        <div className=\"flex items-center gap-4\">\r\n                          <div className=\"w-10 h-10 rounded-2xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20\">\r\n                            <FirstAidKit className=\"w-5 h-5\" />\r\n                          </div>\r\n                          <div>\r\n                            <p className=\"text-sm font-bold text-foreground\">{rec.program}</p>\r\n                            <p className=\"text-[10px] text-muted-foreground uppercase font-bold tracking-widest\">{rec.sessions} Protocol Cycles</p>\r\n                          </div>\r\n                        </div>\r\n                        <motion.button \r\n                          whileHover={{ scale: 1.1 }}\r\n                          whileTap={{ scale: 0.9 }}\r\n                          onClick={() => {\r\n                            const match = treatments.find(t => t.category === rec.standardCategory);\r\n                            if (match) addItem(match, 'treatment');\r\n                          }}\r\n                          className=\"p-2.5 rounded-xl bg-primary text-primary-foreground shadow-lg hover:brightness-110 transition-all\"\r\n                        >\r\n                          <Plus className=\"w-4 h-4 stroke-[3px]\" />\r\n                        </motion.button>\r\n                      </motion.div>\r\n                    ))}\r\n                    {/* Suggest Products */}\r\n                    {aiAnalysis.recommendations?.products?.map((rec, i) => (\r\n                      <motion.div \r\n                        key={rec.name}\r\n                        initial={{ opacity: 0, scale: 0.95 }}\r\n                        animate={{ opacity: 1, scale: 1 }}\r\n                        transition={{ delay: 0.7 + i * 0.1 }}\r\n                        className=\"p-5 bg-emerald-500/5 border border-emerald-500/20 rounded-2xl flex items-center justify-between group hover:bg-emerald-500/10 transition-all\"\r\n                      >\r\n                        <div className=\"flex items-center gap-4\">\r\n                          <div className=\"w-10 h-10 rounded-2xl bg-emerald-500/10 flex items-center justify-center text-emerald-500 border border-emerald-500/20\">\r\n                            <Package className=\"w-5 h-5\" />\r\n                          </div>\r\n                          <div className=\"pr-4\">\r\n                            <p className=\"text-sm font-bold text-foreground line-clamp-1\">{rec.name}</p>\r\n                            <p className=\"text-[10px] text-muted-foreground uppercase font-bold tracking-widest line-clamp-1\">{rec.usage}</p>\r\n                          </div>\r\n                        </div>\r\n                        <motion.button \r\n                          whileHover={{ scale: 1.1 }}\r\n                          whileTap={{ scale: 0.9 }}\r\n                          onClick={() => {\r\n                            const match = products.find(p => p.category === rec.standardCategory);\r\n                            if (match) addItem(match, 'product');\r\n                          }}\r\n                          className=\"p-2.5 rounded-xl bg-emerald-500 text-white shadow-lg hover:brightness-110 transition-all flex-shrink-0\"\r\n                        >\r\n                          <Plus className=\"w-4 h-4 stroke-[3px]\" />\r\n                        </motion.button>\r\n                      </motion.div>\r\n                    ))}\r\n                  </div>\r\n                </motion.div>\r\n              )}\r\n            </AnimatePresence>\r\n\r\n            {/* Selected Items List */}\r\n            <div className=\"space-y-6 pt-8 border-t border-border relative z-10\">\r\n              <div className=\"flex items-center justify-between mb-2\">\r\n                <h3 className=\"text-xs font-bold text-foreground uppercase tracking-[0.3em]\">Bespoke Composition</h3>\r\n                <span className=\"text-[10px] font-bold text-muted-foreground uppercase tracking-widest\">{selectedItems.length} Items Configured</span>\r\n              </div>\r\n              \r\n              <AnimatePresence mode=\"popLayout\">\r\n                {selectedItems.map((item) => (\r\n                  <motion.div\r\n                    key={`${item.type}-${item.id}`}\r\n                    layout\r\n                    initial={{ opacity: 0, x: -20 }}\r\n                    animate={{ opacity: 1, x: 0 }}\r\n                    exit={{ opacity: 0, scale: 0.95 }}\r\n                    className=\"p-6 bg-secondary border border-border rounded-2xl flex flex-col md:flex-row md:items-center justify-between gap-6 group hover:border-primary/30 transition-all hover:bg-accent\"\r\n                  >\r\n                    <div className=\"flex items-center gap-5\">\r\n                      <div className={cn(\r\n                        \"w-14 h-14 rounded-2xl flex items-center justify-center transition-all duration-500 shadow-sm\",\r\n                        item.type === 'treatment' ? \"bg-primary/10 text-primary border border-primary/20\" : \"bg-emerald-500/10 text-emerald-500 border border-emerald-500/20\"\r\n                      )}>\r\n                        {item.type === 'treatment' ? <FirstAidKit className=\"w-7 h-7\" /> : <Package className=\"w-7 h-7\" />}\r\n                      </div>\r\n                      <div>\r\n                        <h4 className=\"text-lg font-bold text-foreground tracking-tight\">{item.type === 'treatment' ? (typeof item.names === 'object' ? item.names.en : item.names) : item.name}</h4>\r\n                        <p className=\"text-[10px] text-muted-foreground uppercase tracking-[0.2em] font-bold italic\">{item.category}</p>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex flex-wrap items-center gap-8 md:gap-12 justify-between md:justify-end\">\r\n                      <div className=\"flex items-center gap-4 bg-background rounded-2xl p-1.5 border border-border shadow-inner\">\r\n                        <motion.button \r\n                          whileHover={{ scale: 1.1 }}\r\n                          whileTap={{ scale: 0.9 }}\r\n                          onClick={() => updateQuantity(item.id, item.type, -1)} \r\n                          className=\"w-10 h-10 rounded-xl hover:bg-secondary text-foreground flex items-center justify-center transition-all font-bold\"\r\n                        >-</motion.button>\r\n                        <span className=\"w-6 text-center text-sm font-bold text-foreground tabular-nums\">{item.quantity}</span>\r\n                        <motion.button \r\n                          whileHover={{ scale: 1.1 }}\r\n                          whileTap={{ scale: 0.9 }}\r\n                          onClick={() => updateQuantity(item.id, item.type, 1)} \r\n                          className=\"w-10 h-10 rounded-xl hover:bg-secondary text-foreground flex items-center justify-center transition-all font-bold\"\r\n                        >+</motion.button>\r\n                      </div>\r\n                      \r\n                      <div className=\"text-right min-w-[100px]\">\r\n                        <p className=\"text-lg font-bold text-foreground tracking-tight\">เธฟ{(Number(item.current_price) * item.quantity).toLocaleString()}</p>\r\n                        <p className=\"text-[9px] text-muted-foreground uppercase tracking-widest font-bold opacity-60\">Investment</p>\r\n                      </div>\r\n\r\n                      <motion.button \r\n                        whileHover={{ scale: 1.1, rotate: 5 }}\r\n                        whileTap={{ scale: 0.9 }}\r\n                        onClick={() => removeItem(item.id, item.type)} \r\n                        className=\"p-3 text-rose-500/40 hover:text-rose-500 hover:bg-rose-500/10 rounded-2xl transition-all\"\r\n                      >\r\n                        <Trash className=\"w-5 h-5\" />\r\n                      </motion.button>\r\n                    </div>\r\n                  </motion.div>\r\n                ))}\r\n              </AnimatePresence>\r\n              \r\n              {selectedItems.length === 0 && (\r\n                <motion.div \r\n                  initial={{ opacity: 0 }}\r\n                  animate={{ opacity: 1 }}\r\n                  className=\"py-20 border-2 border-dashed border-border rounded-2xl text-center space-y-6\"\r\n                >\r\n                  <div className=\"w-20 h-20 bg-secondary rounded-2xl flex items-center justify-center mx-auto opacity-20 border border-border animate-float\">\r\n                    <ShoppingBag className=\"w-10 h-10 text-foreground\" />\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <p className=\"text-xl font-bold text-muted-foreground/40 uppercase tracking-widest\">Composer Empty</p>\r\n                    <p className=\"text-xs text-muted-foreground font-light italic max-w-xs mx-auto\">Initialize the plan by selecting clinical protocols or products from the available catalog.</p>\r\n                  </div>\r\n                </motion.div>\r\n              )}\r\n            </div>\r\n          </motion.section>\r\n        </div>\r\n\r\n        {/* Right Column: Preview & Summary */}\r\n        <div className=\"space-y-8\">\r\n          <motion.section \r\n            initial={{ opacity: 0, x: 20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.5 }}\r\n            className=\"bg-card p-8 rounded-2xl border border-border shadow-card space-y-8 relative overflow-hidden group\"\r\n          >\r\n            <div className=\"absolute top-0 right-0 p-8 opacity-5 group-hover:scale-110 transition-transform duration-700\">\r\n              <Sparkle className=\"w-24 h-24 text-primary\" />\r\n            </div>\r\n            \r\n            <div className=\"flex items-center gap-4 relative z-10\">\r\n              <div className=\"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary border border-primary/20\">\r\n                <Brain className=\"w-5 h-5\" />\r\n              </div>\r\n              <h3 className=\"text-sm font-bold text-foreground uppercase tracking-[0.2em]\">Intelligence Context</h3>\r\n            </div>\r\n\r\n            {aiAnalysis ? (\r\n              <div className=\"space-y-6 relative z-10\">\r\n                <div className=\"p-5 bg-primary/10 rounded-xl border border-primary/20 backdrop-blur-md\">\r\n                  <p className=\"text-[9px] text-primary font-bold uppercase tracking-[0.2em] mb-2\">Cutaneous Deviation</p>\r\n                  <p className=\"text-base font-bold text-foreground leading-tight\">{aiAnalysis.spots_detections?.[0]?.name || 'Dermal Mapping Active'}</p>\r\n                </div>\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div className=\"p-4 bg-secondary rounded-xl border border-border text-center\">\r\n                    <p className=\"text-[9px] text-muted-foreground font-bold uppercase tracking-widest mb-1\">Aura Score</p>\r\n                    <p className=\"text-2xl font-bold text-foreground tracking-tighter\">{aiAnalysis.overall_score}%</p>\r\n                  </div>\r\n                  <div className=\"p-4 bg-secondary rounded-xl border border-border text-center\">\r\n                    <p className=\"text-[9px] text-muted-foreground font-bold uppercase tracking-widest mb-1\">Dermal Age</p>\r\n                    <p className=\"text-2xl font-bold text-foreground tracking-tighter\">{aiAnalysis.skin_age || 24}</p>\r\n                  </div>\r\n                </div>\r\n                <Link href={`/analysis/results?id=${aiAnalysis.id}`} className=\"block\">\r\n                  <motion.button \r\n                    whileHover={{ x: 5 }}\r\n                    className=\"w-full py-4 bg-secondary border border-border rounded-xl text-[9px] font-bold uppercase tracking-[0.3em] text-foreground hover:bg-accent transition-all flex items-center justify-center gap-3 group/btn\"\r\n                  >\r\n                    Examine Full Report \r\n                    <ArrowRight className=\"w-4 h-4 group-hover/btn:translate-x-1 transition-transform\" />\r\n                  </motion.button>\r\n                </Link>\r\n              </div>\r\n            ) : (\r\n              <div className=\"py-10 text-center space-y-4 relative z-10\">\r\n                <div className=\"w-16 h-16 rounded-full border border-dashed border-border flex items-center justify-center mx-auto\">\r\n                  <SpinnerGap className=\"w-6 h-6 text-muted-foreground/20 animate-spin\" />\r\n                </div>\r\n                <div className=\"space-y-1\">\r\n                  <p className=\"text-xs text-muted-foreground font-light\">No cutaneous scan found.</p>\r\n                  <button className=\"text-[9px] font-bold text-primary uppercase tracking-[0.2em] hover:underline transition-colors\">Initialize Diagnostic</button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </motion.section>\r\n\r\n          <motion.section \r\n            initial={{ opacity: 0, x: 20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.6 }}\r\n            className=\"bg-card p-8 rounded-2xl border border-primary/30 bg-primary/5 space-y-10 relative overflow-hidden\"\r\n          >\r\n            <div className=\"absolute -bottom-12 -right-12 w-32 h-32 bg-primary/10 blur-[50px] rounded-full\" />\r\n            \r\n            <div className=\"space-y-6\">\r\n              <div className=\"space-y-3\">\r\n                <label className=\"text-[10px] font-bold text-muted-foreground uppercase tracking-[0.3em] ml-1\">Composition Title</label>\r\n                <input \r\n                  type=\"text\" \r\n                  placeholder=\"e.g. Aura Glow Protocol\"\r\n                  value={proposalTitle}\r\n                  onChange={(e) => setProposalTitle(e.target.value)}\r\n                  className=\"w-full bg-secondary border border-border rounded-xl py-4 px-6 text-foreground text-lg font-bold focus:outline-none focus:border-primary transition-all shadow-inner backdrop-blur-md\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-5 border-t border-border pt-8 relative z-10\">\r\n              <div className=\"flex justify-between items-center text-[11px] font-bold uppercase tracking-widest\">\r\n                <span className=\"text-muted-foreground\">Configured Nodes ({selectedItems.length})</span>\r\n                <span className=\"text-foreground tabular-nums\">เธฟ{calculateTotal().toLocaleString()}</span>\r\n              </div>\r\n              <div className=\"flex justify-between items-center text-[11px] font-bold uppercase tracking-widest\">\r\n                <span className=\"text-muted-foreground\">Neural Intelligence mapping</span>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span className=\"text-emerald-500\">Synced</span>\r\n                  <div className=\"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse\" />\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"pt-8 flex justify-between items-end border-t border-border mt-4\">\r\n                <div className=\"space-y-1\">\r\n                  <p className=\"text-[10px] font-bold text-muted-foreground uppercase tracking-[0.3em]\">Consolidated Value</p>\r\n                  <p className=\"text-4xl font-bold text-foreground tracking-tighter tabular-nums\">เธฟ{calculateTotal().toLocaleString()}</p>\r\n                </div>\r\n                <div className=\"w-14 h-14 rounded-2xl bg-primary/20 flex items-center justify-center text-primary border border-primary/20 shadow-premium\">\r\n                  <CurrencyDollar className=\"w-8 h-8\" />\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-4 pt-4 relative z-10\">\r\n              <div className=\"flex items-center gap-3 p-3 bg-secondary rounded-xl border border-border group hover:border-emerald-500/20 transition-all\">\r\n                <div className=\"w-8 h-8 rounded-xl bg-emerald-500/10 flex items-center justify-center text-emerald-500\">\r\n                  <CheckCircle className=\"w-4 h-4\" />\r\n                </div>\r\n                <p className=\"text-[9px] text-muted-foreground font-bold uppercase tracking-widest group-hover:text-emerald-500 transition-colors\">3D Genomic Visualization Included</p>\r\n              </div>\r\n              <div className=\"flex items-center gap-3 p-3 bg-secondary rounded-xl border border-border group hover:border-emerald-500/20 transition-all\">\r\n                <div className=\"w-8 h-8 rounded-xl bg-emerald-500/10 flex items-center justify-center text-emerald-500\">\r\n                  <CheckCircle className=\"w-4 h-4\" />\r\n                </div>\r\n                <p className=\"text-[9px] text-muted-foreground font-bold uppercase tracking-widest group-hover:text-emerald-500 transition-colors\">AI Personalized Diagnostics Active</p>\r\n              </div>\r\n            </div>\r\n          </motion.section>\r\n        </div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\sales\\proposals\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pulse' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":8,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pulse"},"fix":{"range":[128,138],"text":""},"desc":"Remove unused variable \"Pulse\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":7,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"User"},"fix":{"range":[179,188],"text":""},"desc":"Remove unused variable \"User\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CaretRight' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":13,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CaretRight"},"fix":{"range":[188,203],"text":""},"desc":"Remove unused variable \"CaretRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'IdentificationCard' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":21,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"IdentificationCard"},"fix":{"range":[203,226],"text":""},"desc":"Remove unused variable \"IdentificationCard\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Briefcase' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Briefcase"},"fix":{"range":[226,240],"text":""},"desc":"Remove unused variable \"Briefcase\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":12,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[268,282],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Monitor' is defined but never used.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Monitor"},"fix":{"range":[302,314],"text":""},"desc":"Remove unused variable \"Monitor\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sparkle' is defined but never used.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":10,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Sparkle"},"fix":{"range":[338,350],"text":""},"desc":"Remove unused variable \"Sparkle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":28,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardHeader"},"fix":{"range":[461,473],"text":""},"desc":"Remove unused variable \"CardHeader\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":28,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":37,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CardTitle"},"fix":{"range":[473,484],"text":""},"desc":"Remove unused variable \"CardTitle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useTranslations' is defined but never used.","line":33,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":25,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"useTranslations"},"fix":{"range":[746,790],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'goBack' is assigned a value but never used.","line":53,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":53,"endColumn":17},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'Funnel' is not defined.","line":208,"column":16,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":208,"endColumn":22},{"ruleId":"react/jsx-no-undef","severity":2,"message":"'SpinnerGap' is not defined.","line":219,"column":14,"nodeType":"JSXIdentifier","messageId":"undefined","endLine":219,"endColumn":24}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { \r\n  FileText, \r\n  Plus, \r\n  MagnifyingGlass, \r\n  Eye, \r\n  DownloadSimple, \r\n  CurrencyDollar,\r\n  Clock,\r\n  Pulse,\r\n  DotsThreeVertical,\r\n  PaperPlaneTilt,\r\n  User,\r\n  CaretRight,\r\n  IdentificationCard,\r\n  Briefcase,\r\n  CheckCircle,\r\n  Archive,\r\n  ArrowLeft,\r\n  ArrowsClockwise,\r\n  Monitor,\r\n  IdentificationBadge,\r\n  Sparkle,\r\n  Icon\r\n} from '@phosphor-icons/react';\r\nimport { StatCard } from '@/components/ui/StatCard';\r\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\r\nimport { Badge } from '@/components/ui/Badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport Breadcrumb from '@/components/ui/Breadcrumb';\r\nimport { useBackNavigation } from '@/hooks/useBackNavigation';\r\nimport { useTranslations } from 'next-intl';\r\nimport { cn } from '@/lib/utils';\r\nimport { useEffect, useState, useCallback, useMemo } from 'react';\r\nimport { createClient } from '@/lib/supabase/client';\r\nimport { Link } from '@/i18n/routing';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface Proposal {\r\n  id: string;\r\n  title: string;\r\n  total_value: number;\r\n  status: string;\r\n  created_at: string;\r\n  lead: {\r\n    name: string;\r\n    email: string;\r\n  };\r\n}\r\n\r\nexport default function ProposalsPage() {\r\n  const { goBack } = useBackNavigation();\r\n  const [proposals, setProposals] = useState<Proposal[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n\r\n  const supabase = createClient();\r\n\r\n  const fetchProposals = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('sales_proposals')\r\n        .select(`\r\n          *,\r\n          lead:lead_id (name, email)\r\n        `)\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n      setProposals((data as unknown as Proposal[]) || []);\r\n    } catch (err) {\r\n      console.error('Error fetching proposals:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [supabase]);\r\n\r\n  useEffect(() => {\r\n    fetchProposals();\r\n  }, [fetchProposals]);\r\n\r\n  const filteredProposals = proposals.filter(p => \r\n    p.title?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    p.lead?.name?.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  const stats = useMemo(() => ({\r\n    total: proposals.length,\r\n    volume: proposals.reduce((acc, p) => acc + (p.total_value || 0), 0),\r\n    accepted: proposals.filter(p => p.status === 'accepted').length,\r\n    pending: proposals.filter(p => p.status === 'sent' || p.status === 'draft').length\r\n  }), [proposals]);\r\n\r\n  return (\r\n    <motion.div \r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      className=\"space-y-8 pb-20 font-sans\"\r\n    >\r\n      <Breadcrumb />\r\n\r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\r\n        <div className=\"space-y-1\">\r\n          <motion.div \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\r\n          >\r\n            <FileText weight=\"duotone\" className=\"w-4 h-4\" />\r\n            Commercial Asset Registry\r\n          </motion.div>\r\n          <motion.h1 \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.1 }}\r\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\r\n          >\r\n            Digital <span className=\"text-primary\">Proposals</span>\r\n          </motion.h1>\r\n          <motion.p \r\n            initial={{ opacity: 0, x: -20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ delay: 0.2 }}\r\n            className=\"text-muted-foreground font-light text-sm italic\"\r\n          >\r\n            Orchestrating high-value aesthetic transformation proposals and commercial conversion nodes.\r\n          </motion.p>\r\n        </div>\r\n\r\n        <motion.div \r\n          initial={{ opacity: 0, scale: 0.9 }}\r\n          animate={{ opacity: 1, scale: 1 }}\r\n          transition={{ delay: 0.3 }}\r\n          className=\"flex flex-wrap items-center gap-3\"\r\n        >\r\n          <Button \r\n            variant=\"outline\"\r\n            onClick={fetchProposals}\r\n            disabled={loading}\r\n            className=\"gap-2 px-6 py-6 rounded-2xl text-xs font-black uppercase tracking-widest border-border/50 hover:bg-secondary group\"\r\n          >\r\n            <ArrowsClockwise weight=\"bold\" className={cn(\"w-4 h-4\", loading && \"animate-spin\")} />\r\n            Sync Vault\r\n          </Button>\r\n          <Link href=\"/sales/proposals/create\">\r\n            <Button className=\"gap-3 shadow-premium px-8 py-6 rounded-2xl text-xs font-black uppercase tracking-widest group\">\r\n              <Plus weight=\"bold\" className=\"w-4 h-4 group-hover:scale-110 transition-transform\" />\r\n              Generate Proposal\r\n            </Button>\r\n          </Link>\r\n        </motion.div>\r\n      </div>\r\n\r\n      {/* Stats Summary */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 px-2\">\r\n        <StatCard\r\n          title=\"Pipeline Volume\"\r\n          value={stats.volume}\r\n          prefix=\"เธฟ\"\r\n          icon={CurrencyDollar as Icon}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Accepted Nodes\"\r\n          value={stats.accepted}\r\n          icon={CheckCircle as Icon}\r\n          iconColor=\"text-emerald-500\"\r\n          trend=\"up\"\r\n          change={8.4}\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Pending Flux\"\r\n          value={stats.pending}\r\n          icon={Clock as Icon}\r\n          iconColor=\"text-amber-500\"\r\n          className=\"p-4\"\r\n        />\r\n        <StatCard\r\n          title=\"Dispatched Assets\"\r\n          value={stats.total}\r\n          icon={PaperPlaneTilt as Icon}\r\n          iconColor=\"text-primary\"\r\n          className=\"p-4\"\r\n        />\r\n      </div>\r\n\r\n      {/* Search & Intelligence Controls */}\r\n      <div className=\"px-2\">\r\n        <Card className=\"p-6 rounded-[32px] border-border/50 shadow-card relative overflow-hidden group\">\r\n          <div className=\"flex flex-col md:flex-row gap-6 relative z-10\">\r\n            <div className=\"relative flex-1 group/input\">\r\n              <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within/input:opacity-100 transition-opacity rounded-xl\" />\r\n              <MagnifyingGlass className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground/40 group-focus-within/input:text-primary transition-colors\" />\r\n              <input \r\n                type=\"text\" \r\n                placeholder=\"Query asset title, customer identity, or status node...\" \r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"w-full bg-secondary/50 border border-border rounded-2xl py-3.5 pl-12 pr-4 text-sm text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10 font-bold\"\r\n              />\r\n            </div>\r\n            \r\n            <Button variant=\"outline\" className=\"gap-2 px-8 py-3.5 rounded-2xl text-[10px] font-black uppercase tracking-widest border-border/50 hover:bg-secondary shrink-0\">\r\n              <Funnel weight=\"bold\" className=\"w-4 h-4\" />\r\n              Protocol Filters\r\n            </Button>\r\n          </div>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Proposals Matrix */}\r\n      <div className=\"px-2\">\r\n        {loading ? (\r\n          <div className=\"py-32 flex flex-col items-center justify-center gap-4 bg-card border border-border/50 rounded-[40px] shadow-inner\">\r\n            <SpinnerGap className=\"w-10 h-10 text-primary animate-spin\" />\r\n            <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest text-center\">Accessing Secure Asset Vault...</p>\r\n          </div>\r\n        ) : filteredProposals.length > 0 ? (\r\n          <div className=\"grid grid-cols-1 gap-6\">\r\n            <AnimatePresence mode=\"popLayout\">\r\n              {filteredProposals.map((p, i) => (\r\n                <motion.div\r\n                  key={p.id}\r\n                  layout\r\n                  initial={{ opacity: 0, x: -20 }}\r\n                  animate={{ opacity: 1, x: 0 }}\r\n                  exit={{ opacity: 0, scale: 0.95 }}\r\n                  transition={{ delay: i * 0.05 }}\r\n                >\r\n                  <Card className=\"rounded-[40px] border-border/50 hover:border-primary/30 shadow-card hover:shadow-card-hover transition-all group overflow-hidden\">\r\n                    <div className=\"absolute top-0 right-0 p-8 opacity-[0.02] group-hover:scale-110 transition-transform duration-700 pointer-events-none\">\r\n                      <Archive className=\"w-48 h-48 text-primary\" />\r\n                    </div>\r\n\r\n                    <CardContent className=\"p-8 relative z-10\">\r\n                      <div className=\"flex flex-col xl:flex-row xl:items-center justify-between gap-10\">\r\n                        <div className=\"flex items-center gap-8 min-w-0\">\r\n                          <div className=\"w-16 h-16 rounded-3xl bg-secondary border border-border/50 flex items-center justify-center text-primary group-hover:bg-primary/10 transition-all duration-500 shadow-inner\">\r\n                            <FileText weight=\"duotone\" className=\"w-8 h-8\" />\r\n                          </div>\r\n                          <div className=\"space-y-2 min-w-0\">\r\n                            <h3 className=\"text-xl font-black text-foreground group-hover:text-primary transition-colors tracking-tight truncate uppercase leading-tight\">\r\n                              {p.title}\r\n                            </h3>\r\n                            <div className=\"flex flex-wrap items-center gap-4 text-[10px] font-black text-muted-foreground uppercase tracking-widest\">\r\n                              <span className=\"flex items-center gap-2\">\r\n                                <IdentificationBadge weight=\"bold\" className=\"w-3.5 h-3.5 text-primary/60\" /> \r\n                                {p.lead?.name || 'ANONYMOUS_NODE'}\r\n                              </span>\r\n                              <div className=\"w-1 h-1 rounded-full bg-border\" />\r\n                              <span className=\"flex items-center gap-2\">\r\n                                <Clock weight=\"bold\" className=\"w-3.5 h-3.5 text-primary/60\" /> \r\n                                NODE_SYNC: {new Date(p.created_at).toLocaleDateString()}\r\n                              </span>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex flex-col sm:flex-row items-start sm:items-center gap-10 xl:gap-16\">\r\n                          <div className=\"space-y-1.5 min-w-[160px]\">\r\n                            <p className=\"text-[8px] font-black text-muted-foreground uppercase tracking-[0.3em] opacity-60\">Fiscal Valuation</p>\r\n                            <div className=\"flex items-baseline gap-2\">\r\n                              <span className=\"text-2xl font-black text-foreground tabular-nums tracking-tighter\">\r\n                                เธฟ{Number(p.total_value).toLocaleString()}\r\n                              </span>\r\n                              <Badge variant=\"ghost\" className=\"bg-emerald-500/5 text-emerald-500 border-none font-black text-[8px] uppercase px-2 py-0.5\">PREMIUM</Badge>\r\n                            </div>\r\n                          </div>\r\n\r\n                          <div className=\"flex items-center gap-6\">\r\n                            <Badge \r\n                              variant={\r\n                                p.status === 'accepted' ? 'success' : \r\n                                p.status === 'sent' ? 'default' : \r\n                                'secondary'\r\n                              }\r\n                              className=\"font-black uppercase text-[9px] tracking-[0.2em] px-5 py-2 rounded-full shadow-sm\"\r\n                            >\r\n                              {p.status.toUpperCase()}\r\n                            </Badge>\r\n\r\n                            <div className=\"flex items-center gap-2.5\">\r\n                              <Button variant=\"outline\" size=\"sm\" className=\"h-12 w-12 p-0 rounded-2xl border-border/50 hover:bg-secondary group/action\">\r\n                                <Eye weight=\"bold\" className=\"w-5 h-5 text-muted-foreground group-hover/action:text-primary transition-colors\" />\r\n                              </Button>\r\n                              <Button variant=\"outline\" size=\"sm\" className=\"h-12 w-12 p-0 rounded-2xl border-border/50 hover:bg-secondary group/action\">\r\n                                <DownloadSimple weight=\"bold\" className=\"w-5 h-5 text-muted-foreground group-hover/action:text-primary transition-colors\" />\r\n                              </Button>\r\n                              <Button variant=\"ghost\" size=\"sm\" className=\"h-12 w-12 p-0 rounded-2xl hover:bg-secondary border border-transparent hover:border-border/50\">\r\n                                <DotsThreeVertical weight=\"bold\" className=\"w-5 h-5\" />\r\n                              </Button>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                </motion.div>\r\n              ))}\r\n            </AnimatePresence>\r\n          </div>\r\n        ) : (\r\n          <Card variant=\"ghost\" className=\"py-48 border-2 border-dashed border-border/50 flex flex-col items-center justify-center gap-8 opacity-40 rounded-[48px]\">\r\n            <div className=\"w-24 h-24 rounded-[40px] bg-secondary border border-border/50 flex items-center justify-center text-muted-foreground shadow-inner\">\r\n              <FileText weight=\"duotone\" className=\"w-12 h-12\" />\r\n            </div>\r\n            <div className=\"text-center space-y-3\">\r\n              <h3 className=\"text-2xl font-black text-foreground uppercase tracking-widest\">\r\n                {searchTerm ? 'Zero Search Correlates' : 'Proposal Vault Empty'}\r\n              </h3>\r\n              <p className=\"text-sm text-muted-foreground font-medium italic max-w-sm mx-auto leading-relaxed\">\r\n                {searchTerm ? 'Adjust query parameters to expand the search horizon.' : 'No digital aesthetic proposals established in this clinical sector.'}\r\n              </p>\r\n            </div>\r\n            {!searchTerm && (\r\n              <Link href=\"/sales/proposals/create\">\r\n                <Button variant=\"ghost\" className=\"text-primary font-black uppercase tracking-[0.3em] gap-3 px-8 py-4 rounded-2xl border border-dashed border-primary/20 hover:bg-primary/5 transition-all\">\r\n                  <Plus weight=\"bold\" className=\"w-4 h-4\" />\r\n                  Initialize First Node\r\n                </Button>\r\n              </Link>\r\n            )}\r\n          </Card>\r\n        )}\r\n      </div>\r\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\sales\\workflow\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(dashboard)\\shared\\chat\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Invalid character.","line":56,"column":9}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect, useRef } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  PaperPlaneTilt, \n  ChatCircle, \n  User, \n  Users,\n  MagnifyingGlass,\n  DotsThreeVertical,\n  Phone,\n  VideoCamera,\n  ArrowLeft,\n  Monitor,\n  Lightning,\n  CheckCircle,\n  Clock,\n  Plus,\n  Funnel,\n  IdentificationCard,\n  Icon\n} from '@phosphor-icons/react';\nimport { cn } from '@/lib/utils';\nimport { useAuth } from '@/hooks/useAuth';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/Card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/Badge';\nimport Breadcrumb from '@/components/ui/Breadcrumb';\n\ninterface ChatSession {\n  id: string;\n  customer_id: string;\n  sales_staff_id: string;\n  customer_name: string;\n  sales_name: string;\n  last_message: string;\n  last_message_at: string;\n  unread_count: number;\n}\n\ninterface Message {\n  id: string;\n  content: string;\n  sender_type: 'customer' | 'sales';\n  sender_id: string;\n  created_at: string;\n  is_read: boolean;\n}\n\n// Format time consistently to avoid hydration mismatch\nfunction formatTime(dateStr: string): string {\n  const date = new Date(dateStr);\n  const hours = date.getHours().toString().padStart(2, '0');\n  const minutes = date.getMinutes().toString().padStart(2, '0');\n  return \\\\:\\\\;\n}\n\nfunction formatDate(dateStr: string): string {\n  const date = new Date(dateStr);\n  const today = new Date();\n  const yesterday = new Date(today);\n  yesterday.setDate(yesterday.getDate() - 1);\n  \n  if (date.toDateString() === today.toDateString()) {\n    return 'Today';\n  } else if (date.toDateString() === yesterday.toDateString()) {\n    return 'Yesterday';\n  }\n  return date.toLocaleDateString('th-TH', { day: 'numeric', month: 'short' });\n}\n\nexport default function SharedChatPage() {\n  const { user, getUserRole } = useAuth();\n  const [isClient, setIsClient] = useState(false);\n  const [sessions, setSessions] = useState<ChatSession[]>([]);\n  const [selectedSession, setSelectedSession] = useState<ChatSession | null>(null);\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [input, setInput] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [searchQuery, setSearchQuery] = useState('');\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  \n  const userRole = getUserRole();\n  const isCustomer = ['customer', 'free_user', 'free_customer', 'premium_customer'].includes(userRole);\n  const isSales = userRole === 'sales_staff';\n\n  useEffect(() => {\n    setIsClient(true);\n  }, []);\n\n  useEffect(() => {\n    if (user) {\n      fetchChatSessions();\n    }\n  }, [user]);\n\n  useEffect(() => {\n    if (selectedSession) {\n      fetchMessages(selectedSession.id);\n    }\n  }, [selectedSession]);\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  const fetchChatSessions = async () => {\n    try {\n      setLoading(true);\n      const response = await fetch('/api/chat?action=sessions');\n      if (response.ok) {\n        const data = await response.json();\n        setSessions(data.sessions || []);\n      }\n    } catch (error) {\n      console.error('Error fetching chat sessions:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchMessages = async (sessionId: string) => {\n    try {\n      const response = await fetch(\\/api/chat?action=history&sessionId=\\\\);\n      if (response.ok) {\n        const data = await response.json();\n        setMessages(data.messages || []);\n      }\n    } catch (error) {\n      console.error('Error fetching messages:', error);\n    }\n  };\n\n  const handleSend = async () => {\n    if (!input.trim() || !selectedSession) return;\n    \n    const newMessage: Message = {\n      id: Date.now().toString(),\n      content: input,\n      sender_type: isCustomer ? 'customer' : 'sales',\n      sender_id: user?.id || '',\n      created_at: new Date().toISOString(),\n      is_read: false\n    };\n    \n    setMessages(prev => [...prev, newMessage]);\n    setInput('');\n\n    try {\n      await fetch('/api/chat', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          action: 'send',\n          sessionId: selectedSession.id,\n          content: input\n        })\n      });\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n\n  const filteredSessions = sessions.filter(session => \n    session.customer_name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    session.sales_name.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const getOtherPartyName = (session: ChatSession) => {\n    if (isCustomer) return session.sales_name || 'My Sales Advisor';\n    return session.customer_name || 'Customer';\n  };\n\n  if (!isClient) {\n    return (\n      <div className=\"h-[calc(100vh-160px)] flex flex-col items-center justify-center space-y-6\">\n        <SpinnerGap className=\"w-12 h-12 text-primary animate-spin\" />\n        <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-[0.3em] animate-pulse\">Initializing Neural Link...</p>\n      </div>\n    );\n  }\n\n  return (\n    <motion.div \n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"h-[calc(100vh-120px)] flex flex-col space-y-6 pb-4 font-sans\"\n    >\n      <Breadcrumb />\n\n      {/* Header Section */}\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 px-2\">\n        <div className=\"space-y-1\">\n          <motion.div \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            className=\"flex items-center gap-2 text-primary text-[10px] font-black uppercase tracking-[0.3em]\"\n          >\n            <ChatCircle weight=\"duotone\" className=\"w-4 h-4\" />\n            Neural Communication Node\n          </motion.div>\n          <motion.h1 \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.1 }}\n            className=\"text-4xl font-heading font-bold text-foreground tracking-tight uppercase\"\n          >\n            Global <span className=\"text-primary\">Chat</span>\n          </motion.h1>\n          <motion.p \n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-muted-foreground font-light text-sm italic\"\n          >\n            {isCustomer ? 'Synchronizing with your dedicated clinical advisor.' : 'Orchestrating active customer dialogue streams and identity nodes.'}\n          </motion.p>\n        </div>\n      </div>\n\n      {/* Main Chat Interface Matrix */}\n      <div className=\"flex-1 flex overflow-hidden rounded-[40px] border border-border/50 shadow-premium bg-card relative\">\n        <div className=\"absolute inset-0 bg-scanner-grid opacity-[0.02] pointer-events-none\" />\n        \n        {/* Sessions List Hub */}\n        <div className={cn(\n          \"w-full md:w-96 border-r border-border/50 flex flex-col bg-secondary/10 relative z-10\",\n          selectedSession && \"hidden md:flex\"\n        )}>\n          {/* Registry Search */}\n          <div className=\"p-6 border-b border-border/50\">\n            <div className=\"relative group\">\n              <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-2xl\" />\n              <MagnifyingGlass weight=\"bold\" className=\"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/40 group-focus-within:text-primary transition-colors\" />\n              <input \n                type=\"text\" \n                placeholder=\"Query identity nodes...\" \n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"w-full bg-card border border-border/50 rounded-2xl py-3 pl-11 pr-4 text-xs font-black uppercase tracking-widest text-foreground focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\n              />\n            </div>\n          </div>\n\n          {/* Session Registry */}\n          <div className=\"flex-1 overflow-y-auto custom-scrollbar p-2 space-y-2\">\n            {loading ? (\n              <div className=\"py-20 flex flex-col items-center gap-4 opacity-40\">\n                <SpinnerGap className=\"w-8 h-8 text-primary animate-spin\" />\n                <p className=\"text-[10px] font-black text-muted-foreground uppercase tracking-widest\">Syncing Matrix...</p>\n              </div>\n            ) : filteredSessions.length === 0 ? (\n              <div className=\"py-20 text-center opacity-40 space-y-4\">\n                <ChatCircle weight=\"duotone\" className=\"w-12 h-12 mx-auto mb-3\" />\n                <p className=\"text-[10px] font-black uppercase tracking-[0.2em]\">Registry Nominal</p>\n              </div>\n            ) : (\n              filteredSessions.map((session) => (\n                <button\n                  key={session.id}\n                  onClick={() => setSelectedSession(session)}\n                  className={cn(\n                    \"w-full p-5 flex items-start gap-4 rounded-[28px] transition-all duration-500 group relative overflow-hidden border border-transparent\",\n                    selectedSession?.id === session.id \n                      ? \"bg-primary/10 border-primary/20 shadow-sm\" \n                      : \"hover:bg-card hover:border-border/50 shadow-none\"\n                  )}\n                >\n                  <div className=\"w-12 h-12 rounded-2xl bg-secondary border border-border/50 flex items-center justify-center flex-shrink-0 group-hover:scale-110 transition-transform shadow-inner\">\n                    <User weight=\"duotone\" className=\"w-6 h-6 text-primary\" />\n                  </div>\n                  <div className=\"flex-1 min-w-0 text-left relative z-10\">\n                    <div className=\"flex items-center justify-between mb-1\">\n                      <span className=\"text-sm font-black text-foreground truncate uppercase tracking-tight\">\n                        {getOtherPartyName(session)}\n                      </span>\n                      <span className=\"text-[9px] font-bold text-muted-foreground tabular-nums uppercase\">\n                        {formatDate(session.last_message_at)}\n                      </span>\n                    </div>\n                    <p className=\"text-[11px] text-muted-foreground font-medium italic truncate opacity-80 leading-relaxed\">\n                      {session.last_message || 'Awaiting transmission...'}\n                    </p>\n                  </div>\n                  {session.unread_count > 0 && (\n                    <span className=\"w-5 h-5 rounded-full bg-primary text-[9px] font-black flex items-center justify-center text-primary-foreground shadow-glow-sm relative z-10\">\n                      {session.unread_count}\n                    </span>\n                  )}\n                </button>\n              ))\n            )}\n          </div>\n        </div>\n\n        {/* Terminal Chat Node Area */}\n        <div className={cn(\n          \"flex-1 flex flex-col bg-card/50 relative z-10\",\n          !selectedSession && \"hidden md:flex\"\n        )}>\n          {selectedSession ? (\n            <>\n              {/* Node Header */}\n              <div className=\"p-6 border-b border-border/50 flex items-center gap-5 bg-secondary/10 backdrop-blur-md\">\n                <Button\n                  variant=\"ghost\"\n                  onClick={() => setSelectedSession(null)}\n                  className=\"md:hidden p-3 h-11 w-11 rounded-xl hover:bg-card border-border/50\"\n                >\n                  <ArrowLeft weight=\"bold\" className=\"w-5 h-5\" />\n                </Button>\n                <div className=\"w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center border border-primary/20 shadow-inner\">\n                  <User weight=\"duotone\" className=\"w-6 h-6 text-primary\" />\n                </div>\n                <div className=\"flex-1 min-w-0\">\n                  <div className=\"flex items-center gap-3\">\n                    <h3 className=\"text-base font-black text-foreground uppercase tracking-tight truncate\">\n                      {getOtherPartyName(selectedSession)}\n                    </h3>\n                    <div className=\"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse shadow-[0_0_8px_rgba(16,185,129,0.6)]\" />\n                  </div>\n                  <div className=\"flex items-center gap-2 text-[9px] font-black text-muted-foreground uppercase tracking-widest opacity-60\">\n                    <Badge variant=\"ghost\" className=\"bg-primary/5 text-primary border-none text-[8px] px-2 py-0.5 tracking-tighter uppercase\">LINK_ESTABLISHED</Badge>\n                    <span>ID: {selectedSession.id.slice(0, 8).toUpperCase()}</span>\n                  </div>\n                </div>\n                <div className=\"flex gap-2.5\">\n                  <Button variant=\"outline\" size=\"sm\" className=\"h-11 w-11 p-0 rounded-2xl border-border/50 hover:bg-secondary\">\n                    <Phone weight=\"bold\" className=\"w-4.5 h-4.5 text-muted-foreground hover:text-primary transition-colors\" />\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" className=\"h-11 w-11 p-0 rounded-2xl border-border/50 hover:bg-secondary\">\n                    <DotsThreeVertical weight=\"bold\" className=\"w-4.5 h-4.5 text-muted-foreground hover:text-primary transition-colors\" />\n                  </Button>\n                </div>\n              </div>\n\n              {/* Message Matrix Stream */}\n              <div className=\"flex-1 overflow-y-auto custom-scrollbar p-8 space-y-6\">\n                <AnimatePresence mode=\"popLayout\">\n                  {messages.map((msg, i) => {\n                    const isOwnMessage = (isCustomer && msg.sender_type === 'customer') || \n                                         (!isCustomer && msg.sender_type === 'sales');\n                    return (\n                      <motion.div\n                        key={msg.id}\n                        initial={{ opacity: 0, y: 10, scale: 0.95 }}\n                        animate={{ opacity: 1, y: 0, scale: 1 }}\n                        transition={{ delay: i * 0.05 }}\n                        className={cn(\n                          \"flex group/msg\",\n                          isOwnMessage ? \"justify-end\" : \"justify-start\"\n                        )}\n                      >\n                        <div className={cn(\n                          \"max-w-[70%] space-y-2\",\n                          isOwnMessage ? \"items-end\" : \"items-start\"\n                        )}>\n                          <div className={cn(\n                            \"rounded-[28px] px-6 py-4 shadow-card transition-all relative overflow-hidden\",\n                            isOwnMessage \n                              ? \"bg-primary text-primary-foreground rounded-br-sm shadow-glow-sm\" \n                              : \"bg-secondary/50 border border-border/50 text-foreground rounded-bl-sm shadow-inner\"\n                          )}>\n                            <div className=\"absolute inset-0 bg-white/5 opacity-0 group-hover/msg:opacity-100 transition-opacity\" />\n                            <p className=\"text-sm font-medium leading-relaxed relative z-10\">{msg.content}</p>\n                          </div>\n                          <div className={cn(\n                            \"flex items-center gap-3 px-2 text-[9px] font-black uppercase tracking-[0.2em] opacity-40 group-hover/msg:opacity-100 transition-opacity\",\n                            isOwnMessage ? \"justify-end\" : \"justify-start\"\n                          )}>\n                            <Clock weight=\"bold\" className=\"w-3 h-3\" />\n                            <span>{formatTime(msg.created_at)}</span>\n                            {isOwnMessage && msg.is_read && (\n                              <CheckCircle weight=\"fill\" className=\"w-3 h-3 text-emerald-500\" />\n                            )}\n                          </div>\n                        </div>\n                      </motion.div>\n                    );\n                  })}\n                </AnimatePresence>\n                <div ref={messagesEndRef} />\n              </div>\n\n              {/* Payload Transmission Interface */}\n              <div className=\"p-6 border-t border-border/50 bg-secondary/10\">\n                <div className=\"flex gap-4 relative\">\n                  <div className=\"absolute inset-0 bg-primary/5 blur-xl opacity-0 focus-within:opacity-100 transition-opacity rounded-3xl\" />\n                  <input\n                    type=\"text\"\n                    value={input}\n                    onChange={(e) => setInput(e.target.value)}\n                    onKeyDown={(e) => e.key === 'Enter' && handleSend()}\n                    placeholder=\"Compose neural payload...\"\n                    className=\"flex-1 bg-card border border-border/50 rounded-[24px] py-4 px-8 text-sm font-bold text-foreground placeholder:text-muted-foreground/40 focus:outline-none focus:border-primary transition-all shadow-inner relative z-10\"\n                  />\n                  <Button\n                    onClick={handleSend}\n                    disabled={!input.trim()}\n                    className=\"h-[52px] w-[52px] p-0 rounded-2xl shadow-premium shrink-0 relative z-10 group/send\"\n                  >\n                    <PaperPlaneTilt weight=\"bold\" className=\"w-5 h-5 group-hover/send:-rotate-12 group-hover/send:scale-110 transition-all\" />\n                  </Button>\n                </div>\n              </div>\n            </>\n          ) : (\n            <div className=\"flex-1 flex items-center justify-center p-10\">\n              <div className=\"text-center space-y-8 opacity-40\">\n                <div className=\"w-24 h-24 rounded-[48px] bg-secondary border border-border flex items-center justify-center mx-auto shadow-inner group\">\n                  <ChatCircle weight=\"duotone\" className=\"w-12 h-12 text-muted-foreground group-hover:text-primary transition-colors\" />\n                </div>\n                <div className=\"space-y-3\">\n                  <h3 className=\"text-2xl font-black text-foreground uppercase tracking-widest\">Select Protocol</h3>\n                  <p className=\"text-sm text-muted-foreground font-medium max-w-xs mx-auto leading-relaxed italic\">\n                    Choose a conversation from the identity hub to establish a secure communication uplink.\n                  </p>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(public)\\book\\[clinicCode]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":142,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":142,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":176,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":176,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useParams } from 'next/navigation';\nimport { CalendarDots, Clock, User, Phone, EnvelopeSimple, CreditCard, Gift, CaretLeft, CaretRight, Check, SpinnerGap } from '@phosphor-icons/react';\n\ninterface Service {\n  id: string;\n  name: { th: string; en: string };\n  description?: { th: string; en: string };\n  duration_minutes: number;\n  price: number;\n  deposit_required: number;\n  category?: string;\n  image_url?: string;\n}\n\ninterface TimeSlot {\n  time: string;\n  available: boolean;\n}\n\ninterface BookingSettings {\n  minAdvanceHours: number;\n  maxAdvanceDays: number;\n  slotDuration: number;\n  workingHours: Record<string, { open: string; close: string; enabled: boolean }>;\n  requireDeposit: boolean;\n  depositAmount: number;\n  depositPercentage: number;\n  cancellationHours: number;\n  theme: { primaryColor: string; borderRadius: string };\n}\n\nexport default function PublicBookingPage() {\n  const params = useParams();\n  const clinicCode = params.clinicCode as string;\n  const locale = (params.locale as string) || 'th';\n\n  const [step, setStep] = useState(1);\n  const [loading, setLoading] = useState(true);\n  const [submitting, setSubmitting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState(false);\n\n  const [clinic, setClinic] = useState<{ id: string; display_name: { th: string; en: string } } | null>(null);\n  const [settings, setSettings] = useState<BookingSettings | null>(null);\n  const [services, setServices] = useState<Service[]>([]);\n\n  const [selectedService, setSelectedService] = useState<Service | null>(null);\n  const [selectedDate, setSelectedDate] = useState<Date | null>(null);\n  const [selectedTime, setSelectedTime] = useState<string | null>(null);\n  const [timeSlots, setTimeSlots] = useState<TimeSlot[]>([]);\n  const [loadingSlots, setLoadingSlots] = useState(false);\n\n  const [customerInfo, setCustomerInfo] = useState({\n    name: '',\n    phone: '',\n    email: '',\n    notes: ''\n  });\n\n  const [giftCardCode, setGiftCardCode] = useState('');\n  const [giftCardValid, setGiftCardValid] = useState<boolean | null>(null);\n  const [giftCardDiscount, setGiftCardDiscount] = useState(0);\n\n  // Fetch clinic data\n  useEffect(() => {\n    const fetchClinicData = async () => {\n      try {\n        setLoading(true);\n        const res = await fetch(`/api/booking/public?clinic_code=${clinicCode}`);\n        \n        if (!res.ok) {\n          throw new Error('Clinic not found or booking not available');\n        }\n\n        const data = await res.json();\n        setClinic(data.clinic);\n        setSettings(data.settings);\n        setServices(data.services);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to load booking');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    if (clinicCode) {\n      fetchClinicData();\n    }\n  }, [clinicCode]);\n\n  // Fetch time slots when date changes\n  useEffect(() => {\n    const fetchSlots = async () => {\n      if (!selectedService || !selectedDate || !clinic) return;\n\n      try {\n        setLoadingSlots(true);\n        const dateStr = selectedDate.toISOString().split('T')[0];\n        const res = await fetch(\n          `/api/booking/slots?clinic_id=${clinic.id}&service_id=${selectedService.id}&date=${dateStr}`\n        );\n\n        if (res.ok) {\n          const data = await res.json();\n          setTimeSlots(data.slots);\n        }\n      } catch (err) {\n        console.error('Failed to fetch slots:', err);\n      } finally {\n        setLoadingSlots(false);\n      }\n    };\n\n    fetchSlots();\n  }, [selectedService, selectedDate, clinic]);\n\n  // Validate gift card\n  const validateGiftCard = async () => {\n    if (!giftCardCode || !clinic) return;\n\n    try {\n      const res = await fetch('/api/gift-cards/validate', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ code: giftCardCode, clinicId: clinic.id })\n      });\n\n      const data = await res.json();\n      setGiftCardValid(data.valid);\n      \n      if (data.valid && selectedService) {\n        if (data.giftCard.type === 'value') {\n          setGiftCardDiscount(Math.min(data.giftCard.balance, selectedService.price));\n        } else if (data.giftCard.type === 'percentage') {\n          const discount = (selectedService.price * data.giftCard.discountPercentage) / 100;\n          setGiftCardDiscount(Math.min(discount, data.giftCard.maxDiscount || discount));\n        }\n      }\n    } catch (err) {\n      setGiftCardValid(false);\n    }\n  };\n\n  // Submit booking\n  const handleSubmit = async () => {\n    if (!clinic || !selectedService || !selectedDate || !selectedTime) return;\n\n    try {\n      setSubmitting(true);\n      const dateStr = selectedDate.toISOString().split('T')[0];\n\n      const res = await fetch('/api/booking/create', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          clinicId: clinic.id,\n          serviceId: selectedService.id,\n          date: dateStr,\n          time: selectedTime,\n          customerInfo,\n          notes: customerInfo.notes,\n          giftCardCode: giftCardValid ? giftCardCode : undefined\n        })\n      });\n\n      const data = await res.json();\n\n      if (data.success) {\n        setSuccess(true);\n      } else {\n        setError(data.error || 'Booking failed');\n      }\n    } catch (err) {\n      setError('Failed to create booking');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Generate calendar dates\n  const generateDates = () => {\n    if (!settings) return [];\n\n    const dates: Date[] = [];\n    const today = new Date();\n    const maxDate = new Date();\n    maxDate.setDate(today.getDate() + settings.maxAdvanceDays);\n\n    const current = new Date(today);\n    current.setHours(0, 0, 0, 0);\n\n    while (current <= maxDate) {\n      const dayName = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'][current.getDay()];\n      if (settings.workingHours[dayName]?.enabled) {\n        dates.push(new Date(current));\n      }\n      current.setDate(current.getDate() + 1);\n    }\n\n    return dates;\n  };\n\n  const formatPrice = (price: number) => {\n    return new Intl.NumberFormat(locale === 'th' ? 'th-TH' : 'en-US', {\n      style: 'currency',\n      currency: 'THB',\n      minimumFractionDigits: 0\n    }).format(price);\n  };\n\n  const formatDate = (date: Date) => {\n    return date.toLocaleDateString(locale === 'th' ? 'th-TH' : 'en-US', {\n      weekday: 'short',\n      day: 'numeric',\n      month: 'short'\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <SpinnerGap className=\"w-8 h-8 animate-spin text-indigo-600\" />\n      </div>\n    );\n  }\n\n  if (error && !clinic) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">\n            {locale === 'th' ? 'เนเธกเนเธเธเธเธฅเธดเธเธดเธ' : 'Clinic Not Found'}\n          </h1>\n          <p className=\"text-gray-600\">{error}</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (success) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50 p-4\">\n        <div className=\"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full text-center\">\n          <div className=\"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n            <Check className=\"w-8 h-8 text-green-600\" />\n          </div>\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">\n            {locale === 'th' ? 'เธเธญเธเธชเธณเน€เธฃเนเธ!' : 'Booking Confirmed!'}\n          </h1>\n          <p className=\"text-gray-600 mb-4\">\n            {locale === 'th' \n              ? 'เน€เธฃเธฒเธเธฐเธชเนเธเธเนเธญเธเธงเธฒเธกเธขเธทเธเธขเธฑเธเนเธเธขเธฑเธเธซเธกเธฒเธขเน€เธฅเธเนเธ—เธฃเธจเธฑเธเธ—เนเธเธญเธเธเธธเธ“'\n              : 'A confirmation will be sent to your phone number'}\n          </p>\n          <div className=\"bg-gray-50 rounded-lg p-4 text-left\">\n            <p className=\"font-medium\">{selectedService?.name[locale as 'th' | 'en']}</p>\n            <p className=\"text-sm text-gray-600\">\n              {selectedDate && formatDate(selectedDate)} โ€ข {selectedTime}\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const availableDates = generateDates();\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 py-8 px-4\">\n      <div className=\"max-w-2xl mx-auto\">\n        {/* Header */}\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-2xl font-bold text-gray-900\">\n            {clinic?.display_name[locale as 'th' | 'en']}\n          </h1>\n          <p className=\"text-gray-600\">\n            {locale === 'th' ? 'เธเธญเธเธเธฑเธ”เธซเธกเธฒเธขเธญเธญเธเนเธฅเธเน' : 'Book an Appointment'}\n          </p>\n        </div>\n\n        {/* Progress Steps */}\n        <div className=\"flex items-center justify-center mb-8\">\n          {[1, 2, 3, 4].map((s) => (\n            <div key={s} className=\"flex items-center\">\n              <div\n                className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${\n                  step >= s\n                    ? 'bg-indigo-600 text-white'\n                    : 'bg-gray-200 text-gray-600'\n                }`}\n              >\n                {s}\n              </div>\n              {s < 4 && (\n                <div\n                  className={`w-12 h-1 ${\n                    step > s ? 'bg-indigo-600' : 'bg-gray-200'\n                  }`}\n                />\n              )}\n            </div>\n          ))}\n        </div>\n\n        {/* Content */}\n        <div className=\"bg-white rounded-2xl shadow-lg p-6\">\n          {/* Step 1: Select Service */}\n          {step === 1 && (\n            <div>\n              <h2 className=\"text-lg font-semibold mb-4\">\n                {locale === 'th' ? 'เน€เธฅเธทเธญเธเธเธฃเธดเธเธฒเธฃ' : 'Select Service'}\n              </h2>\n              <div className=\"space-y-3\">\n                {services.map((service) => (\n                  <button\n                    key={service.id}\n                    onClick={() => {\n                      setSelectedService(service);\n                      setStep(2);\n                    }}\n                    className={`w-full p-4 rounded-xl border-2 text-left transition-all ${\n                      selectedService?.id === service.id\n                        ? 'border-indigo-600 bg-indigo-50'\n                        : 'border-gray-200 hover:border-indigo-300'\n                    }`}\n                  >\n                    <div className=\"flex justify-between items-start\">\n                      <div>\n                        <p className=\"font-medium text-gray-900\">\n                          {service.name[locale as 'th' | 'en']}\n                        </p>\n                        {service.description && (\n                          <p className=\"text-sm text-gray-600 mt-1\">\n                            {service.description[locale as 'th' | 'en']}\n                          </p>\n                        )}\n                        <div className=\"flex items-center gap-3 mt-2 text-sm text-gray-500\">\n                          <span className=\"flex items-center gap-1\">\n                            <Clock className=\"w-4 h-4\" />\n                            {service.duration_minutes} {locale === 'th' ? 'เธเธฒเธ—เธต' : 'min'}\n                          </span>\n                        </div>\n                      </div>\n                      <p className=\"font-semibold text-indigo-600\">\n                        {formatPrice(service.price)}\n                      </p>\n                    </div>\n                  </button>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Step 2: Select Date & Time */}\n          {step === 2 && selectedService && (\n            <div>\n              <h2 className=\"text-lg font-semibold mb-4\">\n                {locale === 'th' ? 'เน€เธฅเธทเธญเธเธงเธฑเธเนเธฅเธฐเน€เธงเธฅเธฒ' : 'Select Date & Time'}\n              </h2>\n\n              {/* Date Selection */}\n              <div className=\"mb-6\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  <CalendarDots className=\"w-4 h-4 inline mr-1\" />\n                  {locale === 'th' ? 'เธงเธฑเธเธ—เธตเน' : 'Date'}\n                </label>\n                <div className=\"flex gap-2 overflow-x-auto pb-2\">\n                  {availableDates.slice(0, 14).map((date, idx) => (\n                    <button\n                      key={idx}\n                      onClick={() => {\n                        setSelectedDate(date);\n                        setSelectedTime(null);\n                      }}\n                      className={`flex-shrink-0 px-4 py-3 rounded-lg text-center ${\n                        selectedDate?.toDateString() === date.toDateString()\n                          ? 'bg-indigo-600 text-white'\n                          : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                      }`}\n                    >\n                      <p className=\"text-xs font-medium\">\n                        {date.toLocaleDateString(locale === 'th' ? 'th-TH' : 'en-US', { weekday: 'short' })}\n                      </p>\n                      <p className=\"text-lg font-bold\">{date.getDate()}</p>\n                    </button>\n                  ))}\n                </div>\n              </div>\n\n              {/* Time Selection */}\n              {selectedDate && (\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    <Clock className=\"w-4 h-4 inline mr-1\" />\n                    {locale === 'th' ? 'เน€เธงเธฅเธฒ' : 'Time'}\n                  </label>\n                  {loadingSlots ? (\n                    <div className=\"flex justify-center py-8\">\n                      <SpinnerGap className=\"w-6 h-6 animate-spin text-indigo-600\" />\n                    </div>\n                  ) : (\n                    <div className=\"grid grid-cols-4 gap-2\">\n                      {timeSlots.map((slot) => (\n                        <button\n                          key={slot.time}\n                          onClick={() => slot.available && setSelectedTime(slot.time)}\n                          disabled={!slot.available}\n                          className={`py-2 px-3 rounded-lg text-sm font-medium ${\n                            selectedTime === slot.time\n                              ? 'bg-indigo-600 text-white'\n                              : slot.available\n                              ? 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                              : 'bg-gray-50 text-gray-300 cursor-not-allowed'\n                          }`}\n                        >\n                          {slot.time}\n                        </button>\n                      ))}\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {/* Navigation */}\n              <div className=\"flex justify-between mt-6\">\n                <button\n                  onClick={() => setStep(1)}\n                  className=\"flex items-center gap-1 text-gray-600 hover:text-gray-900\"\n                >\n                  <CaretLeft className=\"w-4 h-4\" />\n                  {locale === 'th' ? 'เธขเนเธญเธเธเธฅเธฑเธ' : 'Back'}\n                </button>\n                <button\n                  onClick={() => setStep(3)}\n                  disabled={!selectedTime}\n                  className=\"flex items-center gap-1 bg-indigo-600 text-white px-6 py-2 rounded-lg disabled:opacity-50\"\n                >\n                  {locale === 'th' ? 'เธ–เธฑเธ”เนเธ' : 'Next'}\n                  <CaretRight className=\"w-4 h-4\" />\n                </button>\n              </div>\n            </div>\n          )}\n\n          {/* Step 3: Customer Info */}\n          {step === 3 && (\n            <div>\n              <h2 className=\"text-lg font-semibold mb-4\">\n                {locale === 'th' ? 'เธเนเธญเธกเธนเธฅเธเธนเนเธเธญเธ' : 'Your Information'}\n              </h2>\n\n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    <User className=\"w-4 h-4 inline mr-1\" />\n                    {locale === 'th' ? 'เธเธทเนเธญ-เธเธฒเธกเธชเธเธธเธฅ' : 'Full Name'} *\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={customerInfo.name}\n                    onChange={(e) => setCustomerInfo({ ...customerInfo, name: e.target.value })}\n                    className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"\n                    required\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    <Phone className=\"w-4 h-4 inline mr-1\" />\n                    {locale === 'th' ? 'เน€เธเธญเธฃเนเนเธ—เธฃเธจเธฑเธเธ—เน' : 'Phone Number'} *\n                  </label>\n                  <input\n                    type=\"tel\"\n                    value={customerInfo.phone}\n                    onChange={(e) => setCustomerInfo({ ...customerInfo, phone: e.target.value })}\n                    className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"\n                    required\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    <EnvelopeSimple className=\"w-4 h-4 inline mr-1\" />\n                    {locale === 'th' ? 'เธญเธตเน€เธกเธฅ' : 'Email'}\n                  </label>\n                  <input\n                    type=\"email\"\n                    value={customerInfo.email}\n                    onChange={(e) => setCustomerInfo({ ...customerInfo, email: e.target.value })}\n                    className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    {locale === 'th' ? 'เธซเธกเธฒเธขเน€เธซเธ•เธธ' : 'Notes'}\n                  </label>\n                  <textarea\n                    value={customerInfo.notes}\n                    onChange={(e) => setCustomerInfo({ ...customerInfo, notes: e.target.value })}\n                    rows={3}\n                    className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"\n                  />\n                </div>\n              </div>\n\n              {/* Navigation */}\n              <div className=\"flex justify-between mt-6\">\n                <button\n                  onClick={() => setStep(2)}\n                  className=\"flex items-center gap-1 text-gray-600 hover:text-gray-900\"\n                >\n                  <CaretLeft className=\"w-4 h-4\" />\n                  {locale === 'th' ? 'เธขเนเธญเธเธเธฅเธฑเธ' : 'Back'}\n                </button>\n                <button\n                  onClick={() => setStep(4)}\n                  disabled={!customerInfo.name || !customerInfo.phone}\n                  className=\"flex items-center gap-1 bg-indigo-600 text-white px-6 py-2 rounded-lg disabled:opacity-50\"\n                >\n                  {locale === 'th' ? 'เธ–เธฑเธ”เนเธ' : 'Next'}\n                  <CaretRight className=\"w-4 h-4\" />\n                </button>\n              </div>\n            </div>\n          )}\n\n          {/* Step 4: Confirmation */}\n          {step === 4 && selectedService && selectedDate && (\n            <div>\n              <h2 className=\"text-lg font-semibold mb-4\">\n                {locale === 'th' ? 'เธขเธทเธเธขเธฑเธเธเธฒเธฃเธเธญเธ' : 'Confirm Booking'}\n              </h2>\n\n              {/* Summary */}\n              <div className=\"bg-gray-50 rounded-xl p-4 mb-6\">\n                <div className=\"flex justify-between items-start mb-3\">\n                  <div>\n                    <p className=\"font-medium text-gray-900\">\n                      {selectedService.name[locale as 'th' | 'en']}\n                    </p>\n                    <p className=\"text-sm text-gray-600\">\n                      {formatDate(selectedDate)} โ€ข {selectedTime}\n                    </p>\n                    <p className=\"text-sm text-gray-600\">\n                      {selectedService.duration_minutes} {locale === 'th' ? 'เธเธฒเธ—เธต' : 'minutes'}\n                    </p>\n                  </div>\n                  <p className=\"font-semibold text-lg\">\n                    {formatPrice(selectedService.price)}\n                  </p>\n                </div>\n\n                <div className=\"border-t pt-3\">\n                  <p className=\"text-sm text-gray-600\">{customerInfo.name}</p>\n                  <p className=\"text-sm text-gray-600\">{customerInfo.phone}</p>\n                </div>\n              </div>\n\n              {/* Gift Card */}\n              <div className=\"mb-6\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  <Gift className=\"w-4 h-4 inline mr-1\" />\n                  {locale === 'th' ? 'เธฃเธซเธฑเธช Gift Card' : 'Gift Card Code'}\n                </label>\n                <div className=\"flex gap-2\">\n                  <input\n                    type=\"text\"\n                    value={giftCardCode}\n                    onChange={(e) => {\n                      setGiftCardCode(e.target.value.toUpperCase());\n                      setGiftCardValid(null);\n                    }}\n                    placeholder=\"GC-XXXXXXXX\"\n                    className=\"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"\n                  />\n                  <button\n                    onClick={validateGiftCard}\n                    className=\"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200\"\n                  >\n                    {locale === 'th' ? 'เนเธเน' : 'Apply'}\n                  </button>\n                </div>\n                {giftCardValid === true && (\n                  <p className=\"text-green-600 text-sm mt-1\">\n                    โ“ {locale === 'th' ? 'เธชเนเธงเธเธฅเธ”' : 'Discount'}: {formatPrice(giftCardDiscount)}\n                  </p>\n                )}\n                {giftCardValid === false && (\n                  <p className=\"text-red-600 text-sm mt-1\">\n                    {locale === 'th' ? 'เธฃเธซเธฑเธชเนเธกเนเธ–เธนเธเธ•เนเธญเธ' : 'Invalid code'}\n                  </p>\n                )}\n              </div>\n\n              {/* Total */}\n              <div className=\"bg-indigo-50 rounded-xl p-4 mb-6\">\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"font-medium\">\n                    {locale === 'th' ? 'เธขเธญเธ”เธฃเธงเธก' : 'Total'}\n                  </span>\n                  <span className=\"text-xl font-bold text-indigo-600\">\n                    {formatPrice(selectedService.price - giftCardDiscount)}\n                  </span>\n                </div>\n                {settings?.requireDeposit && (\n                  <p className=\"text-sm text-gray-600 mt-1\">\n                    {locale === 'th' ? 'เธ•เนเธญเธเธเธณเธฃเธฐเธกเธฑเธ”เธเธณ' : 'Deposit required'}: {formatPrice(settings.depositAmount || (selectedService.price * settings.depositPercentage / 100))}\n                  </p>\n                )}\n              </div>\n\n              {error && (\n                <div className=\"bg-red-50 text-red-600 p-3 rounded-lg mb-4 text-sm\">\n                  {error}\n                </div>\n              )}\n\n              {/* Navigation */}\n              <div className=\"flex justify-between\">\n                <button\n                  onClick={() => setStep(3)}\n                  className=\"flex items-center gap-1 text-gray-600 hover:text-gray-900\"\n                >\n                  <CaretLeft className=\"w-4 h-4\" />\n                  {locale === 'th' ? 'เธขเนเธญเธเธเธฅเธฑเธ' : 'Back'}\n                </button>\n                <button\n                  onClick={handleSubmit}\n                  disabled={submitting}\n                  className=\"flex items-center gap-2 bg-indigo-600 text-white px-8 py-3 rounded-lg hover:bg-indigo-700 disabled:opacity-50\"\n                >\n                  {submitting ? (\n                    <SpinnerGap className=\"w-5 h-5 animate-spin\" />\n                  ) : (\n                    <CreditCard className=\"w-5 h-5\" />\n                  )}\n                  {locale === 'th' ? 'เธขเธทเธเธขเธฑเธเธเธฒเธฃเธเธญเธ' : 'Confirm Booking'}\n                </button>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\(public)\\kiosk\\[clinicId]\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchSettings'. Either include it or remove the dependency array.","line":19,"column":6,"nodeType":"ArrayExpression","endLine":19,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [clinicId, fetchSettings]","fix":{"range":[846,856],"text":"[clinicId, fetchSettings]"}}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":70,"column":9,"nodeType":"JSXOpeningElement","endLine":70,"endColumn":73}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useParams } from 'next/navigation';\nimport { User, Phone, CalendarDots, QrCode, CheckCircle } from '@phosphor-icons/react';\n\nexport default function KioskPage() {\n  const params = useParams();\n  const clinicId = params.clinicId as string;\n  const [settings, setSettings] = useState<{ welcome_message?: { th?: string }; logo_url?: string; theme?: { primaryColor?: string } } | null>(null);\n  const [clinic, setClinic] = useState<{ display_name?: { th?: string } } | null>(null);\n  const [step, setStep] = useState<'welcome' | 'method' | 'phone' | 'success'>('welcome');\n  const [phone, setPhone] = useState('');\n  const [queueNumber, setQueueNumber] = useState<number | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    fetchSettings();\n  }, [clinicId]);\n\n  const fetchSettings = async () => {\n    try {\n      const res = await fetch(`/api/kiosk?clinic_id=${clinicId}`);\n      const data = await res.json();\n      setSettings(data.settings);\n      setClinic(data.clinic);\n    } catch (e) { console.error(e); }\n    setLoading(false);\n  };\n\n  const handleCheckIn = async (method: string) => {\n    try {\n      const res = await fetch('/api/kiosk', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          clinicId,\n          method,\n          phone: method === 'phone' ? phone : undefined\n        })\n      });\n      const data = await res.json();\n      if (data.success) {\n        setQueueNumber(data.queueNumber);\n        setStep('success');\n        // Auto reset after 10 seconds\n        setTimeout(() => {\n          setStep('welcome');\n          setPhone('');\n          setQueueNumber(null);\n        }, 10000);\n      }\n    } catch (e) { console.error(e); }\n  };\n\n  const primaryColor = settings?.theme?.primaryColor || '#6366f1';\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-100\">\n        <div className=\"animate-spin w-12 h-12 border-4 border-indigo-600 border-t-transparent rounded-full\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-indigo-50 to-purple-50 flex flex-col items-center justify-center p-8\">\n      {/* Logo */}\n      {settings?.logo_url && (\n        <img src={settings.logo_url} alt=\"Logo\" className=\"h-20 mb-6\" />\n      )}\n\n      {step === 'welcome' && (\n        <div className=\"text-center\">\n          <h1 className=\"text-4xl font-bold text-gray-900 mb-4\">\n            {clinic?.display_name?.th || 'เธขเธดเธเธ”เธตเธ•เนเธญเธเธฃเธฑเธ'}\n          </h1>\n          <p className=\"text-xl text-gray-600 mb-8\">\n            {settings?.welcome_message?.th || 'เธเธฃเธธเธ“เธฒเน€เธเนเธเธญเธดเธเน€เธเธทเนเธญเน€เธเนเธฒเธฃเธฑเธเธเธฃเธดเธเธฒเธฃ'}\n          </p>\n          <button\n            onClick={() => setStep('method')}\n            style={{ backgroundColor: primaryColor }}\n            className=\"px-12 py-6 text-2xl text-white rounded-2xl shadow-lg hover:opacity-90 transition\"\n          >\n            เน€เธเนเธเธญเธดเธ\n          </button>\n        </div>\n      )}\n\n      {step === 'method' && (\n        <div className=\"text-center\">\n          <h2 className=\"text-3xl font-bold text-gray-900 mb-8\">เน€เธฅเธทเธญเธเธงเธดเธเธตเน€เธเนเธเธญเธดเธ</h2>\n          <div className=\"grid grid-cols-2 gap-6 max-w-xl\">\n            <button\n              onClick={() => setStep('phone')}\n              className=\"flex flex-col items-center gap-4 p-8 bg-white rounded-2xl shadow-lg hover:shadow-xl transition\"\n            >\n              <Phone className=\"w-16 h-16 text-indigo-600\" />\n              <span className=\"text-xl font-medium\">เน€เธเธญเธฃเนเนเธ—เธฃเธจเธฑเธเธ—เน</span>\n            </button>\n            <button\n              onClick={() => handleCheckIn('walk_in')}\n              className=\"flex flex-col items-center gap-4 p-8 bg-white rounded-2xl shadow-lg hover:shadow-xl transition\"\n            >\n              <User className=\"w-16 h-16 text-green-600\" />\n              <span className=\"text-xl font-medium\">Walk-in</span>\n            </button>\n            <button\n              onClick={() => handleCheckIn('appointment')}\n              className=\"flex flex-col items-center gap-4 p-8 bg-white rounded-2xl shadow-lg hover:shadow-xl transition\"\n            >\n              <CalendarDots className=\"w-16 h-16 text-blue-600\" />\n              <span className=\"text-xl font-medium\">เธกเธตเธเธฑเธ”เธซเธกเธฒเธข</span>\n            </button>\n            <button\n              onClick={() => handleCheckIn('qr_code')}\n              className=\"flex flex-col items-center gap-4 p-8 bg-white rounded-2xl shadow-lg hover:shadow-xl transition\"\n            >\n              <QrCode className=\"w-16 h-16 text-purple-600\" />\n              <span className=\"text-xl font-medium\">QR Code</span>\n            </button>\n          </div>\n          <button onClick={() => setStep('welcome')} className=\"mt-8 text-gray-500 hover:underline\">\n            โ เธเธฅเธฑเธ\n          </button>\n        </div>\n      )}\n\n      {step === 'phone' && (\n        <div className=\"text-center\">\n          <h2 className=\"text-3xl font-bold text-gray-900 mb-8\">เธเธฃเธญเธเน€เธเธญเธฃเนเนเธ—เธฃเธจเธฑเธเธ—เน</h2>\n          <input\n            type=\"tel\"\n            value={phone}\n            onChange={e => setPhone(e.target.value.replace(/\\D/g, ''))}\n            placeholder=\"0812345678\"\n            className=\"text-4xl text-center w-80 px-6 py-4 border-2 border-gray-300 rounded-xl focus:border-indigo-500 focus:outline-none\"\n            maxLength={10}\n          />\n          <div className=\"mt-8 flex gap-4 justify-center\">\n            <button onClick={() => setStep('method')} className=\"px-8 py-4 bg-gray-200 rounded-xl text-xl\">\n              เธเธฅเธฑเธ\n            </button>\n            <button\n              onClick={() => handleCheckIn('phone')}\n              disabled={phone.length < 9}\n              style={{ backgroundColor: phone.length >= 9 ? primaryColor : '#ccc' }}\n              className=\"px-8 py-4 text-white rounded-xl text-xl\"\n            >\n              เธขเธทเธเธขเธฑเธ\n            </button>\n          </div>\n        </div>\n      )}\n\n      {step === 'success' && (\n        <div className=\"text-center\">\n          <CheckCircle className=\"w-24 h-24 text-green-500 mx-auto mb-6\" />\n          <h2 className=\"text-3xl font-bold text-gray-900 mb-4\">เน€เธเนเธเธญเธดเธเธชเธณเน€เธฃเนเธ!</h2>\n          <div className=\"text-8xl font-bold my-8\" style={{ color: primaryColor }}>\n            {queueNumber}\n          </div>\n          <p className=\"text-2xl text-gray-600\">เธเธดเธงเธเธญเธเธเธธเธ“</p>\n          <p className=\"text-lg text-gray-500 mt-4\">เธเธฃเธธเธ“เธฒเธฃเธญเน€เธฃเธตเธขเธเธเธดเธง</p>\n        </div>\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\analysis\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\analysis\\results\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\demo\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\layout.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ibmPlexThai' is assigned a value but never used.","line":12,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'anuphan' is assigned a value but never used.","line":18,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'inter' is assigned a value but never used.","line":24,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":12}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextIntlClientProvider } from 'next-intl';\r\nimport { getMessages, setRequestLocale } from 'next-intl/server';\r\nimport { notFound } from 'next/navigation';\r\nimport { routing } from '@/i18n/routing';\r\nimport { AuthProvider } from '@/hooks/useAuth';\r\nimport {IBM_Plex_Sans_Thai, Anuphan, Inter} from \"next/font/google\";\r\nimport \"@/app/globals.css\";\r\nimport PDPAModal from \"@/components/ui/PDPAModal\";\r\nimport { Toaster } from 'sonner';\r\nimport { ReactQueryProvider } from '@/app/providers';\r\n\r\nconst ibmPlexThai = IBM_Plex_Sans_Thai({\r\n  subsets: [\"thai\", \"latin\"],\r\n  variable: \"--font-ibm-thai\",\r\n  weight: [\"300\", \"400\", \"500\", \"600\", \"700\"],\r\n});\r\n\r\nconst anuphan = Anuphan({\r\n  subsets: [\"thai\", \"latin\"],\r\n  variable: \"--font-anuphan\",\r\n  weight: [\"400\", \"500\", \"600\", \"700\"],\r\n});\r\n\r\nconst inter = Inter({\r\n  subsets: [\"latin\"],\r\n  variable: \"--font-inter\",\r\n});\r\n\r\nexport function generateStaticParams() {\r\n  return routing.locales.map((locale) => ({locale}));\r\n}\r\n\r\nexport default async function LocaleLayout({\r\n  children,\r\n  params\r\n}: {\r\n  children: React.ReactNode;\r\n  params: Promise<{locale: string}>;\r\n}) {\r\n  const {locale} = await params;\r\n\r\n  // Ensure that the incoming `locale` is valid\r\n  if (!routing.locales.includes(locale as \"th\" | \"en\")) {\r\n    notFound();\r\n  }\r\n\r\n  // Enable static rendering\r\n  setRequestLocale(locale);\r\n\r\n  // Providing all messages to the client\r\n  // side is the easiest way to get started\r\n  const messages = await getMessages();\r\n\r\n  return (\r\n    <NextIntlClientProvider messages={messages}>\r\n      <ReactQueryProvider>\r\n        <AuthProvider>\r\n          <div className=\"fixed inset-0 bg-grain pointer-events-none z-[9999]\" />\r\n          <Toaster position=\"top-right\" expand={false} richColors />\r\n          <PDPAModal />\r\n          {children}\r\n        </AuthProvider>\r\n      </ReactQueryProvider>\r\n    </NextIntlClientProvider>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\proposal\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\register\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":53,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":53,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport Link from 'next/link';\nimport { EnvelopeSimple, Lock, User, Eye, EyeSlash, Shield, Sparkle } from '@phosphor-icons/react';\n\nexport default function RegisterPage() {\n  const [formData, setFormData] = useState({\n    email: '',\n    password: '',\n    confirmPassword: '',\n    fullName: '',\n    phone: ''\n  });\n  const [showPassword, setShowPassword] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const router = useRouter();\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError('');\n    setLoading(true);\n\n    if (formData.password !== formData.confirmPassword) {\n      setError('เธฃเธซเธฑเธชเธเนเธฒเธเนเธกเนเธ•เธฃเธเธเธฑเธ');\n      setLoading(false);\n      return;\n    }\n\n    try {\n      const response = await fetch('/api/auth/register', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          email: formData.email,\n          password: formData.password,\n          fullName: formData.fullName,\n          phone: formData.phone,\n        }),\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        router.push('/th/login?message=Registration successful. Please login.');\n      } else {\n        setError(data.error || 'Registration failed');\n      }\n    } catch (error) {\n      setError('Something went wrong. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md\">\n        {/* Logo/Brand */}\n        <div className=\"text-center mb-8\">\n          <div className=\"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full mb-4\">\n            <Sparkle className=\"w-8 h-8 text-white\" />\n          </div>\n          <h1 className=\"text-3xl font-bold text-white mb-2\">BN-Aura</h1>\n          <p className=\"text-blue-200\">เธชเธกเธฑเธเธฃเธชเธกเธฒเธเธดเธเน€เธเธทเนเธญเน€เธฃเธดเนเธกเธ•เนเธเธเธฒเธฃเธ”เธนเนเธฅเธเธงเธฒเธกเธเธฒเธก</p>\n        </div>\n\n        {/* Register Form */}\n        <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-8 border border-white/20\">\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            {error && (\n              <div className=\"bg-red-500/20 border border-red-500/50 rounded-lg p-3\">\n                <p className=\"text-red-200 text-sm\">{error}</p>\n              </div>\n            )}\n\n            {/* Full Name */}\n            <div>\n              <label className=\"block text-sm font-medium text-blue-200 mb-2\">\n                เธเธทเนเธญ-เธเธฒเธกเธชเธเธธเธฅ\n              </label>\n              <div className=\"relative\">\n                <User className=\"absolute left-3 top-3 w-5 h-5 text-blue-300\" />\n                <input\n                  type=\"text\"\n                  required\n                  value={formData.fullName}\n                  onChange={(e) => setFormData({ ...formData, fullName: e.target.value })}\n                  className=\"w-full bg-white/5 border border-white/10 rounded-lg py-3 pl-10 pr-4 text-white placeholder-blue-300 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent\"\n                  placeholder=\"เธเธฃเธญเธเธเธทเนเธญ-เธเธฒเธกเธชเธเธธเธฅ\"\n                />\n              </div>\n            </div>\n\n            {/* Email */}\n            <div>\n              <label className=\"block text-sm font-medium text-blue-200 mb-2\">\n                เธญเธตเน€เธกเธฅ\n              </label>\n              <div className=\"relative\">\n                <EnvelopeSimple className=\"absolute left-3 top-3 w-5 h-5 text-blue-300\" />\n                <input\n                  type=\"email\"\n                  required\n                  value={formData.email}\n                  onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                  className=\"w-full bg-white/5 border border-white/10 rounded-lg py-3 pl-10 pr-4 text-white placeholder-blue-300 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent\"\n                  placeholder=\"your@email.com\"\n                />\n              </div>\n            </div>\n\n            {/* Phone */}\n            <div>\n              <label className=\"block text-sm font-medium text-blue-200 mb-2\">\n                เน€เธเธญเธฃเนเนเธ—เธฃเธจเธฑเธเธ—เน (เนเธกเนเธเธณเน€เธเนเธ)\n              </label>\n              <div className=\"relative\">\n                <User className=\"absolute left-3 top-3 w-5 h-5 text-blue-300\" />\n                <input\n                  type=\"tel\"\n                  value={formData.phone}\n                  onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\n                  className=\"w-full bg-white/5 border border-white/10 rounded-lg py-3 pl-10 pr-4 text-white placeholder-blue-300 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent\"\n                  placeholder=\"081-234-5678\"\n                />\n              </div>\n            </div>\n\n            {/* Password */}\n            <div>\n              <label className=\"block text-sm font-medium text-blue-200 mb-2\">\n                เธฃเธซเธฑเธชเธเนเธฒเธ\n              </label>\n              <div className=\"relative\">\n                <Lock className=\"absolute left-3 top-3 w-5 h-5 text-blue-300\" />\n                <input\n                  type={showPassword ? 'text' : 'password'}\n                  required\n                  value={formData.password}\n                  onChange={(e) => setFormData({ ...formData, password: e.target.value })}\n                  className=\"w-full bg-white/5 border border-white/10 rounded-lg py-3 pl-10 pr-12 text-white placeholder-blue-300 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent\"\n                  placeholder=\"เธฃเธซเธฑเธชเธเนเธฒเธเธญเธขเนเธฒเธเธเนเธญเธข 8 เธ•เธฑเธงเธญเธฑเธเธฉเธฃ\"\n                  minLength={8}\n                />\n                <button\n                  type=\"button\"\n                  onClick={() => setShowPassword(!showPassword)}\n                  className=\"absolute right-3 top-3 text-blue-300 hover:text-white\"\n                >\n                  {showPassword ? <EyeSlash className=\"w-5 h-5\" /> : <Eye className=\"w-5 h-5\" />}\n                </button>\n              </div>\n            </div>\n\n            {/* Confirm Password */}\n            <div>\n              <label className=\"block text-sm font-medium text-blue-200 mb-2\">\n                เธขเธทเธเธขเธฑเธเธฃเธซเธฑเธชเธเนเธฒเธ\n              </label>\n              <div className=\"relative\">\n                <Lock className=\"absolute left-3 top-3 w-5 h-5 text-blue-300\" />\n                <input\n                  type={showPassword ? 'text' : 'password'}\n                  required\n                  value={formData.confirmPassword}\n                  onChange={(e) => setFormData({ ...formData, confirmPassword: e.target.value })}\n                  className=\"w-full bg-white/5 border border-white/10 rounded-lg py-3 pl-10 pr-4 text-white placeholder-blue-300 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent\"\n                  placeholder=\"เธขเธทเธเธขเธฑเธเธฃเธซเธฑเธชเธเนเธฒเธเธญเธตเธเธเธฃเธฑเนเธ\"\n                  minLength={8}\n                />\n              </div>\n            </div>\n\n            {/* Terms */}\n            <div className=\"flex items-start gap-3\">\n              <input\n                type=\"checkbox\"\n                required\n                className=\"mt-1 w-4 h-4 text-purple-500 bg-white/5 border-white/20 rounded focus:ring-purple-500\"\n              />\n              <p className=\"text-sm text-blue-200\">\n                เธเธฑเธเธขเธญเธกเธฃเธฑเธ{' '}\n                <Link href=\"/th/terms\" className=\"text-purple-300 hover:text-purple-200 underline\">\n                  เน€เธเธทเนเธญเธเนเธเธเธฒเธฃเนเธซเนเธเธฃเธดเธเธฒเธฃ\n                </Link>{' '}\n                เนเธฅเธฐ{' '}\n                <Link href=\"/th/privacy\" className=\"text-purple-300 hover:text-purple-200 underline\">\n                  เธเนเธขเธเธฒเธขเธเธงเธฒเธกเน€เธเนเธเธชเนเธงเธเธ•เธฑเธง\n                </Link>\n              </p>\n            </div>\n\n            {/* Submit Button */}\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white font-semibold py-3 px-4 rounded-lg hover:from-purple-600 hover:to-pink-600 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 focus:ring-offset-transparent disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\n            >\n              {loading ? 'เธเธณเธฅเธฑเธเธชเธกเธฑเธเธฃ...' : 'เธชเธกเธฑเธเธฃเธชเธกเธฒเธเธดเธ'}\n            </button>\n          </form>\n\n          {/* Login Link */}\n          <div className=\"mt-6 text-center\">\n            <p className=\"text-blue-200\">\n              เธกเธตเธเธฑเธเธเธตเธญเธขเธนเนเนเธฅเนเธง?{' '}\n              <Link href=\"/th/login\" className=\"text-purple-300 hover:text-purple-200 font-semibold\">\n                เน€เธเนเธฒเธชเธนเนเธฃเธฐเธเธ\n              </Link>\n            </p>\n          </div>\n        </div>\n\n        {/* Security Notice */}\n        <div className=\"mt-6 flex items-center justify-center gap-2 text-blue-300 text-sm\">\n          <Shield className=\"w-4 h-4\" />\n          <span>เธเนเธญเธกเธนเธฅเธเธญเธเธเธธเธ“เธเธฅเธญเธ”เธ เธฑเธขเนเธฅเธฐเน€เธเนเธฒเธฃเธซเธฑเธช</span>\n        </div>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\unauthorized\\page.en.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":70,"column":22,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[2302,2443],"text":"\r\n              You don&apos;t have permission to access this page. Please contact your administrator if you think this is an error.\r\n            "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[2302,2443],"text":"\r\n              You don&lsquo;t have permission to access this page. Please contact your administrator if you think this is an error.\r\n            "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[2302,2443],"text":"\r\n              You don&#39;t have permission to access this page. Please contact your administrator if you think this is an error.\r\n            "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[2302,2443],"text":"\r\n              You don&rsquo;t have permission to access this page. Please contact your administrator if you think this is an error.\r\n            "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useRouter } from 'next/navigation';\r\nimport { motion } from 'framer-motion';\r\nimport { ShieldSlash, ArrowLeft, SignOut } from '@phosphor-icons/react';\r\nimport { useAuth } from '@/hooks/useAuth';\r\n\r\n// Simple Button component inline to avoid import issues\r\nconst Button = ({ \r\n  children, \r\n  onClick, \r\n  variant = 'default',\r\n  className = '' \r\n}: { \r\n  children: React.ReactNode; \r\n  onClick?: () => void; \r\n  variant?: 'default' | 'outline';\r\n  className?: string;\r\n}) => {\r\n  const baseClasses = 'inline-flex items-center justify-center rounded-xl font-medium transition-all focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 disabled:cursor-not-allowed px-6 py-3 text-sm';\r\n  const variants = {\r\n    default: 'bg-primary text-primary-foreground hover:bg-primary/90 shadow-premium',\r\n    outline: 'border border-white/10 bg-white/5 text-white hover:bg-white/10 hover:border-white/20'\r\n  };\r\n  \r\n  return (\r\n    <button \r\n      onClick={onClick}\r\n      className={`${baseClasses} ${variants[variant]} ${className}`}\r\n    >\r\n      {children}\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default function UnauthorizedPage() {\r\n  const router = useRouter();\r\n  const { signOut } = useAuth();\r\n\r\n  const handleLogout = async () => {\r\n    await signOut();\r\n    router.push('/en/login');\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-background p-4\">\r\n      <motion.div\r\n        initial={{ opacity: 0, y: 20 }}\r\n        animate={{ opacity: 1, y: 0 }}\r\n        transition={{ duration: 0.5 }}\r\n        className=\"max-w-md w-full\"\r\n      >\r\n        <div className=\"text-center space-y-6\">\r\n          {/* Icon */}\r\n          <motion.div\r\n            initial={{ scale: 0 }}\r\n            animate={{ scale: 1 }}\r\n            transition={{ delay: 0.2, type: \"spring\", stiffness: 200 }}\r\n            className=\"w-20 h-20 bg-destructive/10 rounded-full flex items-center justify-center mx-auto\"\r\n          >\r\n            <ShieldSlash className=\"w-10 h-10 text-destructive\" />\r\n          </motion.div>\r\n\r\n          {/* Content */}\r\n          <div className=\"space-y-2\">\r\n            <h1 className=\"text-2xl font-bold text-foreground\">\r\n              Access Denied\r\n            </h1>\r\n            <p className=\"text-muted-foreground\">\r\n              You don't have permission to access this page. Please contact your administrator if you think this is an error.\r\n            </p>\r\n          </div>\r\n\r\n          {/* Actions */}\r\n          <div className=\"space-y-3\">\r\n            <Button\r\n              onClick={() => router.back()}\r\n              variant=\"outline\"\r\n              className=\"w-full\"\r\n            >\r\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n              Go Back\r\n            </Button>\r\n            \r\n            <Button\r\n              onClick={handleLogout}\r\n              className=\"w-full\"\r\n            >\r\n              <SignOut className=\"w-4 h-4 mr-2\" />\r\n              Sign Out\r\n            </Button>\r\n          </div>\r\n\r\n          {/* Help Text */}\r\n          <p className=\"text-xs text-muted-foreground\">\r\n            If you need help, please contact support\r\n          </p>\r\n        </div>\r\n      </motion.div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\[locale]\\unauthorized\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\create-auth-staff\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":17,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[529,532],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[529,532],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":42,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { Users, Shield, Key, EnvelopeSimple, User, Buildings, SpinnerGap, CheckCircle, WarningCircle } from '@phosphor-icons/react';\r\n\r\nexport default function CreateAuthStaffPage() {\r\n  const [formData, setFormData] = useState({\r\n    email: '',\r\n    fullName: '',\r\n    role: 'sales_staff',\r\n    clinicId: '',\r\n    temporaryPassword: ''\r\n  });\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [result, setResult] = useState<any>(null);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setError(null);\r\n    setResult(null);\r\n\r\n    try {\r\n      const response = await fetch('/api/admin/create-staff-with-auth', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(formData),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        setResult(data);\r\n      } else {\r\n        setError(data.error || 'Failed to create staff');\r\n      }\r\n    } catch (err) {\r\n      setError('Network error occurred');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\r\n    setFormData({\r\n      ...formData,\r\n      [e.target.name]: e.target.value,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-8\">\r\n      <div className=\"max-w-2xl mx-auto\">\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-8 border border-white/20\"\r\n        >\r\n          <div className=\"flex items-center gap-3 mb-8\">\r\n            <div className=\"p-3 bg-purple-500/20 rounded-xl\">\r\n              <Shield className=\"w-6 h-6 text-purple-400\" />\r\n            </div>\r\n            <div>\r\n              <h1 className=\"text-2xl font-bold text-white\">Create Authenticated Staff</h1>\r\n              <p className=\"text-gray-400\">Create staff with Supabase Auth integration</p>\r\n            </div>\r\n          </div>\r\n\r\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                  <EnvelopeSimple className=\"w-4 h-4 inline mr-2\" />\r\n                  Email Address\r\n                </label>\r\n                <input\r\n                  type=\"email\"\r\n                  name=\"email\"\r\n                  value={formData.email}\r\n                  onChange={handleInputChange}\r\n                  placeholder=\"staff@clinic.com\"\r\n                  className=\"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500\"\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                  <User className=\"w-4 h-4 inline mr-2\" />\r\n                  Full Name\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  name=\"fullName\"\r\n                  value={formData.fullName}\r\n                  onChange={handleInputChange}\r\n                  placeholder=\"Staff Name\"\r\n                  className=\"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500\"\r\n                  required\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                  <Users className=\"w-4 h-4 inline mr-2\" />\r\n                  Role\r\n                </label>\r\n                <select\r\n                  name=\"role\"\r\n                  value={formData.role}\r\n                  onChange={handleInputChange}\r\n                  className=\"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500\"\r\n                >\r\n                  <option value=\"sales_staff\">Sales Staff</option>\r\n                  <option value=\"clinic_staff\">Clinic Staff</option>\r\n                  <option value=\"clinic_admin\">Clinic Admin</option>\r\n                </select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                  <Buildings className=\"w-4 h-4 inline mr-2\" />\r\n                  Clinic ID\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  name=\"clinicId\"\r\n                  value={formData.clinicId}\r\n                  onChange={handleInputChange}\r\n                  placeholder=\"00000000-0000-0000-0000-000000000001\"\r\n                  className=\"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500\"\r\n                  required\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-300 mb-2\">\r\n                <Key className=\"w-4 h-4 inline mr-2\" />\r\n                Temporary Password (optional)\r\n              </label>\r\n              <input\r\n                type=\"password\"\r\n                name=\"temporaryPassword\"\r\n                value={formData.temporaryPassword}\r\n                onChange={handleInputChange}\r\n                placeholder=\"Leave blank for default password\"\r\n                className=\"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500\"\r\n              />\r\n            </div>\r\n\r\n            <button\r\n              type=\"submit\"\r\n              disabled={loading}\r\n              className=\"w-full py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-semibold rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n              {loading ? (\r\n                <div className=\"flex items-center justify-center gap-2\">\r\n                  <SpinnerGap className=\"w-5 h-5 animate-spin\" />\r\n                  Creating Staff...\r\n                </div>\r\n              ) : (\r\n                'Create Authenticated Staff'\r\n              )}\r\n            </button>\r\n          </form>\r\n\r\n          {error && (\r\n            <motion.div\r\n              initial={{ opacity: 0, y: 10 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              className=\"mt-6 p-4 bg-red-500/20 border border-red-500/50 rounded-lg\"\r\n            >\r\n              <div className=\"flex items-center gap-3\">\r\n                <WarningCircle className=\"w-5 h-5 text-red-400\" />\r\n                <div>\r\n                  <p className=\"text-red-400 font-medium\">Error</p>\r\n                  <p className=\"text-red-300 text-sm\">{error}</p>\r\n                </div>\r\n              </div>\r\n            </motion.div>\r\n          )}\r\n\r\n          {result && (\r\n            <motion.div\r\n              initial={{ opacity: 0, y: 10 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              className=\"mt-6 p-6 bg-green-500/20 border border-green-500/50 rounded-lg\"\r\n            >\r\n              <div className=\"flex items-center gap-3 mb-4\">\r\n                <CheckCircle className=\"w-6 h-6 text-green-400\" />\r\n                <div>\r\n                  <p className=\"text-green-400 font-medium text-lg\">Staff Created Successfully!</p>\r\n                  <p className=\"text-green-300 text-sm\">Authentication and database records created</p>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"space-y-3\">\r\n                <div className=\"bg-black/30 p-4 rounded-lg\">\r\n                  <p className=\"text-gray-300 text-sm mb-2\">Login Credentials:</p>\r\n                  <p className=\"text-white font-mono\">\r\n                    Email: {result.data.credentials.email}\r\n                  </p>\r\n                  <p className=\"text-white font-mono\">\r\n                    Password: {result.data.credentials.temporaryPassword}\r\n                  </p>\r\n                </div>\r\n\r\n                <div className=\"bg-black/30 p-4 rounded-lg\">\r\n                  <p className=\"text-gray-300 text-sm mb-2\">Next Steps:</p>\r\n                  <p className=\"text-white text-sm\">\r\n                    โ€ข Login at: {result.nextSteps.loginUrl}\r\n                  </p>\r\n                  <p className=\"text-white text-sm\">\r\n                    โ€ข Dashboard: {result.nextSteps.dashboardUrl}\r\n                  </p>\r\n                  <p className=\"text-white text-sm\">\r\n                    โ€ข Staff can now access their role-specific dashboard\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </motion.div>\r\n          )}\r\n        </motion.div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\create-production-users\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":6,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[143,146],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[143,146],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState } from 'react';\n\nexport default function CreateProductionUsersPage() {\n  const [result, setResult] = useState<any>(null);\n  const [loading, setLoading] = useState(false);\n  const [config, setConfig] = useState({\n    clinicCount: 10,\n    staffPerClinic: 5,\n    customersPerSales: 30\n  });\n\n  const executeCreation = async () => {\n    setLoading(true);\n    try {\n      const response = await fetch('/api/admin/create-production-users', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(config)\n      });\n\n      const data = await response.json();\n      setResult(data);\n    } catch (error) {\n      setResult({ error: error instanceof Error ? error.message : 'Unknown error' });\n    }\n    setLoading(false);\n  };\n\n  const estimatedUsers = config.clinicCount * (config.staffPerClinic + config.customersPerSales);\n  const estimatedConcurrent = Math.floor(estimatedUsers * 0.15);\n\n  return (\n    <div style={{ padding: '20px', fontFamily: 'monospace', maxWidth: '1200px' }}>\n      <h1>๐ญ Production Scale User Creation</h1>\n      <p><strong>Phase 2A:</strong> Creating production-scale test data for multi-tenant testing</p>\n      \n      <div style={{ marginBottom: '30px', padding: '20px', backgroundColor: '#f0f8ff', borderRadius: '8px' }}>\n        <h3>๐ฏ Configuration</h3>\n        \n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '20px', marginBottom: '20px' }}>\n          <div>\n            <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\n              Number of Clinics:\n            </label>\n            <input \n              type=\"number\" \n              min=\"1\" \n              max=\"20\" \n              value={config.clinicCount}\n              onChange={(e) => setConfig({...config, clinicCount: parseInt(e.target.value)})}\n              style={{ width: '100%', padding: '8px', fontSize: '14px' }}\n            />\n          </div>\n          \n          <div>\n            <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\n              Staff per Clinic:\n            </label>\n            <input \n              type=\"number\" \n              min=\"2\" \n              max=\"20\" \n              value={config.staffPerClinic}\n              onChange={(e) => setConfig({...config, staffPerClinic: parseInt(e.target.value)})}\n              style={{ width: '100%', padding: '8px', fontSize: '14px' }}\n            />\n          </div>\n          \n          <div>\n            <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\n              Customers per Sales Staff:\n            </label>\n            <input \n              type=\"number\" \n              min=\"10\" \n              max=\"50\" \n              value={config.customersPerSales}\n              onChange={(e) => setConfig({...config, customersPerSales: parseInt(e.target.value)})}\n              style={{ width: '100%', padding: '8px', fontSize: '14px' }}\n            />\n          </div>\n        </div>\n\n        <div style={{ padding: '15px', backgroundColor: '#e7f3ff', borderRadius: '5px' }}>\n          <h4>๐“ Estimated Scale:</h4>\n          <ul>\n            <li><strong>Total Users:</strong> {estimatedUsers.toLocaleString()}</li>\n            <li><strong>Staff Members:</strong> {(config.clinicCount * config.staffPerClinic).toLocaleString()}</li>\n            <li><strong>Customers:</strong> {(config.clinicCount * config.customersPerSales).toLocaleString()}</li>\n            <li><strong>Estimated Concurrent Users:</strong> {estimatedConcurrent.toLocaleString()} (15% peak usage)</li>\n          </ul>\n        </div>\n      </div>\n\n      <div style={{ marginBottom: '20px' }}>\n        <h3>๐—๏ธ What will be created:</h3>\n        <ul>\n          <li>โ… <strong>{config.clinicCount} Test Clinics</strong> (Premium, Standard, Basic tiers)</li>\n          <li>โ… <strong>1 Clinic Owner</strong> per clinic</li>\n          <li>โ… <strong>1 Sales Staff</strong> per clinic (isolated customer base)</li>\n          <li>โ… <strong>{config.staffPerClinic - 1} Additional Staff</strong> per clinic (admins, beauticians)</li>\n          <li>โ… <strong>{config.customersPerSales} Customers</strong> per sales staff (data isolation testing)</li>\n          <li>โ… <strong>Multi-region distribution</strong> (Bangkok, Chiang Mai, Phuket)</li>\n        </ul>\n      </div>\n      \n      <button \n        onClick={executeCreation}\n        disabled={loading}\n        style={{\n          padding: '15px 30px',\n          backgroundColor: loading ? '#ccc' : '#28a745',\n          color: 'white',\n          border: 'none',\n          borderRadius: '5px',\n          cursor: loading ? 'not-allowed' : 'pointer',\n          fontSize: '16px',\n          fontWeight: 'bold',\n          marginBottom: '20px'\n        }}\n      >\n        {loading ? '๐ญ Creating Production Users...' : '๐€ Create Production Scale Users'}\n      </button>\n\n      {result && (\n        <div style={{ marginTop: '20px' }}>\n          <h3>Creation Results:</h3>\n          \n          {result.success && (\n            <div style={{ padding: '15px', backgroundColor: '#d4edda', borderRadius: '5px', marginBottom: '15px' }}>\n              <h4>โ… Production Users Created Successfully!</h4>\n              \n              {result.summary && (\n                <div style={{ marginTop: '15px' }}>\n                  <h5>๐“ Creation Summary:</h5>\n                  <table style={{ borderCollapse: 'collapse', width: '100%', border: '1px solid #ccc' }}>\n                    <thead>\n                      <tr style={{ backgroundColor: '#f8f9fa' }}>\n                        <th style={{ border: '1px solid #ccc', padding: '8px' }}>Type</th>\n                        <th style={{ border: '1px solid #ccc', padding: '8px' }}>Count</th>\n                        <th style={{ border: '1px solid #ccc', padding: '8px' }}>Status</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      <tr>\n                        <td style={{ border: '1px solid #ccc', padding: '8px' }}>Test Clinics</td>\n                        <td style={{ border: '1px solid #ccc', padding: '8px' }}>{result.summary.clinics}</td>\n                        <td style={{ border: '1px solid #ccc', padding: '8px' }}>โ… Created</td>\n                      </tr>\n                      <tr>\n                        <td style={{ border: '1px solid #ccc', padding: '8px' }}>Staff Members</td>\n                        <td style={{ border: '1px solid #ccc', padding: '8px' }}>{result.summary.staff}</td>\n                        <td style={{ border: '1px solid #ccc', padding: '8px' }}>โ… Created</td>\n                      </tr>\n                      <tr>\n                        <td style={{ border: '1px solid #ccc', padding: '8px' }}>Customers</td>\n                        <td style={{ border: '1px solid #ccc', padding: '8px' }}>{result.summary.customers}</td>\n                        <td style={{ border: '1px solid #ccc', padding: '8px' }}>โ… Created</td>\n                      </tr>\n                      <tr style={{ backgroundColor: '#e7f3ff' }}>\n                        <td style={{ border: '1px solid #ccc', padding: '8px' }}><strong>Total Users</strong></td>\n                        <td style={{ border: '1px solid #ccc', padding: '8px' }}><strong>{result.summary.totalUsers}</strong></td>\n                        <td style={{ border: '1px solid #ccc', padding: '8px' }}><strong>๐ฏ Ready for Testing</strong></td>\n                      </tr>\n                      <tr style={{ backgroundColor: '#fff3cd' }}>\n                        <td style={{ border: '1px solid #ccc', padding: '8px' }}><strong>Estimated Concurrent</strong></td>\n                        <td style={{ border: '1px solid #ccc', padding: '8px' }}><strong>{result.summary.estimatedConcurrentUsers}</strong></td>\n                        <td style={{ border: '1px solid #ccc', padding: '8px' }}><strong>๐“ Peak Load Target</strong></td>\n                      </tr>\n                    </tbody>\n                  </table>\n                </div>\n              )}\n            </div>\n          )}\n          \n          {result.error && (\n            <div style={{ padding: '15px', backgroundColor: '#f8d7da', borderRadius: '5px', marginBottom: '15px' }}>\n              <h4>โ Creation Failed!</h4>\n              <p><strong>Error:</strong> {result.error}</p>\n              {result.details && <pre style={{ fontSize: '12px', overflow: 'auto' }}>{result.details}</pre>}\n            </div>\n          )}\n          \n          <div style={{ marginTop: '20px', padding: '10px', backgroundColor: '#f5f5f5', borderRadius: '5px' }}>\n            <h4>Full Response:</h4>\n            <pre style={{ fontSize: '12px', overflow: 'auto' }}>{JSON.stringify(result, null, 2)}</pre>\n          </div>\n        </div>\n      )}\n\n      {result && result.success && (\n        <div style={{ marginTop: '30px', padding: '15px', backgroundColor: '#e7f3ff', borderRadius: '5px' }}>\n          <h3>๐€ Next Testing Steps:</h3>\n          <ol>\n            <li>โ… Production scale users created</li>\n            <li>๐” Test sales staff data isolation</li>\n            <li>๐งช Run concurrent load testing ({estimatedConcurrent}+ users)</li>\n            <li>๐”’ Verify commission security between sales staff</li>\n            <li>๐“ Performance testing under production load</li>\n          </ol>\n        </div>\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\database-cleanup\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":6,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[137,140],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[137,140],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":119,"column":86,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":119,"endColumn":89,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4792,4795],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4792,4795],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState } from 'react';\n\nexport default function DatabaseCleanupPage() {\n  const [result, setResult] = useState<any>(null);\n  const [loading, setLoading] = useState(false);\n\n  const executeCleanup = async () => {\n    setLoading(true);\n    try {\n      const response = await fetch('/api/admin/database-cleanup', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const data = await response.json();\n      setResult(data);\n    } catch (error) {\n      setResult({ error: error instanceof Error ? error.message : 'Unknown error' });\n    }\n    setLoading(false);\n  };\n\n  return (\n    <div style={{ padding: '20px', fontFamily: 'monospace', maxWidth: '1200px' }}>\n      <h1>๐งน Database Cleanup - Clean Slate Implementation</h1>\n      <p><strong>โ ๏ธ WARNING:</strong> This will delete ALL test data except super admin (nuttapong161@gmail.com)</p>\n      \n      <div style={{ marginBottom: '20px' }}>\n        <h3>What will be removed:</h3>\n        <ul>\n          <li>โ… All test clinic records (clinic.owner@bntest.com related)</li>\n          <li>โ… All clinic_staff records</li>\n          <li>โ… All test users except super admin</li>\n          <li>โ… All appointments, customers, sales_staff data</li>\n          <li>โ… All broken/duplicate records</li>\n        </ul>\n        \n        <h3>What will be preserved:</h3>\n        <ul>\n          <li>๐”’ Super admin: nuttapong161@gmail.com</li>\n          <li>๐”’ Database schema and migrations</li>\n          <li>๐”’ System configurations</li>\n        </ul>\n      </div>\n      \n      <button \n        onClick={executeCleanup}\n        disabled={loading}\n        style={{\n          padding: '15px 30px',\n          backgroundColor: loading ? '#ccc' : '#dc3545',\n          color: 'white',\n          border: 'none',\n          borderRadius: '5px',\n          cursor: loading ? 'not-allowed' : 'pointer',\n          fontSize: '16px',\n          fontWeight: 'bold',\n          marginBottom: '20px'\n        }}\n      >\n        {loading ? '๐งน Cleaning Database...' : '๐งน Execute Database Cleanup'}\n      </button>\n\n      {result && (\n        <div style={{ marginTop: '20px' }}>\n          <h3>Cleanup Results:</h3>\n          \n          {result.success && (\n            <div style={{ padding: '15px', backgroundColor: '#d4edda', borderRadius: '5px', marginBottom: '15px' }}>\n              <h4>โ… Cleanup Successful!</h4>\n              <p><strong>Super Admin Status:</strong> {result.superAdmin ? `โ… ${result.superAdmin.email} (${result.superAdmin.role})` : 'โ NOT FOUND!'}</p>\n            </div>\n          )}\n          \n          {result.error && (\n            <div style={{ padding: '15px', backgroundColor: '#f8d7da', borderRadius: '5px', marginBottom: '15px' }}>\n              <h4>โ Cleanup Failed!</h4>\n              <p><strong>Error:</strong> {result.error}</p>\n            </div>\n          )}\n          \n          {result.auditResults && (\n            <div style={{ marginBottom: '20px' }}>\n              <h4>๐“ Record Counts</h4>\n              <table style={{ borderCollapse: 'collapse', width: '100%', border: '1px solid #ccc' }}>\n                <thead>\n                  <tr style={{ backgroundColor: '#f8f9fa' }}>\n                    <th style={{ border: '1px solid #ccc', padding: '8px' }}>Table</th>\n                    <th style={{ border: '1px solid #ccc', padding: '8px' }}>Before</th>\n                    <th style={{ border: '1px solid #ccc', padding: '8px' }}>After</th>\n                    <th style={{ border: '1px solid #ccc', padding: '8px' }}>Status</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {Object.keys(result.auditResults.before).map(table => (\n                    <tr key={table}>\n                      <td style={{ border: '1px solid #ccc', padding: '8px' }}>{table}</td>\n                      <td style={{ border: '1px solid #ccc', padding: '8px' }}>{result.auditResults.before[table]}</td>\n                      <td style={{ border: '1px solid #ccc', padding: '8px' }}>{result.auditResults.after[table]}</td>\n                      <td style={{ border: '1px solid #ccc', padding: '8px' }}>\n                        {result.auditResults.after[table] === 0 ? 'โ… Clean' : \n                         result.auditResults.after[table] === 1 && table === 'users' ? 'โ… Super Admin Only' :\n                         'โ ๏ธ Has Data'}\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          )}\n          \n          {result.deletionResults && (\n            <div style={{ marginBottom: '20px' }}>\n              <h4>๐—‘๏ธ Deletion Results</h4>\n              {Object.entries(result.deletionResults).map(([table, status]: [string, any]) => (\n                <div key={table} style={{ marginBottom: '5px' }}>\n                  <strong>{table}:</strong> {status === 'SUCCESS' ? 'โ…' : 'โ'} {status}\n                </div>\n              ))}\n            </div>\n          )}\n          \n          <div style={{ marginTop: '20px', padding: '10px', backgroundColor: '#f5f5f5', borderRadius: '5px' }}>\n            <h4>Full Response:</h4>\n            <pre style={{ fontSize: '12px', overflow: 'auto' }}>{JSON.stringify(result, null, 2)}</pre>\n          </div>\n        </div>\n      )}\n\n      {result && result.success && (\n        <div style={{ marginTop: '30px', padding: '15px', backgroundColor: '#e7f3ff', borderRadius: '5px' }}>\n          <h3>๐ฏ Next Steps:</h3>\n          <ol>\n            <li>โ… Database cleaned successfully</li>\n            <li>๐” Test super admin login: <a href=\"/th/login\" target=\"_blank\">Login Page</a></li>\n            <li>๐—๏ธ Create clean clinic owner account</li>\n            <li>๐” Test authentication flows</li>\n            <li>๐งช Verify data isolation</li>\n          </ol>\n        </div>\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\fix-rls-complete\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\fix-rls\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\fix-user-role\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\layout.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":40,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1114,1117],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1114,1117],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { ReactNode } from 'react'\nimport { getLocale } from 'next-intl/server'\nimport { notFound } from 'next/navigation'\nimport { routing } from '@/i18n/routing'\nimport { IBM_Plex_Sans_Thai, Anuphan, Inter } from \"next/font/google\";\nimport \"@/app/globals.css\";\nimport { ThemeProvider } from '@/components/ui/ThemeProvider';\n\nconst ibmPlexThai = IBM_Plex_Sans_Thai({\n  subsets: [\"thai\", \"latin\"],\n  variable: \"--font-ibm-thai\",\n  weight: [\"300\", \"400\", \"500\", \"600\", \"700\"],\n});\n\nconst anuphan = Anuphan({\n  subsets: [\"thai\", \"latin\"],\n  variable: \"--font-anuphan\",\n  weight: [\"400\", \"500\", \"600\", \"700\"],\n});\n\nconst inter = Inter({\n  subsets: [\"latin\"],\n  variable: \"--font-inter\",\n});\n\nexport const metadata = {\n  title: \"BN-Aura | Premium Aesthetic Intelligence\",\n  description: \"Enterprise-grade aesthetic clinic platform with AI-powered skin analysis\",\n};\n\n// This is the root layout that wraps all locales\nexport default async function RootLayout({\n  children,\n}: {\n  children: ReactNode\n}) {\n  const locale = await getLocale()\n  \n  // Ensure we have a valid locale\n  if (!routing.locales.includes(locale as any)) {\n    notFound()\n  }\n\n  return (\n    <html lang={locale} suppressHydrationWarning>\n      <head>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\" />\n        <meta name=\"theme-color\" content=\"#0A0A0A\" />\n        <link rel=\"manifest\" href=\"/manifest.json\" />\n        <link rel=\"apple-touch-icon\" href=\"/next.svg\" />\n      </head>\n      <body\n        className={`${ibmPlexThai.variable} ${anuphan.variable} ${inter.variable} font-sans antialiased`}\n        suppressHydrationWarning={true}\n      >\n        <ThemeProvider>\n          {children}\n        </ThemeProvider>\n      </body>\n    </html>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\providers.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\sudtailaw\\app\\test-clinic-owner\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":6,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[137,140],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[137,140],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState } from 'react';\n\nexport default function TestClinicOwnerPage() {\n  const [result, setResult] = useState<any>(null);\n  const [loading, setLoading] = useState(false);\n\n  const createClinicOwner = async () => {\n    setLoading(true);\n    try {\n      const response = await fetch('/api/admin/create-clinic-owner', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const data = await response.json();\n      setResult(data);\n    } catch (error) {\n      setResult({ error: error instanceof Error ? error.message : 'Unknown error' });\n    }\n    setLoading(false);\n  };\n\n  return (\n    <div style={{ padding: '20px', fontFamily: 'monospace' }}>\n      <h1>Clinic Owner Creation Test</h1>\n      \n      <button \n        onClick={createClinicOwner}\n        disabled={loading}\n        style={{\n          padding: '10px 20px',\n          backgroundColor: loading ? '#ccc' : '#007bff',\n          color: 'white',\n          border: 'none',\n          borderRadius: '5px',\n          cursor: loading ? 'not-allowed' : 'pointer'\n        }}\n      >\n        {loading ? 'Creating...' : 'Create Clinic Owner'}\n      </button>\n\n      {result && (\n        <div style={{ marginTop: '20px', padding: '10px', backgroundColor: '#f5f5f5' }}>\n          <h3>Result:</h3>\n          <pre>{JSON.stringify(result, null, 2)}</pre>\n        </div>\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]}]
