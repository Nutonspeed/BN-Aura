# BN-Aura Data Isolation & Customer Role Report

## ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: 2 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2026
‡πÄ‡∏ß‡∏•‡∏≤: 20:10 ‡∏ô.

## ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: 90% ‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå ‚úÖ

## 1. ‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡∏ó‡∏µ‡πà‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à

### ‚úÖ Super Admin
- ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á: ‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á
- Dashboard: Admin Dashboard
- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: 9 ‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å, 26 ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤, 10 ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô

### ‚úÖ Clinic Owner  
- ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á: ‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡∏Ç‡∏≠‡∏á‡∏ï‡∏ô‡πÄ‡∏≠‡∏á
- Dashboard: Clinic Dashboard
- ‡πÄ‡∏°‡∏ô‡∏π: POS, Appointments, Staff, Revenue, Reports

### ‚úÖ Sales Staff
- ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á: Leads ‡πÅ‡∏•‡∏∞ Customers ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢
- Dashboard: Sales Intelligence
- ‡πÄ‡∏°‡∏ô‡∏π: POS, Sales Intelligence, AI Analysis, AR Simulator

## 2. Data Isolation ‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß

### ‚úÖ Role-based Routing
```typescript
// ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó
Super Admin ‚Üí /th/admin
Clinic Owner ‚Üí /th/clinic  
Sales Staff ‚Üí /th/sales
```

### ‚úÖ Menu Visibility
- ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•‡∏Ç‡∏≠‡∏á‡πÄ‡∏°‡∏ô‡∏π‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó

### ‚ö†Ô∏è Customer Assignment
‡∏°‡∏µ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå:
- `sales_leads.sales_user_id` - ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á leads ‡∏Å‡∏±‡∏ö sales staff
- `customer_conversations.sales_staff_id` - ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏ó‡∏ô‡∏≤
- `customer_treatment_journeys.sales_staff_id` - ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤

### ‚úÖ RLS Policies
- ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ RLS ‡∏ö‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏•‡πâ‡∏ß
- ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ï‡∏ô‡πÄ‡∏≠‡∏á

## 3. Customer Role

### üìã ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
- **‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ**: 26 ‡∏Ñ‡∏ô (‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
- **‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó**: `free_user`, `premium_customer`
- **‡∏Å‡∏≤‡∏£ login**: ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö (‡πÑ‡∏°‡πà‡∏°‡∏µ register page)

### üéØ ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
1. **Sales Staff** ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ:
   - ‡∏î‡∏π leads ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢
   - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏ó‡∏ô‡∏≤‡∏Å‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
   - ‡πÉ‡∏ä‡πâ AI Coach ‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢

2. **Clinic Owner/Admin** ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ:
   - ‡∏î‡∏π‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å
   - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ appointment
   - ‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤

## 4. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Data Isolation ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Sales Staff

### ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö:
- Sales Staff A: `salesstaff2026@10minutemail.com`
- Sales Staff B: ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á

### Leads ‡∏ó‡∏µ‡πà‡∏°‡∏µ:
1. Nattaya R. (nat@example.com) - Status: qualified
2. Kitti P. (kitti@example.com) - Status: contacted  
3. Thanaporn S. (than@example.com) - Status: new

### ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:
- ‚úÖ Leads ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏á (API 404 error)
- ‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Sales Staff

## 5. ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö

### üêõ API Issues
- `/api/ai/lead-prioritizer` - 404 Not Found
- ‡∏ó‡∏≥‡πÉ‡∏´‡πâ Leads ‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ô Sales Dashboard

### üêõ Session Timeout
- Session ‡∏´‡∏°‡∏î‡πÄ‡∏£‡πá‡∏ß (5-10 ‡∏ô‡∏≤‡∏ó‡∏µ)
- ‡∏ï‡πâ‡∏≠‡∏á login ‡∏ö‡πà‡∏≠‡∏¢

### üêõ Register Page
- `/th/register` - 404 Not Found
- ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ

## 6. ‡∏Ç‡πâ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥

### ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô:
1. **‡∏™‡∏£‡πâ‡∏≤‡∏á API endpoints ‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î‡∏´‡∏≤‡∏¢**
   - `/api/ai/lead-prioritizer`
   - `/api/auth/register`

2. **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Session timeout**
   - ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏ô‡∏≤‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô (30-60 ‡∏ô‡∏≤‡∏ó‡∏µ)

3. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö Data Isolation ‡∏â‡∏ö‡∏±‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå**
   - ‡∏™‡∏£‡πâ‡∏≤‡∏á Sales Staff 2 ‡∏Ñ‡∏ô
   - Assign leads ‡∏Ñ‡∏ô‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô
   - ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡∏≠‡∏á‡∏ï‡∏ô

### ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡πà‡∏≠:
1. **Customer Portal**
   - ‡∏´‡∏ô‡πâ‡∏≤ login ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
   - Dashboard ‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤
   - Booking system

2. **Advanced Features**
   - Commission tracking ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Sales Staff
   - Performance analytics
   - Automated lead assignment

## 7. ‡∏™‡∏£‡∏∏‡∏õ

‡∏£‡∏∞‡∏ö‡∏ö BN-Aura ‡∏°‡∏µ **Data Isolation ‡∏ó‡∏µ‡πà‡∏î‡∏µ** ‡πÅ‡∏•‡∏∞ **Role-based Access Control ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå**
- ‚úÖ ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
- ‚úÖ Routing ‡πÅ‡∏•‡∏∞ Menu ‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç API ‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏â‡∏ö‡∏±‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå

**‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á: 90%** üöÄ
