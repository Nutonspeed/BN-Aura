# üí∞ BN-Aura: Quota & Billing Specification (Production v2.0)

‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö BN-Aura ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏±‡πà‡∏á‡∏¢‡∏∑‡∏ô‡πÉ‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ï‡∏±‡∏ß (Scalability) ‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤‡∏ñ‡∏π‡∏Å‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏™‡∏π‡∏á

## 1. Hybrid Quota Architecture

‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ö‡πà‡∏á‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏ä‡∏±‡πâ‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å:

### A. Dynamic Monthly Quota (Subscription Based)
- **Allocation**: ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à (100, 1,000, ‡∏´‡∏£‡∏∑‡∏≠ Unlimited)
- **Neural Caching**: ‡∏´‡∏≤‡∏Å‡∏™‡πÅ‡∏Å‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏ã‡πâ‡∏≥‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏´‡∏±‡∏Å‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° (‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô)
- **Overflow Protection**: ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏Ñ‡∏£‡∏ö 100% ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡∏•‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡πÇ‡∏´‡∏°‡∏î Pay-as-you-go ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Ç‡∏±‡∏î‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢

### B. On-Demand Add-ons (Top-up)
- **Nature**: ‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à‡πÄ‡∏™‡∏£‡∏¥‡∏° (‡πÄ‡∏ä‡πà‡∏ô +500 scans)
- **Lifespan**: ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (Carry-over enabled)
- **Logic**: ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏´‡∏±‡∏Å‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏™‡∏°‡∏≠ ‡∏´‡∏≤‡∏Å‡∏´‡∏°‡∏î‡∏à‡∏∂‡∏á‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏´‡∏±‡∏Å‡∏à‡∏≤‡∏Å‡∏™‡πà‡∏ß‡∏ô Top-up

## 2. Technical Implementation Logic

### Database Governance
‡∏ï‡∏≤‡∏£‡∏≤‡∏á `usage_metrics` ‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô Canonical Source ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Quota:
- `current_usage`: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Scans ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏õ‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô‡∏£‡∏≠‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
- `quota_limit`: ‡∏Ç‡∏µ‡∏î‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏ï‡∏≤‡∏° Tier ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
- `overage_balance`: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡∏á‡∏Ñ‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡πÉ‡∏ä‡πâ‡πÄ‡∏Å‡∏¥‡∏ô (Pay-as-you-go)

### Consumption Rates
- **Clinical Analysis (Gemini 1.5 Pro)**: ‡∏´‡∏±‡∏Å 1.0 ‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏™‡∏π‡∏á)
- **Quick Scan (Gemini 1.5 Flash)**: ‡∏´‡∏±‡∏Å 0.2 ‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì)
- **AI Chat Advisor**: ‡πÑ‡∏°‡πà‡∏´‡∏±‡∏Å‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤ (‡∏£‡∏ß‡∏°‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏£‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö)

## 3. Quota Enforcement & Stability
- **Middleware Check**: ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ Neural Engine API ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Quota ‡∏ú‡πà‡∏≤‡∏ô `lib/quota/quotaManager.ts`
- **Error Handling**: ‡∏´‡∏≤‡∏Å‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô `403_QUOTA_EXCEEDED` ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏° Quota
- **Vercel AI Gateway**: ‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô (Guardrail) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Rate Limiting ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£ Abuse ‡∏£‡∏∞‡∏ö‡∏ö

## 4. Administrative Oversight
- **Sales View**: ‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏ñ‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Quota ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÅ‡∏ö‡∏ö Real-time ‡∏ö‡∏ô Dashboard
- **Admin View**: ‡πÄ‡∏´‡πá‡∏ô‡∏Å‡∏£‡∏≤‡∏ü‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏ß‡∏±‡∏ô‡∏™‡πÅ‡∏Å‡∏ô‡∏´‡∏°‡∏î (Burn Rate Forecast) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÅ‡∏ú‡∏ô‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì
- **System Notifications**: ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö "‡∏ß‡∏¥‡∏Å‡∏§‡∏ï" ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Quota ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ < 5%

---
**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤**: ‚úÖ **OPERATIONAL & SECURED**
**‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î**: 31 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2569
