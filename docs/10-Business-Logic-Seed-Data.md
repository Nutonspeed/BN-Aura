# ğŸ“‹ BN-Aura: Business Logic & Seed Data

à¹€à¸à¸·à¹ˆà¸­à¹ƒà¸«à¹‰ AI à¸ªà¸²à¸¡à¸²à¸£à¸–à¸—à¸”à¸ªà¸­à¸šà¸£à¸°à¸šà¸š BN-Aura à¸—à¸µà¹ˆà¸ªà¸£à¹‰à¸²à¸‡à¸‚à¸¶à¹‰à¸™à¹ƒà¸«à¸¡à¹ˆà¹„à¸”à¹‰à¸—à¸±à¸™à¸—à¸µ à¸ˆà¸³à¹€à¸›à¹‡à¸™à¸•à¹‰à¸­à¸‡à¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™ (Seed Data) à¸—à¸µà¹ˆà¸ªà¸°à¸—à¹‰à¸­à¸™à¸–à¸¶à¸‡ Business Logic à¸‚à¸­à¸‡à¸„à¸¥à¸´à¸™à¸´à¸à¸„à¸§à¸²à¸¡à¸‡à¸²à¸¡

## 1. Roles & Permissions Mapping

à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¸ªà¸³à¸«à¸£à¸±à¸šà¸•à¸²à¸£à¸²à¸‡ `user_roles` à¸«à¸£à¸·à¸­à¸à¸²à¸£à¸à¸³à¸«à¸™à¸”à¸ªà¸´à¸—à¸˜à¸´à¹Œ:

| Role | Permissions | Dashboard Access |
|------|------------|------------------|
| `super_admin` | à¸ˆà¸±à¸”à¸à¸²à¸£à¸—à¸¸à¸à¸­à¸¢à¹ˆà¸²à¸‡à¹ƒà¸™à¸£à¸°à¸šà¸š, à¸”à¸¹à¸ªà¸–à¸´à¸•à¸´à¸£à¸§à¸¡à¸—à¸¸à¸à¸„à¸¥à¸´à¸™à¸´à¸ | `/super-admin` |
| `clinic_owner` | à¸ˆà¸±à¸”à¸à¸²à¸£à¸„à¸¥à¸´à¸™à¸´à¸à¸•à¸±à¸§à¹€à¸­à¸‡, à¸ˆà¸±à¸”à¸à¸²à¸£à¸à¸™à¸±à¸à¸‡à¸²à¸™, à¸”à¸¹à¸£à¸²à¸¢à¹„à¸”à¹‰ | `/clinic/dashboard` |
| `sales_staff` | à¹€à¸à¸´à¹ˆà¸¡ Lead, à¸ªà¹à¸à¸™à¸œà¸´à¸§, à¸ªà¸£à¹‰à¸²à¸‡ Proposal | `/sales/dashboard` |
| `customer` | à¸”à¸¹à¸œà¸¥à¸à¸²à¸£à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸œà¸´à¸§à¸‚à¸­à¸‡à¸•à¸±à¸§à¹€à¸­à¸‡, à¸ˆà¸­à¸‡à¸„à¸´à¸§ | `/customer/dashboard` |

## 1.1 Subscription Tiers (Mapping)

à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¹€à¸à¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¹€à¸­à¸à¸ªà¸²à¸£ `@/docs/12-Subscription-Tiers-Pricing.md`

- **starter**: à¸ªà¸³à¸«à¸£à¸±à¸šà¸„à¸¥à¸´à¸™à¸´à¸à¸‚à¸™à¸²à¸”à¹€à¸¥à¹‡à¸ (100 Scans/Month)
- **professional**: à¸ªà¸³à¸«à¸£à¸±à¸šà¸„à¸¥à¸´à¸™à¸´à¸à¸‚à¸™à¸²à¸”à¸à¸¥à¸²à¸‡ (1,000 Scans/Month)
- **enterprise**: à¸ªà¸³à¸«à¸£à¸±à¸šà¹€à¸Šà¸™à¸„à¸¥à¸´à¸™à¸´à¸ (Unlimited*)

## 2. Default Treatment Catalog (Sample)

à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¸ªà¸³à¸«à¸£à¸±à¸šà¸•à¸²à¸£à¸²à¸‡ `treatments` à¹€à¸à¸·à¹ˆà¸­à¹ƒà¸«à¹‰à¸£à¸°à¸šà¸šà¹à¸™à¸°à¸™à¸³à¹‚à¸›à¸£à¹à¸à¸£à¸¡à¹„à¸”à¹‰:

```sql
INSERT INTO public.treatments (name, name_th, category, price_min, price_max, effectiveness_overall)
VALUES 
('Pico Rejuvenation', 'à¸à¸µà¹‚à¸„à¹€à¸¥à¹€à¸‹à¸­à¸£à¹Œà¸«à¸™à¹‰à¸²à¹ƒà¸ª', 'laser', 5000, 15000, 90),
('Botox Wrinkle Reduction', 'à¸‰à¸µà¸”à¹‚à¸šà¸—à¹‡à¸­à¸à¸‹à¹Œà¸¥à¸”à¸£à¸´à¹‰à¸§à¸£à¸­à¸¢', 'injectable', 3500, 12000, 85),
('HIFU Ultra Lift', 'à¹„à¸®à¸Ÿà¸¹à¸¢à¸à¸à¸£à¸°à¸Šà¸±à¸š', 'device', 8000, 25000, 80),
('Deep Cleansing Facial', 'à¸—à¸³à¸„à¸§à¸²à¸¡à¸ªà¸°à¸­à¸²à¸”à¸œà¸´à¸§à¸¥à¹‰à¸³à¸¥à¸¶à¸', 'skincare', 1500, 3000, 70);
```

## 3. Lead Scoring Logic (Technical)

à¹€à¸à¸“à¸‘à¹Œà¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“ `lead_score` (0-100) à¹€à¸šà¸·à¹‰à¸­à¸‡à¸•à¹‰à¸™:
- **Scan Done**: +40 points (à¸¡à¸µà¸„à¸§à¸²à¸¡à¸ªà¸™à¹ƒà¸ˆà¸ªà¸¹à¸‡)
- **Email/Phone Provided**: +20 points
- **Budget > 20,000 THB**: +20 points
- **Proposal Opened**: +20 points

## 4. Multi-tenant Configuration (Default Settings)

à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸à¸·à¹‰à¸™à¸à¸²à¸™à¸ªà¸³à¸«à¸£à¸±à¸šà¸„à¸¥à¸´à¸™à¸´à¸à¹ƒà¸«à¸¡à¹ˆà¹ƒà¸™à¸•à¸²à¸£à¸²à¸‡ `clinics`:
- `subscription_tier`: 'starter'
- `max_sales_staff`: 3
- `features_enabled`: `{"ai_analysis": true, "ar_simulator": false, "crm": true}`

## 5. Development Test Users

à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸š E2E à¹ƒà¸™à¸ªà¸ à¸²à¸à¹à¸§à¸”à¸¥à¹‰à¸­à¸¡à¹ƒà¸«à¸¡à¹ˆ:
- **Admin**: `admin@test.com` / `password123`
- **Clinic**: `owner@test.com` / `password123`
- **Sales**: `sales@test.com` / `password123`
- **Customer**: `customer@test.com` / `password123`
